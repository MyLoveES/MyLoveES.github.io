[{"name":"Install web app","block":[{"name":"ensure path exists","file":"dest= mode=0755 state=directory"},{"name":"copy jar file","copy":"src=webapp.jar dest="},{"name":"generate application properties","template":"src=application.properties.j2 dest=/application.properties force=true"}],"tags":["install"]},{"name":"check if webapp's port had already stopped","wait_for":{"port":"","state":"stopped","timeout":"3","msg":"Port  is accessible,  not stopped"},"tags":["start","check-stop"]},{"name":"start webapp","shell":{"chdir":"","cmd":"nohup java -jar webapp.jar &> nohup.out &"},"tags":["start"]},{"name":"check if port is accessible","wait_for":{"port":"","state":"started","timeout":"10000","msg":"Port  is not accessible,  not started"},"tags":["start","check-start"]},{"name":"check if port is accessible","wait_for":{"port":"","state":"started","timeout":"3","msg":"Port  is not accessible,  not started"},"tags":["stop"]},{"name":"stop webapp","shell":{"chdir":"","cmd":"ps aux|grep webapp.jar| grep -v grep| awk '{print $2}'|xargs kill"},"tags":["stop"]},{"name":"check if webapp's port had already stopped","wait_for":{"port":"","state":"stopped","timeout":"300","msg":"Port  is accessible,  not stopped"},"tags":["stop","check-stop"]}]