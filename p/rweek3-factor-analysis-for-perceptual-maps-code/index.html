<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content=' R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\n1. Brand rating data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 > brand.ratings <- read.csv("Data_Factor_Analysis.csv", stringsAsFactors = TRUE) > head(brand.ratings) perform leader latest fun serious bargain value trendy rebuy brand 1 2 4 8 8 2 9 7 4 6 a 2 1 1 4 7 1 1 1 2 2 a 3 2 3 5 9 2 9 5 1 6 a 4 1 6 10 8 3 4 5 2 1 a 5 1 1 5 8 1 9 9 1 1 a 6 2 8 9 5 3 8 7 1 2 a > summary(brand.ratings) perform leader latest fun serious bargain value trendy rebuy brand Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.00 Min. : 1.000 a :100 1st Qu.: 1.000 1st Qu.: 2.000 1st Qu.: 4.000 1st Qu.: 4.000 1st Qu.: 2.000 1st Qu.: 2.000 1st Qu.: 2.000 1st Qu.: 3.00 1st Qu.: 1.000 b :100 Median : 4.000 Median : 4.000 Median : 7.000 Median : 6.000 Median : 4.000 Median : 4.000 Median : 4.000 Median : 5.00 Median : 3.000 c :100 Mean : 4.488 Mean : 4.417 Mean : 6.195 Mean : 6.068 Mean : 4.323 Mean : 4.259 Mean : 4.337 Mean : 5.22 Mean : 3.727 d :100 3rd Qu.: 7.000 3rd Qu.: 6.000 3rd Qu.: 9.000 3rd Qu.: 8.000 3rd Qu.: 6.000 3rd Qu.: 6.000 3rd Qu.: 6.000 3rd Qu.: 7.00 3rd Qu.: 5.000 e :100 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.00 Max. :10.000 f :100 (Other):400 > str(brand.ratings) &#39;data.frame&#39;:\t1000 obs. of 10 variables: $ perform: int 2 1 2 1 1 2 1 2 2 3 ... $ leader : int 4 1 3 6 1 8 1 1 1 1 ... $ latest : int 8 4 5 10 5 9 5 7 8 9 ... $ fun : int 8 7 9 8 8 5 7 5 10 8 ... $ serious: int 2 1 2 3 1 3 1 2 1 1 ... $ bargain: int 9 1 9 4 9 8 5 8 7 3 ... $ value : int 7 1 5 5 9 7 1 7 7 3 ... $ trendy : int 4 2 1 2 1 1 1 7 5 4 ... $ rebuy : int 6 2 6 1 1 2 1 1 1 1 ... $ brand : Factor w/ 10 levels "a","b","c","d",..: 1 1 1 1 1 1 1 1 1 1 ... Perceptual adjective (column name) Example survey text perform Brand has a strong performance leader Brand is a leader in the field latest Brand has the latest products fun Brand is fun serious Brand is serious bargain Brand products are a bargain value Brand has a good value trendy Brand is trendy rebuy I would buy from Brand again 1.1 Rescaling the data 标准化 1 2 3 4 5 6 7 8 9 10 11 12 13 14 > brand.sc <- brand.ratings > brand.sc[,1:9] <- scale (brand.ratings[,1:9]) > #we select all rows and the first 9 columns as the 10th column is a factor variable. > summary(brand.sc) perform leader latest fun serious bargain value trendy rebuy brand Min. :-1.0888 Min. :-1.3100 Min. :-1.6878 Min. :-1.84677 Min. :-1.1961 Min. :-1.22196 Min. :-1.3912 Min. :-1.53897 Min. :-1.0717 a :100 1st Qu.:-1.0888 1st Qu.:-0.9266 1st Qu.:-0.7131 1st Qu.:-0.75358 1st Qu.:-0.8362 1st Qu.:-0.84701 1st Qu.:-0.9743 1st Qu.:-0.80960 1st Qu.:-1.0717 b :100 Median :-0.1523 Median :-0.1599 Median : 0.2615 Median :-0.02478 Median :-0.1163 Median :-0.09711 Median :-0.1405 Median :-0.08023 Median :-0.2857 c :100 Mean : 0.0000 Mean : 0.0000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 d :100 3rd Qu.: 0.7842 3rd Qu.: 0.6069 3rd Qu.: 0.9113 3rd Qu.: 0.70402 3rd Qu.: 0.6036 3rd Qu.: 0.65279 3rd Qu.: 0.6933 3rd Qu.: 0.64914 3rd Qu.: 0.5003 e :100 Max. : 1.7206 Max. : 2.1404 Max. : 1.2362 Max. : 1.43281 Max. : 2.0434 Max. : 2.15258 Max. : 2.3610 Max. : 1.74319 Max. : 2.4652 f :100 (Other):400 We can see the standardized variable has a mean of 0.00.\n'><title>R[week3] Factor Analysis For Perceptual Maps Code</title><link rel=canonical href=https://MyLoveES.github.io/p/rweek3-factor-analysis-for-perceptual-maps-code/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="R[week3] Factor Analysis For Perceptual Maps Code"><meta property='og:description' content=' R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\n1. Brand rating data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 > brand.ratings <- read.csv("Data_Factor_Analysis.csv", stringsAsFactors = TRUE) > head(brand.ratings) perform leader latest fun serious bargain value trendy rebuy brand 1 2 4 8 8 2 9 7 4 6 a 2 1 1 4 7 1 1 1 2 2 a 3 2 3 5 9 2 9 5 1 6 a 4 1 6 10 8 3 4 5 2 1 a 5 1 1 5 8 1 9 9 1 1 a 6 2 8 9 5 3 8 7 1 2 a > summary(brand.ratings) perform leader latest fun serious bargain value trendy rebuy brand Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.00 Min. : 1.000 a :100 1st Qu.: 1.000 1st Qu.: 2.000 1st Qu.: 4.000 1st Qu.: 4.000 1st Qu.: 2.000 1st Qu.: 2.000 1st Qu.: 2.000 1st Qu.: 3.00 1st Qu.: 1.000 b :100 Median : 4.000 Median : 4.000 Median : 7.000 Median : 6.000 Median : 4.000 Median : 4.000 Median : 4.000 Median : 5.00 Median : 3.000 c :100 Mean : 4.488 Mean : 4.417 Mean : 6.195 Mean : 6.068 Mean : 4.323 Mean : 4.259 Mean : 4.337 Mean : 5.22 Mean : 3.727 d :100 3rd Qu.: 7.000 3rd Qu.: 6.000 3rd Qu.: 9.000 3rd Qu.: 8.000 3rd Qu.: 6.000 3rd Qu.: 6.000 3rd Qu.: 6.000 3rd Qu.: 7.00 3rd Qu.: 5.000 e :100 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.00 Max. :10.000 f :100 (Other):400 > str(brand.ratings) &#39;data.frame&#39;:\t1000 obs. of 10 variables: $ perform: int 2 1 2 1 1 2 1 2 2 3 ... $ leader : int 4 1 3 6 1 8 1 1 1 1 ... $ latest : int 8 4 5 10 5 9 5 7 8 9 ... $ fun : int 8 7 9 8 8 5 7 5 10 8 ... $ serious: int 2 1 2 3 1 3 1 2 1 1 ... $ bargain: int 9 1 9 4 9 8 5 8 7 3 ... $ value : int 7 1 5 5 9 7 1 7 7 3 ... $ trendy : int 4 2 1 2 1 1 1 7 5 4 ... $ rebuy : int 6 2 6 1 1 2 1 1 1 1 ... $ brand : Factor w/ 10 levels "a","b","c","d",..: 1 1 1 1 1 1 1 1 1 1 ... Perceptual adjective (column name) Example survey text perform Brand has a strong performance leader Brand is a leader in the field latest Brand has the latest products fun Brand is fun serious Brand is serious bargain Brand products are a bargain value Brand has a good value trendy Brand is trendy rebuy I would buy from Brand again 1.1 Rescaling the data 标准化 1 2 3 4 5 6 7 8 9 10 11 12 13 14 > brand.sc <- brand.ratings > brand.sc[,1:9] <- scale (brand.ratings[,1:9]) > #we select all rows and the first 9 columns as the 10th column is a factor variable. > summary(brand.sc) perform leader latest fun serious bargain value trendy rebuy brand Min. :-1.0888 Min. :-1.3100 Min. :-1.6878 Min. :-1.84677 Min. :-1.1961 Min. :-1.22196 Min. :-1.3912 Min. :-1.53897 Min. :-1.0717 a :100 1st Qu.:-1.0888 1st Qu.:-0.9266 1st Qu.:-0.7131 1st Qu.:-0.75358 1st Qu.:-0.8362 1st Qu.:-0.84701 1st Qu.:-0.9743 1st Qu.:-0.80960 1st Qu.:-1.0717 b :100 Median :-0.1523 Median :-0.1599 Median : 0.2615 Median :-0.02478 Median :-0.1163 Median :-0.09711 Median :-0.1405 Median :-0.08023 Median :-0.2857 c :100 Mean : 0.0000 Mean : 0.0000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 d :100 3rd Qu.: 0.7842 3rd Qu.: 0.6069 3rd Qu.: 0.9113 3rd Qu.: 0.70402 3rd Qu.: 0.6036 3rd Qu.: 0.65279 3rd Qu.: 0.6933 3rd Qu.: 0.64914 3rd Qu.: 0.5003 e :100 Max. : 1.7206 Max. : 2.1404 Max. : 1.2362 Max. : 1.43281 Max. : 2.0434 Max. : 2.15258 Max. : 2.3610 Max. : 1.74319 Max. : 2.4652 f :100 (Other):400 We can see the standardized variable has a mean of 0.00.\n'><meta property='og:url' content='https://MyLoveES.github.io/p/rweek3-factor-analysis-for-perceptual-maps-code/'><meta property='og:site_name' content='Kunkka'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='R语言'><meta property='article:tag' content='数据分析'><meta property='article:tag' content='因子分析'><meta property='article:published_time' content='2024-03-23T00:00:00+00:00'><meta property='article:modified_time' content='2024-03-23T00:00:00+00:00'><meta name=twitter:title content="R[week3] Factor Analysis For Perceptual Maps Code"><meta name=twitter:description content=' R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\n1. Brand rating data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 > brand.ratings <- read.csv("Data_Factor_Analysis.csv", stringsAsFactors = TRUE) > head(brand.ratings) perform leader latest fun serious bargain value trendy rebuy brand 1 2 4 8 8 2 9 7 4 6 a 2 1 1 4 7 1 1 1 2 2 a 3 2 3 5 9 2 9 5 1 6 a 4 1 6 10 8 3 4 5 2 1 a 5 1 1 5 8 1 9 9 1 1 a 6 2 8 9 5 3 8 7 1 2 a > summary(brand.ratings) perform leader latest fun serious bargain value trendy rebuy brand Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.00 Min. : 1.000 a :100 1st Qu.: 1.000 1st Qu.: 2.000 1st Qu.: 4.000 1st Qu.: 4.000 1st Qu.: 2.000 1st Qu.: 2.000 1st Qu.: 2.000 1st Qu.: 3.00 1st Qu.: 1.000 b :100 Median : 4.000 Median : 4.000 Median : 7.000 Median : 6.000 Median : 4.000 Median : 4.000 Median : 4.000 Median : 5.00 Median : 3.000 c :100 Mean : 4.488 Mean : 4.417 Mean : 6.195 Mean : 6.068 Mean : 4.323 Mean : 4.259 Mean : 4.337 Mean : 5.22 Mean : 3.727 d :100 3rd Qu.: 7.000 3rd Qu.: 6.000 3rd Qu.: 9.000 3rd Qu.: 8.000 3rd Qu.: 6.000 3rd Qu.: 6.000 3rd Qu.: 6.000 3rd Qu.: 7.00 3rd Qu.: 5.000 e :100 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.00 Max. :10.000 f :100 (Other):400 > str(brand.ratings) &#39;data.frame&#39;:\t1000 obs. of 10 variables: $ perform: int 2 1 2 1 1 2 1 2 2 3 ... $ leader : int 4 1 3 6 1 8 1 1 1 1 ... $ latest : int 8 4 5 10 5 9 5 7 8 9 ... $ fun : int 8 7 9 8 8 5 7 5 10 8 ... $ serious: int 2 1 2 3 1 3 1 2 1 1 ... $ bargain: int 9 1 9 4 9 8 5 8 7 3 ... $ value : int 7 1 5 5 9 7 1 7 7 3 ... $ trendy : int 4 2 1 2 1 1 1 7 5 4 ... $ rebuy : int 6 2 6 1 1 2 1 1 1 1 ... $ brand : Factor w/ 10 levels "a","b","c","d",..: 1 1 1 1 1 1 1 1 1 1 ... Perceptual adjective (column name) Example survey text perform Brand has a strong performance leader Brand is a leader in the field latest Brand has the latest products fun Brand is fun serious Brand is serious bargain Brand products are a bargain value Brand has a good value trendy Brand is trendy rebuy I would buy from Brand again 1.1 Rescaling the data 标准化 1 2 3 4 5 6 7 8 9 10 11 12 13 14 > brand.sc <- brand.ratings > brand.sc[,1:9] <- scale (brand.ratings[,1:9]) > #we select all rows and the first 9 columns as the 10th column is a factor variable. > summary(brand.sc) perform leader latest fun serious bargain value trendy rebuy brand Min. :-1.0888 Min. :-1.3100 Min. :-1.6878 Min. :-1.84677 Min. :-1.1961 Min. :-1.22196 Min. :-1.3912 Min. :-1.53897 Min. :-1.0717 a :100 1st Qu.:-1.0888 1st Qu.:-0.9266 1st Qu.:-0.7131 1st Qu.:-0.75358 1st Qu.:-0.8362 1st Qu.:-0.84701 1st Qu.:-0.9743 1st Qu.:-0.80960 1st Qu.:-1.0717 b :100 Median :-0.1523 Median :-0.1599 Median : 0.2615 Median :-0.02478 Median :-0.1163 Median :-0.09711 Median :-0.1405 Median :-0.08023 Median :-0.2857 c :100 Mean : 0.0000 Mean : 0.0000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 d :100 3rd Qu.: 0.7842 3rd Qu.: 0.6069 3rd Qu.: 0.9113 3rd Qu.: 0.70402 3rd Qu.: 0.6036 3rd Qu.: 0.65279 3rd Qu.: 0.6933 3rd Qu.: 0.64914 3rd Qu.: 0.5003 e :100 Max. : 1.7206 Max. : 2.1404 Max. : 1.2362 Max. : 1.43281 Max. : 2.0434 Max. : 2.15258 Max. : 2.3610 Max. : 1.74319 Max. : 2.4652 f :100 (Other):400 We can see the standardized variable has a mean of 0.00.\n'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c68a00bbf16dac8.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>Kunkka</a></h1><h2 class=site-description>wind rises</h2></div></header><ol class=menu-social><li><a href=https://github.com/MyLoveES target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/about><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/all-categories><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li><a href=/links><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/all-tags><svg class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>Tags</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#11-rescaling-the-data>1.1 Rescaling the data</a><ol><li><a href=#标准化>标准化</a></li></ol></li><li><a href=#12-correlation>1.2 Correlation</a></li><li><a href=#13-mean-rating-by-brand>1.3 Mean rating by brand</a><ol><li><a href=#131-aggregate>1.3.1 aggregate()</a></li></ol></li></ol><ol><li><a href=#21-pca>2.1 PCA</a></li><li><a href=#22-visualising-pca-perceptual-map>2.2 Visualising PCA (perceptual map)</a></li></ol><ol><li><a href=#31-determine-the-factor-number>3.1 Determine the factor number</a></li><li><a href=#32-factor-loadings>3.2 Factor loadings</a></li><li><a href=#33-factor-scores>3.3 Factor scores</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E6%95%99%E7%A8%8B/>教程</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/rweek3-factor-analysis-for-perceptual-maps-code/>R[week3] Factor Analysis For Perceptual Maps Code</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 23, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>12 minute read</time></div></footer></div></header><section class=article-content><blockquote><p>R: 4.3.2 (2023-10-31)
R studio: 2023.12.1+402 (2023.12.1+402)</p></blockquote><h1 id=1-brand-rating-data>1. Brand rating data</h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>ratings</span> <span class=o>&lt;-</span> <span class=n>read</span><span class=o>.</span><span class=n>csv</span><span class=p>(</span><span class=s2>&#34;Data_Factor_Analysis.csv&#34;</span><span class=p>,</span> <span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=n>TRUE</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>head</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>perform</span> <span class=n>leader</span> <span class=n>latest</span> <span class=n>fun</span> <span class=n>serious</span> <span class=n>bargain</span> <span class=n>value</span> <span class=n>trendy</span> <span class=n>rebuy</span> <span class=n>brand</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>       <span class=mi>2</span>      <span class=mi>4</span>      <span class=mi>8</span>   <span class=mi>8</span>       <span class=mi>2</span>       <span class=mi>9</span>     <span class=mi>7</span>      <span class=mi>4</span>     <span class=mi>6</span>     <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>       <span class=mi>1</span>      <span class=mi>1</span>      <span class=mi>4</span>   <span class=mi>7</span>       <span class=mi>1</span>       <span class=mi>1</span>     <span class=mi>1</span>      <span class=mi>2</span>     <span class=mi>2</span>     <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>       <span class=mi>2</span>      <span class=mi>3</span>      <span class=mi>5</span>   <span class=mi>9</span>       <span class=mi>2</span>       <span class=mi>9</span>     <span class=mi>5</span>      <span class=mi>1</span>     <span class=mi>6</span>     <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>       <span class=mi>1</span>      <span class=mi>6</span>     <span class=mi>10</span>   <span class=mi>8</span>       <span class=mi>3</span>       <span class=mi>4</span>     <span class=mi>5</span>      <span class=mi>2</span>     <span class=mi>1</span>     <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>       <span class=mi>1</span>      <span class=mi>1</span>      <span class=mi>5</span>   <span class=mi>8</span>       <span class=mi>1</span>       <span class=mi>9</span>     <span class=mi>9</span>      <span class=mi>1</span>     <span class=mi>1</span>     <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>       <span class=mi>2</span>      <span class=mi>8</span>      <span class=mi>9</span>   <span class=mi>5</span>       <span class=mi>3</span>       <span class=mi>8</span>     <span class=mi>7</span>      <span class=mi>1</span>     <span class=mi>2</span>     <span class=n>a</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>perform</span>           <span class=n>leader</span>           <span class=n>latest</span>            <span class=n>fun</span>            <span class=n>serious</span>          <span class=n>bargain</span>           <span class=n>value</span>            <span class=n>trendy</span>          <span class=n>rebuy</span>            <span class=n>brand</span>    
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.00</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>a</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>1.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>2.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>4.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>4.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>2.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>2.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>2.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>3.00</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>1.000</span>   <span class=n>b</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span> <span class=mf>4.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>4.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>7.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>6.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>4.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>4.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>4.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>5.00</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>3.000</span>   <span class=n>c</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>4.488</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>4.417</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>6.195</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>6.068</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>4.323</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>4.259</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>4.337</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>5.22</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>3.727</span>   <span class=n>d</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>7.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>6.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>9.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>8.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>6.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>6.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>6.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>7.00</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>5.000</span>   <span class=n>e</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.00</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>f</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl>                                                                                                                                                         <span class=p>(</span><span class=n>Other</span><span class=p>):</span><span class=mi>400</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>str</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;data.frame&#39;</span><span class=p>:</span>	<span class=mi>1000</span> <span class=n>obs</span><span class=o>.</span> <span class=n>of</span>  <span class=mi>10</span> <span class=n>variables</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>perform</span><span class=p>:</span> <span class=ne>int</span>  <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>3</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>leader</span> <span class=p>:</span> <span class=ne>int</span>  <span class=mi>4</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>6</span> <span class=mi>1</span> <span class=mi>8</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>latest</span> <span class=p>:</span> <span class=ne>int</span>  <span class=mi>8</span> <span class=mi>4</span> <span class=mi>5</span> <span class=mi>10</span> <span class=mi>5</span> <span class=mi>9</span> <span class=mi>5</span> <span class=mi>7</span> <span class=mi>8</span> <span class=mi>9</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>fun</span>    <span class=p>:</span> <span class=ne>int</span>  <span class=mi>8</span> <span class=mi>7</span> <span class=mi>9</span> <span class=mi>8</span> <span class=mi>8</span> <span class=mi>5</span> <span class=mi>7</span> <span class=mi>5</span> <span class=mi>10</span> <span class=mi>8</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>serious</span><span class=p>:</span> <span class=ne>int</span>  <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>bargain</span><span class=p>:</span> <span class=ne>int</span>  <span class=mi>9</span> <span class=mi>1</span> <span class=mi>9</span> <span class=mi>4</span> <span class=mi>9</span> <span class=mi>8</span> <span class=mi>5</span> <span class=mi>8</span> <span class=mi>7</span> <span class=mi>3</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>value</span>  <span class=p>:</span> <span class=ne>int</span>  <span class=mi>7</span> <span class=mi>1</span> <span class=mi>5</span> <span class=mi>5</span> <span class=mi>9</span> <span class=mi>7</span> <span class=mi>1</span> <span class=mi>7</span> <span class=mi>7</span> <span class=mi>3</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>trendy</span> <span class=p>:</span> <span class=ne>int</span>  <span class=mi>4</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>7</span> <span class=mi>5</span> <span class=mi>4</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>rebuy</span>  <span class=p>:</span> <span class=ne>int</span>  <span class=mi>6</span> <span class=mi>2</span> <span class=mi>6</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>brand</span>  <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>10</span> <span class=n>levels</span> <span class=s2>&#34;a&#34;</span><span class=p>,</span><span class=s2>&#34;b&#34;</span><span class=p>,</span><span class=s2>&#34;c&#34;</span><span class=p>,</span><span class=s2>&#34;d&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><div class=table-wrapper><table><thead><tr><th>Perceptual adjective (column name)</th><th>Example survey text</th></tr></thead><tbody><tr><td>perform</td><td>Brand has a strong performance</td></tr><tr><td>leader</td><td>Brand is a leader in the field</td></tr><tr><td>latest</td><td>Brand has the latest products</td></tr><tr><td>fun</td><td>Brand is fun</td></tr><tr><td>serious</td><td>Brand is serious</td></tr><tr><td>bargain</td><td>Brand products are a bargain</td></tr><tr><td>value</td><td>Brand has a good value</td></tr><tr><td>trendy</td><td>Brand is trendy</td></tr><tr><td>rebuy</td><td>I would buy from Brand again</td></tr></tbody></table></div><h2 id=11-rescaling-the-data>1.1 Rescaling the data</h2><h3 id=标准化>标准化</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>sc</span> <span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>ratings</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>]</span> <span class=o>&lt;-</span> <span class=n>scale</span> <span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>[,</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=c1>#we select all rows and the first 9 columns as the 10th column is a factor variable. </span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>perform</span>            <span class=n>leader</span>            <span class=n>latest</span>             <span class=n>fun</span>              <span class=n>serious</span>           <span class=n>bargain</span>             <span class=n>value</span>             <span class=n>trendy</span>             <span class=n>rebuy</span>             <span class=n>brand</span>    
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.0888</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.3100</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.6878</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.84677</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.1961</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.22196</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.3912</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.53897</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.0717</span>   <span class=n>a</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>1.0888</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.9266</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.7131</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.75358</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.8362</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.84701</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.9743</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.80960</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>1.0717</span>   <span class=n>b</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.1523</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.1599</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>0.2615</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.02478</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.1163</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.09711</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.1405</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.08023</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.2857</span>   <span class=n>c</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.00000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.00000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.00000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>   <span class=n>d</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.7842</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.6069</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.9113</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.70402</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.6036</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.65279</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.6933</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.64914</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.5003</span>   <span class=n>e</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.7206</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.1404</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.2362</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.43281</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.0434</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.15258</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.3610</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.74319</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.4652</span>   <span class=n>f</span>      <span class=p>:</span><span class=mi>100</span>  
</span></span><span class=line><span class=cl>                                                                                                                                                                      <span class=p>(</span><span class=n>Other</span><span class=p>):</span><span class=mi>400</span>
</span></span></code></pre></td></tr></table></div></div><p>We can see the standardized variable has a mean of 0.00.</p><h2 id=12-correlation>1.2 Correlation</h2><p>Correlations among variables show some variables are highly related to each other and potentially could be combined.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; cor(brand.sc[,1:9])
</span></span><span class=line><span class=cl>             perform      leader       latest        fun      serious     bargain       value       trendy      rebuy
</span></span><span class=line><span class=cl>perform  1.000000000  0.50020206 -0.122445813 -0.2563323  0.359172206  0.05712937  0.10194610  0.008733494  0.3066588
</span></span><span class=line><span class=cl>leader   0.500202058  1.00000000  0.026890447 -0.2903576  0.571215126  0.03309405  0.11831017  0.066512436  0.2087004
</span></span><span class=line><span class=cl>latest  -0.122445813  0.02689045  1.000000000  0.2451545  0.009951527 -0.25441902 -0.34271372  0.627627667 -0.3971802
</span></span><span class=line><span class=cl>fun     -0.256332316 -0.29035764  0.245154457  1.0000000 -0.281097443 -0.06655280 -0.14521849  0.127973639 -0.2371607
</span></span><span class=line><span class=cl>serious  0.359172206  0.57121513  0.009951527 -0.2810974  1.000000000 -0.00265559  0.02375656  0.121009377  0.1807027
</span></span><span class=line><span class=cl>bargain  0.057129372  0.03309405 -0.254419016 -0.0665528 -0.002655590  1.00000000  0.73962672 -0.350533746  0.4673811
</span></span><span class=line><span class=cl>value    0.101946104  0.11831017 -0.342713717 -0.1452185  0.023756556  0.73962672  1.00000000 -0.434534536  0.5059617
</span></span><span class=line><span class=cl>trendy   0.008733494  0.06651244  0.627627667  0.1279736  0.121009377 -0.35053375 -0.43453454  1.000000000 -0.2982462
</span></span><span class=line><span class=cl>rebuy    0.306658801  0.20870036 -0.397180225 -0.2371607  0.180702720  0.46738109  0.50596166 -0.298246195  1.0000000
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>corrplot(cor(brand.sc[,1:9]))
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image R_week3_code_corrplot.png %}</p><div style=background-color:#f0f0f0;padding:10px><blockquote><p>corrplot()</p></blockquote><p>corrplot 是 R 语言中用于可视化相关系数矩阵的函数。它提供了丰富的功能，可以创建各种类型的相关系数图，以帮助理解和分析变量之间的相关性。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>corrplot(
</span></span><span class=line><span class=cl>  M,                  # 相关系数矩阵
</span></span><span class=line><span class=cl>  method = &#34;circle&#34;,  # 相关系数图的类型，可以是 &#34;circle&#34;, &#34;square&#34;, &#34;ellipse&#34;, &#34;number&#34;, &#34;shade&#34;, &#34;color&#34;, &#34;pie&#34; 等
</span></span><span class=line><span class=cl>  type = &#34;full&#34;,      # 相关系数类型，可以是 &#34;full&#34;, &#34;upper&#34;, &#34;lower&#34;，默认是 &#34;full&#34;
</span></span><span class=line><span class=cl>  tl.col = &#34;black&#34;,   # 文本标签的颜色
</span></span><span class=line><span class=cl>  tl.srt = 45,        # 文本标签的旋转角度
</span></span><span class=line><span class=cl>  diag = FALSE,       # 是否显示对角线元素
</span></span><span class=line><span class=cl>  addgrid.col = &#34;gray&#34;, # 是否添加网格线，网格线的颜色
</span></span><span class=line><span class=cl>  order = &#34;original&#34;, # 相关系数的排序方式，可以是 &#34;original&#34;, &#34;alphabet&#34;, &#34;hclust&#34;, &#34;FPC&#34;, &#34;color&#34; 等
</span></span><span class=line><span class=cl>  addrect = 2,        # 添加矩形边框的类型和颜色，0表示不添加，1表示默认颜色，2表示自定义颜色
</span></span><span class=line><span class=cl>  rect.col = &#34;black&#34;, # 矩形边框的颜色
</span></span><span class=line><span class=cl>  bg = &#34;white&#34;,       # 相关系数图的背景颜色
</span></span><span class=line><span class=cl>  mar = c(0,0,2,0),   # 图的边缘空白
</span></span><span class=line><span class=cl>  cl.lim = c(-1, 1),  # 相关系数的颜色范围
</span></span><span class=line><span class=cl>  cl.pos = &#34;n&#34;,       # 相关系数的颜色条位置
</span></span><span class=line><span class=cl>  addCoef.col = &#34;black&#34;, # 系数的颜色
</span></span><span class=line><span class=cl>总结一下，当您希望跨多个维度比较几个品牌时，将注意力集中在解释数据变异的前两个或三个主成分上可能会有所帮助。您可以使用屏幕图选择要关注的主成分数量，该图显示了每个主成分解释数据中的多少变化。感知地图将品牌绘制在前两个主成分上，揭示了观察结果与潜在维度（即成分）的关系。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PCA可以使用品牌调查评分（如我们在此处所做的）进行，也可以使用价格和物理测量等客观数据，或者二者的组合进行。无论在哪种情况下，当您面对品牌或产品的多维数据时，PCA可视化都是了解市场差异的有用工具。  addCoefasPercent = TRUE, # 是否以百分比形式显示系数
</span></span><span class=line><span class=cl>  outline = TRUE,     # 是否显示相关系数的外框
</span></span><span class=line><span class=cl>  number.cex = 0.8,  # 数字标签的大小
</span></span><span class=line><span class=cl>  ...)
</span></span></code></pre></td></tr></table></div></div><p>corrplot 函数的主要参数包括：</p><ul><li>M：一个数值型的矩阵，其中存储了相关系数。</li><li>method：指定要绘制的相关系数图的类型，可以是 &ldquo;circle&rdquo;、&ldquo;square&rdquo;、&ldquo;ellipse&rdquo;、&ldquo;number&rdquo;、&ldquo;shade&rdquo;、&ldquo;color&rdquo;、&ldquo;pie&rdquo; 等。</li><li>其中，x是包含原始数据的数据框或矩阵，&mldr;是其他参数，用于控制主成分分析的过程，例如是否进行变量标准化等。</li></ul><p>princomp() 函数返回一个主成分分析结果的对象，该对象包含了主成分分析的各种信息，包括主成分分数、主成分载荷、方差解释比例等。可以使用summary()函数对主成分分析结果进行摘要统计，或者直接访问返回的对象的成分来获取相关信息。type：相关系数类型，可以是 &ldquo;full&rdquo;、&ldquo;upper&rdquo;、&ldquo;lower&rdquo;，默认是 &ldquo;full&rdquo;，表示绘制全部相关系数。</p><ul><li>tl.col：文本标签的颜色。</li><li>tl.srt：文本标签的旋转角度。</li><li>diag：是否显示对角线元素。</li><li>order：相关系数的排序方式，可以是 &ldquo;original&rdquo;、&ldquo;alphabet&rdquo;、&ldquo;hclust&rdquo;、&ldquo;FPC&rdquo;、&ldquo;color&rdquo; 等。</li><li>cl.lim：相关系数的颜色范围。</li><li>addCoefasPercent：是否以百分比形式显示系数。</li></ul></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># use the optional argument (order = “hclust”) to order variables for better visualization</span>
</span></span><span class=line><span class=cl><span class=n>corrplot</span><span class=p>(</span><span class=n>cor</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>]),</span> <span class=n>order</span> <span class=o>=</span> <span class=s2>&#34;hclust&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image R_week3_code_corrplot_with_order.png %}</p><p>The result shows that some of the ratings are highly related to each other so that they could be represented by common factors.</p><h2 id=13-mean-rating-by-brand>1.3 Mean rating by brand</h2><h3 id=131-aggregate>1.3.1 aggregate()</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span> <span class=o>&lt;-</span> <span class=n>aggregate</span><span class=p>(</span><span class=o>.</span> <span class=o>~</span> <span class=n>brand</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>,</span> <span class=n>mean</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span>
</span></span><span class=line><span class=cl>   <span class=n>brand</span>     <span class=n>perform</span>     <span class=n>leader</span>     <span class=n>latest</span>        <span class=n>fun</span>     <span class=n>serious</span>     <span class=n>bargain</span>       <span class=n>value</span>      <span class=n>trendy</span>       <span class=n>rebuy</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=n>a</span> <span class=o>-</span><span class=mf>0.88591874</span> <span class=o>-</span><span class=mf>0.5279035</span>  <span class=mf>0.4109732</span>  <span class=mf>0.6566458</span> <span class=o>-</span><span class=mf>0.91894067</span>  <span class=mf>0.21409609</span>  <span class=mf>0.18469264</span> <span class=o>-</span><span class=mf>0.52514473</span> <span class=o>-</span><span class=mf>0.59616642</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=n>b</span>  <span class=mf>0.93087022</span>  <span class=mf>1.0707584</span>  <span class=mf>0.7261069</span> <span class=o>-</span><span class=mf>0.9722147</span>  <span class=mf>1.18314061</span>  <span class=mf>0.04161938</span>  <span class=mf>0.15133957</span>  <span class=mf>0.74030819</span>  <span class=mf>0.23697320</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>      <span class=n>c</span>  <span class=mf>0.64992347</span>  <span class=mf>1.1627677</span> <span class=o>-</span><span class=mf>0.1023372</span> <span class=o>-</span><span class=mf>0.8446753</span>  <span class=mf>1.22273461</span> <span class=o>-</span><span class=mf>0.60704302</span> <span class=o>-</span><span class=mf>0.44067747</span>  <span class=mf>0.02552787</span> <span class=o>-</span><span class=mf>0.13243776</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>      <span class=n>d</span> <span class=o>-</span><span class=mf>0.67989112</span> <span class=o>-</span><span class=mf>0.5930767</span>  <span class=mf>0.3524948</span>  <span class=mf>0.1865719</span> <span class=o>-</span><span class=mf>0.69217505</span> <span class=o>-</span><span class=mf>0.88075605</span> <span class=o>-</span><span class=mf>0.93263529</span>  <span class=mf>0.73666135</span> <span class=o>-</span><span class=mf>0.49398892</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>      <span class=n>e</span> <span class=o>-</span><span class=mf>0.56439079</span>  <span class=mf>0.1928362</span>  <span class=mf>0.4564564</span>  <span class=mf>0.2958914</span>  <span class=mf>0.04211361</span>  <span class=mf>0.55155051</span>  <span class=mf>0.41816415</span>  <span class=mf>0.13857986</span>  <span class=mf>0.03654811</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>      <span class=n>f</span> <span class=o>-</span><span class=mf>0.05868665</span>  <span class=mf>0.2695106</span> <span class=o>-</span><span class=mf>1.2621589</span> <span class=o>-</span><span class=mf>0.2179102</span>  <span class=mf>0.58923066</span>  <span class=mf>0.87400696</span>  <span class=mf>1.02268859</span> <span class=o>-</span><span class=mf>0.81324496</span>  <span class=mf>1.35699580</span>
</span></span><span class=line><span class=cl><span class=mi>7</span>      <span class=n>g</span>  <span class=mf>0.91838369</span> <span class=o>-</span><span class=mf>0.1675336</span> <span class=o>-</span><span class=mf>1.2849005</span> <span class=o>-</span><span class=mf>0.5167168</span> <span class=o>-</span><span class=mf>0.53379906</span>  <span class=mf>0.89650392</span>  <span class=mf>1.25616009</span> <span class=o>-</span><span class=mf>1.27639344</span>  <span class=mf>1.36092571</span>
</span></span><span class=line><span class=cl><span class=mi>8</span>      <span class=n>h</span> <span class=o>-</span><span class=mf>0.01498383</span> <span class=o>-</span><span class=mf>0.2978802</span>  <span class=mf>0.5019396</span>  <span class=mf>0.7149495</span> <span class=o>-</span><span class=mf>0.14145855</span> <span class=o>-</span><span class=mf>0.73827529</span> <span class=o>-</span><span class=mf>0.78254646</span>  <span class=mf>0.86430070</span> <span class=o>-</span><span class=mf>0.60402622</span>
</span></span><span class=line><span class=cl><span class=mi>9</span>      <span class=n>i</span>  <span class=mf>0.33463879</span> <span class=o>-</span><span class=mf>0.3208825</span>  <span class=mf>0.3557436</span>  <span class=mf>0.4124989</span> <span class=o>-</span><span class=mf>0.14865746</span> <span class=o>-</span><span class=mf>0.25459062</span> <span class=o>-</span><span class=mf>0.80339213</span>  <span class=mf>0.59078782</span> <span class=o>-</span><span class=mf>0.20317603</span>
</span></span><span class=line><span class=cl><span class=mi>10</span>     <span class=n>j</span> <span class=o>-</span><span class=mf>0.62994504</span> <span class=o>-</span><span class=mf>0.7885965</span> <span class=o>-</span><span class=mf>0.1543180</span>  <span class=mf>0.2849595</span> <span class=o>-</span><span class=mf>0.60218870</span> <span class=o>-</span><span class=mf>0.09711188</span> <span class=o>-</span><span class=mf>0.07379367</span> <span class=o>-</span><span class=mf>0.48138267</span> <span class=o>-</span><span class=mf>0.96164748</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>rownames</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>[,</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=c1># Use brand for the row name</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span> <span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span> <span class=p>[,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=c1># Remove the brand name column by not selecting the first column # Negative index is used to exclude the variable</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span>
</span></span><span class=line><span class=cl>      <span class=n>perform</span>     <span class=n>leader</span>     <span class=n>latest</span>        <span class=n>fun</span>     <span class=n>serious</span>     <span class=n>bargain</span>       <span class=n>value</span>      <span class=n>trendy</span>       <span class=n>rebuy</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>-</span><span class=mf>0.88591874</span> <span class=o>-</span><span class=mf>0.5279035</span>  <span class=mf>0.4109732</span>  <span class=mf>0.6566458</span> <span class=o>-</span><span class=mf>0.91894067</span>  <span class=mf>0.21409609</span>  <span class=mf>0.18469264</span> <span class=o>-</span><span class=mf>0.52514473</span> <span class=o>-</span><span class=mf>0.59616642</span>
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mf>0.93087022</span>  <span class=mf>1.0707584</span>  <span class=mf>0.7261069</span> <span class=o>-</span><span class=mf>0.9722147</span>  <span class=mf>1.18314061</span>  <span class=mf>0.04161938</span>  <span class=mf>0.15133957</span>  <span class=mf>0.74030819</span>  <span class=mf>0.23697320</span>
</span></span><span class=line><span class=cl><span class=n>c</span>  <span class=mf>0.64992347</span>  <span class=mf>1.1627677</span> <span class=o>-</span><span class=mf>0.1023372</span> <span class=o>-</span><span class=mf>0.8446753</span>  <span class=mf>1.22273461</span> <span class=o>-</span><span class=mf>0.60704302</span> <span class=o>-</span><span class=mf>0.44067747</span>  <span class=mf>0.02552787</span> <span class=o>-</span><span class=mf>0.13243776</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>-</span><span class=mf>0.67989112</span> <span class=o>-</span><span class=mf>0.5930767</span>  <span class=mf>0.3524948</span>  <span class=mf>0.1865719</span> <span class=o>-</span><span class=mf>0.69217505</span> <span class=o>-</span><span class=mf>0.88075605</span> <span class=o>-</span><span class=mf>0.93263529</span>  <span class=mf>0.73666135</span> <span class=o>-</span><span class=mf>0.49398892</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>-</span><span class=mf>0.56439079</span>  <span class=mf>0.1928362</span>  <span class=mf>0.4564564</span>  <span class=mf>0.2958914</span>  <span class=mf>0.04211361</span>  <span class=mf>0.55155051</span>  <span class=mf>0.41816415</span>  <span class=mf>0.13857986</span>  <span class=mf>0.03654811</span>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>-</span><span class=mf>0.05868665</span>  <span class=mf>0.2695106</span> <span class=o>-</span><span class=mf>1.2621589</span> <span class=o>-</span><span class=mf>0.2179102</span>  <span class=mf>0.58923066</span>  <span class=mf>0.87400696</span>  <span class=mf>1.02268859</span> <span class=o>-</span><span class=mf>0.81324496</span>  <span class=mf>1.35699580</span>
</span></span><span class=line><span class=cl><span class=n>g</span>  <span class=mf>0.91838369</span> <span class=o>-</span><span class=mf>0.1675336</span> <span class=o>-</span><span class=mf>1.2849005</span> <span class=o>-</span><span class=mf>0.5167168</span> <span class=o>-</span><span class=mf>0.53379906</span>  <span class=mf>0.89650392</span>  <span class=mf>1.25616009</span> <span class=o>-</span><span class=mf>1.27639344</span>  <span class=mf>1.36092571</span>
</span></span><span class=line><span class=cl><span class=n>h</span> <span class=o>-</span><span class=mf>0.01498383</span> <span class=o>-</span><span class=mf>0.2978802</span>  <span class=mf>0.5019396</span>  <span class=mf>0.7149495</span> <span class=o>-</span><span class=mf>0.14145855</span> <span class=o>-</span><span class=mf>0.73827529</span> <span class=o>-</span><span class=mf>0.78254646</span>  <span class=mf>0.86430070</span> <span class=o>-</span><span class=mf>0.60402622</span>
</span></span><span class=line><span class=cl><span class=n>i</span>  <span class=mf>0.33463879</span> <span class=o>-</span><span class=mf>0.3208825</span>  <span class=mf>0.3557436</span>  <span class=mf>0.4124989</span> <span class=o>-</span><span class=mf>0.14865746</span> <span class=o>-</span><span class=mf>0.25459062</span> <span class=o>-</span><span class=mf>0.80339213</span>  <span class=mf>0.59078782</span> <span class=o>-</span><span class=mf>0.20317603</span>
</span></span><span class=line><span class=cl><span class=n>j</span> <span class=o>-</span><span class=mf>0.62994504</span> <span class=o>-</span><span class=mf>0.7885965</span> <span class=o>-</span><span class=mf>0.1543180</span>  <span class=mf>0.2849595</span> <span class=o>-</span><span class=mf>0.60218870</span> <span class=o>-</span><span class=mf>0.09711188</span> <span class=o>-</span><span class=mf>0.07379367</span> <span class=o>-</span><span class=mf>0.48138267</span> <span class=o>-</span><span class=mf>0.96164748</span>
</span></span></code></pre></td></tr></table></div></div><p>Then we can visualize this matrix by using a heat map :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>heatmap.2(as.matrix(brand.mean),main = &#34;Brand attributes&#34;, trace = &#34;none&#34;, key = FALSE, dend = &#34;none&#34;) #turn off some options
</span></span></code></pre></td></tr></table></div></div><p>颜色越浅表示值越高，颜色越深表示值越低。我们可以看到，品牌的感知明显不同，一些品牌在performance、leader方面得分很高(品牌b和c)，而另一些品牌在value和rebuy方面得分很高(品牌f和g)。<br>从相关图和热图图中，我们可以猜测形容词和品牌的分组和关系。例如，bargin/value/rebuy的各栏的颜色模式有相似之处。接下来我们将正式阐述这种见解。</p><h1 id=2-principal-component-analysis-pca-using-princomp>2 Principal component analysis (PCA) using princomp()</h1><p>princomp()函数产生未旋转的主成分分析。</p><p>您可以使用原始的个人评分数据brand.sc或聚合的平均评分数据brand.mean。个体受访者评分的图表可能会过于密集，可能无法清楚地告诉我们有关品牌位置的信息！更好的解决方案是使用按品牌聚合的评分执行PCA。</p><h2 id=21-pca>2.1 PCA</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; brand.pc&lt;- princomp(brand.mean, cor = TRUE)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; #We added &#34;cor =TRUE&#34; to use correlation-based one. 
</span></span><span class=line><span class=cl>&gt; summary(brand.pc)
</span></span><span class=line><span class=cl>Importance of components:
</span></span><span class=line><span class=cl>                         Comp.1    Comp.2     Comp.3     Comp.4    Comp.5     Comp.6      Comp.7      Comp.8       Comp.9
</span></span><span class=line><span class=cl>Standard deviation     2.134521 1.7349473 0.76898915 0.61498280 0.5098261 0.36661576 0.215062433 0.145882355 0.0486674686
</span></span><span class=line><span class=cl>Proportion of Variance 0.506242 0.3344491 0.06570492 0.04202265 0.0288803 0.01493412 0.005139094 0.002364629 0.0002631692
</span></span><span class=line><span class=cl>Cumulative Proportion  0.506242 0.8406911 0.90639603 0.94841868 0.9772990 0.99223311 0.997372202 0.999736831 1.0000000000
</span></span></code></pre></td></tr></table></div></div><div style=background-color:#f0f0f0;padding:10px><blockquote><p>princomp()</p></blockquote><p>princomp() 函数是R语言中用于进行主成分分析（PCA）的函数之一。它可以用于对数据进行降维，找出数据中的主要方向或主成分，从而简化数据并提取关键特征。</p><p>其中，x是包含原始数据的数据框或矩阵，&mldr;是其他参数，用于控制主成分分析的过程，例如是否进行变量标准化等。</p><p>princomp() 函数返回一个主成分分析结果的对象，该对象包含了主成分分析的各种信息，包括主成分分数、主成分载荷、方差解释比例等。可以使用summary()函数对主成分分析结果进行摘要统计，或者直接访问返回的对象的成分来获取相关信息。</p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>plot(brand.pc,type=&#34;l&#34;) # scree plot
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image R_week3_PCA %}</p><p>发生在图线出现拐点的地方，在上图中，拐点出现在第三个组件处。这表明前两个组件解释了观察到的品牌评分中大部分的变异。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>loadings</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>pc</span><span class=p>)</span> <span class=c1># pc loadings</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Loadings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>Comp</span><span class=o>.</span><span class=mi>1</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>2</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>3</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>4</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>5</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>6</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>7</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>8</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=n>perform</span>  <span class=mf>0.285</span>  <span class=mf>0.337</span>  <span class=mf>0.481</span>  <span class=mf>0.470</span>  <span class=mf>0.396</span>  <span class=mf>0.435</span>                     
</span></span><span class=line><span class=cl><span class=n>leader</span>   <span class=mf>0.247</span>  <span class=mf>0.457</span> <span class=o>-</span><span class=mf>0.317</span> <span class=o>-</span><span class=mf>0.191</span>         <span class=mf>0.119</span> <span class=o>-</span><span class=mf>0.610</span>         <span class=mf>0.451</span>
</span></span><span class=line><span class=cl><span class=n>latest</span>  <span class=o>-</span><span class=mf>0.356</span>  <span class=mf>0.251</span> <span class=o>-</span><span class=mf>0.496</span>  <span class=mf>0.275</span>  <span class=mf>0.461</span>        <span class=o>-</span><span class=mf>0.196</span> <span class=o>-</span><span class=mf>0.119</span> <span class=o>-</span><span class=mf>0.466</span>
</span></span><span class=line><span class=cl><span class=n>fun</span>     <span class=o>-</span><span class=mf>0.336</span> <span class=o>-</span><span class=mf>0.335</span> <span class=o>-</span><span class=mf>0.152</span>  <span class=mf>0.324</span> <span class=o>-</span><span class=mf>0.388</span>  <span class=mf>0.636</span> <span class=o>-</span><span class=mf>0.246</span>  <span class=mf>0.179</span>       
</span></span><span class=line><span class=cl><span class=n>serious</span>  <span class=mf>0.212</span>  <span class=mf>0.475</span> <span class=o>-</span><span class=mf>0.244</span> <span class=o>-</span><span class=mf>0.212</span> <span class=o>-</span><span class=mf>0.394</span>  <span class=mf>0.334</span>  <span class=mf>0.439</span>        <span class=o>-</span><span class=mf>0.407</span>
</span></span><span class=line><span class=cl><span class=n>bargain</span>  <span class=mf>0.361</span> <span class=o>-</span><span class=mf>0.278</span> <span class=o>-</span><span class=mf>0.459</span>  <span class=mf>0.291</span>  <span class=mf>0.112</span>  <span class=mf>0.127</span>  <span class=mf>0.319</span> <span class=o>-</span><span class=mf>0.513</span>  <span class=mf>0.321</span>
</span></span><span class=line><span class=cl><span class=n>value</span>    <span class=mf>0.401</span> <span class=o>-</span><span class=mf>0.241</span> <span class=o>-</span><span class=mf>0.336</span>         <span class=mf>0.206</span>                <span class=mf>0.778</span>       
</span></span><span class=line><span class=cl><span class=n>trendy</span>  <span class=o>-</span><span class=mf>0.311</span>  <span class=mf>0.375</span>         <span class=mf>0.484</span> <span class=o>-</span><span class=mf>0.273</span> <span class=o>-</span><span class=mf>0.339</span>  <span class=mf>0.322</span>  <span class=mf>0.243</span>  <span class=mf>0.410</span>
</span></span><span class=line><span class=cl><span class=n>rebuy</span>    <span class=mf>0.430</span>                <span class=mf>0.442</span> <span class=o>-</span><span class=mf>0.438</span> <span class=o>-</span><span class=mf>0.368</span> <span class=o>-</span><span class=mf>0.352</span> <span class=o>-</span><span class=mf>0.142</span> <span class=o>-</span><span class=mf>0.372</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>               <span class=n>Comp</span><span class=o>.</span><span class=mi>1</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>2</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>3</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>4</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>5</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>6</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>7</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>8</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=n>SS</span> <span class=n>loadings</span>     <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>
</span></span><span class=line><span class=cl><span class=n>Proportion</span> <span class=n>Var</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>
</span></span><span class=line><span class=cl><span class=n>Cumulative</span> <span class=n>Var</span>  <span class=mf>0.111</span>  <span class=mf>0.222</span>  <span class=mf>0.333</span>  <span class=mf>0.444</span>  <span class=mf>0.556</span>  <span class=mf>0.667</span>  <span class=mf>0.778</span>  <span class=mf>0.889</span>  <span class=mf>1.000</span>
</span></span></code></pre></td></tr></table></div></div><div style=background-color:#f0f0f0;padding:10px><blockquote><p>loadings()</p></blockquote><p>通常用于提取主成分分析（PCA）结果中的主成分载荷。主成分载荷是描述主成分与原始变量之间相关性的系数，它告诉我们每个主成分与每个原始变量之间的关系强度和方向。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>loadings</span><span class=p>(</span><span class=n>object</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>其中，object是进行主成分分析后返回的结果对象，通常是使用princomp()或prcomp()函数进行主成分分析后得到的对象。</p><p>loadings()函数会返回一个矩阵，其中的行表示原始变量，列表示主成分。矩阵中的元素是主成分载荷，表示每个主成分与对应原始变量之间的相关系数。</p></div><h2 id=22-visualising-pca-perceptual-map>2.2 Visualising PCA (perceptual map)</h2><p>biplot()是关于前两个PCA成分的数据点的二维图。它展示了评分形容词之间的关联。对平均评分的PCA解的biplot提供了可解释的感知图，显示了品牌相对于前两个主成分的位置。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>biplot(brand.pc, main = &#34;Brand positioning&#34;)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image R_week3_biplot.png %}</p><p>The result shows the adjective map in four regions:<br>• category leadership: “serious”, “leader”, and “perform”<br>• category value: “rebuy”, “value”, and “bargain”<br>• category trendiness: “trendy” and “latest”<br>• category fun: “fun”</p><p>What does the map tell us? First, we interpret the adjective clusters and relationships and see four areas with well-differentiated sets of adjectives and brands that are positioned in proximity. Brands f and g are high on “value”, while brands a and j are relatively high on fun, which is opposite in direction from leadership adjectives (“leader” and “serious”).</p><div style=background-color:#f0f0f0;padding:10px><p>假设您是品牌e的品牌经理，地图告诉您什么？</p><p>您的品牌位于中心，因此在任何维度上似乎都没有很好的差异化。这可能是好事，也可能是坏事，这取决于您的战略目标。</p><p>关于您的品牌e的位置，您应该怎么做？</p><p>再次强调，这取决于战略目标。如果您希望增加差异化，一种可能性是采取行动将您的品牌朝地图上的某个方向移动。</p></div><ul><li>假设您希望朝品牌c的方向移动</li></ul><p>您可以查看数据中与c的具体差异：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; brand.mean[&#34;c&#34;,] - brand.mean[&#34;e&#34;,]
</span></span><span class=line><span class=cl>   perform    leader     latest       fun  serious   bargain      value    trendy      rebuy
</span></span><span class=line><span class=cl>c 1.214314 0.9699315 -0.5587936 -1.140567 1.180621 -1.158594 -0.8588416 -0.113052 -0.1689859
</span></span></code></pre></td></tr></table></div></div><p>这表明在“value”和“fun”方面，e相对于c更强，<br>而在“perform”和“serious”方面则比c弱。<br>这些可能是e需要努力改进的产品或信息方面。</p><ul><li>另一个选择是瞄准一个没有品牌定位的差异化空间</li></ul><p>在图中，右下角和右上角之间有一个很大的间隙。这个区域可以被描述为“value leader”区域或类似的区域。我们如何找出如何定位在那里呢？<br>让我们假设这个间隙大致反映了那四个品牌（g、f、c和b）的平均值。我们可以使用colMeans()在品牌的行上找到平均值，然后将e与该平均值相比较：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; colMeans(brand.mean[c(&#34;b&#34;,&#34;c&#34;,&#34;f&#34;,&#34;g&#34;),]) - brand.mean[&#34;e&#34;,]
</span></span><span class=line><span class=cl>   perform    leader     latest        fun   serious    bargain      value     trendy     rebuy
</span></span><span class=line><span class=cl>e 1.174513 0.3910396 -0.9372789 -0.9337707 0.5732131 -0.2502787 0.07921355 -0.4695304 0.6690661
</span></span></code></pre></td></tr></table></div></div><p>这表明品牌e可以通过增加对性能的重视，同时减少对“最新”和“乐趣”的重视来瞄准这个间隙。</p><h1 id=3-factor-analysis-using-factanal->3 Factor analysis using factanal() *</h1><p>factanal()函数执行最大似然因子分析。</p><div style=background-color:#f0f0f0;padding:10px><blockquote><p>factanal()</p></blockquote><p>factanal()函数是R语言中用于执行因子分析（Factor Analysis）的函数之一。因子分析是一种多变量统计方法，用于探索多个变量之间的内在结构和关联关系，它试图通过发现潜在的不可观测的因子来解释变量之间的相关性。</p><p>基本语法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>factanal(x, factors, data, ...)
</span></span></code></pre></td></tr></table></div></div><p>其中：</p><ul><li>x 是包含原始数据的数据框或矩阵。</li><li>factors 是要提取的因子数量，可以是一个整数或一个因子提取方法，如"ML"表示最大似然估计法。</li><li>data 是包含原始数据的数据框，如果在x中指定了变量名，可以不使用该参数。</li><li>&mldr; 是其他参数，用于指定因子分析的一些选项，例如旋转方法、提取方法等。</li></ul><p>factanal()函数返回一个包含因子分析结果的对象，其中包括提取的因子、因子载荷、特征值等信息。可以使用print()或summary()函数来查看因子分析结果的摘要信息。</p><blockquote><p>最大似然因子分析（Maximum Likelihood Factor Analysis）</p></blockquote><p>是因子分析（Factor Analysis）的一种参数估计方法。在最大似然因子分析中，通过最大化观察数据的似然函数来估计因子载荷、因子方差和误差方差等参数，以获得对数据结构的最佳解释。</p><p>最大似然因子分析假设观察数据服从多变量正态分布，并试图找出能够最大程度地解释数据变异的潜在因子。具体来说，它假设每个观察数据是由一个线性组合的因子和误差项组成，并尝试找出最合适的因子载荷，使得模型对观察数据的拟合最优。</p><p>在最大似然因子分析中，通常会使用EM算法（期望最大化算法）来估计模型参数，其中EM算法的目标是在每次迭代中最大化观察数据的似然函数，通过交替地进行E步骤（Expectation Step）和M步骤（Maximization Step）来达到这个目标。</p><p>最大似然因子分析是一种常用的因子分析方法，它通常用于探索多个变量之间的潜在结构，并识别出能够解释观察数据变异的重要因子。</p></div><h2 id=31-determine-the-factor-number>3.1 Determine the factor number</h2><p>首先要确定要估计的因子数量。有各种方法可以做到这一点，其中两种传统方法是使用screen plot，以及保留特征值（用于解释方差比例的指标）大于1.0的因子。特征值为1.0对应于可能归因于单个自变量的方差量；捕获比此类项更少方差的因子可能被认为相对不重要。</p><p>screen plot和eigenvalues可以通过使用nFactors中的nScree()函数从分析中正式获得。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; nScree(brand.mean)
</span></span><span class=line><span class=cl>  noc naf nparallel nkaiser
</span></span><span class=line><span class=cl>1   2   2         2       2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; eigen(cor(brand.mean))
</span></span><span class=line><span class=cl>eigen() decomposition
</span></span><span class=line><span class=cl>$values
</span></span><span class=line><span class=cl>[1] 4.556177847 3.010042148 0.591344314 0.378203844 0.259922697 0.134407115 0.046251850 0.021281662 0.002368523
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$vectors
</span></span><span class=line><span class=cl>            [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]         [,8]         [,9]
</span></span><span class=line><span class=cl> [1,] -0.2852486 -0.33729698  0.48121446  0.46995620  0.39623804  0.43471514 -0.02784431  0.074243080  0.012984626
</span></span><span class=line><span class=cl> [2,] -0.2473668 -0.45654557 -0.31711577 -0.19084693 -0.06130157  0.11868317  0.60997229  0.021119910  0.450594077
</span></span><span class=line><span class=cl> [3,]  0.3562989 -0.25056983 -0.49589600  0.27477470  0.46061874 -0.08173299  0.19587019 -0.119316063 -0.466262266
</span></span><span class=line><span class=cl> [4,]  0.3355152  0.33455495 -0.15167546  0.32394053 -0.38757837  0.63609709  0.24602385  0.179248006 -0.008094488
</span></span><span class=line><span class=cl> [5,] -0.2121240 -0.47463096 -0.24371327 -0.21229430 -0.39428137  0.33437227 -0.43881277  0.005157446 -0.406716076
</span></span><span class=line><span class=cl> [6,] -0.3613409  0.27776101 -0.45940272  0.29120398  0.11248446  0.12716342 -0.31905166 -0.512721569  0.320827507
</span></span><span class=line><span class=cl> [7,] -0.4010778  0.24062869 -0.33576144  0.05052374  0.20581208 -0.08329187 -0.08325891  0.778125659 -0.065102236
</span></span><span class=line><span class=cl> [8,]  0.3114405 -0.37521575 -0.08724910  0.48392969 -0.27261916 -0.33925412 -0.32150758  0.243224760  0.410460300
</span></span><span class=line><span class=cl> [9,] -0.4295359  0.04438337  0.09031492  0.44234693 -0.43824713 -0.36828116  0.35159046 -0.141872872 -0.371841553
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nScree()应用了几种方法来从屏幕测试中估计因子的数量。
</span></span></code></pre></td></tr></table></div></div><div style=background-color:#f0f0f0;padding:10px><blockquote><p>nScree()</p></blockquote><p>用于绘制Scree Plot（屏幕图），以帮助确定因子分析中的因子数量。</p><p>基本语法是：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nScree(fit)
</span></span></code></pre></td></tr></table></div></div><p>其中，fit是一个包含因子分析结果的对象，通常是使用nFactors包中的fa()函数进行因子分析后得到的结果。</p><p>此函数将会绘制一个Scree Plot，图中横轴表示因子数量，纵轴表示特征值（eigenvalue），并且可以根据特征值的变化趋势来帮助确定合适的因子数量。通常，我们会观察Scree Plot中特征值开始急剧下降的位置，这个位置之前的因子数量通常被认为是适当的因子数量。</p><p>在您的情况下，您使用nScree(brand.mean)，其中brand.mean是您的数据，将会绘制一个Scree Plot来帮助您确定适当的因子数量。您可以根据Scree Plot的结果来选择合适的因子数量，以便在因子分析中获得最佳的解释力和简化度。</p><blockquote><p>eigen()</p></blockquote><p>eigen() 函数是R语言中用于计算矩阵特征值（eigenvalues）和特征向量（eigenvectors）的函数。在因子分析中，它通常用于计算相关矩阵的特征值和特征向量，以便进行主成分分析或因子分析。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>eigen(x)
</span></span></code></pre></td></tr></table></div></div><p>其中，x是一个方阵，可以是一个相关矩阵或协方差矩阵。</p><p>eigen()函数返回一个列表，其中包含了两个元素：</p><ul><li>$values：一个向量，包含了矩阵的特征值。</li><li>$vectors：一个矩阵，每一列是矩阵的一个特征向量。</li></ul><p>这些特征值和特征向量可以用于进行主成分分析（PCA）或因子分析（FA），以及其他需要计算矩阵特征值和特征向量的分析方法。</p></div><p>最终模型的选择取决于它是否有用。最佳实践是检查几个因子解决方案，包括scree和eigenvalues结果建议的解决方案。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>fa</span> <span class=o>&lt;-</span> <span class=n>factanal</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>,</span> <span class=n>factors</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=n>rotation</span> <span class=o>=</span> <span class=s2>&#34;varimax&#34;</span><span class=p>,</span> <span class=n>scores</span> <span class=o>=</span> <span class=s2>&#34;regression&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>因子分析可以进行旋转，以具有解释相同方差比例的新载荷。</span><span class=n>factanal</span><span class=p>()</span><span class=err>中的默认设置是找到各因子之间的零相关性（使用</span><span class=n>varimax旋转</span><span class=err>）。</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=32-factor-loadings>3.2 Factor loadings</h2><p>因子载荷是从载荷值中获得的。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>fl</span><span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>fa</span><span class=o>$</span><span class=n>loadings</span><span class=p>[,</span> <span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>可以简单地使用因子载荷将变量绘制在两个因子上。例如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; plot(brand.fl,type=&#34;n&#34;) # set up plot 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; text(brand.fl,labels=names(brand.mean),cex=.7)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image R_week3_factor_loading.png %}</p><h2 id=33-factor-scores>3.3 Factor scores</h2><p>从factanal()请求因子得分是通过添加"scores = &mldr;&ldquo;参数实现的。然后，我们可以从生成的对象中提取它们以形成一个新的数据框。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>brand.fs &lt;- brand.fa$scores
</span></span></code></pre></td></tr></table></div></div><p>我们可以简单地使用因子得分将品牌绘制在两个因子上。例如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; plot(brand.fl,type=&#34;n&#34;) # set up plot 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; text(brand.fl,labels=rownames(brand.mean),cex=.7)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image R_week3_factor_scores.png %}</p><h1 id=recap>Recap</h1><p>总结一下，当希望跨多个维度比较几个品牌时，将注意力集中在解释数据变异的前两个或三个主成分上可能会有所帮助。您可以使用屏幕图选择要关注的主成分数量，该图显示了每个主成分解释数据中的多少变化。感知地图将品牌绘制在前两个主成分上，揭示了观察结果与潜在维度（即成分）的关系。</p><p>PCA可以使用品牌调查评分（如我们在此处所做的）进行，也可以使用价格和物理测量等客观数据，或者二者的组合进行。无论在哪种情况下，当您面对品牌或产品的多维数据时，PCA可视化都是了解市场差异的有用工具。</p><h1 id=code>Code</h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>library</span><span class=p>(</span><span class=s2>&#34;corrplot&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>library</span><span class=p>(</span><span class=s2>&#34;gplots&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>library</span><span class=p>(</span><span class=s2>&#34;nFactors&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span> <span class=o>&lt;-</span> <span class=n>read</span><span class=o>.</span><span class=n>csv</span><span class=p>(</span><span class=s2>&#34;Data_Factor_Analysis.csv&#34;</span><span class=p>,</span> <span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=n>TRUE</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>head</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>summary</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>str</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>sc</span> <span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>ratings</span>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>]</span> <span class=o>&lt;-</span> <span class=n>scale</span> <span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>[,</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=c1>#we select all rows and the first 9 columns as the 10th column is a factor variable. </span>
</span></span><span class=line><span class=cl><span class=n>summary</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cor</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>corrplot</span><span class=p>(</span><span class=n>cor</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>corrplot</span><span class=p>(</span><span class=n>cor</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>]),</span> <span class=n>order</span> <span class=o>=</span> <span class=s2>&#34;hclust&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>mean</span> <span class=o>&lt;-</span> <span class=n>aggregate</span><span class=p>(</span><span class=o>.</span> <span class=o>~</span> <span class=n>brand</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>,</span> <span class=n>mean</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>mean</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rownames</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>[,</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># Use brand for the row name</span>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>mean</span> <span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span> <span class=p>[,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># Remove the brand name column by not selecting the first column # Negative index is used to exclude the variable</span>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>mean</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>heatmap</span><span class=o>.</span><span class=mi>2</span><span class=p>(</span><span class=n>as</span><span class=o>.</span><span class=n>matrix</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>),</span><span class=n>main</span> <span class=o>=</span> <span class=s2>&#34;Brand attributes&#34;</span><span class=p>,</span> <span class=n>trace</span> <span class=o>=</span> <span class=s2>&#34;none&#34;</span><span class=p>,</span> <span class=n>key</span> <span class=o>=</span> <span class=n>FALSE</span><span class=p>,</span> <span class=n>dend</span> <span class=o>=</span> <span class=s2>&#34;none&#34;</span><span class=p>)</span> <span class=c1>#turn off some options</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>pc</span><span class=o>&lt;-</span> <span class=n>princomp</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>,</span> <span class=n>cor</span> <span class=o>=</span> <span class=n>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#We added &#34;cor =TRUE&#34; to use correlation-based one. </span>
</span></span><span class=line><span class=cl><span class=n>summary</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>pc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>pc</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s2>&#34;l&#34;</span><span class=p>)</span> <span class=c1># scree plot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>loadings</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>pc</span><span class=p>)</span> <span class=c1># pc loadings</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>biplot</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>pc</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s2>&#34;Brand positioning&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>[</span><span class=s2>&#34;c&#34;</span><span class=p>,]</span> <span class=o>-</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>[</span><span class=s2>&#34;e&#34;</span><span class=p>,]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>colMeans</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>[</span><span class=n>c</span><span class=p>(</span><span class=s2>&#34;b&#34;</span><span class=p>,</span><span class=s2>&#34;c&#34;</span><span class=p>,</span><span class=s2>&#34;f&#34;</span><span class=p>,</span><span class=s2>&#34;g&#34;</span><span class=p>),])</span> <span class=o>-</span> <span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>[</span><span class=s2>&#34;e&#34;</span><span class=p>,]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>nScree</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>eigen</span><span class=p>(</span><span class=n>cor</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>fa</span> <span class=o>&lt;-</span> <span class=n>factanal</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>,</span> <span class=n>factors</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=n>rotation</span> <span class=o>=</span> <span class=s2>&#34;varimax&#34;</span><span class=p>,</span> <span class=n>scores</span> <span class=o>=</span> <span class=s2>&#34;regression&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>brand</span><span class=o>.</span><span class=n>fl</span><span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>fa</span><span class=o>$</span><span class=n>loadings</span><span class=p>[,</span> <span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>fl</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=p>)</span> <span class=c1># set up plot </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>text</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>fl</span><span class=p>,</span><span class=n>labels</span><span class=o>=</span><span class=n>names</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>),</span><span class=n>cex</span><span class=o>=.</span><span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plot</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>fl</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=p>)</span> <span class=c1># set up plot </span>
</span></span><span class=line><span class=cl><span class=n>text</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>fl</span><span class=p>,</span><span class=n>labels</span><span class=o>=</span><span class=n>rownames</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>),</span><span class=n>cex</span><span class=o>=.</span><span class=mi>7</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/r%E8%AF%AD%E8%A8%80/>R语言</a>
<a href=/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/>数据分析</a>
<a href=/tags/%E5%9B%A0%E5%AD%90%E5%88%86%E6%9E%90/>因子分析</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/rweek3-factor-analysis-for-perceptual-maps-lecture/><div class=article-details><h2 class=article-title>R[week3] Factor Analysis For Perceptual Maps Lecture</h2></div></a></article><article><a href=/p/rweek9-managing-resource-trade-offs-ii-code/><div class=article-details><h2 class=article-title>R[week9] Managing Resource Trade-Offs II Code</h2></div></a></article><article><a href=/p/rweek8-managing-resource-trade-offs-code/><div class=article-details><h2 class=article-title>R[week8] Managing Resource Trade-Offs Code</h2></div></a></article><article><a href=/p/rweek8-managing-resource-trade-offs/><div class=article-details><h2 class=article-title>R[week8] Managing Resource Trade-Offs</h2></div></a></article><article><a href=/p/rweek7-managing-sustainable-competitive-advantage-code-ii/><div class=article-details><h2 class=article-title>R[week7] Managing Sustainable Competitive Advantage code II</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//weasley.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Kunkka</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>