<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="\nWhat & Why Single entry point for all clients (é¢å‘å®¢æˆ·ç«¯çš„å•ä¸€å…¥å£) Common in microservice architectures ï¼ˆå¾®æœåŠ¡éœ€è¦ä¸šåŠ¡èšåˆï¼‰ Client insulation from services ï¼ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡éš”ç¦»ï¼‰ protocol ï¼ˆåè®®è½¬æ¢ï¼‰ Securityï¼ˆå®‰å…¨ï¼‰ surgical routingï¼ˆè·¯ç”±ï¼‰ Load Shedding ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰ Rate Limitï¼ˆé™æµï¼‰ Cacheï¼ˆç¼“å­˜ï¼‰ Fuseï¼ˆç†”æ–­ï¼‰ Retryï¼ˆé‡è¯•ï¼‰ Authï¼ˆè®¤è¯ã€é‰´æƒï¼‰ Logï¼ˆæ—¥å¿—æ”¶é›†ï¼‰ Monitorï¼ˆç›‘æ§ï¼‰ Tracing Analysisï¼ˆé“¾è·¯è¿½è¸ªï¼‰ Aspects to be considered Develepmentï¼ˆProgramming Languageï¼‰ Community activity Performance Stability Update SOME GATEWAY(By programming language) Nginx+Luaï¼šOpen Restyã€Kongã€Orangeã€Abtesting Gatewayç­‰ï¼› Javaï¼šZuul/Zuul 2ã€Spring Cloud Gatewayã€Kaazing KWGã€graviteeã€Dromara soulç­‰ï¼› Goï¼šJanusã€fagongziã€Grpc-Gatewayï¼› .NETï¼šOcelotï¼› Node.jsï¼šExpress Gatewayã€MicroGatewayã€‚ ä½¿ç”¨èŒƒå›´ã€æˆç†Ÿåº¦ã€æ´»è·ƒåº¦ç­‰ï¼Œä¸»æµæœ‰ï¼šKongã€Zuul/Zuul 2ã€Spring Cloud Gatewayã€apisix\n"><title>ç½‘å…³é€‰å‹</title><link rel=canonical href=https://MyLoveES.github.io/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="ç½‘å…³é€‰å‹"><meta property='og:description' content="\nWhat & Why Single entry point for all clients (é¢å‘å®¢æˆ·ç«¯çš„å•ä¸€å…¥å£) Common in microservice architectures ï¼ˆå¾®æœåŠ¡éœ€è¦ä¸šåŠ¡èšåˆï¼‰ Client insulation from services ï¼ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡éš”ç¦»ï¼‰ protocol ï¼ˆåè®®è½¬æ¢ï¼‰ Securityï¼ˆå®‰å…¨ï¼‰ surgical routingï¼ˆè·¯ç”±ï¼‰ Load Shedding ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰ Rate Limitï¼ˆé™æµï¼‰ Cacheï¼ˆç¼“å­˜ï¼‰ Fuseï¼ˆç†”æ–­ï¼‰ Retryï¼ˆé‡è¯•ï¼‰ Authï¼ˆè®¤è¯ã€é‰´æƒï¼‰ Logï¼ˆæ—¥å¿—æ”¶é›†ï¼‰ Monitorï¼ˆç›‘æ§ï¼‰ Tracing Analysisï¼ˆé“¾è·¯è¿½è¸ªï¼‰ Aspects to be considered Develepmentï¼ˆProgramming Languageï¼‰ Community activity Performance Stability Update SOME GATEWAY(By programming language) Nginx+Luaï¼šOpen Restyã€Kongã€Orangeã€Abtesting Gatewayç­‰ï¼› Javaï¼šZuul/Zuul 2ã€Spring Cloud Gatewayã€Kaazing KWGã€graviteeã€Dromara soulç­‰ï¼› Goï¼šJanusã€fagongziã€Grpc-Gatewayï¼› .NETï¼šOcelotï¼› Node.jsï¼šExpress Gatewayã€MicroGatewayã€‚ ä½¿ç”¨èŒƒå›´ã€æˆç†Ÿåº¦ã€æ´»è·ƒåº¦ç­‰ï¼Œä¸»æµæœ‰ï¼šKongã€Zuul/Zuul 2ã€Spring Cloud Gatewayã€apisix\n"><meta property='og:url' content='https://MyLoveES.github.io/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/'><meta property='og:site_name' content='Kunkka'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='æ¶æ„'><meta property='article:tag' content='ç½‘å…³'><meta property='article:published_time' content='2022-03-10T00:00:00+00:00'><meta property='article:modified_time' content='2022-03-10T00:00:00+00:00'><meta name=twitter:title content="ç½‘å…³é€‰å‹"><meta name=twitter:description content="\nWhat & Why Single entry point for all clients (é¢å‘å®¢æˆ·ç«¯çš„å•ä¸€å…¥å£) Common in microservice architectures ï¼ˆå¾®æœåŠ¡éœ€è¦ä¸šåŠ¡èšåˆï¼‰ Client insulation from services ï¼ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡éš”ç¦»ï¼‰ protocol ï¼ˆåè®®è½¬æ¢ï¼‰ Securityï¼ˆå®‰å…¨ï¼‰ surgical routingï¼ˆè·¯ç”±ï¼‰ Load Shedding ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰ Rate Limitï¼ˆé™æµï¼‰ Cacheï¼ˆç¼“å­˜ï¼‰ Fuseï¼ˆç†”æ–­ï¼‰ Retryï¼ˆé‡è¯•ï¼‰ Authï¼ˆè®¤è¯ã€é‰´æƒï¼‰ Logï¼ˆæ—¥å¿—æ”¶é›†ï¼‰ Monitorï¼ˆç›‘æ§ï¼‰ Tracing Analysisï¼ˆé“¾è·¯è¿½è¸ªï¼‰ Aspects to be considered Develepmentï¼ˆProgramming Languageï¼‰ Community activity Performance Stability Update SOME GATEWAY(By programming language) Nginx+Luaï¼šOpen Restyã€Kongã€Orangeã€Abtesting Gatewayç­‰ï¼› Javaï¼šZuul/Zuul 2ã€Spring Cloud Gatewayã€Kaazing KWGã€graviteeã€Dromara soulç­‰ï¼› Goï¼šJanusã€fagongziã€Grpc-Gatewayï¼› .NETï¼šOcelotï¼› Node.jsï¼šExpress Gatewayã€MicroGatewayã€‚ ä½¿ç”¨èŒƒå›´ã€æˆç†Ÿåº¦ã€æ´»è·ƒåº¦ç­‰ï¼Œä¸»æµæœ‰ï¼šKongã€Zuul/Zuul 2ã€Spring Cloud Gatewayã€apisix\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c68a00bbf16dac8.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>Kunkka</a></h1><h2 class=site-description>wind rises</h2></div></header><ol class=menu-social><li><a href=https://github.com/MyLoveES target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/about><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/all-categories><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li><a href=/links><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/all-tags><svg class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>Tags</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#what--why>What & Why</a></li><li><a href=#aspects-to-be-considered>Aspects to be considered</a></li><li><a href=#some-gatewayby-programming-language>SOME GATEWAY(By programming language)</a><ol><li><a href=#nginx>Nginx</a></li><li><a href=#openrestynginx--lua>OpenRestyï¼ˆNginx + Luaï¼‰</a></li><li><a href=#apisixnginx--etcd>APISIXï¼ˆNginx + etcdï¼‰</a></li><li><a href=#kongnginx--postgres>Kongï¼ˆNginx + postgresï¼‰</a></li><li><a href=#zuul-java>Zuul (Java)</a><ol><li><a href=#problems>PROBLEMS?</a></li></ol></li><li><a href=#zuul2-java>Zuul2 (Java)</a></li><li><a href=#spring-cloud-gateway-java>Spring Cloud Gateway (Java)</a><ol><li><a href=#spring-cloudç´§å¯†é…åˆ>Spring Cloudç´§å¯†é…åˆ</a></li></ol></li></ol></li><li><a href=#compare>Compare</a><ol><li><a href=#zuul-vs-zuul2-difference-between-sync-and-async-zuul2-win><strong>Zuul vs Zuul2 (Difference between sync and async): Zuul2 Win!</strong></a></li><li><a href=#kong-vs-apisix><strong>Kong vs APISIX</strong></a></li><li><a href=#spring-cloud-gateway-vs-zuul2-vs-openresty-vs-kong><strong>Spring Cloud Gateway vs Zuul2 vs OpenResty vs Kong</strong></a></li></ol></li><li><a href=#finally>Finally</a><ol><li><a href=#kong>Kong</a></li><li><a href=#apisix>Apisix</a></li><li><a href=#zuul>Zuul</a></li><li><a href=#zuul2>Zuul2</a></li><li><a href=#spring-cloud-gateway>Spring Cloud Gateway</a></li></ol></li><li><a href=#ç»“è®º>ç»“è®º</a></li><li><a href=#ref>Ref</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E6%8A%80%E6%9C%AF/>æŠ€æœ¯</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/>ç½‘å…³é€‰å‹</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 10, 2022</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/gateway.png width=811 height=445 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/gateway_hu_474b40f71541ad21.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/gateway_hu_734a63bf04d57ab2.png 1024w" loading=lazy class=gallery-image data-flex-grow=182 data-flex-basis=437px></p><h2 id=what--why>What & Why</h2><ul><li>Single entry point for all clients (é¢å‘å®¢æˆ·ç«¯çš„å•ä¸€å…¥å£)</li><li>Common in microservice architectures ï¼ˆå¾®æœåŠ¡éœ€è¦ä¸šåŠ¡èšåˆï¼‰</li><li>Client insulation from services ï¼ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡éš”ç¦»ï¼‰</li><li>protocol ï¼ˆåè®®è½¬æ¢ï¼‰</li><li>Securityï¼ˆå®‰å…¨ï¼‰</li><li>surgical routingï¼ˆè·¯ç”±ï¼‰</li><li>Load Shedding ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰</li><li>Rate Limitï¼ˆé™æµï¼‰</li><li>Cacheï¼ˆç¼“å­˜ï¼‰</li><li>Fuseï¼ˆç†”æ–­ï¼‰</li><li>Retryï¼ˆé‡è¯•ï¼‰</li><li>Authï¼ˆè®¤è¯ã€é‰´æƒï¼‰</li><li>Logï¼ˆæ—¥å¿—æ”¶é›†ï¼‰</li><li>Monitorï¼ˆç›‘æ§ï¼‰</li><li>Tracing Analysisï¼ˆé“¾è·¯è¿½è¸ªï¼‰</li></ul><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/apigateway.jpeg width=570 height=420 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/apigateway_hu_93a6d3dcc6e22fe2.jpeg 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/apigateway_hu_e66f4eba1fab897d.jpeg 1024w" loading=lazy class=gallery-image data-flex-grow=135 data-flex-basis=325px></p><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/backendforfrontend.png width=1024 height=768 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/backendforfrontend_hu_86362f78dcc77950.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/backendforfrontend_hu_6e347c66b33e1c0e.png 1024w" loading=lazy class=gallery-image data-flex-grow=133 data-flex-basis=320px></p><h2 id=aspects-to-be-considered>Aspects to be considered</h2><ul><li>Develepmentï¼ˆProgramming Languageï¼‰</li><li>Community activity</li><li>Performance</li><li>Stability</li><li>Update</li></ul><h2 id=some-gatewayby-programming-language>SOME GATEWAY(By programming language)</h2><ul><li>Nginx+Luaï¼šOpen Restyã€Kongã€Orangeã€Abtesting Gatewayç­‰ï¼›</li><li>Javaï¼šZuul/Zuul 2ã€Spring Cloud Gatewayã€Kaazing KWGã€graviteeã€Dromara soulç­‰ï¼›</li><li>Goï¼šJanusã€fagongziã€Grpc-Gatewayï¼›</li><li>.NETï¼šOcelotï¼›</li><li>Node.jsï¼šExpress Gatewayã€MicroGatewayã€‚</li></ul><p>ä½¿ç”¨èŒƒå›´ã€æˆç†Ÿåº¦ã€æ´»è·ƒåº¦ç­‰ï¼Œä¸»æµæœ‰ï¼šKongã€Zuul/Zuul 2ã€Spring Cloud Gatewayã€apisix</p><h3 id=nginx>Nginx</h3><p>Nginx æ›´åå‘äºä½œä¸ºæµé‡ç½‘å…³ã€‚æˆç†Ÿï¼Œæ€§èƒ½å¥½ï¼Œç¨³å®šã€‚
ä½†è‡´å‘½å¼±ç‚¹æ˜¯ï¼Œä¸ä¾¿äºè‡ªå®šä¹‰å¼€å‘ï¼ˆæœ‰ä¸€éƒ¨åˆ†æ˜¯å¼€å‘è¯­è¨€çš„åŸå› ï¼‰ï¼Œéœ€è¦ +Lua (ä¾‹å¦‚ä¸‹é¢çš„ OpenResty / Kong / Apisix)ã€‚</p><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/nginx.png width=518 height=341 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/nginx_hu_6bfe384206284b58.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/nginx_hu_79b53cadc4c3d597.png 1024w" loading=lazy class=gallery-image data-flex-grow=151 data-flex-basis=364px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Nginx åœ¨å¯åŠ¨åï¼Œä¼šæœ‰ä¸€ä¸ª Master è¿›ç¨‹å’Œå¤šä¸ª Worker è¿›ç¨‹ï¼ŒMaster è¿›ç¨‹å’Œ Worker è¿›ç¨‹ä¹‹é—´æ˜¯é€šè¿‡è¿›ç¨‹é—´é€šä¿¡è¿›è¡Œäº¤äº’çš„ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚Worker å·¥ä½œè¿›ç¨‹çš„é˜»å¡ç‚¹æ˜¯åœ¨åƒ select()ã€epoll_wait() ç­‰è¿™æ ·çš„ I/O å¤šè·¯å¤ç”¨å‡½æ•°è°ƒç”¨å¤„ï¼Œä»¥ç­‰å¾…å‘ç”Ÿæ•°æ®å¯è¯» / å†™äº‹ä»¶ã€‚Nginx é‡‡ç”¨äº†å¼‚æ­¥éé˜»å¡çš„æ–¹å¼æ¥å¤„ç†è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒNginx æ˜¯å¯ä»¥åŒæ—¶å¤„ç†æˆåƒä¸Šä¸‡ä¸ªè¯·æ±‚çš„ã€‚
</span></span></code></pre></td></tr></table></div></div><h3 id=openrestynginx--lua>OpenRestyï¼ˆNginx + Luaï¼‰</h3><p>OpenResty nginx + LuaåŠ¨æ€æ‰©å±•ã€‚ç›®å‰å·²ç»æœ‰åŸºäºOpen Restyäº§ç”Ÿçš„gatewayï¼Œä¾‹å¦‚ Kongï¼ŒAPISIXç­‰ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>è¿˜å¯ä»¥å°† Lua åµŒå…¥åˆ° Nginx ä¸­ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨ Lua æ¥ç¼–å†™è„šæœ¬ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨ Lua ç¼–å†™åº”ç”¨è„šæœ¬ï¼Œéƒ¨ç½²åˆ° Nginx ä¸­è¿è¡Œï¼Œå³ Nginx å˜æˆäº†ä¸€ä¸ª Web å®¹å™¨ï¼›è¿™æ ·å¼€å‘äººå‘˜å°±å¯ä»¥ä½¿ç”¨ Lua è¯­è¨€å¼€å‘é«˜æ€§èƒ½Webåº”ç”¨äº†ã€‚åœ¨å¼€å‘çš„æ—¶å€™ä½¿ç”¨ OpenResty æ¥æ­å»ºå¼€å‘ç¯å¢ƒï¼ŒOpenResty å°† Nginx æ ¸å¿ƒã€LuaJITã€è®¸å¤šæœ‰ç”¨çš„ Lua åº“å’Œ Nginx ç¬¬ä¸‰æ–¹æ¨¡å—æ‰“åŒ…åœ¨ä¸€èµ·ï¼›è¿™æ ·åªéœ€è¦å®‰è£… OpenRestyï¼Œä¸éœ€è¦äº†è§£ Nginx æ ¸å¿ƒå’Œå†™å¤æ‚çš„ C/C++ æ¨¡å—å°±å¯ä»¥ï¼Œåªéœ€è¦ä½¿ç”¨ Lua è¯­è¨€è¿›è¡Œ Web åº”ç”¨å¼€å‘äº†ã€‚
</span></span></code></pre></td></tr></table></div></div><h3 id=apisixnginx--etcd>APISIXï¼ˆNginx + etcdï¼‰</h3><ul><li>Develepmentï¼ˆProgramming Languageï¼‰: N</li><li>Community activity: Y</li><li>Performance: Y</li><li>Stability: ï¼Ÿ</li><li>Update: Y</li></ul><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/apisix.webp width=1280 height=625 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/apisix_hu_a45f8406feeca355.webp 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/apisix_hu_af6578e16e291a5e.webp 1024w" loading=lazy class=gallery-image data-flex-grow=204 data-flex-basis=491px></p><p>APISIXçš„æ€§èƒ½æ›´å¥½ï¼ŒåŠŸèƒ½ä¹Ÿæ›´åŠ ä¸°å¯Œã€‚
ä½†APISIXå¾ˆå¹´è½»ï¼Œæˆ–è®¸éœ€è¦æ›´å¤šçš„â€œæ£€éªŒâ€ï¼Œå¼€å‘è¯­è¨€çš„å·®åˆ«ä¹Ÿä¼šå¢åŠ é—®é¢˜æ’æŸ¥ã€å¤„ç†çš„ä»£ä»·ã€‚<br>(å¯ä»¥å°è¯•)</p><h3 id=kongnginx--postgres>Kongï¼ˆNginx + postgresï¼‰</h3><ul><li>Develepmentï¼ˆProgramming Languageï¼‰: Y</li><li>Community activity: Y</li><li>Performance: N (compared with apisix)</li><li>Stability: Y</li><li>Update: Y</li></ul><p>Kongå’ŒAPISIXç›¸æ¯”è¾ƒè€Œè¨€ï¼Œä»æ€§èƒ½ã€åŠŸèƒ½ä¸°å¯Œåº¦æ–¹é¢ éƒ½å¤„äºä¸‹é£ï¼ˆæ¯•ç«ŸAPISIXæ›´æ–°ï¼‰ã€‚è€Œä¸”å¼€å‘è¯­è¨€çš„åŠ£åŠ¿åŒæ ·å…·æœ‰ã€‚</p><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Kong.png width=1466 height=1372 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Kong_hu_3b513c167937bb43.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Kong_hu_a0ecef3e2c7f7914.png 1024w" loading=lazy class=gallery-image data-flex-grow=106 data-flex-basis=256px></p><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Kong2.png width=879 height=369 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Kong2_hu_b230d23971cb240b.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Kong2_hu_813c611b12eab014.png 1024w" loading=lazy class=gallery-image data-flex-grow=238 data-flex-basis=571px></p><h3 id=zuul-java>Zuul (Java)</h3><p>Zuul-åŠ¨æ€è·¯ç”±ã€ç›‘æ§ã€å¼¹æ€§å’Œå®‰å…¨ã€‚åŸºäºServletï¼Œå±äºä¸Šä¸€ä»£äº§å“ï¼ŒåŒæ­¥I/Oã€å¤šçº¿ç¨‹ã€‚æ€§èƒ½ä¸å¥½ï¼Œé’ˆå¯¹äºZuulçš„æ›¿ä»£æ–¹æ¡ˆå·²ç»æœ‰ Zuul2 ä»¥åŠ Spring Gateway ä¸¤ç±»ã€‚å› æ­¤Zuulä¸äºˆè€ƒè™‘ã€‚</p><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/zuul-lifecycle.png width=960 height=720 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/zuul-lifecycle_hu_4e1bfcf0bb00de2a.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/zuul-lifecycle_hu_23c5a5ad429bc0c4.png 1024w" loading=lazy class=gallery-image data-flex-grow=133 data-flex-basis=320px></p><blockquote><p>PreDecorationFilter<br>SendForwardFilter<br>RibbonRoutingFilter<br>SimpleHostRoutingFilter<br>SendResponseFilter<br>SendErrorFilter</p></blockquote><h4 id=problems>PROBLEMS?</h4><blockquote><p>Large coupled filters
Filter model/API is clunky</p></blockquote><h3 id=zuul2-java>Zuul2 (Java)</h3><ul><li>Develepmentï¼ˆProgramming Languageï¼‰: N</li><li>Community activity: Y</li><li>Performance: Y</li><li>Stability: ï¼Ÿ</li><li>Update: Y</li></ul><p>æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€è¿æ¥æ± ã€çŠ¶æ€åˆ†ç±»ã€é‡è¯•ã€è¯·æ±‚å‡­è¯ã€HTTP/2ã€TLSã€ä»£ç†åè®®ã€GZipã€WebSocket<br>åŸºäº Nettyï¼ŒZuul 2.xæœ€å¤§çš„æ”¹è¿›å°±æ˜¯åŸºäºNetty Serverå®ç°äº†å¼‚æ­¥I/Oæ¥æ¥å…¥è¯·æ±‚ï¼ŒåŒæ—¶åŸºäºNetty Clientå®ç°äº†åˆ°åç«¯ä¸šåŠ¡æœåŠ¡APIçš„è¯·æ±‚ã€‚è¿™æ ·å°±å¯ä»¥å®ç°æ›´é«˜çš„æ€§èƒ½ã€æ›´ä½çš„å»¶è¿Ÿã€‚æ­¤å¤–ä¹Ÿè°ƒæ•´äº†Filterç±»å‹ï¼Œå°†åŸæ¥çš„ä¸‰ä¸ªæ ¸å¿ƒFilteræ˜¾å¼å‘½åä¸ºInbound Filterã€Endpoint Filterå’ŒOutbound Filterï¼Œå¦‚å›¾7-8æ‰€ç¤ºã€‚</p><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Zuul2.png width=872 height=721 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Zuul2_hu_dc9b3033cce22d5.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Zuul2_hu_2fb45e3040d5e8f1.png 1024w" loading=lazy class=gallery-image data-flex-grow=120 data-flex-basis=290px></p><blockquote><p>Major rewrite<br>Not backwards compatible with Zuul 1<br>Non-blocking/Netty<br>Not released yet<br>HTTP/2 and Websockets in the future<br>Reinvents many things from Spring</p></blockquote><h3 id=spring-cloud-gateway-java>Spring Cloud Gateway (Java)</h3><ul><li>Develepmentï¼ˆProgramming Languageï¼‰: Y</li><li>Community activity: Y</li><li>Performance: Y</li><li>Stability: Y</li><li>Update: Y</li></ul><p>Java 8ã€Spring 5.0ã€Spring Boot 2.0ã€Reactor -> Spring family</p><h4 id=spring-cloudç´§å¯†é…åˆ>Spring Cloudç´§å¯†é…åˆ</h4><p>ç›®å‰ä½¿ç”¨äº†nacosä½œä¸ºé…ç½®ä¸­å¿ƒï¼Œå¯ä»¥å’Œ gateway æ­é…ã€‚</p><blockquote><p>Java 8/Spring 5/Boot 2
WebFlux/Reactor
HTTP/2 and Websockets
Finchley Release Train</p></blockquote><p>Spring Cloud Gatewayé‡Œæ˜ç¡®åœ°åŒºåˆ†äº†Routerå’ŒFilterï¼Œå†…ç½®äº†éå¸¸å¤šçš„å¼€ç®±å³ç”¨åŠŸèƒ½ï¼Œå¹¶ä¸”éƒ½å¯ä»¥é€šè¿‡Spring Booté…ç½®æˆ–æ‰‹å·¥ç¼–ç é“¾å¼è°ƒç”¨æ¥ä½¿ç”¨ã€‚<br>å†…ç½®äº†10ç§Routerï¼Œç›´æ¥é…ç½®å°±å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°æ ¹æ®Headerã€Pathã€Hostæˆ–Queryæ¥åšè·¯ç”±ã€‚</p><h5 id=æ ¸å¿ƒç‰¹æ€§>æ ¸å¿ƒç‰¹æ€§ï¼š</h5><ul><li>é€šè¿‡è¯·æ±‚å‚æ•°åŒ¹é…è·¯ç”±ï¼›</li><li>é€šè¿‡æ–­è¨€å’Œè¿‡æ»¤å™¨å®ç°è·¯ç”±ï¼›</li><li>ä¸Hystrixç†”æ–­é›†æˆï¼›</li><li>ä¸Spring Cloud DiscoveryClienté›†æˆï¼›</li><li>éå¸¸æ–¹ä¾¿åœ°å®ç°æ–­è¨€å’Œè¿‡æ»¤å™¨ï¼›</li><li>è¯·æ±‚é™æµï¼›</li><li>è·¯å¾„é‡å†™ã€‚</li></ul><h2 id=compare>Compare</h2><h3 id=zuul-vs-zuul2-difference-between-sync-and-async-zuul2-win><strong>Zuul vs Zuul2 (Difference between sync and async): Zuul2 Win!</strong></h3><ul><li><strong>Zuul(block) disadvantages</strong></li><li><em>Zuul 1</em> was built on the Servlet framework</li><li>Blocking and mltithreaded, means they process requests by using one thread per connection.</li><li>I/O oprations are done by choosing a worker threade from athread pool to execute the I/O, and the request thread is blocked until the worker thread completes, and the worker thread notifies the request thread when its work is complete.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>This</span> <span class=n>works</span> <span class=n>well</span> <span class=n>with</span> <span class=n>modern</span> <span class=n>multi</span><span class=o>-</span><span class=n>core</span> <span class=n>AWS</span> <span class=n>instances</span> <span class=n>handling</span> <span class=mi>100</span><span class=err>â€™</span><span class=n>s</span> <span class=n>of</span> <span class=n>concurrent</span> <span class=n>connections</span> <span class=n>each</span><span class=o>.</span> <span class=n>But</span> <span class=n>when</span> <span class=n>things</span> <span class=n>go</span> <span class=n>wrong</span><span class=p>,</span> <span class=n>like</span> <span class=n>backend</span> <span class=n>latency</span> <span class=n>increases</span> <span class=ow>or</span> <span class=n>device</span> <span class=n>retries</span> <span class=n>due</span> <span class=n>to</span> <span class=n>errors</span><span class=p>,</span> <span class=n>the</span> <span class=n>count</span> <span class=n>of</span> <span class=n>active</span> <span class=n>connections</span> <span class=ow>and</span> <span class=n>threads</span> <span class=n>increases</span><span class=o>.</span> <span class=n>When</span> <span class=n>this</span> <span class=n>happens</span><span class=p>,</span> <span class=n>nodes</span> <span class=n>get</span> <span class=n>into</span> <span class=n>trouble</span> <span class=ow>and</span> <span class=n>can</span> <span class=n>go</span> <span class=n>into</span> <span class=n>a</span> <span class=n>death</span> <span class=n>spiral</span> <span class=n>where</span> <span class=n>backed</span> <span class=n>up</span> <span class=n>threads</span> <span class=n>spike</span> <span class=n>server</span> <span class=n>loads</span> <span class=ow>and</span> <span class=n>overwhelm</span> <span class=n>the</span> <span class=n>cluster</span><span class=o>.</span> <span class=n>To</span> <span class=n>offset</span> <span class=n>these</span> <span class=n>risks</span><span class=p>,</span> <span class=n>we</span> <span class=n>built</span> <span class=ow>in</span> <span class=n>throttling</span> <span class=n>mechanisms</span> <span class=ow>and</span> <span class=n>libraries</span> <span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>g</span><span class=o>.</span><span class=p>,</span> <span class=n>Hystrix</span><span class=p>)</span> <span class=n>to</span> <span class=n>help</span> <span class=n>keep</span> <span class=n>our</span> <span class=n>blocking</span> <span class=n>systems</span> <span class=n>stable</span> <span class=n>during</span> <span class=n>these</span> <span class=n>events</span><span class=o>.</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Multithreaded_System_Architecture.png width=572 height=344 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Multithreaded_System_Architecture_hu_d87eeb4c381c80df.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Multithreaded_System_Architecture_hu_4573d414f79beea9.png 1024w" loading=lazy class=gallery-image data-flex-grow=166 data-flex-basis=399px></p><ul><li><strong>Zuul2(async) advantages</strong></li><li><em>Zuul2</em> async.</li><li>One thread per CPU core handling all requests and responses. The lifecycle of the request and response is handled through events and callbacks.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Because there is not a thread for each request, the cost of connections is cheap. This is the cost of a file descriptor, and the addition of a listener. Whereas the cost of a connection in the blocking model is a thread and with heavy memory and system overhead. There are some efficiency gains because data stays on the same CPU, making better use of CPU level caches and requiring fewer context switches. The fallout of backend latency and â€œretry stormsâ€ (customers and devices retrying requests when problems occur) is also less stressful on the system because connections and increased events in the queue are far less expensive than piling up threads.
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Asynchronous_and_Non-blocking_System_Architecture.png width=552 height=434 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Asynchronous_and_Non-blocking_System_Architecture_hu_af69c71f234b2f1d.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Asynchronous_and_Non-blocking_System_Architecture_hu_ec4949e740125ac4.png 1024w" loading=lazy class=gallery-image data-flex-grow=127 data-flex-basis=305px></p><ul><li><strong>Zuul2(async) disadvantages & Zuul(block) advantages</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>The</span> <span class=n>advantages</span> <span class=n>of</span> <span class=n>async</span> <span class=n>systems</span> <span class=n>sound</span> <span class=n>glorious</span><span class=p>,</span> <span class=n>but</span> <span class=n>the</span> <span class=n>above</span> <span class=n>benefits</span> <span class=n>come</span> <span class=n>at</span> <span class=n>a</span> <span class=n>cost</span> <span class=n>to</span> <span class=n>operations</span><span class=o>.</span> <span class=n>Blocking</span> <span class=n>systems</span> <span class=n>are</span> <span class=n>easy</span> <span class=n>to</span> <span class=n>grok</span> <span class=ow>and</span> <span class=n>debug</span><span class=o>.</span> <span class=n>A</span> <span class=n>thread</span> <span class=n>is</span> <span class=n>always</span> <span class=n>doing</span> <span class=n>a</span> <span class=n>single</span> <span class=n>operation</span> <span class=n>so</span> <span class=n>the</span> <span class=n>thread</span><span class=err>â€™</span><span class=n>s</span> <span class=n>stack</span> <span class=n>is</span> <span class=n>an</span> <span class=n>accurate</span> <span class=n>snapshot</span> <span class=n>of</span> <span class=n>the</span> <span class=n>progress</span> <span class=n>of</span> <span class=n>a</span> <span class=n>request</span> <span class=ow>or</span> <span class=n>spawned</span> <span class=n>task</span><span class=p>;</span> <span class=ow>and</span> <span class=n>a</span> <span class=n>thread</span> <span class=n>dump</span> <span class=n>can</span> <span class=n>be</span> <span class=n>read</span> <span class=n>to</span> <span class=n>follow</span> <span class=n>a</span> <span class=n>request</span> <span class=n>spanning</span> <span class=n>multiple</span> <span class=n>threads</span> <span class=n>by</span> <span class=n>following</span> <span class=n>locks</span><span class=o>.</span> <span class=n>An</span> <span class=n>exception</span> <span class=n>thrown</span> <span class=n>just</span> <span class=n>pops</span> <span class=n>up</span> <span class=n>the</span> <span class=n>stack</span><span class=o>.</span> <span class=n>A</span> <span class=err>â€œ</span><span class=n>catch</span><span class=o>-</span><span class=n>all</span><span class=err>â€</span> <span class=n>exception</span> <span class=n>handler</span> <span class=n>can</span> <span class=n>cleanup</span> <span class=n>everything</span> <span class=n>that</span> <span class=n>isn</span><span class=err>â€™</span><span class=n>t</span> <span class=n>explicitly</span> <span class=n>caught</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Async</span><span class=p>,</span> <span class=n>by</span> <span class=n>contrast</span><span class=p>,</span> <span class=n>is</span> <span class=n>callback</span> <span class=n>based</span> <span class=ow>and</span> <span class=n>driven</span> <span class=n>by</span> <span class=n>an</span> <span class=n>event</span> <span class=n>loop</span><span class=o>.</span> <span class=n>The</span> <span class=n>event</span> <span class=n>loop</span><span class=err>â€™</span><span class=n>s</span> <span class=n>stack</span> <span class=n>trace</span> <span class=n>is</span> <span class=n>meaningless</span> <span class=n>when</span> <span class=n>trying</span> <span class=n>to</span> <span class=n>follow</span> <span class=n>a</span> <span class=n>request</span><span class=o>.</span> <span class=n>It</span> <span class=n>is</span> <span class=n>difficult</span> <span class=n>to</span> <span class=n>follow</span> <span class=n>a</span> <span class=n>request</span> <span class=n>as</span> <span class=n>events</span> <span class=ow>and</span> <span class=n>callbacks</span> <span class=n>are</span> <span class=n>processed</span><span class=p>,</span> <span class=ow>and</span> <span class=n>the</span> <span class=n>tools</span> <span class=n>to</span> <span class=n>help</span> <span class=n>with</span> <span class=n>debugging</span> <span class=n>this</span> <span class=n>are</span> <span class=n>sorely</span> <span class=n>lacking</span> <span class=ow>in</span> <span class=n>this</span> <span class=n>area</span><span class=o>.</span> <span class=n>Edge</span> <span class=n>cases</span><span class=p>,</span> <span class=n>unhandled</span> <span class=n>exceptions</span><span class=p>,</span> <span class=ow>and</span> <span class=n>incorrectly</span> <span class=n>handled</span> <span class=n>state</span> <span class=n>changes</span> <span class=n>create</span> <span class=n>dangling</span> <span class=n>resources</span> <span class=n>resulting</span> <span class=ow>in</span> <span class=n>ByteBuf</span> <span class=n>leaks</span><span class=p>,</span> <span class=n>file</span> <span class=n>descriptor</span> <span class=n>leaks</span><span class=p>,</span> <span class=n>lost</span> <span class=n>responses</span><span class=p>,</span> <span class=n>etc</span><span class=o>.</span> <span class=n>These</span> <span class=n>types</span> <span class=n>of</span> <span class=n>issues</span> <span class=n>have</span> <span class=n>proven</span> <span class=n>to</span> <span class=n>be</span> <span class=n>quite</span> <span class=n>difficult</span> <span class=n>to</span> <span class=n>debug</span> <span class=n>because</span> <span class=n>it</span> <span class=n>is</span> <span class=n>difficult</span> <span class=n>to</span> <span class=n>know</span> <span class=n>which</span> <span class=n>event</span> <span class=n>wasn</span><span class=err>â€™</span><span class=n>t</span> <span class=n>handled</span> <span class=n>properly</span> <span class=ow>or</span> <span class=n>cleaned</span> <span class=n>up</span> <span class=n>appropriately</span><span class=o>.</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=kong-vs-apisix><strong>Kong vs APISIX</strong></h3><p><img src=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Kong_vs_APISIX.png width=930 height=1159 srcset="/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Kong_vs_APISIX_hu_df92414906ab4608.png 480w, /p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/Kong_vs_APISIX_hu_4419ec1e0d832e3a.png 1024w" loading=lazy class=gallery-image data-flex-grow=80 data-flex-basis=192px></p><h3 id=spring-cloud-gateway-vs-zuul2-vs-openresty-vs-kong><strong>Spring Cloud Gateway vs Zuul2 vs OpenResty vs Kong</strong></h3><div class=table-wrapper><table><thead><tr><th>ç½‘å…³</th><th>é™æµ</th><th>é‰´æƒ</th><th>ç›‘æ§</th><th>æ˜“ç”¨æ€§</th><th>å¯ç»´æŠ¤æ€§</th><th>æˆç†Ÿåº¦</th></tr></thead><tbody><tr><td>Spring Cloud Gateway</td><td>IPã€ç”¨æˆ·ã€é›†ç¾¤é™æµï¼Œæä¾›ç›¸åº”æ¥å£æ‰©å±•</td><td>æ™®é€šé‰´æƒã€OAuth2.0</td><td>Gateway Metrics Filter</td><td>ç®€å•</td><td>Springå…¨å®¶æ¡¶æˆå‘˜ã€æ‰©å±•æ€§å¼ºã€æ˜“é…ç½®ã€æ˜“ç»´æŠ¤</td><td>æˆç†Ÿ</td></tr><tr><td>Zuul2</td><td>é…ç½®æ–‡ä»¶ï¼Œé…ç½®é›†ç¾¤ã€å•æœåŠ¡å™¨é™æµã€Filteræ‰©å±•</td><td>Filterå®ç°</td><td>Filterå®ç°</td><td>-</td><td>-</td><td>-</td></tr><tr><td>OpenResty</td><td>Lua</td><td>Lua</td><td>éœ€è¦å¼€å‘</td><td>ç®€å•æ˜“ç”¨ï¼Œä½†éœ€è¦Luaå¼€å‘</td><td>å¯ç»´æŠ¤æ€§å·®</td><td>æˆç†Ÿ</td></tr><tr><td>Kong</td><td>æ ¹æ®æ—¶é—´ã€ç”¨æˆ·é™æµã€‚å¯åœ¨æºç åŸºç¡€ä¸Šå¼€å‘http://coding.idealworld.group/2021/05/26/reflections-of-middle-platform-api-gateway-selection/</td><td>æ™®é€šé‰´æƒã€OAuth2.0ã€Key Authã€HMAC</td><td>ä¸ŠæŠ¥datadogï¼Œè®°å½•è¯·æ±‚æ•°é‡ã€æ•°æ®é‡ã€åº”ç­”æ•°æ®é‡ã€æ¥æ”¶å‘é€æ—¶é—´é—´éš”ã€çŠ¶æ€ç æ•°é‡ã€Kongå†…è€—æ—¶</td><td>ç®€å•æ˜“ç”¨ï¼ŒAPIè½¬å‘é€šè¿‡ç®¡ç†æ¥å£é…ç½®ã€‚éœ€è¦Luaå¼€å‘</td><td>ç»´æŠ¤éœ€è¦Lua</td><td>æˆç†Ÿ</td></tr></tbody></table></div><h2 id=finally>Finally</h2><h3 id=kong>Kong</h3><ol><li>nginx + luaï¼Œå¼€å‘ä¸å‹å¥½</li><li>ä»…æ”¯æŒPostgreSQLï¼Œå¢åŠ è¿ç»´æˆæœ¬ï¼Œå•ç‚¹æ•°æ®åº“</li><li>åœ¨ä¸ä¿®æ”¹æºç çš„æƒ…å†µä¸‹ï¼Œæ— æ³•è‡ªå®šä¹‰Nginxé…ç½®æ–‡ä»¶ï¼Œé‡å¯åé‡æ–°åˆå§‹åŒ–æ‰€æœ‰å˜æ›´çš„Nginxé…ç½®æ–‡ä»¶</li></ol><h3 id=apisix>Apisix</h3><ol><li>nginx + luaï¼Œå¼€å‘ä¸å‹å¥½</li><li>å¾…æ£€éªŒ</li></ol><h3 id=zuul>Zuul</h3><ol><li>æ€§èƒ½å·®ï¼Œå·²æœ‰æ›¿ä»£å“</li></ol><h3 id=zuul2>Zuul2</h3><ol><li>æ€§èƒ½å¥½ï¼Œä½† Sprintg Cloud æ²¡æœ‰å…¼å®¹è®¡åˆ’ï¼Œä¸ç›®å‰ä½¿ç”¨çš„æŠ€æœ¯æ ˆç»“åˆçš„ä¸æ˜¯å¾ˆå¥½</li><li>è¿˜ä¸å¤ªç¨³å®š</li></ol><h3 id=spring-cloud-gateway>Spring Cloud Gateway</h3><ol><li>æ€§èƒ½æ¯”è¾ƒå¥½ï¼ˆnot bestï¼‰</li></ol><h2 id=ç»“è®º>ç»“è®º</h2><p>ç»¼åˆæ¯”è¾ƒä¸‹æ¥ï¼ŒSpring Cloud Gateway æ€§èƒ½å¥½ï¼Œä¹Ÿæ¯”è¾ƒæˆç†Ÿç¨³å®šï¼Œå¹¶ä¸”æ˜¯Springå…¨å®¶æ¡¶æˆå‘˜ï¼Œå’Œå½“å‰é¡¹ç›®æ˜¯ç”¨çš„æŠ€æœ¯æ ˆæ›´åŒ¹é…ã€‚)</p><h2 id=ref>Ref</h2><blockquote><p>ref: <a class=link href=https://spencergibb.netlify.app/preso/detroit-cf-api-gateway-2017-03/#/ target=_blank rel=noopener>The author of spring cloud gateway&rsquo;s PPT</a><br>ref: <a class=link href=https://microservices.io/patterns/apigateway.html target=_blank rel=noopener>What is api gateway</a><br>ref: <a class=link href=https://netflixtechblog.com/zuul-2-the-netflix-journey-to-asynchronous-non-blocking-systems-45947377fb5c target=_blank rel=noopener>Netflix blog: Zuul2</a><br>ref: <a class=link href=https://netflixtechblog.com/optimizing-the-netflix-api-5c9ac715cf19 target=_blank rel=noopener>Netflix blog: Optimizing the Netflix API</a><br>ref: <a class=link href=https://microservices.io/patterns/microservices.html target=_blank rel=noopener>Microservice Architecture</a><br>ref: <a class=link href=http://blog.itpub.net/31562044/viewspace-2651041/ target=_blank rel=noopener>ç™¾äº¿æµé‡å¾®æœåŠ¡ç½‘å…³çš„è®¾è®¡ä¸å®ç°</a><br>ref: <a class=link href=http://coding.idealworld.group/2021/05/26/reflections-of-middle-platform-api-gateway-selection/ target=_blank rel=noopener>ä¸­å°åæ€ï¼šäº‘åŸç”Ÿä¸‹APIç½‘å…³çš„é€‰æ‹©</a><br>ref: <a class=link href=https://www.yihuo.tech/news/api-gateways-apache-apisix-and-kong-selection-comparison/ target=_blank rel=noopener>API ç½‘å…³ Apache APISIX å’Œ Kong çš„é€‰å‹å¯¹æ¯”</a><br>ref: <a class=link href=https://blog.csdn.net/star1210644725/article/details/113399714 target=_blank rel=noopener>APIç½‘å…³æ¶æ„ä¸æŠ€æœ¯é€‰å‹</a><br>ref: <a class=link href=https://www.daimajiaoliu.com/daima/47973c73d100400 target=_blank rel=noopener>APIç½‘å…³ä»‹ç»åŠé€‰å‹(kong)</a><br>ref: <a class=link href=https://wakzz.cn/2021/03/06/%E6%9E%B6%E6%9E%84/API%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B%E8%B0%83%E7%A0%94/ target=_blank rel=noopener>APIç½‘å…³é€‰å‹è°ƒç ”</a><br>ref: <a class=link href=https://www.cnblogs.com/wtzbk/p/14009219.html target=_blank rel=noopener>å¾®æœåŠ¡ä¸‹çš„ç½‘å…³å¦‚ä½•é€‰æ‹©(æåˆ°äº†soul)</a><br>ref: <a class=link href=https://www.infoq.cn/article/comparing-api-gateway-performances/ target=_blank rel=noopener>API ç½‘å…³æ€§èƒ½æ¯”è¾ƒï¼šNGINX vs. ZUUL vs. Spring Cloud Gateway vs. Linkerd</a><br>ref: <a class=link href=https://juejin.cn/post/6882952033712734216 target=_blank rel=noopener>API ç½‘å…³é€‰å‹åŠåŒ…å« BFF çš„æ¶æ„è®¾è®¡</a><br>ref: <a class=link href=https://www.jianshu.com/p/a2f292221b5c target=_blank rel=noopener>5ã€å¾®æœåŠ¡ç½‘å…³</a><br>ref: <a class=link href=https://www.zhihu.com/question/280850489 target=_blank rel=noopener>å¦‚ä½•è¯„ä»· spring cloud gateway? å¯¹æ¯” zuul2.0 ä¸»è¦çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆ?</a><br>ref: <a class=link href=https://www.jianshu.com/p/ebe4636a13aa target=_blank rel=noopener>å¦‚ä½•é€‰æ‹©å’Œè®¾è®¡å¾®æœåŠ¡ç½‘å…³</a><br>ref: <a class=link href=https://www.apiseven.com/zh/blog/why-we-need-Apache-APISIX target=_blank rel=noopener>æœ‰äº† NGINX å’Œ Kongï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ Apache APISIX</a><br>ref: <a class=link href=https://zhuanlan.zhihu.com/p/109458069 target=_blank rel=noopener>æµ…è°ˆ k8s ingress controller é€‰å‹</a></p></blockquote></section><footer class=article-footer><section class=article-tags><a href=/tags/%E6%9E%B6%E6%9E%84/>æ¶æ„</a>
<a href=/tags/%E7%BD%91%E5%85%B3/>ç½‘å…³</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B%E7%BB%86%E8%8A%82/><div class=article-details><h2 class=article-title>ç½‘å…³é€‰å‹ç»†èŠ‚</h2></div></a></article><article><a href=/p/why-reactor/><div class=article-details><h2 class=article-title>Why Reactor</h2></div></a></article><article><a href=/p/callback-or-messagequeue/><div class=article-details><h2 class=article-title>Callback Or MessageQueue</h2></div></a></article><article><a href=/p/seda-the-staged-event-driven-architecture/><div class=article-details><h2 class=article-title>Seda - The Staged Event-Driven Architecture</h2></div></a></article><article><a href=/p/why-events-are-a-bad-idea/><div class=article-details><h2 class=article-title>Why events are a bad idea</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//weasley.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Kunkka</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>