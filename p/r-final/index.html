<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content=" R: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\n1. Manage customer hierarchical 1.1 segmentation According to the demographics data provided, &lsquo;Emplyment&rsquo; data was excluded because it was related to salary. The data with &lsquo;salary=7&rsquo; was removed because it was invalid. &lsquo;Regions&rsquo; are simplified to 3. Finally the continuous vectors are normalized and the ordinal variables are factored.\nConsidering data contains ordinal varibles and continous variables, we segment customers into four groups based on hierarchical clustering, which differentiation between groups was more appropriate than three or five groups.\n"><title>R final</title><link rel=canonical href=https://MyLoveES.github.io/p/r-final/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="R final"><meta property='og:description' content=" R: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\n1. Manage customer hierarchical 1.1 segmentation According to the demographics data provided, &lsquo;Emplyment&rsquo; data was excluded because it was related to salary. The data with &lsquo;salary=7&rsquo; was removed because it was invalid. &lsquo;Regions&rsquo; are simplified to 3. Finally the continuous vectors are normalized and the ordinal variables are factored.\nConsidering data contains ordinal varibles and continous variables, we segment customers into four groups based on hierarchical clustering, which differentiation between groups was more appropriate than three or five groups.\n"><meta property='og:url' content='https://MyLoveES.github.io/p/r-final/'><meta property='og:site_name' content='Kunkka'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='RËØ≠Ë®Ä'><meta property='article:tag' content='Êï∞ÊçÆÂàÜÊûê'><meta property='article:published_time' content='2023-04-05T00:00:00+00:00'><meta property='article:modified_time' content='2023-04-05T00:00:00+00:00'><meta name=twitter:title content="R final"><meta name=twitter:description content=" R: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\n1. Manage customer hierarchical 1.1 segmentation According to the demographics data provided, &lsquo;Emplyment&rsquo; data was excluded because it was related to salary. The data with &lsquo;salary=7&rsquo; was removed because it was invalid. &lsquo;Regions&rsquo; are simplified to 3. Finally the continuous vectors are normalized and the ordinal variables are factored.\nConsidering data contains ordinal varibles and continous variables, we segment customers into four groups based on hierarchical clustering, which differentiation between groups was more appropriate than three or five groups.\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c68a00bbf16dac8.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üç•</span></figure><div class=site-meta><h1 class=site-name><a href=/>Kunkka</a></h1><h2 class=site-description>wind rises</h2></div></header><ol class=menu-social><li><a href=https://github.com/MyLoveES target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/about><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/all-categories><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li><a href=/links><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/all-tags><svg class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>Tags</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#11-segmentation>1.1 segmentation</a><ol><li><a href=#111-import-and-check-data>1.1.1 import and check data</a></li><li><a href=#112-hclust>1.1.2 hclust()</a></li><li><a href=#113-conclusion>1.1.3 Conclusion</a></li></ol></li><li><a href=#12-factor-analysis>1.2 Factor analysis</a><ol><li><a href=#121-import-and-check-data>1.2.1 import and check data</a></li><li><a href=#122-rescaling-the-data>1.2.2 Rescaling the data</a></li><li><a href=#123-mean-rating-by-brand>1.2.3 Mean rating by brand</a></li><li><a href=#124-principal-component-analysis-pca-using-princomp>1.2.4 Principal component analysis (PCA) using princomp()</a></li><li><a href=#125-move-forward>1.2.5 move forward</a></li><li><a href=#126-factor-analysis-using-factanal->1.2.6 Factor analysis using factanal() *</a></li></ol></li></ol><ol><li><a href=#21-choice-based-conjoint-analysis>2.1 Choice-Based Conjoint Analysis</a><ol><li><a href=#211-import-and-check-data>2.1.1 import and check data</a></li><li><a href=#212-prepare-the-data>2.1.2 prepare the data</a></li><li><a href=#213-multinomial-conjoint-model-estimation-with-mlogit>2.1.3 Multinomial conjoint model estimation with mlogit()</a></li><li><a href=#214-model-fit>2.1.4 Model fit</a></li><li><a href=#215-interpreting-conjoint-analysis-findings>2.1.5 Interpreting Conjoint Analysis Findings</a></li></ol></li><li><a href=#22-willingness-to-pay>2.2 Willingness to pay</a><ol><li><a href=#221-what-is-the-nuts-value>2.2.1 What is the Nuts&rsquo; value</a></li><li><a href=#222-willingness-to-pay-for-an-attribute-upgrade>2.2.2 Willingness to Pay for an Attribute Upgrade</a></li></ol></li><li><a href=#23-market-basket>2.3 Market Basket</a><ol><li><a href=#231-retail-transaction-data-groceries>2.3.1 Retail Transaction Data: Groceries</a></li><li><a href=#232-retail-transaction-data-groceries>2.3.2 Retail Transaction Data: Groceries</a></li></ol></li></ol><ol><li><a href=#31-selecting-advertising-platforms>3.1 Selecting Advertising platforms</a><ol><li><a href=#311-import-and-check-data>3.1.1 import and check data</a></li><li><a href=#312-selecting-advertising-platforms>3.1.2 Selecting Advertising platforms</a><ol><li><a href=#3121-line>3.1.2.1 line</a></li><li><a href=#3122-log>3.1.2.2 log</a></li><li><a href=#3123-log-better>3.1.2.3 log better</a></li></ol></li><li><a href=#313-allocating-marketing-budget>3.1.3 Allocating Marketing Budget</a></li><li><a href=#314-advertising-carryover-effect>3.1.4 Advertising Carryover Effect</a></li><li><a href=#315-synergy-effect>3.1.5 Synergy Effect</a></li></ol></li><li><a href=#32-compare-groups>3.2 Compare groups</a><ol><li><a href=#321-import-and-check-data>3.2.1 import and check data</a></li><li><a href=#322-descriptives-by-group>3.2.2 Descriptives by group</a><ol><li><a href=#3221-seconds-spent-vary-for-two-versions-of-ads>3.2.2.1 seconds spent vary for two versions of ads.</a></li><li><a href=#3222-the-frequency-with-which-different-combinations-of-condition-and-like-occur>3.2.2.2 the frequency with which different combinations of condition and like occur</a></li></ol></li><li><a href=#323-visualization-by-group>3.2.3 Visualization by group</a></li><li><a href=#324-statistical-tests>3.2.4 Statistical tests</a><ol><li><a href=#3241-chisptest>3.2.4.1 chisp.test()</a></li><li><a href=#3242-ttest>3.2.4.2 t.test()</a></li><li><a href=#3243-anova>3.2.4.3 anova</a></li></ol></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E6%95%99%E7%A8%8B/>ÊïôÁ®ã</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/r-final/>R final</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 05, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>64 minute read</time></div></footer></div></header><section class=article-content><blockquote><p>R: 4.3.2 (2023-10-31)<br>R studio: 2023.12.1+402 (2023.12.1+402)</p></blockquote><h1 id=1-manage-customer-hierarchical>1. Manage customer hierarchical</h1><h2 id=11-segmentation>1.1 segmentation</h2><p>According to the demographics data provided, &lsquo;Emplyment&rsquo; data was excluded because it was related to salary. The data with &lsquo;salary=7&rsquo; was removed because it was invalid. &lsquo;Regions&rsquo; are simplified to 3. Finally the continuous vectors are normalized and the ordinal variables are factored.</p><p>Considering data contains ordinal varibles and continous variables, we segment customers into four groups based on hierarchical clustering, which differentiation between groups was more appropriate than three or five groups.</p><h3 id=111-import-and-check-data>1.1.1 import and check data</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; seg.df &lt;- read.csv(&#34;1_demographics.csv&#34;, stringsAsFactors = TRUE)
</span></span><span class=line><span class=cl>&gt; head(seg.df, n = 5)
</span></span><span class=line><span class=cl>  Consumer_id Age_Group Gender Salary Education Employment Location_by_region Choco_Consumption
</span></span><span class=line><span class=cl>1         352         1      2      1         2          3                  4                 0
</span></span><span class=line><span class=cl>2         103         3      2      3         1          1                  1                 1
</span></span><span class=line><span class=cl>3          17         1      1      1         1          4                  1                 1
</span></span><span class=line><span class=cl>4          66         1      1      1         1          3                  1                 1
</span></span><span class=line><span class=cl>5         329         2      1      1         1          8                  1                 1
</span></span><span class=line><span class=cl>  Sustainability_Score
</span></span><span class=line><span class=cl>1             -1.15059
</span></span><span class=line><span class=cl>2              0.50287
</span></span><span class=line><span class=cl>3             -1.14517
</span></span><span class=line><span class=cl>4             -0.46688
</span></span><span class=line><span class=cl>5             -2.08817
</span></span><span class=line><span class=cl>&gt; summary(seg.df, digits = 2)
</span></span><span class=line><span class=cl>  Consumer_id    Age_Group       Gender        Salary      Education     Employment   Location_by_region
</span></span><span class=line><span class=cl> Min.   :  1   Min.   :1.0   Min.   :1.0   Min.   :0.0   Min.   :1.0   Min.   : 1.0   Min.   :1.0       
</span></span><span class=line><span class=cl> 1st Qu.: 95   1st Qu.:1.0   1st Qu.:1.0   1st Qu.:1.0   1st Qu.:2.0   1st Qu.: 1.0   1st Qu.:1.0       
</span></span><span class=line><span class=cl> Median :190   Median :2.0   Median :2.0   Median :2.0   Median :2.0   Median : 2.0   Median :1.0       
</span></span><span class=line><span class=cl> Mean   :190   Mean   :2.2   Mean   :1.7   Mean   :2.3   Mean   :2.3   Mean   : 2.4   Mean   :1.3       
</span></span><span class=line><span class=cl> 3rd Qu.:284   3rd Qu.:3.0   3rd Qu.:2.0   3rd Qu.:3.0   3rd Qu.:3.0   3rd Qu.: 3.0   3rd Qu.:1.0       
</span></span><span class=line><span class=cl> Max.   :378   Max.   :4.0   Max.   :2.0   Max.   :7.0   Max.   :4.0   Max.   :10.0   Max.   :8.0       
</span></span><span class=line><span class=cl> Choco_Consumption Sustainability_Score
</span></span><span class=line><span class=cl> Min.   :0         Min.   :-3.26       
</span></span><span class=line><span class=cl> 1st Qu.:2         1st Qu.:-0.61       
</span></span><span class=line><span class=cl> Median :3         Median : 0.14       
</span></span><span class=line><span class=cl> Mean   :3         Mean   : 0.00       
</span></span><span class=line><span class=cl> 3rd Qu.:4         3rd Qu.: 0.68       
</span></span><span class=line><span class=cl> Max.   :5         Max.   : 2.04       
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; ### 1.1.1 remove consumer_id in data set, and set consumer_id as row name
</span></span><span class=line><span class=cl>&gt; rownames(seg.df) &lt;- seg.df[, 1]
</span></span><span class=line><span class=cl>&gt; seg.df &lt;- seg.df[, -1]
</span></span><span class=line><span class=cl>&gt; #### remove salary = 7, invalid data
</span></span><span class=line><span class=cl>&gt; seg.df &lt;- seg.df[seg.df$Salary != 7, ]
</span></span><span class=line><span class=cl>&gt; #### remove Employment, which related to Salary
</span></span><span class=line><span class=cl>&gt; seg.df &lt;- subset(seg.df, select = -Employment)
</span></span><span class=line><span class=cl>&gt; #### just split region to 3 groups
</span></span><span class=line><span class=cl>&gt; seg.df$Location_by_region[seg.df$Location_by_region &gt; 2] &lt;- 3
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>hist(seg.df$Sustainability_Score,
</span></span><span class=line><span class=cl>     main = &#34;All customers&#34;, 
</span></span><span class=line><span class=cl>     xlab = &#34;Sustainability_Score&#34;,
</span></span><span class=line><span class=cl>     ylab = &#34;Count&#34;,
</span></span><span class=line><span class=cl>     col = &#34;lightblue&#34; # colore the bars
</span></span><span class=line><span class=cl>)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_1.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>hist(seg.df$Choco_Consumption,
</span></span><span class=line><span class=cl>     main = &#34;All customers&#34;, 
</span></span><span class=line><span class=cl>     xlab = &#34;Choco_Consumption&#34;,
</span></span><span class=line><span class=cl>     ylab = &#34;Count&#34;,
</span></span><span class=line><span class=cl>     col = &#34;lightblue&#34; # colore the bars
</span></span><span class=line><span class=cl>)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_2.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>head</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Age_Group</span> <span class=n>Gender</span> <span class=n>Salary</span> <span class=n>Education</span> <span class=n>Location_by_region</span> <span class=n>Choco_Consumption</span> <span class=n>Sustainability_Score</span>
</span></span><span class=line><span class=cl><span class=mi>352</span>         <span class=mi>1</span>      <span class=mi>2</span>      <span class=mi>1</span>         <span class=mi>2</span>                  <span class=mi>3</span>                 <span class=mi>0</span>             <span class=o>-</span><span class=mf>1.15059</span>
</span></span><span class=line><span class=cl><span class=mi>103</span>         <span class=mi>3</span>      <span class=mi>2</span>      <span class=mi>3</span>         <span class=mi>1</span>                  <span class=mi>1</span>                 <span class=mi>1</span>              <span class=mf>0.50287</span>
</span></span><span class=line><span class=cl><span class=mi>17</span>          <span class=mi>1</span>      <span class=mi>1</span>      <span class=mi>1</span>         <span class=mi>1</span>                  <span class=mi>1</span>                 <span class=mi>1</span>             <span class=o>-</span><span class=mf>1.14517</span>
</span></span><span class=line><span class=cl><span class=mi>66</span>          <span class=mi>1</span>      <span class=mi>1</span>      <span class=mi>1</span>         <span class=mi>1</span>                  <span class=mi>1</span>                 <span class=mi>1</span>             <span class=o>-</span><span class=mf>0.46688</span>
</span></span><span class=line><span class=cl><span class=mi>329</span>         <span class=mi>2</span>      <span class=mi>1</span>      <span class=mi>1</span>         <span class=mi>1</span>                  <span class=mi>1</span>                 <span class=mi>1</span>             <span class=o>-</span><span class=mf>2.08817</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=p>,</span> <span class=n>digits</span> <span class=o>=</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>Age_Group</span>       <span class=n>Gender</span>        <span class=n>Salary</span>      <span class=n>Education</span>   <span class=n>Location_by_region</span> <span class=n>Choco_Consumption</span>
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>0.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0</span>        <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mi>0</span>        
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>2.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>        <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>2</span>        
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>1.0</span>        <span class=n>Median</span> <span class=p>:</span><span class=mi>3</span>        
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span><span class=mf>2.1</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>1.7</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>2.2</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>2.3</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>1.2</span>        <span class=n>Mean</span>   <span class=p>:</span><span class=mi>3</span>        
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>3.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>2.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>3.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>3.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>        <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>4</span>        
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>4.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>6.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>4.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>3.0</span>        <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mi>5</span>        
</span></span><span class=line><span class=cl> <span class=n>Sustainability_Score</span>
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>3.3e+00</span>    
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>6.1e-01</span>    
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span> <span class=mf>1.4e-01</span>    
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span><span class=o>-</span><span class=mf>9.6e-05</span>    
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>6.8e-01</span>    
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.0e+00</span>    
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>str</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;data.frame&#39;</span><span class=p>:</span>	<span class=mi>373</span> <span class=n>obs</span><span class=o>.</span> <span class=n>of</span>  <span class=mi>7</span> <span class=n>variables</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Age_Group</span>           <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>4</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Gender</span>              <span class=p>:</span> <span class=ne>int</span>  <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Salary</span>              <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>4</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>3</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Education</span>           <span class=p>:</span> <span class=ne>int</span>  <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Location_by_region</span>  <span class=p>:</span> <span class=n>num</span>  <span class=mi>3</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Choco_Consumption</span>   <span class=p>:</span> <span class=ne>int</span>  <span class=mi>0</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Sustainability_Score</span><span class=p>:</span> <span class=n>num</span>  <span class=o>-</span><span class=mf>1.151</span> <span class=mf>0.503</span> <span class=o>-</span><span class=mf>1.145</span> <span class=o>-</span><span class=mf>0.467</span> <span class=o>-</span><span class=mf>2.088</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span> <span class=o>&lt;-</span> <span class=n>seg</span><span class=o>.</span><span class=n>df</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=c1>#### just scale continous variables</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span> <span class=n>c</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>)]</span> <span class=o>&lt;-</span> <span class=n>scale</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=p>[</span> <span class=p>,</span> <span class=n>c</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=c1>#### factor ordered ordinals</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Age_Group</span> <span class=o>&lt;-</span> <span class=n>factor</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Age_Group</span><span class=p>,</span> <span class=n>ordered</span> <span class=o>=</span> <span class=n>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Salary</span> <span class=o>&lt;-</span> <span class=n>factor</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Salary</span><span class=p>,</span> <span class=n>ordered</span> <span class=o>=</span> <span class=n>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Education</span> <span class=o>&lt;-</span> <span class=n>factor</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Education</span><span class=p>,</span> <span class=n>ordered</span> <span class=o>=</span> <span class=n>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Gender</span> <span class=o>&lt;-</span> <span class=n>factor</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Gender</span><span class=p>,</span> <span class=n>ordered</span> <span class=o>=</span> <span class=n>FALSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Location_by_region</span> <span class=o>&lt;-</span> <span class=n>factor</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=o>$</span><span class=n>Location_by_region</span><span class=p>,</span> <span class=n>ordered</span> <span class=o>=</span> <span class=n>FALSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>head</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Age_Group</span> <span class=n>Gender</span> <span class=n>Salary</span> <span class=n>Education</span> <span class=n>Location_by_region</span> <span class=n>Choco_Consumption</span> <span class=n>Sustainability_Score</span>
</span></span><span class=line><span class=cl><span class=mi>352</span>         <span class=mi>1</span>      <span class=mi>2</span>      <span class=mi>1</span>         <span class=mi>2</span>                  <span class=mi>3</span>         <span class=o>-</span><span class=mf>2.449983</span>           <span class=o>-</span><span class=mf>1.1457402</span>
</span></span><span class=line><span class=cl><span class=mi>103</span>         <span class=mi>3</span>      <span class=mi>2</span>      <span class=mi>3</span>         <span class=mi>1</span>                  <span class=mi>1</span>         <span class=o>-</span><span class=mf>1.627442</span>            <span class=mf>0.5008876</span>
</span></span><span class=line><span class=cl><span class=mi>17</span>          <span class=mi>1</span>      <span class=mi>1</span>      <span class=mi>1</span>         <span class=mi>1</span>                  <span class=mi>1</span>         <span class=o>-</span><span class=mf>1.627442</span>           <span class=o>-</span><span class=mf>1.1403426</span>
</span></span><span class=line><span class=cl><span class=mi>66</span>          <span class=mi>1</span>      <span class=mi>1</span>      <span class=mi>1</span>         <span class=mi>1</span>                  <span class=mi>1</span>         <span class=o>-</span><span class=mf>1.627442</span>           <span class=o>-</span><span class=mf>0.4648553</span>
</span></span><span class=line><span class=cl><span class=mi>329</span>         <span class=mi>2</span>      <span class=mi>1</span>      <span class=mi>1</span>         <span class=mi>1</span>                  <span class=mi>1</span>         <span class=o>-</span><span class=mf>1.627442</span>           <span class=o>-</span><span class=mf>2.0794461</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=p>,</span> <span class=n>digits</span> <span class=o>=</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=n>Age_Group</span> <span class=n>Gender</span>  <span class=n>Salary</span>  <span class=n>Education</span> <span class=n>Location_by_region</span> <span class=n>Choco_Consumption</span> <span class=n>Sustainability_Score</span>
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=p>:</span><span class=mi>140</span>     <span class=mi>1</span><span class=p>:</span><span class=mi>119</span>   <span class=mi>0</span><span class=p>:</span> <span class=mi>34</span>   <span class=mi>1</span><span class=p>:</span> <span class=mi>76</span>     <span class=mi>1</span><span class=p>:</span><span class=mi>299</span>              <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>2.450</span>    <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>3.25</span>       
</span></span><span class=line><span class=cl> <span class=mi>2</span><span class=p>:</span><span class=mi>120</span>     <span class=mi>2</span><span class=p>:</span><span class=mi>254</span>   <span class=mi>1</span><span class=p>:</span><span class=mi>116</span>   <span class=mi>2</span><span class=p>:</span><span class=mi>183</span>     <span class=mi>2</span><span class=p>:</span> <span class=mi>58</span>              <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.805</span>    <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.61</span>       
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=p>:</span> <span class=mi>35</span>             <span class=mi>2</span><span class=p>:</span> <span class=mi>40</span>   <span class=mi>3</span><span class=p>:</span> <span class=mi>43</span>     <span class=mi>3</span><span class=p>:</span> <span class=mi>16</span>              <span class=n>Median</span> <span class=p>:</span> <span class=mf>0.018</span>    <span class=n>Median</span> <span class=p>:</span> <span class=mf>0.14</span>       
</span></span><span class=line><span class=cl> <span class=mi>4</span><span class=p>:</span> <span class=mi>78</span>             <span class=mi>3</span><span class=p>:</span><span class=mi>123</span>   <span class=mi>4</span><span class=p>:</span> <span class=mi>71</span>                        <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.000</span>    <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.00</span>       
</span></span><span class=line><span class=cl>                   <span class=mi>4</span><span class=p>:</span> <span class=mi>41</span>                                <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.840</span>    <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.68</span>       
</span></span><span class=line><span class=cl>                   <span class=mi>5</span><span class=p>:</span> <span class=mi>14</span>                                <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.663</span>    <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.03</span>       
</span></span><span class=line><span class=cl>                   <span class=mi>6</span><span class=p>:</span>  <span class=mi>5</span>                                                                      
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>str</span><span class=p>(</span><span class=n>seg</span><span class=o>.</span><span class=n>df</span><span class=o>.</span><span class=n>sc</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;data.frame&#39;</span><span class=p>:</span>	<span class=mi>373</span> <span class=n>obs</span><span class=o>.</span> <span class=n>of</span>  <span class=mi>7</span> <span class=n>variables</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Age_Group</span>           <span class=p>:</span> <span class=n>Ord</span><span class=o>.</span><span class=n>factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>4</span> <span class=n>levels</span> <span class=s2>&#34;1&#34;</span><span class=o>&lt;</span><span class=s2>&#34;2&#34;</span><span class=o>&lt;</span><span class=s2>&#34;3&#34;</span><span class=o>&lt;</span><span class=s2>&#34;4&#34;</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>4</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Gender</span>              <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span><span class=s2>&#34;2&#34;</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Salary</span>              <span class=p>:</span> <span class=n>Ord</span><span class=o>.</span><span class=n>factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>7</span> <span class=n>levels</span> <span class=s2>&#34;0&#34;</span><span class=o>&lt;</span><span class=s2>&#34;1&#34;</span><span class=o>&lt;</span><span class=s2>&#34;2&#34;</span><span class=o>&lt;</span><span class=s2>&#34;3&#34;</span><span class=o>&lt;..</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>4</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>5</span> <span class=mi>3</span> <span class=mi>4</span> <span class=mi>4</span> <span class=mi>4</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Education</span>           <span class=p>:</span> <span class=n>Ord</span><span class=o>.</span><span class=n>factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>4</span> <span class=n>levels</span> <span class=s2>&#34;1&#34;</span><span class=o>&lt;</span><span class=s2>&#34;2&#34;</span><span class=o>&lt;</span><span class=s2>&#34;3&#34;</span><span class=o>&lt;</span><span class=s2>&#34;4&#34;</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Location_by_region</span>  <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>3</span> <span class=n>levels</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span><span class=s2>&#34;2&#34;</span><span class=p>,</span><span class=s2>&#34;3&#34;</span><span class=p>:</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Choco_Consumption</span>   <span class=p>:</span> <span class=n>num</span>  <span class=o>-</span><span class=mf>2.45</span> <span class=o>-</span><span class=mf>1.63</span> <span class=o>-</span><span class=mf>1.63</span> <span class=o>-</span><span class=mf>1.63</span> <span class=o>-</span><span class=mf>1.63</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Sustainability_Score</span><span class=p>:</span> <span class=n>num</span>  <span class=o>-</span><span class=mf>1.146</span> <span class=mf>0.501</span> <span class=o>-</span><span class=mf>1.14</span> <span class=o>-</span><span class=mf>0.465</span> <span class=o>-</span><span class=mf>2.079</span> <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=112-hclust>1.1.2 hclust()</h3><blockquote><p>Considering data contains ordinal varibles and continous variables, use hclust().</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; ### 1.1.2 Hierarchical clustering: hclust()
</span></span><span class=line><span class=cl>&gt; seg.dist &lt;- dist(seg.df.sc)
</span></span><span class=line><span class=cl>&gt; # seg.dist &lt;- daisy(seg.df.sc, metric = &#34;gower&#34;)
</span></span><span class=line><span class=cl>&gt; as.matrix(seg.dist)[1:7, 1:7]
</span></span><span class=line><span class=cl>         352      103        17        66      329      241       34
</span></span><span class=line><span class=cl>352 0.000000 4.048204 2.5839125 2.6721113 2.923762 4.977689 2.821760
</span></span><span class=line><span class=cl>103 4.048204 0.000000 3.4195960 3.1516122 3.557825 2.618749 1.799080
</span></span><span class=line><span class=cl>17  2.583913 3.419596 0.0000000 0.6754873 1.371829 4.254911 1.811081
</span></span><span class=line><span class=cl>66  2.672111 3.151612 0.6754873 0.0000000 1.899185 4.358532 1.738220
</span></span><span class=line><span class=cl>329 2.923762 3.557825 1.3718292 1.8991849 0.000000 3.657826 2.038581
</span></span><span class=line><span class=cl>241 4.977689 2.618749 4.2549114 4.3585316 3.657826 0.000000 3.118659
</span></span><span class=line><span class=cl>34  2.821760 1.799080 1.8110812 1.7382205 2.038581 3.118659 0.000000
</span></span><span class=line><span class=cl>&gt; seg.hc &lt;- hclust(seg.dist, method=&#34;complete&#34;)
</span></span><span class=line><span class=cl>&gt; plot(seg.hc)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_3.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; rect.hclust(seg.hc, k=4, border = &#34;red&#34;)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_4.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; seg.hc.segment &lt;- cutree(seg.hc, k=4) #membership vector for 4 groups 
</span></span><span class=line><span class=cl>&gt; table(seg.hc.segment) #counts
</span></span><span class=line><span class=cl>seg.hc.segment
</span></span><span class=line><span class=cl>  1   2   3   4 
</span></span><span class=line><span class=cl> 78 172  88  35 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>data size of groups</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; clusplot(seg.df, seg.hc.segment,
</span></span><span class=line><span class=cl>+          color = TRUE, #color the groups
</span></span><span class=line><span class=cl>+          shade = TRUE, #shade the ellipses for group membership
</span></span><span class=line><span class=cl>+          labels = 4, #label only the groups, not the individual points 
</span></span><span class=line><span class=cl>+          lines = 0, #omit distance lines between groups
</span></span><span class=line><span class=cl>+          main = &#34;Hierarchical cluster plot&#34; # figure title
</span></span><span class=line><span class=cl>+ )
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_5.png %}</p><blockquote><p>Graph split to 4 groups</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; aggregate(seg.df, list(seg.hc.segment), mean)
</span></span><span class=line><span class=cl>  Group.1 Age_Group   Gender   Salary Education Location_by_region Choco_Consumption Sustainability_Score
</span></span><span class=line><span class=cl>1       1  1.692308 1.602564 1.756410  2.000000           1.282051          3.333333           -1.1191478
</span></span><span class=line><span class=cl>2       2  1.441860 1.686047 1.616279  1.819767           1.377907          2.668605            0.3161955
</span></span><span class=line><span class=cl>3       3  3.272727 1.659091 3.818182  2.977273           1.011364          3.397727            0.1015306
</span></span><span class=line><span class=cl>4       4  3.685714 1.885714 2.228571  3.542857           1.057143          2.657143            0.6839269
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Well-differentiated: Salary(Group3)„ÄÅEducation(Group4)„ÄÅChoco_Consumption(Group1„ÄÅGroup3)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; boxplot(seg.df$Salary ~ seg.hc.segment, ylab = &#34;Salary&#34;, xlab = &#34;Cluster&#34;)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_6.png %}</p><blockquote><p>Well-differentiated: Salary(Group3)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; boxplot(seg.df$Education ~ seg.hc.segment, ylab = &#34;Education&#34;, xlab = &#34;Cluster&#34;)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_7.png %}</p><blockquote><p>Well-differentiated: Education(Group4)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; boxplot(seg.df$Choco_Consumption ~ seg.hc.segment, ylab = &#34;Choco_Consumption&#34;, xlab = &#34;Cluster&#34;)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_8.png %}</p><blockquote><p>Differentiated not welled, ignore</p></blockquote><h3 id=113-conclusion>1.1.3 Conclusion</h3><div class=table-wrapper><table><thead><tr><th>Group.</th><th>Age_Group</th><th>Gender</th><th>Salary</th><th>Education</th><th>Location_by_region</th><th>Choco_Consumption</th><th>Sustainability_Score</th></tr></thead><tbody><tr><td>1</td><td>1.692308</td><td>1.602564</td><td>1.75641</td><td>2.000000</td><td>1.282051</td><td>3.333333</td><td>-1.1191478</td></tr><tr><td>2</td><td>1.441860</td><td>1.686047</td><td>1.61628</td><td>1.819767</td><td>1.377907</td><td>2.668605</td><td>0.3161955</td></tr><tr><td>3</td><td>3.272727</td><td>1.659091</td><td>3.81818</td><td>2.977273</td><td>1.011364</td><td>3.397727</td><td>0.1015306</td></tr><tr><td>4</td><td>3.685714</td><td>1.885714</td><td>2.22857</td><td>3.542857</td><td>1.057143</td><td>2.657143</td><td>0.6839269</td></tr></tbody></table></div><p>Graph split to 4 groups(Only explained 50.93% of the data), we see that group3 is modestly well-differentiated. 88 customers with higher salary and higher consumption of choco, means more potential to pay at a higher price. Second target is group4, higher educated rate and more sensitive to sustainability, companies can move towards sustainability and attract potential highly educated customers.</p><h2 id=12-factor-analysis>1.2 Factor analysis</h2><p>Remove unnecesssary columns from data: product_id,company_location,review_date,country_of_bean_origin,first_taste,second_taste,third_taste. Use heatmap and corrplot to visualizing the relation between factors. Finally using PCA find the position of brand, and looking for future brand positioning.</p><h3 id=121-import-and-check-data>1.2.1 import and check data</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>ratings</span> <span class=o>&lt;-</span> <span class=n>read</span><span class=o>.</span><span class=n>csv</span><span class=p>(</span><span class=s2>&#34;2_chocolate_rating.csv&#34;</span><span class=p>,</span> <span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=n>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=c1>#### remove unnecessary columns</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>ratings</span> <span class=o>&lt;-</span> <span class=n>subset</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>,</span> <span class=n>select</span> <span class=o>=</span> <span class=o>-</span><span class=n>c</span><span class=p>(</span><span class=n>product_id</span><span class=p>,</span><span class=n>company_location</span><span class=p>,</span><span class=n>review_date</span><span class=p>,</span><span class=n>country_of_bean_origin</span><span class=p>,</span><span class=n>first_taste</span><span class=p>,</span><span class=n>second_taste</span><span class=p>,</span><span class=n>third_taste</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>head</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>brand</span> <span class=n>cocoa_percent</span> <span class=n>rating</span> <span class=n>counts_of_ingredients</span> <span class=n>cocoa_butter</span> <span class=n>vanilla</span> <span class=n>organic</span> <span class=n>salt</span> <span class=n>sugar</span> <span class=n>sweetener</span>
</span></span><span class=line><span class=cl><span class=mi>1</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>            <span class=mi>70</span>   <span class=mf>4.00</span>                     <span class=mi>2</span>            <span class=mi>4</span>       <span class=mi>8</span>       <span class=mi>8</span>    <span class=mi>2</span>     <span class=mi>9</span>         <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=mi>2</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>            <span class=mi>70</span>   <span class=mf>3.75</span>                     <span class=mi>1</span>            <span class=mi>1</span>       <span class=mi>4</span>       <span class=mi>7</span>    <span class=mi>1</span>     <span class=mi>1</span>         <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>3</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>            <span class=mi>70</span>   <span class=mf>3.50</span>                     <span class=mi>2</span>            <span class=mi>3</span>       <span class=mi>5</span>       <span class=mi>9</span>    <span class=mi>2</span>     <span class=mi>9</span>         <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>4</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>            <span class=mi>70</span>   <span class=mf>2.75</span>                     <span class=mi>1</span>            <span class=mi>6</span>      <span class=mi>10</span>       <span class=mi>8</span>    <span class=mi>3</span>     <span class=mi>4</span>         <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>5</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>            <span class=mi>70</span>   <span class=mf>3.50</span>                     <span class=mi>1</span>            <span class=mi>1</span>       <span class=mi>5</span>       <span class=mi>8</span>    <span class=mi>1</span>     <span class=mi>9</span>         <span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=mi>6</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>            <span class=mi>63</span>   <span class=mf>3.75</span>                     <span class=mi>2</span>            <span class=mi>8</span>       <span class=mi>9</span>       <span class=mi>5</span>    <span class=mi>3</span>     <span class=mi>8</span>         <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>brand</span>     <span class=n>cocoa_percent</span>        <span class=n>rating</span>      <span class=n>counts_of_ingredients</span>  <span class=n>cocoa_butter</span>       <span class=n>vanilla</span>          <span class=n>organic</span>            <span class=n>salt</span>       
</span></span><span class=line><span class=cl> <span class=n>Soma</span>                  <span class=p>:</span> <span class=mi>11</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>60.00</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>2.250</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>        <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>  
</span></span><span class=line><span class=cl> <span class=n>Arete</span>                 <span class=p>:</span> <span class=mi>10</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>70.00</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>3.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>2.000</span>        <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>3.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>6.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>3.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>2.000</span>  
</span></span><span class=line><span class=cl> <span class=n>Cacao</span> <span class=n>de</span> <span class=n>Origen</span>       <span class=p>:</span> <span class=mi>10</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>70.00</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>3.250</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>4.000</span>        <span class=n>Median</span> <span class=p>:</span> <span class=mf>6.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>8.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>5.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>5.500</span>  
</span></span><span class=line><span class=cl> <span class=n>hexx</span>                  <span class=p>:</span>  <span class=mi>8</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>71.53</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>3.285</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>5.078</span>        <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>5.663</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>7.407</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>5.275</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>5.384</span>  
</span></span><span class=line><span class=cl> <span class=n>Smooth</span> <span class=n>Chocolator</span><span class=p>,</span> <span class=n>The</span><span class=p>:</span>  <span class=mi>8</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>74.00</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>3.500</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>9.000</span>        <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>8.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>9.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>8.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>9.000</span>  
</span></span><span class=line><span class=cl> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>              <span class=p>:</span>  <span class=mi>7</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>100.00</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>4.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>        <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>  
</span></span><span class=line><span class=cl> <span class=p>(</span><span class=n>Other</span><span class=p>)</span>               <span class=p>:</span><span class=mi>204</span>                                                                                                                             
</span></span><span class=line><span class=cl>     <span class=n>sugar</span>          <span class=n>sweetener</span>     
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.000</span>  
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>2.000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>3.000</span>  
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span> <span class=mf>4.000</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>4.000</span>  
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>4.155</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>4.415</span>  
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>6.000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>6.000</span>  
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.000</span>  
</span></span><span class=line><span class=cl>                                  
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>str</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;data.frame&#39;</span><span class=p>:</span>	<span class=mi>258</span> <span class=n>obs</span><span class=o>.</span> <span class=n>of</span>  <span class=mi>10</span> <span class=n>variables</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>brand</span>                <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>56</span> <span class=n>levels</span> <span class=s2>&#34;A. Morin&#34;</span><span class=p>,</span><span class=s2>&#34;Altus aka Cao Artisan&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>cocoa_percent</span>        <span class=p>:</span> <span class=n>num</span>  <span class=mi>70</span> <span class=mi>70</span> <span class=mi>70</span> <span class=mi>70</span> <span class=mi>70</span> <span class=mi>63</span> <span class=mi>70</span> <span class=mi>60</span> <span class=mi>60</span> <span class=mi>60</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>rating</span>               <span class=p>:</span> <span class=n>num</span>  <span class=mi>4</span> <span class=mf>3.75</span> <span class=mf>3.5</span> <span class=mf>2.75</span> <span class=mf>3.5</span> <span class=mf>3.75</span> <span class=mf>3.5</span> <span class=mi>3</span> <span class=mf>2.75</span> <span class=mf>2.5</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>counts_of_ingredients</span><span class=p>:</span> <span class=ne>int</span>  <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>3</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>cocoa_butter</span>         <span class=p>:</span> <span class=ne>int</span>  <span class=mi>4</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>6</span> <span class=mi>1</span> <span class=mi>8</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>vanilla</span>              <span class=p>:</span> <span class=ne>int</span>  <span class=mi>8</span> <span class=mi>4</span> <span class=mi>5</span> <span class=mi>10</span> <span class=mi>5</span> <span class=mi>9</span> <span class=mi>5</span> <span class=mi>7</span> <span class=mi>8</span> <span class=mi>9</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>organic</span>              <span class=p>:</span> <span class=ne>int</span>  <span class=mi>8</span> <span class=mi>7</span> <span class=mi>9</span> <span class=mi>8</span> <span class=mi>8</span> <span class=mi>5</span> <span class=mi>7</span> <span class=mi>5</span> <span class=mi>10</span> <span class=mi>8</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>salt</span>                 <span class=p>:</span> <span class=ne>int</span>  <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>sugar</span>                <span class=p>:</span> <span class=ne>int</span>  <span class=mi>9</span> <span class=mi>1</span> <span class=mi>9</span> <span class=mi>4</span> <span class=mi>9</span> <span class=mi>8</span> <span class=mi>5</span> <span class=mi>8</span> <span class=mi>7</span> <span class=mi>3</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>sweetener</span>            <span class=p>:</span> <span class=ne>int</span>  <span class=mi>7</span> <span class=mi>1</span> <span class=mi>5</span> <span class=mi>5</span> <span class=mi>9</span> <span class=mi>7</span> <span class=mi>1</span> <span class=mi>7</span> <span class=mi>7</span> <span class=mi>3</span> <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=122-rescaling-the-data>1.2.2 Rescaling the data</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>sc</span> <span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>ratings</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span><span class=mi>2</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span> <span class=o>&lt;-</span> <span class=n>scale</span> <span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>ratings</span><span class=p>[,</span><span class=mi>2</span><span class=p>:</span><span class=mi>10</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>head</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>brand</span> <span class=n>cocoa_percent</span>     <span class=n>rating</span> <span class=n>counts_of_ingredients</span> <span class=n>cocoa_butter</span>    <span class=n>vanilla</span>     <span class=n>organic</span>       <span class=n>salt</span>      <span class=n>sugar</span>  <span class=n>sweetener</span>
</span></span><span class=line><span class=cl><span class=mi>1</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>     <span class=o>-</span><span class=mf>0.315311</span>  <span class=mf>1.8112654</span>            <span class=o>-</span><span class=mf>0.8883386</span>   <span class=o>-</span><span class=mf>0.5795367</span>  <span class=mf>0.2596824</span>  <span class=mf>0.96349072</span> <span class=o>-</span><span class=mf>0.9958673</span>  <span class=mf>1.7971812</span>  <span class=mf>1.2538261</span>
</span></span><span class=line><span class=cl><span class=mi>2</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>     <span class=o>-</span><span class=mf>0.315311</span>  <span class=mf>1.1780588</span>            <span class=o>-</span><span class=mf>1.1769927</span>   <span class=o>-</span><span class=mf>1.6251343</span> <span class=o>-</span><span class=mf>1.4919010</span>  <span class=mf>0.60989099</span> <span class=o>-</span><span class=mf>1.2901786</span> <span class=o>-</span><span class=mf>1.1703244</span> <span class=o>-</span><span class=mf>1.6561032</span>
</span></span><span class=line><span class=cl><span class=mi>3</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>     <span class=o>-</span><span class=mf>0.315311</span>  <span class=mf>0.5448522</span>            <span class=o>-</span><span class=mf>0.8883386</span>   <span class=o>-</span><span class=mf>0.9280692</span> <span class=o>-</span><span class=mf>1.0540051</span>  <span class=mf>1.31709044</span> <span class=o>-</span><span class=mf>0.9958673</span>  <span class=mf>1.7971812</span>  <span class=mf>0.2838497</span>
</span></span><span class=line><span class=cl><span class=mi>4</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>     <span class=o>-</span><span class=mf>0.315311</span> <span class=o>-</span><span class=mf>1.3547676</span>            <span class=o>-</span><span class=mf>1.1769927</span>    <span class=mf>0.1175284</span>  <span class=mf>1.1354741</span>  <span class=mf>0.96349072</span> <span class=o>-</span><span class=mf>0.7015560</span> <span class=o>-</span><span class=mf>0.0575098</span>  <span class=mf>0.2838497</span>
</span></span><span class=line><span class=cl><span class=mi>5</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>     <span class=o>-</span><span class=mf>0.315311</span>  <span class=mf>0.5448522</span>            <span class=o>-</span><span class=mf>1.1769927</span>   <span class=o>-</span><span class=mf>1.6251343</span> <span class=o>-</span><span class=mf>1.0540051</span>  <span class=mf>0.96349072</span> <span class=o>-</span><span class=mf>1.2901786</span>  <span class=mf>1.7971812</span>  <span class=mf>2.2238026</span>
</span></span><span class=line><span class=cl><span class=mi>6</span> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>     <span class=o>-</span><span class=mf>1.755138</span>  <span class=mf>1.1780588</span>            <span class=o>-</span><span class=mf>0.8883386</span>    <span class=mf>0.8145935</span>  <span class=mf>0.6975783</span> <span class=o>-</span><span class=mf>0.09730845</span> <span class=o>-</span><span class=mf>0.7015560</span>  <span class=mf>1.4262430</span>  <span class=mf>1.2538261</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>brand</span>     <span class=n>cocoa_percent</span>         <span class=n>rating</span>         <span class=n>counts_of_ingredients</span>  <span class=n>cocoa_butter</span>        <span class=n>vanilla</span>           <span class=n>organic</span>        
</span></span><span class=line><span class=cl> <span class=n>Soma</span>                  <span class=p>:</span> <span class=mi>11</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>2.3722</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>2.62118</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.1770</span>       <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.6251</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>2.8056</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.51171</span>  
</span></span><span class=line><span class=cl> <span class=n>Arete</span>                 <span class=p>:</span> <span class=mi>10</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.3153</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.72156</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.8883</span>       <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.9281</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.6161</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.80451</span>  
</span></span><span class=line><span class=cl> <span class=n>Cacao</span> <span class=n>de</span> <span class=n>Origen</span>       <span class=p>:</span> <span class=mi>10</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.3153</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.08835</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.3110</span>       <span class=n>Median</span> <span class=p>:</span> <span class=mf>0.1175</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>0.2597</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.09731</span>  
</span></span><span class=line><span class=cl> <span class=n>hexx</span>                  <span class=p>:</span>  <span class=mi>8</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.00000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>       <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.00000</span>  
</span></span><span class=line><span class=cl> <span class=n>Smooth</span> <span class=n>Chocolator</span><span class=p>,</span> <span class=n>The</span><span class=p>:</span>  <span class=mi>8</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.5074</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.54485</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>1.1322</span>       <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.8146</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.6976</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.96349</span>  
</span></span><span class=line><span class=cl> <span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>              <span class=p>:</span>  <span class=mi>7</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>5.8554</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.81127</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.4209</span>       <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.5117</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.1355</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.67069</span>  
</span></span><span class=line><span class=cl> <span class=p>(</span><span class=n>Other</span><span class=p>)</span>               <span class=p>:</span><span class=mi>204</span>                                                                                                                    
</span></span><span class=line><span class=cl>      <span class=n>salt</span>              <span class=n>sugar</span>            <span class=n>sweetener</span>      
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.29018</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.17032</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>1.6561</span>  
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.99587</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.79939</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.6861</span>  
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span> <span class=mf>0.03422</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.05751</span>   <span class=n>Median</span> <span class=p>:</span><span class=o>-</span><span class=mf>0.2011</span>  
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.00000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.00000</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.0000</span>  
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>1.06431</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.68437</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.7688</span>  
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.35862</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.16812</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.7088</span>  
</span></span><span class=line><span class=cl>                                                        
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>str</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;data.frame&#39;</span><span class=p>:</span>	<span class=mi>258</span> <span class=n>obs</span><span class=o>.</span> <span class=n>of</span>  <span class=mi>10</span> <span class=n>variables</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>brand</span>                <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>56</span> <span class=n>levels</span> <span class=s2>&#34;A. Morin&#34;</span><span class=p>,</span><span class=s2>&#34;Altus aka Cao Artisan&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>cocoa_percent</span>        <span class=p>:</span> <span class=n>num</span>  <span class=o>-</span><span class=mf>0.315</span> <span class=o>-</span><span class=mf>0.315</span> <span class=o>-</span><span class=mf>0.315</span> <span class=o>-</span><span class=mf>0.315</span> <span class=o>-</span><span class=mf>0.315</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>rating</span>               <span class=p>:</span> <span class=n>num</span>  <span class=mf>1.811</span> <span class=mf>1.178</span> <span class=mf>0.545</span> <span class=o>-</span><span class=mf>1.355</span> <span class=mf>0.545</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>counts_of_ingredients</span><span class=p>:</span> <span class=n>num</span>  <span class=o>-</span><span class=mf>0.888</span> <span class=o>-</span><span class=mf>1.177</span> <span class=o>-</span><span class=mf>0.888</span> <span class=o>-</span><span class=mf>1.177</span> <span class=o>-</span><span class=mf>1.177</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>cocoa_butter</span>         <span class=p>:</span> <span class=n>num</span>  <span class=o>-</span><span class=mf>0.58</span> <span class=o>-</span><span class=mf>1.625</span> <span class=o>-</span><span class=mf>0.928</span> <span class=mf>0.118</span> <span class=o>-</span><span class=mf>1.625</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>vanilla</span>              <span class=p>:</span> <span class=n>num</span>  <span class=mf>0.26</span> <span class=o>-</span><span class=mf>1.49</span> <span class=o>-</span><span class=mf>1.05</span> <span class=mf>1.14</span> <span class=o>-</span><span class=mf>1.05</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>organic</span>              <span class=p>:</span> <span class=n>num</span>  <span class=mf>0.963</span> <span class=mf>0.61</span> <span class=mf>1.317</span> <span class=mf>0.963</span> <span class=mf>0.963</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>salt</span>                 <span class=p>:</span> <span class=n>num</span>  <span class=o>-</span><span class=mf>0.996</span> <span class=o>-</span><span class=mf>1.29</span> <span class=o>-</span><span class=mf>0.996</span> <span class=o>-</span><span class=mf>0.702</span> <span class=o>-</span><span class=mf>1.29</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>sugar</span>                <span class=p>:</span> <span class=n>num</span>  <span class=mf>1.7972</span> <span class=o>-</span><span class=mf>1.1703</span> <span class=mf>1.7972</span> <span class=o>-</span><span class=mf>0.0575</span> <span class=mf>1.7972</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>sweetener</span>            <span class=p>:</span> <span class=n>num</span>  <span class=mf>1.254</span> <span class=o>-</span><span class=mf>1.656</span> <span class=mf>0.284</span> <span class=mf>0.284</span> <span class=mf>2.224</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>cor</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span><span class=mi>2</span><span class=p>:</span><span class=mi>10</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                      <span class=n>cocoa_percent</span>       <span class=n>rating</span> <span class=n>counts_of_ingredients</span> <span class=n>cocoa_butter</span>     <span class=n>vanilla</span>     <span class=n>organic</span>        <span class=n>salt</span>       <span class=n>sugar</span>    <span class=n>sweetener</span>
</span></span><span class=line><span class=cl><span class=n>cocoa_percent</span>           <span class=mf>1.000000000</span> <span class=o>-</span><span class=mf>0.052546644</span>            <span class=mf>0.07123417</span>  <span class=mf>0.077370649</span> <span class=o>-</span><span class=mf>0.02206531</span> <span class=o>-</span><span class=mf>0.04113143</span>  <span class=mf>0.17036000</span> <span class=o>-</span><span class=mf>0.03957938</span>  <span class=mf>0.003483658</span>
</span></span><span class=line><span class=cl><span class=n>rating</span>                 <span class=o>-</span><span class=mf>0.052546644</span>  <span class=mf>1.000000000</span>            <span class=mf>0.01437280</span>  <span class=mf>0.005272191</span> <span class=o>-</span><span class=mf>0.09133055</span>  <span class=mf>0.04277047</span> <span class=o>-</span><span class=mf>0.04554864</span>  <span class=mf>0.03054233</span>  <span class=mf>0.003668166</span>
</span></span><span class=line><span class=cl><span class=n>counts_of_ingredients</span>   <span class=mf>0.071234169</span>  <span class=mf>0.014372799</span>            <span class=mf>1.00000000</span>  <span class=mf>0.711183570</span>  <span class=mf>0.05157357</span> <span class=o>-</span><span class=mf>0.57011292</span>  <span class=mf>0.72006935</span> <span class=o>-</span><span class=mf>0.10961457</span> <span class=o>-</span><span class=mf>0.106926187</span>
</span></span><span class=line><span class=cl><span class=n>cocoa_butter</span>            <span class=mf>0.077370649</span>  <span class=mf>0.005272191</span>            <span class=mf>0.71118357</span>  <span class=mf>1.000000000</span> <span class=o>-</span><span class=mf>0.02054327</span> <span class=o>-</span><span class=mf>0.50977572</span>  <span class=mf>0.74932496</span> <span class=o>-</span><span class=mf>0.13708717</span> <span class=o>-</span><span class=mf>0.040725138</span>
</span></span><span class=line><span class=cl><span class=n>vanilla</span>                <span class=o>-</span><span class=mf>0.022065307</span> <span class=o>-</span><span class=mf>0.091330547</span>            <span class=mf>0.05157357</span> <span class=o>-</span><span class=mf>0.020543269</span>  <span class=mf>1.00000000</span>  <span class=mf>0.08983402</span> <span class=o>-</span><span class=mf>0.00917223</span>  <span class=mf>0.07187530</span>  <span class=mf>0.111933243</span>
</span></span><span class=line><span class=cl><span class=n>organic</span>                <span class=o>-</span><span class=mf>0.041131426</span>  <span class=mf>0.042770467</span>           <span class=o>-</span><span class=mf>0.57011292</span> <span class=o>-</span><span class=mf>0.509775721</span>  <span class=mf>0.08983402</span>  <span class=mf>1.00000000</span> <span class=o>-</span><span class=mf>0.61074144</span>  <span class=mf>0.10206892</span>  <span class=mf>0.091787605</span>
</span></span><span class=line><span class=cl><span class=n>salt</span>                    <span class=mf>0.170360004</span> <span class=o>-</span><span class=mf>0.045548635</span>            <span class=mf>0.72006935</span>  <span class=mf>0.749324961</span> <span class=o>-</span><span class=mf>0.00917223</span> <span class=o>-</span><span class=mf>0.61074144</span>  <span class=mf>1.00000000</span> <span class=o>-</span><span class=mf>0.13863007</span> <span class=o>-</span><span class=mf>0.134994219</span>
</span></span><span class=line><span class=cl><span class=n>sugar</span>                  <span class=o>-</span><span class=mf>0.039579384</span>  <span class=mf>0.030542330</span>           <span class=o>-</span><span class=mf>0.10961457</span> <span class=o>-</span><span class=mf>0.137087169</span>  <span class=mf>0.07187530</span>  <span class=mf>0.10206892</span> <span class=o>-</span><span class=mf>0.13863007</span>  <span class=mf>1.00000000</span>  <span class=mf>0.629589888</span>
</span></span><span class=line><span class=cl><span class=n>sweetener</span>               <span class=mf>0.003483658</span>  <span class=mf>0.003668166</span>           <span class=o>-</span><span class=mf>0.10692619</span> <span class=o>-</span><span class=mf>0.040725138</span>  <span class=mf>0.11193324</span>  <span class=mf>0.09178760</span> <span class=o>-</span><span class=mf>0.13499422</span>  <span class=mf>0.62958989</span>  <span class=mf>1.000000000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>corrplot</span><span class=p>(</span><span class=n>cor</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>sc</span><span class=p>[,</span><span class=mi>2</span><span class=p>:</span><span class=mi>10</span><span class=p>]),</span> <span class=n>order</span> <span class=o>=</span> <span class=s2>&#34;hclust&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_9.png %}</p><blockquote><p>organic un-related with countsOfIngredients„ÄÅcocoaButter and salt
salt related with countsOfIngredients and cocoaButter</p></blockquote><h3 id=123-mean-rating-by-brand>1.2.3 Mean rating by brand</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; brand.mean &lt;- aggregate(. ~ brand, data=brand.sc, mean) 
</span></span><span class=line><span class=cl>&gt; brand.mean
</span></span><span class=line><span class=cl>                          brand cocoa_percent      rating counts_of_ingredients cocoa_butter     vanilla     organic        salt       sugar    sweetener
</span></span><span class=line><span class=cl>1                      A. Morin  -0.521000636  0.63531027           -1.05328377   -0.7786981 -0.36588308  0.76143373 -1.03791178  0.84334011  0.283849693
</span></span><span class=line><span class=cl>2         Altus aka Cao Artisan  -1.857983139 -1.19646594           -0.81617505   -1.6251343 -0.06873946  0.69829093 -1.21660078  0.22069385  0.041355584
</span></span><span class=line><span class=cl>3                      Ambrosia  -0.366733424  0.06994724           -0.88833857   -1.0152024 -0.28768739  1.05189065 -1.14302296 -0.61391709 -0.686126742
</span></span><span class=line><span class=cl>4                        Amedei  -0.109621404 -0.59491968           -0.77287693   -0.6492432  0.34726159  0.96349072 -0.93700505  0.38761604  1.156828484
</span></span><span class=line><span class=cl>5                         Arete  -0.253604135  0.67149350           -1.06153103   -0.9629225  0.25968242  0.68061094 -1.08416070 -0.28007272 -0.007143237
</span></span><span class=line><span class=cl>6                        Bonnat   0.198913020  1.17805877           -1.03266562   -0.8409361 -0.39716135  1.05189065 -1.06944513  0.03522475  0.162602639
</span></span><span class=line><span class=cl>7  Brasstown aka It&#39;s Chocolate  -0.191897250  0.92477613           -1.11926184   -0.7886562  0.43484076  0.89277077 -0.99586731  0.01667784  0.574842623
</span></span><span class=line><span class=cl>8                        Brazen  -0.315311020 -0.56325935           -1.03266562   -0.8409361  0.04073450  0.52149106 -1.14302296 -0.15024435 -0.443632633
</span></span><span class=line><span class=cl>9                        Bright  -0.041058199  0.12271446           -1.08077463   -1.2766018 -1.34593569  1.31709044 -1.19207484  1.67353512  0.607175171
</span></span><span class=line><span class=cl>10              Burnt Fork Bend  -0.726690252 -0.51049213           -0.88833857   -0.3471816 -0.76207456  0.84562414 -0.99586731  0.18978233 -0.686126742
</span></span><span class=line><span class=cl>11              Cacao de Origen   0.507447444 -0.40495770           -1.06153103   -1.1023355 -0.17821343  1.06957063 -1.14302296  0.16505312  0.332348515
</span></span><span class=line><span class=cl>12                   Castronovo  -0.212466212  0.06994724           -1.17699266   -0.5795367 -0.17821343  1.14029058 -0.99586731  0.31342840  0.283849693
</span></span><span class=line><span class=cl>13                  Chocolarder  -0.109621404 -1.51306923           -1.10482914   -0.3181373  0.58810431  1.22869051 -0.84871166  0.31342840  0.283849693
</span></span><span class=line><span class=cl>14           Chocolate Con Amor  -0.058199000 -0.56325935           -0.96050209   -0.1438710  0.25968242  0.87509079 -0.84871166  0.68436660  0.041355584
</span></span><span class=line><span class=cl>15             Chocolate Makers   1.227361100  0.54485218           -1.03266562   -1.6251343  0.69757827  0.96349072 -1.29017861 -1.17032439 -0.686126742
</span></span><span class=line><span class=cl>16                       Domori  -0.315311020  1.17805877           -0.88833857   -1.2766018  0.47863035  0.60989099 -0.99586731  0.31342840  0.041355584
</span></span><span class=line><span class=cl>17                     Dormouse   0.850263471 -0.93262986           -1.08077463   -1.2766018  0.40564770  0.37415785 -1.09397107 -0.67574013 -0.201138524
</span></span><span class=line><span class=cl>18                        Durci  -0.315311020  0.75592104           -0.79212054   -0.9861580 -0.03224814  0.96349072 -1.14302296  1.24077389  0.930500649
</span></span><span class=line><span class=cl>19            East Van Roasters  -0.315311020  0.54485218           -1.08077463   -1.1604242  0.84354355  0.84562414 -1.09397107  0.06613627  0.283849693
</span></span><span class=line><span class=cl>20                        Fossa   0.044645808 -0.40495770           -0.74401152   -0.9280692  0.36915638  0.87509079 -0.92228948  0.59163205  0.283849693
</span></span><span class=line><span class=cl>21                   Franceschi  -0.109621404 -0.17881249           -1.05328377   -0.8782789 -0.05310033  1.21606195 -1.03791178  0.31342840  0.075997600
</span></span><span class=line><span class=cl>22                       Fresco  -0.178184609  0.22824889           -0.16670333   -0.6957142  0.18669978 -0.27410831  0.03422224  0.37525143 -0.524464002
</span></span><span class=line><span class=cl>23                Georgia Ramon   0.370321033  0.12271446            0.84358600    0.6403272  0.69757827 -0.92237447  0.67189673  0.37525143 -0.039475785
</span></span><span class=line><span class=cl>24                     Habitual   0.164631417 -0.61602657            0.60304092    0.5241497  0.40564770 -0.33304160  0.77000049  0.18978233  0.283849693
</span></span><span class=line><span class=cl>25                         hexx   0.070357010 -0.87986264            0.41060485    0.2917947  0.09547148 -0.62770803  0.36532246 -0.24297890  0.405096747
</span></span><span class=line><span class=cl>26                      Hogarth   0.233194623 -0.29942327            0.89169501    0.5822385  0.40564770 -0.21517503  0.42663731 -0.11933283  0.203018324
</span></span><span class=line><span class=cl>27                   Holy Cacao  -0.315311020  0.06994724            0.41060485    0.7274604  0.47863035 -0.71610797  1.13788962 -0.33571345 -0.079891470
</span></span><span class=line><span class=cl>28               Johnny Iuzzini   0.219481982  0.41821086            0.84358600    0.2569414  0.60999910 -0.73378795  0.71113823  0.46180368  0.186852050
</span></span><span class=line><span class=cl>29                          Kto   0.096068212 -0.72156100            0.84358600    0.8145935  0.69757827 -0.59234806  0.59341371 -0.42844799  0.089854406
</span></span><span class=line><span class=cl>30                         Kyya   0.198913020 -1.14369872            0.55493190    0.5822385  0.69757827 -0.45090817  1.26051933  0.93165873  0.122186954
</span></span><span class=line><span class=cl>31           Laia aka Chat-Noir   0.233194623 -0.93262986            0.65114993    0.3498834  0.25968242 -0.92237447  0.86810426  1.05530479  0.768837910
</span></span><span class=line><span class=cl>32                  Letterpress  -0.315311020  0.75592104           -0.11859432    0.4660610  0.69757827 -0.09730845  0.96620803 -0.30480193  0.283849693
</span></span><span class=line><span class=cl>33                         Mana   0.507447444 -1.77690531            0.26627781    0.1175284  0.11371714 -0.92237447  0.47568919  0.06613627 -0.201138524
</span></span><span class=line><span class=cl>34                Map Chocolate  -0.521000636  0.33378332            0.50682289    0.2917947  0.25968242 -0.98130776  0.32853354 -0.42844799  0.122186954
</span></span><span class=line><span class=cl>35                     Maverick  -0.315311020  0.06994724            1.06007657    0.9888598  0.47863035 -0.98130776  0.54926702  0.22069385 -0.079891470
</span></span><span class=line><span class=cl>36                 Mike &amp; Becky  -0.315311020 -0.51049213            0.07384175    0.8145935  0.69757827 -0.92237447  0.08327413 -0.18115586  0.283849693
</span></span><span class=line><span class=cl>37                       Milton  -0.315311020  0.86145548            1.42089418    0.4660610  0.47863035  0.07949141  0.32853354  0.68436660  0.041355584
</span></span><span class=line><span class=cl>38                        Naive   0.198913020 -1.03816429            0.84358600    0.8145935  0.47863035 -0.62770803  1.35862310 -0.42844799 -0.443632633
</span></span><span class=line><span class=cl>39                       Nibble   0.096068212 -1.35476759            0.77142247    0.7274604  0.25968242 -0.89290783  0.99073397  0.03522475 -0.079891470
</span></span><span class=line><span class=cl>40                       Nuance  -0.315311020 -0.08835441            1.34873066    0.3789278  0.36915638 -1.06970769  0.10780007 -0.24297890  0.405096747
</span></span><span class=line><span class=cl>41                       Pacari  -0.315311020  0.86145548            1.42089418    0.9017266  0.58810431 -0.80450790  0.99073397  0.68436660 -0.201138524
</span></span><span class=line><span class=cl>42              Palette de Bine   0.541729047 -0.29942327            0.55493190    0.4079722  0.55161299 -0.39197489  1.06431180  0.49889750  0.688006541
</span></span><span class=line><span class=cl>43                       Pangea   0.576010649  0.12271446            1.22845812    1.0469485  0.40564770 -0.80450790  0.47568919 -0.18115586  0.122186954
</span></span><span class=line><span class=cl>44                       Pralus   0.713137060 -0.24665605            0.91574952    0.7274604  0.58810431 -0.36250824  0.40211137 -0.15024435  0.041355584
</span></span><span class=line><span class=cl>45           Pump Street Bakery   0.987389881 -0.40495770           -0.02237629    0.8145935 -0.98102248 -0.21517503  0.96620803 -0.42844799 -0.281969894
</span></span><span class=line><span class=cl>46                 Pura Delizia  -0.521000636  0.54485218           -0.59968447    0.4660610 -1.49190097 -0.45090817  0.47568919 -0.24297890 -0.201138524
</span></span><span class=line><span class=cl>47                        Qantu  -0.315311020  0.33378332           -0.11859432    0.9307710 -0.17821343 -0.45090817  1.16241556 -0.42844799 -0.039475785
</span></span><span class=line><span class=cl>48                       Sirene   1.712200909  0.63531027            0.80234970    0.5158513 -0.67866582 -0.34987968  0.72795602 -0.42844799 -0.478274648
</span></span><span class=line><span class=cl>49       Smooth Chocolator, The  -0.469578232  0.78230465            0.33844133    0.8145935 -0.94453116 -0.98130776  0.69642267 -0.70665164 -0.504256160
</span></span><span class=line><span class=cl>50                         Soma  -0.090922348  0.89023759            0.44996678    0.5294305 -0.41706571  0.22414584  0.26164461 -0.66449957 -0.730216579
</span></span><span class=line><span class=cl>51                         Soul   0.198913020  0.22824889            0.77142247    0.6403272 -1.05400512 -0.89290783  1.06431180 -0.52118254 -0.564879687
</span></span><span class=line><span class=cl>52                 Szanto Tibor  -0.315311020  0.38655053            0.84358600    0.2917947 -0.72558324 -0.89290783  0.62284484 -0.89212074 -0.928620850
</span></span><span class=line><span class=cl>53                Taste Artisan   0.713137060  0.33378332            1.22845812    0.6984160  0.25968242  0.37415785  0.77000049 -0.79938619 -0.362801263
</span></span><span class=line><span class=cl>54                      Terroir  -0.178184609  0.22824889            0.55493190    0.5822385 -1.49190097 -0.68664132  0.62284484 -0.30480193 -0.766958111
</span></span><span class=line><span class=cl>55                       Tribar  -0.006776596 -0.08835441           -0.02237629    0.2917947 -0.39716135 -0.98130776  1.21146745 -0.42844799  0.041355584
</span></span><span class=line><span class=cl>56                        Zak&#39;s  -0.829535060 -0.24665605            1.27656714    1.3373923 -1.05400512 -0.71610797  0.77000049 -0.52118254 -0.443632633
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; rownames(brand.mean) &lt;- brand.mean[, 1]
</span></span><span class=line><span class=cl>&gt; #### Use brand for the row name
</span></span><span class=line><span class=cl>&gt; brand.mean &lt;- brand.mean [, -1]
</span></span><span class=line><span class=cl>&gt; brand.mean
</span></span><span class=line><span class=cl>                             cocoa_percent      rating counts_of_ingredients cocoa_butter     vanilla     organic        salt       sugar    sweetener
</span></span><span class=line><span class=cl>A. Morin                      -0.521000636  0.63531027           -1.05328377   -0.7786981 -0.36588308  0.76143373 -1.03791178  0.84334011  0.283849693
</span></span><span class=line><span class=cl>Altus aka Cao Artisan         -1.857983139 -1.19646594           -0.81617505   -1.6251343 -0.06873946  0.69829093 -1.21660078  0.22069385  0.041355584
</span></span><span class=line><span class=cl>Ambrosia                      -0.366733424  0.06994724           -0.88833857   -1.0152024 -0.28768739  1.05189065 -1.14302296 -0.61391709 -0.686126742
</span></span><span class=line><span class=cl>Amedei                        -0.109621404 -0.59491968           -0.77287693   -0.6492432  0.34726159  0.96349072 -0.93700505  0.38761604  1.156828484
</span></span><span class=line><span class=cl>Arete                         -0.253604135  0.67149350           -1.06153103   -0.9629225  0.25968242  0.68061094 -1.08416070 -0.28007272 -0.007143237
</span></span><span class=line><span class=cl>Bonnat                         0.198913020  1.17805877           -1.03266562   -0.8409361 -0.39716135  1.05189065 -1.06944513  0.03522475  0.162602639
</span></span><span class=line><span class=cl>Brasstown aka It&#39;s Chocolate  -0.191897250  0.92477613           -1.11926184   -0.7886562  0.43484076  0.89277077 -0.99586731  0.01667784  0.574842623
</span></span><span class=line><span class=cl>Brazen                        -0.315311020 -0.56325935           -1.03266562   -0.8409361  0.04073450  0.52149106 -1.14302296 -0.15024435 -0.443632633
</span></span><span class=line><span class=cl>Bright                        -0.041058199  0.12271446           -1.08077463   -1.2766018 -1.34593569  1.31709044 -1.19207484  1.67353512  0.607175171
</span></span><span class=line><span class=cl>Burnt Fork Bend               -0.726690252 -0.51049213           -0.88833857   -0.3471816 -0.76207456  0.84562414 -0.99586731  0.18978233 -0.686126742
</span></span><span class=line><span class=cl>Cacao de Origen                0.507447444 -0.40495770           -1.06153103   -1.1023355 -0.17821343  1.06957063 -1.14302296  0.16505312  0.332348515
</span></span><span class=line><span class=cl>Castronovo                    -0.212466212  0.06994724           -1.17699266   -0.5795367 -0.17821343  1.14029058 -0.99586731  0.31342840  0.283849693
</span></span><span class=line><span class=cl>Chocolarder                   -0.109621404 -1.51306923           -1.10482914   -0.3181373  0.58810431  1.22869051 -0.84871166  0.31342840  0.283849693
</span></span><span class=line><span class=cl>Chocolate Con Amor            -0.058199000 -0.56325935           -0.96050209   -0.1438710  0.25968242  0.87509079 -0.84871166  0.68436660  0.041355584
</span></span><span class=line><span class=cl>Chocolate Makers               1.227361100  0.54485218           -1.03266562   -1.6251343  0.69757827  0.96349072 -1.29017861 -1.17032439 -0.686126742
</span></span><span class=line><span class=cl>Domori                        -0.315311020  1.17805877           -0.88833857   -1.2766018  0.47863035  0.60989099 -0.99586731  0.31342840  0.041355584
</span></span><span class=line><span class=cl>Dormouse                       0.850263471 -0.93262986           -1.08077463   -1.2766018  0.40564770  0.37415785 -1.09397107 -0.67574013 -0.201138524
</span></span><span class=line><span class=cl>Durci                         -0.315311020  0.75592104           -0.79212054   -0.9861580 -0.03224814  0.96349072 -1.14302296  1.24077389  0.930500649
</span></span><span class=line><span class=cl>East Van Roasters             -0.315311020  0.54485218           -1.08077463   -1.1604242  0.84354355  0.84562414 -1.09397107  0.06613627  0.283849693
</span></span><span class=line><span class=cl>Fossa                          0.044645808 -0.40495770           -0.74401152   -0.9280692  0.36915638  0.87509079 -0.92228948  0.59163205  0.283849693
</span></span><span class=line><span class=cl>Franceschi                    -0.109621404 -0.17881249           -1.05328377   -0.8782789 -0.05310033  1.21606195 -1.03791178  0.31342840  0.075997600
</span></span><span class=line><span class=cl>Fresco                        -0.178184609  0.22824889           -0.16670333   -0.6957142  0.18669978 -0.27410831  0.03422224  0.37525143 -0.524464002
</span></span><span class=line><span class=cl>Georgia Ramon                  0.370321033  0.12271446            0.84358600    0.6403272  0.69757827 -0.92237447  0.67189673  0.37525143 -0.039475785
</span></span><span class=line><span class=cl>Habitual                       0.164631417 -0.61602657            0.60304092    0.5241497  0.40564770 -0.33304160  0.77000049  0.18978233  0.283849693
</span></span><span class=line><span class=cl>hexx                           0.070357010 -0.87986264            0.41060485    0.2917947  0.09547148 -0.62770803  0.36532246 -0.24297890  0.405096747
</span></span><span class=line><span class=cl>Hogarth                        0.233194623 -0.29942327            0.89169501    0.5822385  0.40564770 -0.21517503  0.42663731 -0.11933283  0.203018324
</span></span><span class=line><span class=cl>Holy Cacao                    -0.315311020  0.06994724            0.41060485    0.7274604  0.47863035 -0.71610797  1.13788962 -0.33571345 -0.079891470
</span></span><span class=line><span class=cl>Johnny Iuzzini                 0.219481982  0.41821086            0.84358600    0.2569414  0.60999910 -0.73378795  0.71113823  0.46180368  0.186852050
</span></span><span class=line><span class=cl>Kto                            0.096068212 -0.72156100            0.84358600    0.8145935  0.69757827 -0.59234806  0.59341371 -0.42844799  0.089854406
</span></span><span class=line><span class=cl>Kyya                           0.198913020 -1.14369872            0.55493190    0.5822385  0.69757827 -0.45090817  1.26051933  0.93165873  0.122186954
</span></span><span class=line><span class=cl>Laia aka Chat-Noir             0.233194623 -0.93262986            0.65114993    0.3498834  0.25968242 -0.92237447  0.86810426  1.05530479  0.768837910
</span></span><span class=line><span class=cl>Letterpress                   -0.315311020  0.75592104           -0.11859432    0.4660610  0.69757827 -0.09730845  0.96620803 -0.30480193  0.283849693
</span></span><span class=line><span class=cl>Mana                           0.507447444 -1.77690531            0.26627781    0.1175284  0.11371714 -0.92237447  0.47568919  0.06613627 -0.201138524
</span></span><span class=line><span class=cl>Map Chocolate                 -0.521000636  0.33378332            0.50682289    0.2917947  0.25968242 -0.98130776  0.32853354 -0.42844799  0.122186954
</span></span><span class=line><span class=cl>Maverick                      -0.315311020  0.06994724            1.06007657    0.9888598  0.47863035 -0.98130776  0.54926702  0.22069385 -0.079891470
</span></span><span class=line><span class=cl>Mike &amp; Becky                  -0.315311020 -0.51049213            0.07384175    0.8145935  0.69757827 -0.92237447  0.08327413 -0.18115586  0.283849693
</span></span><span class=line><span class=cl>Milton                        -0.315311020  0.86145548            1.42089418    0.4660610  0.47863035  0.07949141  0.32853354  0.68436660  0.041355584
</span></span><span class=line><span class=cl>Naive                          0.198913020 -1.03816429            0.84358600    0.8145935  0.47863035 -0.62770803  1.35862310 -0.42844799 -0.443632633
</span></span><span class=line><span class=cl>Nibble                         0.096068212 -1.35476759            0.77142247    0.7274604  0.25968242 -0.89290783  0.99073397  0.03522475 -0.079891470
</span></span><span class=line><span class=cl>Nuance                        -0.315311020 -0.08835441            1.34873066    0.3789278  0.36915638 -1.06970769  0.10780007 -0.24297890  0.405096747
</span></span><span class=line><span class=cl>Pacari                        -0.315311020  0.86145548            1.42089418    0.9017266  0.58810431 -0.80450790  0.99073397  0.68436660 -0.201138524
</span></span><span class=line><span class=cl>Palette de Bine                0.541729047 -0.29942327            0.55493190    0.4079722  0.55161299 -0.39197489  1.06431180  0.49889750  0.688006541
</span></span><span class=line><span class=cl>Pangea                         0.576010649  0.12271446            1.22845812    1.0469485  0.40564770 -0.80450790  0.47568919 -0.18115586  0.122186954
</span></span><span class=line><span class=cl>Pralus                         0.713137060 -0.24665605            0.91574952    0.7274604  0.58810431 -0.36250824  0.40211137 -0.15024435  0.041355584
</span></span><span class=line><span class=cl>Pump Street Bakery             0.987389881 -0.40495770           -0.02237629    0.8145935 -0.98102248 -0.21517503  0.96620803 -0.42844799 -0.281969894
</span></span><span class=line><span class=cl>Pura Delizia                  -0.521000636  0.54485218           -0.59968447    0.4660610 -1.49190097 -0.45090817  0.47568919 -0.24297890 -0.201138524
</span></span><span class=line><span class=cl>Qantu                         -0.315311020  0.33378332           -0.11859432    0.9307710 -0.17821343 -0.45090817  1.16241556 -0.42844799 -0.039475785
</span></span><span class=line><span class=cl>Sirene                         1.712200909  0.63531027            0.80234970    0.5158513 -0.67866582 -0.34987968  0.72795602 -0.42844799 -0.478274648
</span></span><span class=line><span class=cl>Smooth Chocolator, The        -0.469578232  0.78230465            0.33844133    0.8145935 -0.94453116 -0.98130776  0.69642267 -0.70665164 -0.504256160
</span></span><span class=line><span class=cl>Soma                          -0.090922348  0.89023759            0.44996678    0.5294305 -0.41706571  0.22414584  0.26164461 -0.66449957 -0.730216579
</span></span><span class=line><span class=cl>Soul                           0.198913020  0.22824889            0.77142247    0.6403272 -1.05400512 -0.89290783  1.06431180 -0.52118254 -0.564879687
</span></span><span class=line><span class=cl>Szanto Tibor                  -0.315311020  0.38655053            0.84358600    0.2917947 -0.72558324 -0.89290783  0.62284484 -0.89212074 -0.928620850
</span></span><span class=line><span class=cl>Taste Artisan                  0.713137060  0.33378332            1.22845812    0.6984160  0.25968242  0.37415785  0.77000049 -0.79938619 -0.362801263
</span></span><span class=line><span class=cl>Terroir                       -0.178184609  0.22824889            0.55493190    0.5822385 -1.49190097 -0.68664132  0.62284484 -0.30480193 -0.766958111
</span></span><span class=line><span class=cl>Tribar                        -0.006776596 -0.08835441           -0.02237629    0.2917947 -0.39716135 -0.98130776  1.21146745 -0.42844799  0.041355584
</span></span><span class=line><span class=cl>Zak&#39;s                         -0.829535060 -0.24665605            1.27656714    1.3373923 -1.05400512 -0.71610797  0.77000049 -0.52118254 -0.443632633
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; heatmap.2(as.matrix(brand.mean),main = &#34;Brand attributes&#34;, trace = &#34;none&#34;, key = FALSE, dend = &#34;none&#34;
</span></span><span class=line><span class=cl>+           #turn off some options
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_10.png %}</p><blockquote><p>Some brands related with salt, such as Letterpress„ÄÅQantu„ÄÅPacari„ÄÅKyya„ÄÅNaive<br>Some brands related with organic, such as Amedei, Fossa, Castronovo</p></blockquote><h3 id=124-principal-component-analysis-pca-using-princomp>1.2.4 Principal component analysis (PCA) using princomp()</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; brand.pc&lt;- princomp(brand.mean, cor = TRUE)
</span></span><span class=line><span class=cl>&gt; #We added &#34;cor =TRUE&#34; to use correlation-based one. 
</span></span><span class=line><span class=cl>&gt; summary(brand.pc)
</span></span><span class=line><span class=cl>Importance of components:
</span></span><span class=line><span class=cl>                          Comp.1    Comp.2    Comp.3     Comp.4     Comp.5     Comp.6     Comp.7     Comp.8      Comp.9
</span></span><span class=line><span class=cl>Standard deviation     1.9484877 1.3240155 1.0553760 0.94838484 0.84633623 0.57860956 0.41928231 0.37770849 0.259982952
</span></span><span class=line><span class=cl>Proportion of Variance 0.4218449 0.1947797 0.1237576 0.09993709 0.07958722 0.03719878 0.01953307 0.01585152 0.007510126
</span></span><span class=line><span class=cl>Cumulative Proportion  0.4218449 0.6166246 0.7403822 0.84031927 0.91990650 0.95710528 0.97663835 0.99248987 1.000000000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; plot(brand.pc,type=&#34;l&#34;) # scree plot
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_11.png %}</p><blockquote><p>The elbow occurs at component three. This suggests that the first two components explain most of the variation in the observed brand rating.</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>loadings</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>pc</span><span class=p>)</span> <span class=c1># pc loadings</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Loadings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                      <span class=n>Comp</span><span class=o>.</span><span class=mi>1</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>2</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>3</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>4</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>5</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>6</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>7</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>8</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=n>cocoa_percent</span>          <span class=mf>0.121</span>         <span class=mf>0.765</span>  <span class=mf>0.271</span>  <span class=mf>0.553</span>                            
</span></span><span class=line><span class=cl><span class=n>rating</span>                       <span class=o>-</span><span class=mf>0.329</span> <span class=o>-</span><span class=mf>0.242</span>  <span class=mf>0.903</span>                                   
</span></span><span class=line><span class=cl><span class=n>counts_of_ingredients</span>  <span class=mf>0.466</span>  <span class=mf>0.144</span>         <span class=mf>0.133</span>         <span class=mf>0.274</span> <span class=o>-</span><span class=mf>0.149</span>  <span class=mf>0.748</span> <span class=o>-</span><span class=mf>0.283</span>
</span></span><span class=line><span class=cl><span class=n>cocoa_butter</span>           <span class=mf>0.477</span>        <span class=o>-</span><span class=mf>0.140</span>               <span class=o>-</span><span class=mf>0.122</span> <span class=o>-</span><span class=mf>0.595</span> <span class=o>-</span><span class=mf>0.185</span>  <span class=mf>0.579</span>
</span></span><span class=line><span class=cl><span class=n>vanilla</span>                       <span class=mf>0.502</span>  <span class=mf>0.376</span>  <span class=mf>0.207</span> <span class=o>-</span><span class=mf>0.686</span>  <span class=mf>0.230</span>        <span class=o>-</span><span class=mf>0.185</span>       
</span></span><span class=line><span class=cl><span class=n>organic</span>               <span class=o>-</span><span class=mf>0.471</span>         <span class=mf>0.131</span>                <span class=mf>0.102</span> <span class=o>-</span><span class=mf>0.778</span>        <span class=o>-</span><span class=mf>0.359</span>
</span></span><span class=line><span class=cl><span class=n>salt</span>                   <span class=mf>0.484</span>  <span class=mf>0.106</span>                <span class=mf>0.107</span>               <span class=o>-</span><span class=mf>0.557</span> <span class=o>-</span><span class=mf>0.649</span>
</span></span><span class=line><span class=cl><span class=n>sugar</span>                 <span class=o>-</span><span class=mf>0.215</span>  <span class=mf>0.482</span> <span class=o>-</span><span class=mf>0.384</span>         <span class=mf>0.416</span>  <span class=mf>0.593</span>        <span class=o>-</span><span class=mf>0.151</span>  <span class=mf>0.113</span>
</span></span><span class=line><span class=cl><span class=n>sweetener</span>             <span class=o>-</span><span class=mf>0.190</span>  <span class=mf>0.596</span> <span class=o>-</span><span class=mf>0.134</span>  <span class=mf>0.202</span>  <span class=mf>0.137</span> <span class=o>-</span><span class=mf>0.700</span>         <span class=mf>0.183</span>       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>               <span class=n>Comp</span><span class=o>.</span><span class=mi>1</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>2</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>3</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>4</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>5</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>6</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>7</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>8</span> <span class=n>Comp</span><span class=o>.</span><span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=n>SS</span> <span class=n>loadings</span>     <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>  <span class=mf>1.000</span>
</span></span><span class=line><span class=cl><span class=n>Proportion</span> <span class=n>Var</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>  <span class=mf>0.111</span>
</span></span><span class=line><span class=cl><span class=n>Cumulative</span> <span class=n>Var</span>  <span class=mf>0.111</span>  <span class=mf>0.222</span>  <span class=mf>0.333</span>  <span class=mf>0.444</span>  <span class=mf>0.556</span>  <span class=mf>0.667</span>  <span class=mf>0.778</span>  <span class=mf>0.889</span>  <span class=mf>1.000</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>pc</span><span class=o>$</span><span class=n>scores</span> <span class=c1># the principal components</span>
</span></span><span class=line><span class=cl>                                 <span class=n>Comp</span><span class=o>.</span><span class=mi>1</span>       <span class=n>Comp</span><span class=o>.</span><span class=mi>2</span>      <span class=n>Comp</span><span class=o>.</span><span class=mi>3</span>       <span class=n>Comp</span><span class=o>.</span><span class=mi>4</span>      <span class=n>Comp</span><span class=o>.</span><span class=mi>5</span>      <span class=n>Comp</span><span class=o>.</span><span class=mi>6</span>       <span class=n>Comp</span><span class=o>.</span><span class=mi>7</span>       <span class=n>Comp</span><span class=o>.</span><span class=mi>8</span>       <span class=n>Comp</span><span class=o>.</span><span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=n>A</span><span class=o>.</span> <span class=n>Morin</span>                     <span class=o>-</span><span class=mf>2.6821054</span> <span class=o>-</span><span class=mf>0.082708580</span> <span class=o>-</span><span class=mf>1.40994821</span>  <span class=mf>0.570725489</span>  <span class=mf>0.49085251</span>  <span class=mf>0.18338461</span>  <span class=mf>0.117281714</span> <span class=o>-</span><span class=mf>0.138449624</span>  <span class=mf>0.222125496</span>
</span></span><span class=line><span class=cl><span class=n>Altus</span> <span class=n>aka</span> <span class=n>Cao</span> <span class=n>Artisan</span>        <span class=o>-</span><span class=mf>2.9741352</span> <span class=o>-</span><span class=mf>0.051591141</span> <span class=o>-</span><span class=mf>1.85995919</span> <span class=o>-</span><span class=mf>2.563339244</span> <span class=o>-</span><span class=mf>1.66300987</span>  <span class=mf>0.13097903</span>  <span class=mf>0.303201868</span>  <span class=mf>0.526449188</span> <span class=o>-</span><span class=mf>0.685437305</span>
</span></span><span class=line><span class=cl><span class=n>Ambrosia</span>                     <span class=o>-</span><span class=mf>1.9137525</span> <span class=o>-</span><span class=mf>2.368899919</span>  <span class=mf>0.43991523</span> <span class=o>-</span><span class=mf>0.678527355</span> <span class=o>-</span><span class=mf>0.77889642</span>  <span class=mf>0.36199971</span> <span class=o>-</span><span class=mf>0.253511595</span>  <span class=mf>0.148898733</span> <span class=o>-</span><span class=mf>0.152691868</span>
</span></span><span class=line><span class=cl><span class=n>Amedei</span>                       <span class=o>-</span><span class=mf>2.5823723</span>  <span class=mf>1.971553363</span>  <span class=mf>0.06548182</span> <span class=o>-</span><span class=mf>0.167118353</span>  <span class=mf>0.21991151</span> <span class=o>-</span><span class=mf>1.30388873</span> <span class=o>-</span><span class=mf>0.375674781</span>  <span class=mf>0.417123292</span> <span class=o>-</span><span class=mf>0.136679953</span>
</span></span><span class=line><span class=cl><span class=n>Arete</span>                        <span class=o>-</span><span class=mf>2.1702056</span> <span class=o>-</span><span class=mf>0.945790574</span>  <span class=mf>0.23190842</span>  <span class=mf>0.654926657</span> <span class=o>-</span><span class=mf>0.90339862</span> <span class=o>-</span><span class=mf>0.27205032</span>  <span class=mf>0.180399208</span> <span class=o>-</span><span class=mf>0.080326426</span>  <span class=mf>0.100535236</span>
</span></span><span class=line><span class=cl><span class=n>Bonnat</span>                       <span class=o>-</span><span class=mf>2.4005578</span> <span class=o>-</span><span class=mf>1.197899532</span>  <span class=mf>0.06190293</span>  <span class=mf>1.469628715</span>  <span class=mf>0.58042613</span> <span class=o>-</span><span class=mf>0.38552569</span> <span class=o>-</span><span class=mf>0.087080145</span>  <span class=mf>0.039968656</span>  <span class=mf>0.074068756</span>
</span></span><span class=line><span class=cl><span class=n>Brasstown</span> <span class=n>aka</span> <span class=n>It</span><span class=s1>&#39;s Chocolate -2.5497691  0.133527483 -0.04061230  1.395805810 -0.61251377 -0.84180356 -0.089560874 -0.144162160  0.067272450</span>
</span></span><span class=line><span class=cl><span class=n>Brazen</span>                       <span class=o>-</span><span class=mf>1.8184009</span> <span class=o>-</span><span class=mf>1.005611722</span>  <span class=mf>0.43555261</span> <span class=o>-</span><span class=mf>1.230147922</span> <span class=o>-</span><span class=mf>0.63002787</span>  <span class=mf>0.45912632</span>  <span class=mf>0.170468440</span> <span class=o>-</span><span class=mf>0.064477406</span>  <span class=mf>0.311590190</span>
</span></span><span class=line><span class=cl><span class=n>Bright</span>                       <span class=o>-</span><span class=mf>3.7037423</span>  <span class=mf>0.414163869</span> <span class=o>-</span><span class=mf>1.63190725</span>  <span class=mf>0.102700490</span>  <span class=mf>2.86213684</span>  <span class=mf>0.36906420</span>  <span class=mf>0.152388138</span>  <span class=mf>0.310865000</span> <span class=o>-</span><span class=mf>0.197363762</span>
</span></span><span class=line><span class=cl><span class=n>Burnt</span> <span class=n>Fork</span> <span class=n>Bend</span>              <span class=o>-</span><span class=mf>1.6625728</span> <span class=o>-</span><span class=mf>1.709402032</span> <span class=o>-</span><span class=mf>0.88207876</span> <span class=o>-</span><span class=mf>1.644843428</span>  <span class=mf>0.11059053</span>  <span class=mf>0.87662539</span> <span class=o>-</span><span class=mf>0.500865703</span> <span class=o>-</span><span class=mf>0.110214495</span>  <span class=mf>0.338455701</span>
</span></span><span class=line><span class=cl><span class=n>Cacao</span> <span class=n>de</span> <span class=n>Origen</span>              <span class=o>-</span><span class=mf>2.5921821</span>  <span class=mf>0.055824774</span>  <span class=mf>1.09974476</span> <span class=o>-</span><span class=mf>0.257029615</span>  <span class=mf>0.95579544</span> <span class=o>-</span><span class=mf>0.36550650</span>  <span class=mf>0.021096186</span>  <span class=mf>0.264035914</span> <span class=o>-</span><span class=mf>0.075674123</span>
</span></span><span class=line><span class=cl><span class=n>Castronovo</span>                   <span class=o>-</span><span class=mf>2.5325352</span> <span class=o>-</span><span class=mf>0.126752242</span> <span class=o>-</span><span class=mf>0.25831283</span> <span class=o>-</span><span class=mf>0.004046483</span>  <span class=mf>0.33156085</span> <span class=o>-</span><span class=mf>0.30554860</span> <span class=o>-</span><span class=mf>0.467607448</span> <span class=o>-</span><span class=mf>0.168878318</span>  <span class=mf>0.136666647</span>
</span></span><span class=line><span class=cl><span class=n>Chocolarder</span>                  <span class=o>-</span><span class=mf>2.2207668</span>  <span class=mf>1.307802587</span>  <span class=mf>0.85864663</span> <span class=o>-</span><span class=mf>1.705624676</span> <span class=o>-</span><span class=mf>0.19506501</span> <span class=o>-</span><span class=mf>0.01428509</span> <span class=o>-</span><span class=mf>0.914520915</span> <span class=o>-</span><span class=mf>0.321239544</span>  <span class=mf>0.159779149</span>
</span></span><span class=line><span class=cl><span class=n>Chocolate</span> <span class=n>Con</span> <span class=n>Amor</span>           <span class=o>-</span><span class=mf>1.9007761</span>  <span class=mf>0.670491949</span>  <span class=mf>0.11709196</span> <span class=o>-</span><span class=mf>0.620348573</span>  <span class=mf>0.29421634</span>  <span class=mf>0.61769812</span> <span class=o>-</span><span class=mf>0.560130738</span> <span class=o>-</span><span class=mf>0.436771908</span>  <span class=mf>0.551468923</span>
</span></span><span class=line><span class=cl><span class=n>Chocolate</span> <span class=n>Makers</span>             <span class=o>-</span><span class=mf>1.8579245</span> <span class=o>-</span><span class=mf>2.204259441</span>  <span class=mf>3.65327660</span>  <span class=mf>0.944749264</span> <span class=o>-</span><span class=mf>0.79385429</span>  <span class=mf>0.31025351</span>  <span class=mf>0.457780690</span>  <span class=mf>0.080184237</span> <span class=o>-</span><span class=mf>0.112091537</span>
</span></span><span class=line><span class=cl><span class=n>Domori</span>                       <span class=o>-</span><span class=mf>2.4717189</span> <span class=o>-</span><span class=mf>0.418555050</span> <span class=o>-</span><span class=mf>0.30112024</span>  <span class=mf>1.476626951</span> <span class=o>-</span><span class=mf>0.84493987</span>  <span class=mf>0.44418967</span>  <span class=mf>0.556201865</span> <span class=o>-</span><span class=mf>0.176971531</span> <span class=o>-</span><span class=mf>0.065225214</span>
</span></span><span class=line><span class=cl><span class=n>Dormouse</span>                     <span class=o>-</span><span class=mf>1.6163747</span> <span class=o>-</span><span class=mf>0.573790680</span>  <span class=mf>2.78616294</span> <span class=o>-</span><span class=mf>0.984778126</span> <span class=o>-</span><span class=mf>0.16073317</span> <span class=o>-</span><span class=mf>0.22828856</span>  <span class=mf>0.696346544</span>  <span class=mf>0.154284014</span>  <span class=mf>0.109237073</span>
</span></span><span class=line><span class=cl><span class=n>Durci</span>                        <span class=o>-</span><span class=mf>3.2467009</span>  <span class=mf>1.366316064</span> <span class=o>-</span><span class=mf>1.36938755</span>  <span class=mf>1.343686021</span>  <span class=mf>0.79119360</span> <span class=o>-</span><span class=mf>0.14124389</span>  <span class=mf>0.102989715</span>  <span class=mf>0.247099878</span> <span class=o>-</span><span class=mf>0.003073146</span>
</span></span><span class=line><span class=cl><span class=n>East</span> <span class=n>Van</span> <span class=n>Roasters</span>            <span class=o>-</span><span class=mf>2.6837728</span>  <span class=mf>0.239396951</span>  <span class=mf>0.28472215</span>  <span class=mf>0.845396828</span> <span class=o>-</span><span class=mf>1.26174552</span> <span class=o>-</span><span class=mf>0.10762521</span>  <span class=mf>0.162505518</span> <span class=o>-</span><span class=mf>0.184706997</span> <span class=o>-</span><span class=mf>0.053798374</span>
</span></span><span class=line><span class=cl><span class=n>Fossa</span>                        <span class=o>-</span><span class=mf>2.3465473</span>  <span class=mf>0.884673550</span>  <span class=mf>0.38912206</span> <span class=o>-</span><span class=mf>0.217906869</span>  <span class=mf>0.17706864</span>  <span class=mf>0.37032870</span> <span class=o>-</span><span class=mf>0.012113749</span>  <span class=mf>0.052158396</span> <span class=o>-</span><span class=mf>0.059241914</span>
</span></span><span class=line><span class=cl><span class=n>Franceschi</span>                   <span class=o>-</span><span class=mf>2.5865116</span> <span class=o>-</span><span class=mf>0.208023319</span>  <span class=mf>0.17214188</span> <span class=o>-</span><span class=mf>0.311579190</span>  <span class=mf>0.23054852</span>  <span class=mf>0.18080777</span> <span class=o>-</span><span class=mf>0.351825508</span> <span class=o>-</span><span class=mf>0.065850200</span> <span class=o>-</span><span class=mf>0.063028223</span>
</span></span><span class=line><span class=cl><span class=n>Fresco</span>                       <span class=o>-</span><span class=mf>0.3431384</span> <span class=o>-</span><span class=mf>0.507481093</span> <span class=o>-</span><span class=mf>0.23229647</span>  <span class=mf>0.070751997</span> <span class=o>-</span><span class=mf>0.33561536</span>  <span class=mf>1.27981256</span>  <span class=mf>0.841690012</span> <span class=o>-</span><span class=mf>0.383017742</span> <span class=o>-</span><span class=mf>0.156670600</span>
</span></span><span class=line><span class=cl><span class=n>Georgia</span> <span class=n>Ramon</span>                 <span class=mf>1.6232155</span>  <span class=mf>1.150676748</span>  <span class=mf>0.26498134</span>  <span class=mf>0.776042896</span> <span class=o>-</span><span class=mf>0.08787525</span>  <span class=mf>0.73021028</span>  <span class=mf>0.360040767</span> <span class=o>-</span><span class=mf>0.145401030</span>  <span class=mf>0.344721165</span>
</span></span><span class=line><span class=cl><span class=n>Habitual</span>                      <span class=mf>1.0620088</span>  <span class=mf>1.408417040</span>  <span class=mf>0.20679968</span> <span class=o>-</span><span class=mf>0.256329143</span>  <span class=mf>0.14603119</span> <span class=o>-</span><span class=mf>0.09654839</span> <span class=o>-</span><span class=mf>0.199263082</span> <span class=o>-</span><span class=mf>0.042347238</span> <span class=o>-</span><span class=mf>0.204890356</span>
</span></span><span class=line><span class=cl><span class=n>hexx</span>                          <span class=mf>0.8945803</span>  <span class=mf>0.986405829</span>  <span class=mf>0.27911766</span> <span class=o>-</span><span class=mf>0.823341471</span>  <span class=mf>0.05290067</span> <span class=o>-</span><span class=mf>0.91137130</span>  <span class=mf>0.215896857</span>  <span class=mf>0.391037893</span> <span class=o>-</span><span class=mf>0.053665334</span>
</span></span><span class=line><span class=cl><span class=n>Hogarth</span>                       <span class=mf>1.1469231</span>  <span class=mf>0.888298143</span>  <span class=mf>0.44801300</span>  <span class=mf>0.146795869</span> <span class=o>-</span><span class=mf>0.11225173</span> <span class=o>-</span><span class=mf>0.17267348</span> <span class=o>-</span><span class=mf>0.413312452</span>  <span class=mf>0.421796760</span> <span class=o>-</span><span class=mf>0.079016305</span>
</span></span><span class=line><span class=cl><span class=n>Holy</span> <span class=n>Cacao</span>                    <span class=mf>1.7193074</span>  <span class=mf>0.226734338</span> <span class=o>-</span><span class=mf>0.30964828</span>  <span class=mf>0.129600701</span> <span class=o>-</span><span class=mf>0.98426850</span> <span class=o>-</span><span class=mf>0.25298514</span> <span class=o>-</span><span class=mf>0.041078309</span> <span class=o>-</span><span class=mf>0.590556142</span> <span class=o>-</span><span class=mf>0.164351653</span>
</span></span><span class=line><span class=cl><span class=n>Johnny</span> <span class=n>Iuzzini</span>                <span class=mf>1.1253895</span>  <span class=mf>1.247567957</span> <span class=o>-</span><span class=mf>0.14097718</span>  <span class=mf>1.171762685</span> <span class=o>-</span><span class=mf>0.05453896</span>  <span class=mf>0.49259097</span>  <span class=mf>0.472104322</span> <span class=o>-</span><span class=mf>0.020333808</span> <span class=o>-</span><span class=mf>0.091573476</span>
</span></span><span class=line><span class=cl><span class=n>Kto</span>                           <span class=mf>1.7272265</span>  <span class=mf>0.973823067</span>  <span class=mf>0.71344746</span> <span class=o>-</span><span class=mf>0.485155153</span> <span class=o>-</span><span class=mf>0.79385313</span> <span class=o>-</span><span class=mf>0.32876367</span> <span class=o>-</span><span class=mf>0.322610016</span>  <span class=mf>0.219131057</span>  <span class=mf>0.094206766</span>
</span></span><span class=line><span class=cl><span class=n>Kyya</span>                          <span class=mf>1.2196443</span>  <span class=mf>2.392140992</span>  <span class=mf>0.08609881</span> <span class=o>-</span><span class=mf>0.785365838</span>  <span class=mf>0.47176421</span>  <span class=mf>0.99700206</span> <span class=o>-</span><span class=mf>0.064627360</span> <span class=o>-</span><span class=mf>0.702134952</span> <span class=o>-</span><span class=mf>0.261062705</span>
</span></span><span class=line><span class=cl><span class=n>Laia</span> <span class=n>aka</span> <span class=n>Chat</span><span class=o>-</span><span class=n>Noir</span>            <span class=mf>0.8806390</span>  <span class=mf>2.923105952</span> <span class=o>-</span><span class=mf>0.50273622</span> <span class=o>-</span><span class=mf>0.361966792</span>  <span class=mf>1.15349356</span> <span class=o>-</span><span class=mf>0.04033924</span>  <span class=mf>0.617548018</span>  <span class=mf>0.031480014</span> <span class=o>-</span><span class=mf>0.089609639</span>
</span></span><span class=line><span class=cl><span class=n>Letterpress</span>                   <span class=mf>0.6051745</span>  <span class=mf>0.398736717</span> <span class=o>-</span><span class=mf>0.33394102</span>  <span class=mf>1.207590405</span> <span class=o>-</span><span class=mf>1.13574976</span> <span class=o>-</span><span class=mf>0.76005043</span> <span class=o>-</span><span class=mf>0.322059257</span> <span class=o>-</span><span class=mf>0.881592716</span> <span class=o>-</span><span class=mf>0.346321885</span>
</span></span><span class=line><span class=cl><span class=n>Mana</span>                          <span class=mf>1.2424524</span>  <span class=mf>0.909518098</span>  <span class=mf>1.17916492</span> <span class=o>-</span><span class=mf>2.030151126</span>  <span class=mf>0.60130333</span>  <span class=mf>0.37155938</span>  <span class=mf>0.705169097</span>  <span class=mf>0.001056193</span>  <span class=mf>0.138418715</span>
</span></span><span class=line><span class=cl><span class=n>Map</span> <span class=n>Chocolate</span>                 <span class=mf>1.1256970</span> <span class=o>-</span><span class=mf>0.001899391</span> <span class=o>-</span><span class=mf>0.73005688</span>  <span class=mf>0.332513635</span> <span class=o>-</span><span class=mf>1.15181151</span> <span class=o>-</span><span class=mf>0.66036279</span>  <span class=mf>0.518289540</span>  <span class=mf>0.244298956</span>  <span class=mf>0.097515381</span>
</span></span><span class=line><span class=cl><span class=n>Maverick</span>                      <span class=mf>1.8456138</span>  <span class=mf>0.805863125</span> <span class=o>-</span><span class=mf>0.78667732</span>  <span class=mf>0.280711960</span> <span class=o>-</span><span class=mf>0.66679650</span>  <span class=mf>0.50954160</span>  <span class=mf>0.004065933</span>  <span class=mf>0.125501441</span>  <span class=mf>0.473074791</span>
</span></span><span class=line><span class=cl><span class=n>Mike</span> <span class=o>&amp;</span> <span class=n>Becky</span>                  <span class=mf>0.9510565</span>  <span class=mf>1.163163024</span> <span class=o>-</span><span class=mf>0.11474326</span> <span class=o>-</span><span class=mf>0.450192192</span> <span class=o>-</span><span class=mf>1.05889582</span> <span class=o>-</span><span class=mf>0.66072297</span>  <span class=mf>0.126707167</span> <span class=o>-</span><span class=mf>0.134120447</span>  <span class=mf>0.814806996</span>
</span></span><span class=line><span class=cl><span class=n>Milton</span>                        <span class=mf>0.7017978</span>  <span class=mf>0.850904718</span> <span class=o>-</span><span class=mf>1.16300943</span>  <span class=mf>1.527503410</span> <span class=o>-</span><span class=mf>0.35819662</span>  <span class=mf>1.14825504</span> <span class=o>-</span><span class=mf>0.584746995</span>  <span class=mf>0.519632202</span> <span class=o>-</span><span class=mf>0.228518041</span>
</span></span><span class=line><span class=cl><span class=n>Naive</span>                         <span class=mf>2.4417443</span>  <span class=mf>0.319089869</span>  <span class=mf>0.92180468</span> <span class=o>-</span><span class=mf>1.140138484</span> <span class=o>-</span><span class=mf>0.48419779</span>  <span class=mf>0.39789802</span> <span class=o>-</span><span class=mf>0.287084848</span> <span class=o>-</span><span class=mf>0.378335636</span> <span class=o>-</span><span class=mf>0.356746232</span>
</span></span><span class=line><span class=cl><span class=n>Nibble</span>                        <span class=mf>1.9734880</span>  <span class=mf>1.140361527</span>  <span class=mf>0.32957158</span> <span class=o>-</span><span class=mf>1.481479461</span>  <span class=mf>0.07908308</span>  <span class=mf>0.20080213</span>  <span class=mf>0.090557597</span> <span class=o>-</span><span class=mf>0.062747307</span> <span class=o>-</span><span class=mf>0.042790815</span>
</span></span><span class=line><span class=cl><span class=n>Nuance</span>                        <span class=mf>1.4332957</span>  <span class=mf>0.986854337</span> <span class=o>-</span><span class=mf>0.52270722</span>  <span class=mf>0.204845388</span> <span class=o>-</span><span class=mf>0.84737962</span> <span class=o>-</span><span class=mf>0.60103767</span>  <span class=mf>0.416043810</span>  <span class=mf>1.168117101</span>  <span class=mf>0.091201132</span>
</span></span><span class=line><span class=cl><span class=n>Pacari</span>                        <span class=mf>1.9470450</span>  <span class=mf>0.841192378</span> <span class=o>-</span><span class=mf>1.30359005</span>  <span class=mf>1.428220851</span> <span class=o>-</span><span class=mf>0.52541881</span>  <span class=mf>1.35461573</span> <span class=o>-</span><span class=mf>0.045551375</span> <span class=o>-</span><span class=mf>0.117106120</span>  <span class=mf>0.063566252</span>
</span></span><span class=line><span class=cl><span class=n>Palette</span> <span class=n>de</span> <span class=n>Bine</span>               <span class=mf>0.9298584</span>  <span class=mf>2.257452252</span>  <span class=mf>0.37466152</span>  <span class=mf>0.618514285</span>  <span class=mf>0.71206947</span> <span class=o>-</span><span class=mf>0.35624249</span>  <span class=mf>0.067529550</span> <span class=o>-</span><span class=mf>0.227881300</span> <span class=o>-</span><span class=mf>0.381700241</span>
</span></span><span class=line><span class=cl><span class=n>Pangea</span>                        <span class=mf>2.0918919</span>  <span class=mf>0.743086202</span>  <span class=mf>0.64457687</span>  <span class=mf>0.845258973</span>  <span class=mf>0.09714474</span> <span class=o>-</span><span class=mf>0.12746214</span> <span class=o>-</span><span class=mf>0.154811282</span>  <span class=mf>0.523133595</span>  <span class=mf>0.462947830</span>
</span></span><span class=line><span class=cl><span class=n>Pralus</span>                        <span class=mf>1.5025425</span>  <span class=mf>0.848741299</span>  <span class=mf>1.24672256</span>  <span class=mf>0.437250083</span>  <span class=mf>0.09124140</span>  <span class=mf>0.12844654</span> <span class=o>-</span><span class=mf>0.313421202</span>  <span class=mf>0.312496177</span>  <span class=mf>0.232607192</span>
</span></span><span class=line><span class=cl><span class=n>Pump</span> <span class=n>Street</span> <span class=n>Bakery</span>            <span class=mf>1.6307924</span> <span class=o>-</span><span class=mf>1.119099536</span>  <span class=mf>1.05475875</span> <span class=o>-</span><span class=mf>0.464568575</span>  <span class=mf>1.97645672</span> <span class=o>-</span><span class=mf>0.54624494</span> <span class=o>-</span><span class=mf>0.286472980</span> <span class=o>-</span><span class=mf>0.427151024</span>  <span class=mf>0.025087747</span>
</span></span><span class=line><span class=cl><span class=n>Pura</span> <span class=n>Delizia</span>                  <span class=mf>0.5045011</span> <span class=o>-</span><span class=mf>2.031682772</span> <span class=o>-</span><span class=mf>1.77111102</span> <span class=o>-</span><span class=mf>0.238237657</span>  <span class=mf>0.96235532</span> <span class=o>-</span><span class=mf>0.92302206</span>  <span class=mf>0.202111967</span> <span class=o>-</span><span class=mf>0.518488381</span>  <span class=mf>0.184936862</span>
</span></span><span class=line><span class=cl><span class=n>Qantu</span>                         <span class=mf>1.4325823</span> <span class=o>-</span><span class=mf>0.555242055</span> <span class=o>-</span><span class=mf>0.70143518</span>  <span class=mf>0.194149325</span> <span class=o>-</span><span class=mf>0.26356820</span> <span class=o>-</span><span class=mf>0.83060181</span> <span class=o>-</span><span class=mf>0.317473645</span> <span class=o>-</span><span class=mf>0.896013710</span> <span class=o>-</span><span class=mf>0.059255689</span>
</span></span><span class=line><span class=cl><span class=n>Sirene</span>                        <span class=mf>2.0287743</span> <span class=o>-</span><span class=mf>1.465866212</span>  <span class=mf>1.95083466</span>  <span class=mf>1.357465166</span>  <span class=mf>2.09862837</span>  <span class=mf>0.23708772</span>  <span class=mf>0.107912320</span>  <span class=mf>0.223293081</span>  <span class=mf>0.027220665</span>
</span></span><span class=line><span class=cl><span class=n>Smooth</span> <span class=n>Chocolator</span><span class=p>,</span> <span class=n>The</span>        <span class=mf>1.9426612</span> <span class=o>-</span><span class=mf>2.219944073</span> <span class=o>-</span><span class=mf>1.28110363</span>  <span class=mf>0.197984376</span> <span class=o>-</span><span class=mf>0.10148814</span> <span class=o>-</span><span class=mf>0.56237841</span>  <span class=mf>0.234920584</span> <span class=o>-</span><span class=mf>0.116630110</span>  <span class=mf>0.250077177</span>
</span></span><span class=line><span class=cl><span class=n>Soma</span>                          <span class=mf>1.0272560</span> <span class=o>-</span><span class=mf>2.276609319</span> <span class=o>-</span><span class=mf>0.13465029</span>  <span class=mf>0.682516433</span> <span class=o>-</span><span class=mf>0.32209432</span>  <span class=mf>0.33522067</span> <span class=o>-</span><span class=mf>0.710966281</span>  <span class=mf>0.028455663</span> <span class=o>-</span><span class=mf>0.046039440</span>
</span></span><span class=line><span class=cl><span class=n>Soul</span>                          <span class=mf>2.3573617</span> <span class=o>-</span><span class=mf>1.820518931</span> <span class=o>-</span><span class=mf>0.34243984</span> <span class=o>-</span><span class=mf>0.138235420</span>  <span class=mf>0.91362197</span> <span class=o>-</span><span class=mf>0.10331072</span>  <span class=mf>0.292826044</span>  <span class=mf>0.090846725</span> <span class=o>-</span><span class=mf>0.195176426</span>
</span></span><span class=line><span class=cl><span class=n>Szanto</span> <span class=n>Tibor</span>                  <span class=mf>2.1190874</span> <span class=o>-</span><span class=mf>2.573833100</span> <span class=o>-</span><span class=mf>0.46454741</span> <span class=o>-</span><span class=mf>0.315723730</span> <span class=o>-</span><span class=mf>0.48273243</span>  <span class=mf>0.27114066</span>  <span class=mf>0.403885143</span>  <span class=mf>0.332333083</span> <span class=o>-</span><span class=mf>0.201129415</span>
</span></span><span class=line><span class=cl><span class=n>Taste</span> <span class=n>Artisan</span>                 <span class=mf>1.8160636</span> <span class=o>-</span><span class=mf>0.801618403</span>  <span class=mf>1.48053048</span>  <span class=mf>0.899555134</span> <span class=o>-</span><span class=mf>0.11734995</span>  <span class=mf>0.13028873</span> <span class=o>-</span><span class=mf>1.102099959</span>  <span class=mf>0.394653864</span> <span class=o>-</span><span class=mf>0.541862665</span>
</span></span><span class=line><span class=cl><span class=n>Terroir</span>                       <span class=mf>1.7764533</span> <span class=o>-</span><span class=mf>2.426405123</span> <span class=o>-</span><span class=mf>1.13302992</span> <span class=o>-</span><span class=mf>0.574480808</span>  <span class=mf>1.08742023</span>  <span class=mf>0.25221874</span>  <span class=mf>0.173655136</span>  <span class=mf>0.175666615</span>  <span class=mf>0.038227332</span>
</span></span><span class=line><span class=cl><span class=n>Tribar</span>                        <span class=mf>1.5130001</span> <span class=o>-</span><span class=mf>0.385955737</span> <span class=o>-</span><span class=mf>0.26682521</span> <span class=o>-</span><span class=mf>0.265539271</span>  <span class=mf>0.26746465</span> <span class=o>-</span><span class=mf>0.96064380</span>  <span class=mf>0.684999665</span> <span class=o>-</span><span class=mf>0.541489005</span> <span class=o>-</span><span class=mf>0.348867793</span>
</span></span><span class=line><span class=cl><span class=n>Zak</span><span class=s1>&#39;s                         2.5174379 -1.426444229 -1.78790183 -1.117084841 -0.02701300 -0.28062025 -0.678142919  0.633397547  0.043738507</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>biplot</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>pc</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s2>&#34;Brand positioning&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_12.png %}</p><blockquote><p>If the brand wants to enhance its differentiation from other brands, brand can focus on balancing the organic and rating aspects. This is more in line with the sustainable development mentioned earlier, and there are fewer brands in this position.</p></blockquote><p>And then, we can use brand.mean or colMeans to calculate the difference distance to target brand.</p><h3 id=125-move-forward>1.2.5 move forward</h3><p>Suppose we already have the basis for organic, such as brand Casttronovo. If we want to move forward rating, such as brand Fresco, we should increasing its emphasis on salt, counts_of_ingredients and cocoa_butter. And decrease organic and sweetener.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; colMeans(brand.mean[c(&#34;Fresco&#34;, &#34;Burnt Fork Bend&#34;, &#34;Pura Delizia&#34;), ]) - brand.mean[&#34;Castronovo&#34;,]
</span></span><span class=line><span class=cl>           cocoa_percent     rating counts_of_ingredients cocoa_butter    vanilla   organic     salt      sugar  sweetener
</span></span><span class=line><span class=cl>Castronovo    -0.2628256 0.01758907             0.6254172    0.3872584 -0.5108785 -1.100088 0.833882 -0.2060768 -0.7544261
</span></span></code></pre></td></tr></table></div></div><h3 id=126-factor-analysis-using-factanal->1.2.6 Factor analysis using factanal() *</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>nScree</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>noc</span> <span class=n>naf</span> <span class=n>nparallel</span> <span class=n>nkaiser</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=mi>3</span>   <span class=mi>1</span>         <span class=mi>3</span>       <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>eigen</span><span class=p>(</span><span class=n>cor</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>eigen</span><span class=p>()</span> <span class=n>decomposition</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>values</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=mf>3.79660426</span> <span class=mf>1.75301693</span> <span class=mf>1.11381847</span> <span class=mf>0.89943381</span> <span class=mf>0.71628501</span> <span class=mf>0.33478902</span> <span class=mf>0.17579766</span> <span class=mf>0.14266370</span> <span class=mf>0.06759114</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>vectors</span>
</span></span><span class=line><span class=cl>             <span class=p>[,</span><span class=mi>1</span><span class=p>]</span>        <span class=p>[,</span><span class=mi>2</span><span class=p>]</span>        <span class=p>[,</span><span class=mi>3</span><span class=p>]</span>        <span class=p>[,</span><span class=mi>4</span><span class=p>]</span>        <span class=p>[,</span><span class=mi>5</span><span class=p>]</span>         <span class=p>[,</span><span class=mi>6</span><span class=p>]</span>         <span class=p>[,</span><span class=mi>7</span><span class=p>]</span>         <span class=p>[,</span><span class=mi>8</span><span class=p>]</span>        <span class=p>[,</span><span class=mi>9</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=p>[</span><span class=mi>1</span><span class=p>,]</span>  <span class=mf>0.12098228</span> <span class=o>-</span><span class=mf>0.05345466</span>  <span class=mf>0.76473607</span> <span class=o>-</span><span class=mf>0.27140650</span> <span class=o>-</span><span class=mf>0.55335160</span> <span class=o>-</span><span class=mf>0.042715830</span> <span class=o>-</span><span class=mf>0.083872256</span> <span class=o>-</span><span class=mf>0.007471336</span> <span class=o>-</span><span class=mf>0.09439350</span>
</span></span><span class=line><span class=cl> <span class=p>[</span><span class=mi>2</span><span class=p>,]</span> <span class=o>-</span><span class=mf>0.03942608</span>  <span class=mf>0.32895808</span> <span class=o>-</span><span class=mf>0.24216956</span> <span class=o>-</span><span class=mf>0.90269635</span>  <span class=mf>0.08112631</span>  <span class=mf>0.003969369</span> <span class=o>-</span><span class=mf>0.055740640</span>  <span class=mf>0.075143751</span> <span class=o>-</span><span class=mf>0.03707461</span>
</span></span><span class=line><span class=cl> <span class=p>[</span><span class=mi>3</span><span class=p>,]</span>  <span class=mf>0.46644017</span> <span class=o>-</span><span class=mf>0.14377172</span> <span class=o>-</span><span class=mf>0.07741629</span> <span class=o>-</span><span class=mf>0.13320854</span>  <span class=mf>0.03448633</span> <span class=o>-</span><span class=mf>0.274086437</span>  <span class=mf>0.149381901</span> <span class=o>-</span><span class=mf>0.747725837</span>  <span class=mf>0.28337944</span>
</span></span><span class=line><span class=cl> <span class=p>[</span><span class=mi>4</span><span class=p>,]</span>  <span class=mf>0.47713568</span> <span class=o>-</span><span class=mf>0.09241339</span> <span class=o>-</span><span class=mf>0.13970215</span> <span class=o>-</span><span class=mf>0.02062616</span> <span class=o>-</span><span class=mf>0.07299798</span>  <span class=mf>0.121853132</span>  <span class=mf>0.595019898</span>  <span class=mf>0.184888897</span> <span class=o>-</span><span class=mf>0.57918020</span>
</span></span><span class=line><span class=cl> <span class=p>[</span><span class=mi>5</span><span class=p>,]</span> <span class=o>-</span><span class=mf>0.01644575</span> <span class=o>-</span><span class=mf>0.50210677</span>  <span class=mf>0.37649227</span> <span class=o>-</span><span class=mf>0.20692681</span>  <span class=mf>0.68649303</span> <span class=o>-</span><span class=mf>0.230097021</span>  <span class=mf>0.034521520</span>  <span class=mf>0.185411405</span> <span class=o>-</span><span class=mf>0.05715541</span>
</span></span><span class=line><span class=cl> <span class=p>[</span><span class=mi>6</span><span class=p>,]</span> <span class=o>-</span><span class=mf>0.47064300</span>  <span class=mf>0.09168746</span>  <span class=mf>0.13106717</span> <span class=o>-</span><span class=mf>0.05057970</span> <span class=o>-</span><span class=mf>0.07718575</span> <span class=o>-</span><span class=mf>0.101646053</span>  <span class=mf>0.778103705</span>  <span class=mf>0.009240990</span>  <span class=mf>0.35851266</span>
</span></span><span class=line><span class=cl> <span class=p>[</span><span class=mi>7</span><span class=p>,]</span>  <span class=mf>0.48412835</span> <span class=o>-</span><span class=mf>0.10647051</span> <span class=o>-</span><span class=mf>0.08160011</span> <span class=o>-</span><span class=mf>0.02823560</span> <span class=o>-</span><span class=mf>0.10696045</span>  <span class=mf>0.059388537</span>  <span class=mf>0.008685290</span>  <span class=mf>0.557037340</span>  <span class=mf>0.64922598</span>
</span></span><span class=line><span class=cl> <span class=p>[</span><span class=mi>8</span><span class=p>,]</span> <span class=o>-</span><span class=mf>0.21518798</span> <span class=o>-</span><span class=mf>0.48173066</span> <span class=o>-</span><span class=mf>0.38411284</span> <span class=o>-</span><span class=mf>0.08077891</span> <span class=o>-</span><span class=mf>0.41618156</span> <span class=o>-</span><span class=mf>0.593141261</span> <span class=o>-</span><span class=mf>0.082256717</span>  <span class=mf>0.151363976</span> <span class=o>-</span><span class=mf>0.11340603</span>
</span></span><span class=line><span class=cl> <span class=p>[</span><span class=mi>9</span><span class=p>,]</span> <span class=o>-</span><span class=mf>0.19005934</span> <span class=o>-</span><span class=mf>0.59649010</span> <span class=o>-</span><span class=mf>0.13377738</span> <span class=o>-</span><span class=mf>0.20151517</span> <span class=o>-</span><span class=mf>0.13720262</span>  <span class=mf>0.699691310</span>  <span class=mf>0.004010208</span> <span class=o>-</span><span class=mf>0.182634411</span>  <span class=mf>0.08836494</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>fa</span> <span class=o>&lt;-</span> <span class=n>factanal</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>,</span> <span class=n>factors</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=n>rotation</span> <span class=o>=</span> <span class=s2>&#34;varimax&#34;</span><span class=p>,</span> <span class=n>scores</span> <span class=o>=</span> <span class=s2>&#34;regression&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>brand</span><span class=o>.</span><span class=n>fl</span><span class=o>&lt;-</span> <span class=n>brand</span><span class=o>.</span><span class=n>fa</span><span class=o>$</span><span class=n>loadings</span><span class=p>[,</span> <span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>plot</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>fl</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=p>)</span> <span class=c1># set up plot </span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>text</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>fl</span><span class=p>,</span><span class=n>labels</span><span class=o>=</span><span class=n>names</span><span class=p>(</span><span class=n>brand</span><span class=o>.</span><span class=n>mean</span><span class=p>),</span><span class=n>cex</span><span class=o>=.</span><span class=mi>7</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_13.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; brand.fs &lt;- brand.fa$scores
</span></span><span class=line><span class=cl>&gt; plot(brand.fl,type=&#34;n&#34;) # set up plot 
</span></span><span class=line><span class=cl>&gt; text(brand.fl,labels=rownames(brand.mean),cex=.7)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_14.png %}</p><h1 id=2-managing-sustainable-competitive-advantage>2. Managing Sustainable Competitive Advantage</h1><h2 id=21-choice-based-conjoint-analysis>2.1 Choice-Based Conjoint Analysis</h2><h3 id=211-import-and-check-data>2.1.1 import and check data</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>cbc</span><span class=o>.</span><span class=n>df</span> <span class=o>&lt;-</span> <span class=n>read</span><span class=o>.</span><span class=n>csv</span><span class=p>(</span><span class=s2>&#34;5_conjoint.csv&#34;</span><span class=p>,</span> <span class=n>stringsAsF</span> <span class=o>....</span> <span class=p>[</span><span class=n>TRUNCATED</span><span class=p>]</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>head</span><span class=p>(</span><span class=n>cbc</span><span class=o>.</span><span class=n>df</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>Consumer_id</span> <span class=n>Block</span> <span class=n>Choice_id</span> <span class=n>Alternative</span> <span class=n>Choice</span>    <span class=n>Origin</span>    <span class=n>Manufacture</span> <span class=n>Energy</span>           <span class=n>Nuts</span>     <span class=n>Tokens</span> <span class=n>Organic</span> <span class=n>Premium</span> <span class=n>Fairtrade</span> <span class=n>Sugar</span> <span class=n>Price</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>           <span class=mi>1</span>     <span class=mi>1</span>         <span class=mi>1</span>           <span class=mi>1</span>      <span class=mi>1</span> <span class=n>Venezuela</span>      <span class=n>Developed</span>    <span class=n>Low</span>      <span class=n>Nuts</span> <span class=n>only</span>         <span class=n>No</span>      <span class=n>No</span>     <span class=n>Yes</span>       <span class=n>Yes</span>  <span class=n>High</span>     <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>           <span class=mi>1</span>     <span class=mi>1</span>         <span class=mi>1</span>           <span class=mi>2</span>      <span class=mi>0</span> <span class=n>Venezuela</span> <span class=n>UnderDeveloped</span>    <span class=n>Low</span>      <span class=n>Nuts</span> <span class=n>only</span> <span class=n>Keep</span> <span class=o>&amp;</span> <span class=n>Use</span>      <span class=n>No</span>      <span class=n>No</span>       <span class=n>Yes</span>   <span class=n>Low</span>     <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>           <span class=mi>1</span>     <span class=mi>1</span>         <span class=mi>1</span>           <span class=mi>3</span>      <span class=mi>0</span>      <span class=n>Peru</span>     <span class=n>Developing</span>   <span class=n>High</span>             <span class=n>No</span>     <span class=n>Donate</span>     <span class=n>Yes</span>      <span class=n>No</span>        <span class=n>No</span>  <span class=n>High</span>     <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>           <span class=mi>1</span>     <span class=mi>1</span>         <span class=mi>2</span>           <span class=mi>1</span>      <span class=mi>0</span>   <span class=n>Ecuador</span> <span class=n>UnderDeveloped</span>    <span class=n>Low</span> <span class=n>Nuts</span> <span class=ow>and</span> <span class=n>Fruit</span>     <span class=n>Donate</span>     <span class=n>Yes</span>      <span class=n>No</span>        <span class=n>No</span>  <span class=n>High</span>     <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>           <span class=mi>1</span>     <span class=mi>1</span>         <span class=mi>2</span>           <span class=mi>2</span>      <span class=mi>0</span> <span class=n>Venezuela</span>      <span class=n>Developed</span>    <span class=n>Low</span>             <span class=n>No</span>         <span class=n>No</span>      <span class=n>No</span>     <span class=n>Yes</span>       <span class=n>Yes</span>   <span class=n>Low</span>     <span class=mi>3</span>
</span></span><span class=line><span class=cl>  <span class=n>Age_Group</span> <span class=n>Gender</span> <span class=n>Salary</span> <span class=n>Education</span> <span class=n>Employment</span> <span class=n>Location_by_region</span> <span class=n>Choco_Consumption</span> <span class=n>Sustainability_Score</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>         <span class=mi>1</span>      <span class=mi>2</span>      <span class=mi>1</span>         <span class=mi>2</span>          <span class=mi>1</span>                  <span class=mi>1</span>                 <span class=mi>2</span>              <span class=o>-</span><span class=mf>0.6645</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>         <span class=mi>1</span>      <span class=mi>2</span>      <span class=mi>1</span>         <span class=mi>2</span>          <span class=mi>1</span>                  <span class=mi>1</span>                 <span class=mi>2</span>              <span class=o>-</span><span class=mf>0.6645</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>         <span class=mi>1</span>      <span class=mi>2</span>      <span class=mi>1</span>         <span class=mi>2</span>          <span class=mi>1</span>                  <span class=mi>1</span>                 <span class=mi>2</span>              <span class=o>-</span><span class=mf>0.6645</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>         <span class=mi>1</span>      <span class=mi>2</span>      <span class=mi>1</span>         <span class=mi>2</span>          <span class=mi>1</span>                  <span class=mi>1</span>                 <span class=mi>2</span>              <span class=o>-</span><span class=mf>0.6645</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>         <span class=mi>1</span>      <span class=mi>2</span>      <span class=mi>1</span>         <span class=mi>2</span>          <span class=mi>1</span>                  <span class=mi>1</span>                 <span class=mi>2</span>              <span class=o>-</span><span class=mf>0.6645</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>cbc</span><span class=o>.</span><span class=n>df</span><span class=p>,</span> <span class=n>digits</span> <span class=o>=</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>Consumer_id</span>      <span class=n>Block</span>       <span class=n>Choice_id</span>     <span class=n>Alternative</span>     <span class=n>Choice</span>           <span class=n>Origin</span>             <span class=n>Manufacture</span>    <span class=n>Energy</span>                 <span class=n>Nuts</span>     
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span>  <span class=mi>1</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span>   <span class=mi>1</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mi>1</span>    <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>0.00</span>   <span class=n>Ecuador</span>  <span class=p>:</span><span class=mi>1902</span>   <span class=n>Developed</span>     <span class=p>:</span><span class=mi>1418</span>   <span class=n>High</span><span class=p>:</span><span class=mi>2356</span>   <span class=n>No</span>            <span class=p>:</span><span class=mi>2317</span>  
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mi>95</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>3.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mi>473</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>1</span>    <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>0.00</span>   <span class=n>Peru</span>     <span class=p>:</span><span class=mi>1506</span>   <span class=n>Developing</span>    <span class=p>:</span><span class=mi>2311</span>   <span class=n>Low</span> <span class=p>:</span><span class=mi>3314</span>   <span class=n>Nuts</span> <span class=ow>and</span> <span class=n>Fruit</span><span class=p>:</span><span class=mi>1420</span>  
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span><span class=mi>190</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>4.0</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mi>946</span>   <span class=n>Median</span> <span class=p>:</span><span class=mi>2</span>    <span class=n>Median</span> <span class=p>:</span><span class=mf>0.00</span>   <span class=n>Venezuela</span><span class=p>:</span><span class=mi>2262</span>   <span class=n>UnderDeveloped</span><span class=p>:</span><span class=mi>1941</span>               <span class=n>Nuts</span> <span class=n>only</span>     <span class=p>:</span><span class=mi>1933</span>  
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span><span class=mi>190</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>4.5</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mi>946</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mi>2</span>    <span class=n>Mean</span>   <span class=p>:</span><span class=mf>0.33</span>                                                                           
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>284</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>6.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>1418</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>3</span>    <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.00</span>                                                                           
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mi>378</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>8.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mi>1890</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mi>3</span>    <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.00</span>                                                                           
</span></span><span class=line><span class=cl>        <span class=n>Tokens</span>     <span class=n>Organic</span>    <span class=n>Premium</span>    <span class=n>Fairtrade</span>   <span class=n>Sugar</span>          <span class=n>Price</span>       <span class=n>Age_Group</span>       <span class=n>Gender</span>        <span class=n>Salary</span>      <span class=n>Education</span>     <span class=n>Employment</span>  
</span></span><span class=line><span class=cl> <span class=n>Donate</span>    <span class=p>:</span><span class=mi>1418</span>   <span class=n>No</span> <span class=p>:</span><span class=mi>2664</span>   <span class=n>No</span> <span class=p>:</span><span class=mi>2652</span>   <span class=n>No</span> <span class=p>:</span><span class=mi>2646</span>   <span class=n>High</span><span class=p>:</span><span class=mi>2670</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>0.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>0.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>1.0</span>  
</span></span><span class=line><span class=cl> <span class=n>Keep</span> <span class=o>&amp;</span> <span class=n>Use</span><span class=p>:</span><span class=mi>1945</span>   <span class=n>Yes</span><span class=p>:</span><span class=mi>3006</span>   <span class=n>Yes</span><span class=p>:</span><span class=mi>3018</span>   <span class=n>Yes</span><span class=p>:</span><span class=mi>3024</span>   <span class=n>Low</span> <span class=p>:</span><span class=mi>3000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>3.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>2.0</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>1.0</span>  
</span></span><span class=line><span class=cl> <span class=n>No</span>        <span class=p>:</span><span class=mi>2307</span>                                                <span class=n>Median</span> <span class=p>:</span><span class=mf>4.0</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>1.0</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mf>2.0</span>  
</span></span><span class=line><span class=cl>                                                                <span class=n>Mean</span>   <span class=p>:</span><span class=mf>4.5</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>1.5</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>1.6</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>2.3</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>1.8</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>2.4</span>  
</span></span><span class=line><span class=cl>                                                                <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>5.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>2.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>2.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>3.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>2.0</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>3.0</span>  
</span></span><span class=line><span class=cl>                                                                <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>7.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>7.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>2.0</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>10.0</span>  
</span></span><span class=line><span class=cl> <span class=n>Location_by_region</span> <span class=n>Choco_Consumption</span> <span class=n>Sustainability_Score</span>
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0</span>        <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mi>1</span>         <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=o>-</span><span class=mf>3.26</span>       
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>        <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>2</span>         <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=o>-</span><span class=mf>0.61</span>       
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span><span class=mf>1.0</span>        <span class=n>Median</span> <span class=p>:</span><span class=mi>2</span>         <span class=n>Median</span> <span class=p>:</span> <span class=mf>0.14</span>       
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span><span class=mf>1.2</span>        <span class=n>Mean</span>   <span class=p>:</span><span class=mi>2</span>         <span class=n>Mean</span>   <span class=p>:</span> <span class=mf>0.00</span>       
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0</span>        <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>2</span>         <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mf>0.68</span>       
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>2.0</span>        <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mi>2</span>         <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span> <span class=mf>2.04</span>       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>str</span><span class=p>(</span><span class=n>cbc</span><span class=o>.</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;data.frame&#39;</span><span class=p>:</span>	<span class=mi>5670</span> <span class=n>obs</span><span class=o>.</span> <span class=n>of</span>  <span class=mi>23</span> <span class=n>variables</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Consumer_id</span>         <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Block</span>               <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Choice_id</span>           <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>4</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Alternative</span>         <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Choice</span>              <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>1</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>1</span> <span class=mi>0</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Origin</span>              <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>3</span> <span class=n>levels</span> <span class=s2>&#34;Ecuador&#34;</span><span class=p>,</span><span class=s2>&#34;Peru&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Manufacture</span>         <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>3</span> <span class=n>levels</span> <span class=s2>&#34;Developed&#34;</span><span class=p>,</span><span class=s2>&#34;Developing&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Energy</span>              <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;High&#34;</span><span class=p>,</span><span class=s2>&#34;Low&#34;</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Nuts</span>                <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>3</span> <span class=n>levels</span> <span class=s2>&#34;No&#34;</span><span class=p>,</span><span class=s2>&#34;Nuts and Fruit&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Tokens</span>              <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>3</span> <span class=n>levels</span> <span class=s2>&#34;Donate&#34;</span><span class=p>,</span><span class=s2>&#34;Keep &amp; Use&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Organic</span>             <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;No&#34;</span><span class=p>,</span><span class=s2>&#34;Yes&#34;</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Premium</span>             <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;No&#34;</span><span class=p>,</span><span class=s2>&#34;Yes&#34;</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Fairtrade</span>           <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;No&#34;</span><span class=p>,</span><span class=s2>&#34;Yes&#34;</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Sugar</span>               <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;High&#34;</span><span class=p>,</span><span class=s2>&#34;Low&#34;</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Price</span>               <span class=p>:</span> <span class=n>num</span>  <span class=mi>3</span> <span class=mi>5</span> <span class=mi>7</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>7</span> <span class=mi>7</span> <span class=mi>4</span> <span class=mi>3</span> <span class=mi>5</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Age_Group</span>           <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Gender</span>              <span class=p>:</span> <span class=ne>int</span>  <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Salary</span>              <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Education</span>           <span class=p>:</span> <span class=ne>int</span>  <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Employment</span>          <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Location_by_region</span>  <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Choco_Consumption</span>   <span class=p>:</span> <span class=ne>int</span>  <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Sustainability_Score</span><span class=p>:</span> <span class=n>num</span>  <span class=o>-</span><span class=mf>0.664</span> <span class=o>-</span><span class=mf>0.664</span> <span class=o>-</span><span class=mf>0.664</span> <span class=o>-</span><span class=mf>0.664</span> <span class=o>-</span><span class=mf>0.664</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>cbc</span><span class=o>.</span><span class=n>df</span> <span class=o>&lt;-</span> <span class=n>subset</span><span class=p>(</span><span class=n>cbc</span><span class=o>.</span><span class=n>df</span><span class=p>,</span> <span class=n>select</span> <span class=o>=</span> <span class=o>-</span><span class=n>c</span><span class=p>(</span><span class=n>Block</span><span class=p>,</span><span class=n>Age_Group</span><span class=p>,</span><span class=n>Gender</span><span class=p>,</span><span class=n>Salary</span><span class=p>,</span> <span class=n>Education</span><span class=p>,</span> <span class=n>Employment</span><span class=p>,</span> <span class=n>Location_by_region</span><span class=p>,</span> <span class=n>Choco_Consumption</span><span class=p>,</span> <span class=n>Sustainability_Score</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>head</span><span class=p>(</span><span class=n>cbc</span><span class=o>.</span><span class=n>df</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>Consumer_id</span> <span class=n>Choice_id</span> <span class=n>Alternative</span> <span class=n>Choice</span>    <span class=n>Origin</span>    <span class=n>Manufacture</span> <span class=n>Energy</span>           <span class=n>Nuts</span>     <span class=n>Tokens</span> <span class=n>Organic</span> <span class=n>Premium</span> <span class=n>Fairtrade</span> <span class=n>Sugar</span> <span class=n>Price</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>           <span class=mi>1</span>         <span class=mi>1</span>           <span class=mi>1</span>      <span class=mi>1</span> <span class=n>Venezuela</span>      <span class=n>Developed</span>    <span class=n>Low</span>      <span class=n>Nuts</span> <span class=n>only</span>         <span class=n>No</span>      <span class=n>No</span>     <span class=n>Yes</span>       <span class=n>Yes</span>  <span class=n>High</span>     <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>           <span class=mi>1</span>         <span class=mi>1</span>           <span class=mi>2</span>      <span class=mi>0</span> <span class=n>Venezuela</span> <span class=n>UnderDeveloped</span>    <span class=n>Low</span>      <span class=n>Nuts</span> <span class=n>only</span> <span class=n>Keep</span> <span class=o>&amp;</span> <span class=n>Use</span>      <span class=n>No</span>      <span class=n>No</span>       <span class=n>Yes</span>   <span class=n>Low</span>     <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>           <span class=mi>1</span>         <span class=mi>1</span>           <span class=mi>3</span>      <span class=mi>0</span>      <span class=n>Peru</span>     <span class=n>Developing</span>   <span class=n>High</span>             <span class=n>No</span>     <span class=n>Donate</span>     <span class=n>Yes</span>      <span class=n>No</span>        <span class=n>No</span>  <span class=n>High</span>     <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>           <span class=mi>1</span>         <span class=mi>2</span>           <span class=mi>1</span>      <span class=mi>0</span>   <span class=n>Ecuador</span> <span class=n>UnderDeveloped</span>    <span class=n>Low</span> <span class=n>Nuts</span> <span class=ow>and</span> <span class=n>Fruit</span>     <span class=n>Donate</span>     <span class=n>Yes</span>      <span class=n>No</span>        <span class=n>No</span>  <span class=n>High</span>     <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>           <span class=mi>1</span>         <span class=mi>2</span>           <span class=mi>2</span>      <span class=mi>0</span> <span class=n>Venezuela</span>      <span class=n>Developed</span>    <span class=n>Low</span>             <span class=n>No</span>         <span class=n>No</span>      <span class=n>No</span>     <span class=n>Yes</span>       <span class=n>Yes</span>   <span class=n>Low</span>     <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>cbc</span><span class=o>.</span><span class=n>df</span><span class=p>,</span> <span class=n>digits</span> <span class=o>=</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>Consumer_id</span>    <span class=n>Choice_id</span>     <span class=n>Alternative</span>     <span class=n>Choice</span>           <span class=n>Origin</span>             <span class=n>Manufacture</span>    <span class=n>Energy</span>                 <span class=n>Nuts</span>             <span class=n>Tokens</span>     <span class=n>Organic</span>   
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span>  <span class=mi>1</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span>   <span class=mi>1</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mi>1</span>    <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>0.00</span>   <span class=n>Ecuador</span>  <span class=p>:</span><span class=mi>1902</span>   <span class=n>Developed</span>     <span class=p>:</span><span class=mi>1418</span>   <span class=n>High</span><span class=p>:</span><span class=mi>2356</span>   <span class=n>No</span>            <span class=p>:</span><span class=mi>2317</span>   <span class=n>Donate</span>    <span class=p>:</span><span class=mi>1418</span>   <span class=n>No</span> <span class=p>:</span><span class=mi>2664</span>  
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mi>95</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span> <span class=mi>473</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>1</span>    <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>0.00</span>   <span class=n>Peru</span>     <span class=p>:</span><span class=mi>1506</span>   <span class=n>Developing</span>    <span class=p>:</span><span class=mi>2311</span>   <span class=n>Low</span> <span class=p>:</span><span class=mi>3314</span>   <span class=n>Nuts</span> <span class=ow>and</span> <span class=n>Fruit</span><span class=p>:</span><span class=mi>1420</span>   <span class=n>Keep</span> <span class=o>&amp;</span> <span class=n>Use</span><span class=p>:</span><span class=mi>1945</span>   <span class=n>Yes</span><span class=p>:</span><span class=mi>3006</span>  
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span><span class=mi>190</span>   <span class=n>Median</span> <span class=p>:</span> <span class=mi>946</span>   <span class=n>Median</span> <span class=p>:</span><span class=mi>2</span>    <span class=n>Median</span> <span class=p>:</span><span class=mf>0.00</span>   <span class=n>Venezuela</span><span class=p>:</span><span class=mi>2262</span>   <span class=n>UnderDeveloped</span><span class=p>:</span><span class=mi>1941</span>               <span class=n>Nuts</span> <span class=n>only</span>     <span class=p>:</span><span class=mi>1933</span>   <span class=n>No</span>        <span class=p>:</span><span class=mi>2307</span>             
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span><span class=mi>190</span>   <span class=n>Mean</span>   <span class=p>:</span> <span class=mi>946</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mi>2</span>    <span class=n>Mean</span>   <span class=p>:</span><span class=mf>0.33</span>                                                                                                        
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>284</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>1418</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mi>3</span>    <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.00</span>                                                                                                        
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mi>378</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mi>1890</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mi>3</span>    <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.00</span>                                                                                                        
</span></span><span class=line><span class=cl> <span class=n>Premium</span>    <span class=n>Fairtrade</span>   <span class=n>Sugar</span>          <span class=n>Price</span>    
</span></span><span class=line><span class=cl> <span class=n>No</span> <span class=p>:</span><span class=mi>2652</span>   <span class=n>No</span> <span class=p>:</span><span class=mi>2646</span>   <span class=n>High</span><span class=p>:</span><span class=mi>2670</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>2.0</span>  
</span></span><span class=line><span class=cl> <span class=n>Yes</span><span class=p>:</span><span class=mi>3018</span>   <span class=n>Yes</span><span class=p>:</span><span class=mi>3024</span>   <span class=n>Low</span> <span class=p>:</span><span class=mi>3000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>3.0</span>  
</span></span><span class=line><span class=cl>                                   <span class=n>Median</span> <span class=p>:</span><span class=mf>4.0</span>  
</span></span><span class=line><span class=cl>                                   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>4.5</span>  
</span></span><span class=line><span class=cl>                                   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>5.0</span>  
</span></span><span class=line><span class=cl>                                   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>7.0</span>  
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>str</span><span class=p>(</span><span class=n>cbc</span><span class=o>.</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;data.frame&#39;</span><span class=p>:</span>	<span class=mi>5670</span> <span class=n>obs</span><span class=o>.</span> <span class=n>of</span>  <span class=mi>14</span> <span class=n>variables</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Consumer_id</span><span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Choice_id</span>  <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>4</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Alternative</span><span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Choice</span>     <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>1</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>1</span> <span class=mi>0</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Origin</span>     <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>3</span> <span class=n>levels</span> <span class=s2>&#34;Ecuador&#34;</span><span class=p>,</span><span class=s2>&#34;Peru&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Manufacture</span><span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>3</span> <span class=n>levels</span> <span class=s2>&#34;Developed&#34;</span><span class=p>,</span><span class=s2>&#34;Developing&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Energy</span>     <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;High&#34;</span><span class=p>,</span><span class=s2>&#34;Low&#34;</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Nuts</span>       <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>3</span> <span class=n>levels</span> <span class=s2>&#34;No&#34;</span><span class=p>,</span><span class=s2>&#34;Nuts and Fruit&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Tokens</span>     <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>3</span> <span class=n>levels</span> <span class=s2>&#34;Donate&#34;</span><span class=p>,</span><span class=s2>&#34;Keep &amp; Use&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Organic</span>    <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;No&#34;</span><span class=p>,</span><span class=s2>&#34;Yes&#34;</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Premium</span>    <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;No&#34;</span><span class=p>,</span><span class=s2>&#34;Yes&#34;</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Fairtrade</span>  <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;No&#34;</span><span class=p>,</span><span class=s2>&#34;Yes&#34;</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Sugar</span>      <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;High&#34;</span><span class=p>,</span><span class=s2>&#34;Low&#34;</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Price</span>      <span class=p>:</span> <span class=n>num</span>  <span class=mi>3</span> <span class=mi>5</span> <span class=mi>7</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>7</span> <span class=mi>7</span> <span class=mi>4</span> <span class=mi>3</span> <span class=mi>5</span> <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; xtabs(Choice~Origin, data=cbc.df)
</span></span><span class=line><span class=cl>Origin
</span></span><span class=line><span class=cl>  Ecuador      Peru Venezuela 
</span></span><span class=line><span class=cl>      709       495       686 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Ecuador(38%) > Venezuela(36%) > Peru(26%)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; xtabs(Choice~Manufacture, data=cbc.df)
</span></span><span class=line><span class=cl>Manufacture
</span></span><span class=line><span class=cl>     Developed     Developing UnderDeveloped 
</span></span><span class=line><span class=cl>           436            893            561
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Developing > UnderDeveloped > Developed</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; xtabs(Choice~Energy, data=cbc.df)
</span></span><span class=line><span class=cl>Energy
</span></span><span class=line><span class=cl>High  Low 
</span></span><span class=line><span class=cl> 922  968 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Energy low nearly equals high</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; xtabs(Choice~Nuts, data=cbc.df)
</span></span><span class=line><span class=cl>Nuts
</span></span><span class=line><span class=cl>            No Nuts and Fruit      Nuts only 
</span></span><span class=line><span class=cl>           568            520            802 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Nuts Only(42%) > No(30%) > with Fruit(28%)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; xtabs(Choice~Tokens, data=cbc.df)
</span></span><span class=line><span class=cl>Tokens
</span></span><span class=line><span class=cl>    Donate Keep &amp; Use         No 
</span></span><span class=line><span class=cl>       532        740        618 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Tokens Keep&amp;Use(39%) > No(32%) > Donate(28%)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; xtabs(Choice~Organic, data=cbc.df)
</span></span><span class=line><span class=cl>Organic
</span></span><span class=line><span class=cl>  No  Yes 
</span></span><span class=line><span class=cl> 739 1151 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Organic Yes(60%) > No(40%)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; xtabs(Choice~Premium, data=cbc.df)
</span></span><span class=line><span class=cl>Premium
</span></span><span class=line><span class=cl>  No  Yes 
</span></span><span class=line><span class=cl> 394 1496 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Premium Yes(80%) > No(20%)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; xtabs(Choice~Fairtrade, data=cbc.df)
</span></span><span class=line><span class=cl>Fairtrade
</span></span><span class=line><span class=cl>  No  Yes 
</span></span><span class=line><span class=cl> 846 1044 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Fairtrade Yes(55%) > No(45%)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; xtabs(Choice~Sugar, data=cbc.df)
</span></span><span class=line><span class=cl>Sugar
</span></span><span class=line><span class=cl>High  Low 
</span></span><span class=line><span class=cl>1205  685 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Sugar High(64%) > Low(36%)</p></blockquote><h3 id=212-prepare-the-data>2.1.2 prepare the data</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cbc.df$Origin &lt;- relevel(cbc.df$Origin, ref = &#34;Venezuela&#34;)
</span></span><span class=line><span class=cl>cbc.df$Manufacture &lt;- relevel(cbc.df$Manufacture, ref = &#34;UnderDeveloped&#34;)
</span></span><span class=line><span class=cl>cbc.df$Energy &lt;- relevel(cbc.df$Energy, ref = &#34;Low&#34;)
</span></span><span class=line><span class=cl>cbc.df$Nuts &lt;- relevel(cbc.df$Nuts, ref = &#34;No&#34;)
</span></span><span class=line><span class=cl>cbc.df$Tokens &lt;- relevel(cbc.df$Tokens, ref = &#34;No&#34;)
</span></span><span class=line><span class=cl>cbc.df$Organic &lt;- relevel(cbc.df$Organic, ref = &#34;No&#34;)
</span></span><span class=line><span class=cl>cbc.df$Premium &lt;- relevel(cbc.df$Premium, ref = &#34;No&#34;)
</span></span><span class=line><span class=cl>cbc.df$Fairtrade &lt;- relevel(cbc.df$Fairtrade, ref = &#34;No&#34;)
</span></span><span class=line><span class=cl>cbc.df$Sugar &lt;- relevel(cbc.df$Sugar, ref = &#34;Low&#34;)
</span></span></code></pre></td></tr></table></div></div><h3 id=213-multinomial-conjoint-model-estimation-with-mlogit>2.1.3 Multinomial conjoint model estimation with mlogit()</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; cbc.mlogit &lt;- dfidx(cbc.df, choice=&#34;Choice&#34;,
</span></span><span class=line><span class=cl>+                     idx=list(c(&#34;Choice_id&#34;, &#34;Consumer_id&#34;), &#34;Alternative&#34;))
</span></span><span class=line><span class=cl>&gt; model&lt;-mlogit(Choice ~ 0+Origin+Manufacture+Energy+Nuts+Tokens+Organic+Premium+Fairtrade+Sugar+Price, data=cbc.mlogit) 
</span></span><span class=line><span class=cl>&gt; kable(summary(model)$CoefTable)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>|                      |   Estimate| Std. Error|    z-value| Pr(&gt;&amp;#124;z&amp;#124;)|
</span></span><span class=line><span class=cl>|:---------------------|----------:|----------:|----------:|------------------:|
</span></span><span class=line><span class=cl>|OriginEcuador         |  0.2265894|  0.0836676|  2.7082082|          0.0067648|
</span></span><span class=line><span class=cl>|OriginPeru            |  0.2194174|  0.0753628|  2.9114832|          0.0035972|
</span></span><span class=line><span class=cl>|ManufactureDeveloped  |  0.0396353|  0.0812293|  0.4879435|          0.6255898|
</span></span><span class=line><span class=cl>|ManufactureDeveloping | -0.2157812|  0.1743582| -1.2375742|          0.2158740|
</span></span><span class=line><span class=cl>|EnergyHigh            |  0.4153950|  0.1814621|  2.2891551|          0.0220703|
</span></span><span class=line><span class=cl>|NutsNuts and Fruit    |  0.3435879|  0.0820605|  4.1870067|          0.0000283|
</span></span><span class=line><span class=cl>|NutsNuts only         |  0.2629300|  0.0751140|  3.5004111|          0.0004645|
</span></span><span class=line><span class=cl>|TokensDonate          |  0.5203778|  0.0821382|  6.3353922|          0.0000000|
</span></span><span class=line><span class=cl>|TokensKeep &amp; Use      |  0.1345164|  0.0721562|  1.8642397|          0.0622881|
</span></span><span class=line><span class=cl>|OrganicYes            |  0.3947520|  0.0614207|  6.4270217|          0.0000000|
</span></span><span class=line><span class=cl>|PremiumYes            |  1.3982032|  0.0666952| 20.9640710|          0.0000000|
</span></span><span class=line><span class=cl>|FairtradeYes          |  0.4648390|  0.0613058|  7.5822972|          0.0000000|
</span></span><span class=line><span class=cl>|SugarHigh             |  0.6121655|  0.0632706|  9.6753519|          0.0000000|
</span></span><span class=line><span class=cl>|Price                 | -0.0824375|  0.0207685| -3.9693491|          0.0000721|
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Demonstrated that positive value of utility means prefer than reference value, meanwhile negative value indicates that they prefer reference level.<br>In case of the Nuts attribute, customers prefer more nuts, etc.</p></blockquote><h3 id=214-model-fit>2.1.4 Model fit</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>model</span><span class=o>.</span><span class=n>constraint</span> <span class=o>&lt;-</span><span class=n>mlogit</span><span class=p>(</span><span class=n>Choice</span> <span class=o>~</span> <span class=mi>0</span><span class=o>+</span><span class=n>Nuts</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>cbc</span><span class=o>.</span><span class=n>mlogit</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>lrtest</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>constraint</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Likelihood</span> <span class=n>ratio</span> <span class=n>test</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Model</span> <span class=mi>1</span><span class=p>:</span> <span class=n>Choice</span> <span class=o>~</span> <span class=mi>0</span> <span class=o>+</span> <span class=n>Origin</span> <span class=o>+</span> <span class=n>Manufacture</span> <span class=o>+</span> <span class=n>Energy</span> <span class=o>+</span> <span class=n>Nuts</span> <span class=o>+</span> <span class=n>Tokens</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=n>Organic</span> <span class=o>+</span> <span class=n>Premium</span> <span class=o>+</span> <span class=n>Fairtrade</span> <span class=o>+</span> <span class=n>Sugar</span> <span class=o>+</span> <span class=n>Price</span>
</span></span><span class=line><span class=cl><span class=n>Model</span> <span class=mi>2</span><span class=p>:</span> <span class=n>Choice</span> <span class=o>~</span> <span class=mi>0</span> <span class=o>+</span> <span class=n>Nuts</span>
</span></span><span class=line><span class=cl>  <span class=c1>#Df  LogLik  Df  Chisq Pr(&gt;Chisq)    </span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=mi>14</span> <span class=o>-</span><span class=mf>1566.0</span>                          
</span></span><span class=line><span class=cl><span class=mi>2</span>   <span class=mi>2</span> <span class=o>-</span><span class=mf>2021.2</span> <span class=o>-</span><span class=mi>12</span> <span class=mf>910.45</span>  <span class=o>&lt;</span> <span class=mf>2.2e-16</span> <span class=o>***</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=n>Signif</span><span class=o>.</span> <span class=n>codes</span><span class=p>:</span>  <span class=mi>0</span> <span class=err>‚Äò</span><span class=o>***</span><span class=err>‚Äô</span> <span class=mf>0.001</span> <span class=err>‚Äò</span><span class=o>**</span><span class=err>‚Äô</span> <span class=mf>0.01</span> <span class=err>‚Äò</span><span class=o>*</span><span class=err>‚Äô</span> <span class=mf>0.05</span> <span class=err>‚Äò</span><span class=o>.</span><span class=err>‚Äô</span> <span class=mf>0.1</span> <span class=err>‚Äò</span> <span class=err>‚Äô</span> <span class=mi>1</span>
</span></span></code></pre></td></tr></table></div></div><p>Means the larger model (our first model) fits the data better. So, we should keep all the variables.</p><h3 id=215-interpreting-conjoint-analysis-findings>2.1.5 Interpreting Conjoint Analysis Findings</h3><p>According to mlogit() results, customers prefer:</p><ol><li>Higher energy</li><li>More Nuts</li><li>Donate loyalty points with chocolates</li><li>Be Organic</li><li>Farmers paid a premium price</li><li>Faire trade certified</li><li>Higher sugar</li><li>Lower price</li><li>Origin Ecuador or Peru</li><li>Developed Manufacture</li></ol><p>We test the prediction for the first six choice sets in the data.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; kable(head(predict(model,cbc.mlogit)))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>|         1|         2|         3|
</span></span><span class=line><span class=cl>|---------:|---------:|---------:|
</span></span><span class=line><span class=cl>| 0.6954121| 0.0868465| 0.2177414|
</span></span><span class=line><span class=cl>| 0.2571232| 0.2116132| 0.5312636|
</span></span><span class=line><span class=cl>| 0.6276737| 0.0693051| 0.3030212|
</span></span><span class=line><span class=cl>| 0.3751338| 0.3188902| 0.3059760|
</span></span><span class=line><span class=cl>| 0.2320737| 0.6858870| 0.0820393|
</span></span><span class=line><span class=cl>| 0.6530199| 0.2196068| 0.1273733|
</span></span></code></pre></td></tr></table></div></div><p>We can see that, in group 2, choice 3 is more prefered, which means customers may pay more for higher energy and higher nuts and fruit.</p><p>And then, Measure the accuracy of prediction across all data:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; predicted_alternative &lt;- apply(predict(model,cbc.mlogit),1,which.max) 
</span></span><span class=line><span class=cl>&gt; selected_alternative &lt;- cbc.mlogit$Alternative[cbc.mlogit$Choice&gt;0] 
</span></span><span class=line><span class=cl>&gt; confusionMatrix(table(predicted_alternative,selected_alternative),positive = &#34;1&#34;)
</span></span><span class=line><span class=cl>Confusion Matrix and Statistics
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                     selected_alternative
</span></span><span class=line><span class=cl>predicted_alternative   1   2   3
</span></span><span class=line><span class=cl>                    1 315 104 102
</span></span><span class=line><span class=cl>                    2 142 705 140
</span></span><span class=line><span class=cl>                    3 102  61 219
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Overall Statistics
</span></span><span class=line><span class=cl>                                         
</span></span><span class=line><span class=cl>               Accuracy : 0.6556         
</span></span><span class=line><span class=cl>                 95% CI : (0.6336, 0.677)
</span></span><span class=line><span class=cl>    No Information Rate : 0.4603         
</span></span><span class=line><span class=cl>    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
</span></span><span class=line><span class=cl>                                         
</span></span><span class=line><span class=cl>                  Kappa : 0.4522         
</span></span><span class=line><span class=cl>                                         
</span></span><span class=line><span class=cl> Mcnemar&#39;s Test P-Value : 4.785e-08      
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Statistics by Class:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                     Class: 1 Class: 2 Class: 3
</span></span><span class=line><span class=cl>Sensitivity            0.5635   0.8103   0.4751
</span></span><span class=line><span class=cl>Specificity            0.8452   0.7235   0.8859
</span></span><span class=line><span class=cl>Pos Pred Value         0.6046   0.7143   0.5733
</span></span><span class=line><span class=cl>Neg Pred Value         0.8218   0.8173   0.8395
</span></span><span class=line><span class=cl>Prevalence             0.2958   0.4603   0.2439
</span></span><span class=line><span class=cl>Detection Rate         0.1667   0.3730   0.1159
</span></span><span class=line><span class=cl>Detection Prevalence   0.2757   0.5222   0.2021
</span></span><span class=line><span class=cl>Balanced Accuracy      0.7044   0.7669   0.6805
</span></span></code></pre></td></tr></table></div></div><p>If the predictions were random, the accuracy would be 33.3% (for three alternatives). Our simple model is doing much better than that ‚Äì although it is not perfect.</p><h2 id=22-willingness-to-pay>2.2 Willingness to pay</h2><h3 id=221-what-is-the-nuts-value>2.2.1 What is the Nuts&rsquo; value</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; (coef(model)[&#34;NutsNuts and Fruit&#34;]-coef(model)[&#34;NutsNuts only&#34;]) / (-coef(model)[&#34;Price&#34;])
</span></span><span class=line><span class=cl>NutsNuts and Fruit 
</span></span><span class=line><span class=cl>         0.9784127 
</span></span></code></pre></td></tr></table></div></div><p>The dollar value of an upgrade from Nuts only to Nuts and Fruit.</p><h3 id=222-willingness-to-pay-for-an-attribute-upgrade>2.2.2 Willingness to Pay for an Attribute Upgrade</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; coef(model)[&#34;NutsNuts and Fruit&#34;] / (-coef(model)[&#34;Price&#34;])
</span></span><span class=line><span class=cl>NutsNuts and Fruit 
</span></span><span class=line><span class=cl>          4.167859
</span></span></code></pre></td></tr></table></div></div><p>The dollar value of an upgrade from No Nuts to Nuts and Fruit (No Nuts is reference level. Hence its coeff is 0)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; coef(model)[&#34;EnergyHigh&#34;] / (-coef(model)[&#34;Price&#34;])
</span></span><span class=line><span class=cl>EnergyHigh 
</span></span><span class=line><span class=cl>  5.038907
</span></span></code></pre></td></tr></table></div></div><p>The dollar value of an upgrade from Energy Low to Energy High (Energy Low is reference level. Hence its coeff is 0)</p><h2 id=23-market-basket>2.3 Market Basket</h2><h3 id=231-retail-transaction-data-groceries>2.3.1 Retail Transaction Data: Groceries</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>retail</span><span class=o>.</span><span class=n>raw</span> <span class=o>&lt;-</span> <span class=n>readLines</span><span class=p>(</span><span class=s2>&#34;6_groceries.dat&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>head</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>raw</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;fruit, semi-finished bread, margarine, ready soups&#34;</span>         <span class=s2>&#34;crisps and nuts, yogurt, coffee&#34;</span>                           
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;whole milk&#34;</span>                                                 <span class=s2>&#34;pip fruit, yogurt, cream cheese, meat spreads&#34;</span>             
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;milk chocolate, whole milk, condensed milk, dark chocolate&#34;</span> <span class=s2>&#34;whole milk, butter, yogurt, rice, abrasive cleaner&#34;</span>        
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>tail</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>raw</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;crisps and nuts, milk chocolate, domestic eggs, zwieback, ketchup, soda, dishes&#34;</span>                                                                                                                             
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;sausage, chicken, sweet, hamburger meat, fruit, grapes, biscuits and crackers, whole milk, butter, whipped/sour cream, flour, coffee, red/blush wine, salty snack, milk chocolate, hygiene articles, napkins&#34;</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;cooking milk chocolate&#34;</span>                                                                                                                                                                                      
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;chicken, fruit, milk chocolate, butter, yogurt, frozen dessert, domestic eggs, bread, rum, cling film/bags&#34;</span>                                                                                                  
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;semi-finished bread, bottled water, soda, bottled beer&#34;</span>                                                                                                                                                      
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=s2>&#34;chicken, crisps and nuts, milk chocolate, vinegar, shopping bags&#34;</span>                                                                                                                                            
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>raw</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>Length</span>     <span class=n>Class</span>      <span class=n>Mode</span> 
</span></span><span class=line><span class=cl>     <span class=mi>9835</span> <span class=n>character</span> <span class=n>character</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>retail</span><span class=o>.</span><span class=n>list</span> <span class=o>&lt;-</span> <span class=n>strsplit</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>raw</span><span class=p>,</span> <span class=s2>&#34;,&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>names</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>list</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=n>paste</span><span class=p>(</span><span class=s2>&#34;Trans&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>:</span><span class=n>length</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>list</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>str</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>List</span> <span class=n>of</span> <span class=mi>9835</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>1</span>   <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;fruit&#34;</span> <span class=s2>&#34; semi-finished bread&#34;</span> <span class=s2>&#34; margarine&#34;</span> <span class=s2>&#34; ready soups&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>2</span>   <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;crisps and nuts&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=s2>&#34; coffee&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>3</span>   <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;whole milk&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>4</span>   <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;pip fruit&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=s2>&#34; cream cheese&#34;</span> <span class=s2>&#34; meat spreads&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>5</span>   <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;milk chocolate&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; condensed milk&#34;</span> <span class=s2>&#34; dark chocolate&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>6</span>   <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;whole milk&#34;</span> <span class=s2>&#34; butter&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=s2>&#34; rice&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>7</span>   <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;bread&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>8</span>   <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;milk chocolate&#34;</span> <span class=s2>&#34; UHT-milk&#34;</span> <span class=s2>&#34; bread&#34;</span> <span class=s2>&#34; bottled beer&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>9</span>   <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;potted plants&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>10</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;whole milk&#34;</span> <span class=s2>&#34; cereals&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>11</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;crisps and nuts&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; white bread&#34;</span> <span class=s2>&#34; bottled water&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>12</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>]</span> <span class=s2>&#34;fruit&#34;</span> <span class=s2>&#34; crisps and nuts&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; butter&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>13</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;sweet&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>14</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;frankfurter&#34;</span> <span class=s2>&#34; bread&#34;</span> <span class=s2>&#34; soda&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>15</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;chicken&#34;</span> <span class=s2>&#34; crisps and nuts&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>16</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;butter&#34;</span> <span class=s2>&#34; sugar&#34;</span> <span class=s2>&#34; fruit/vegetable juice&#34;</span> <span class=s2>&#34; newspapers&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>17</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;fruit/vegetable juice&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>18</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;packaged fruit/vegetables&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>19</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;milk chocolate&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>20</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;specialty bar&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>21</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;milk chocolate&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>22</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;butter milk&#34;</span> <span class=s2>&#34; pastry&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>23</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;whole milk&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>24</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;crisps and nuts&#34;</span> <span class=s2>&#34; cream cheese&#34;</span> <span class=s2>&#34; processed cheese&#34;</span> <span class=s2>&#34; detergent&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>25</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>11</span><span class=p>]</span> <span class=s2>&#34;crisps and nuts&#34;</span> <span class=s2>&#34; biscuits and crackers&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; frozen dessert&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>26</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;bottled water&#34;</span> <span class=s2>&#34; canned beer&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>27</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;yogurt&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>28</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;sausage&#34;</span> <span class=s2>&#34; bread&#34;</span> <span class=s2>&#34; soda&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>29</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;milk chocolate&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>30</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>6</span><span class=p>]</span> <span class=s2>&#34;brown bread&#34;</span> <span class=s2>&#34; soda&#34;</span> <span class=s2>&#34; fruit/vegetable juice&#34;</span> <span class=s2>&#34; canned beer&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>31</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;yogurt&#34;</span> <span class=s2>&#34; beverages&#34;</span> <span class=s2>&#34; bottled water&#34;</span> <span class=s2>&#34; specialty bar&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>32</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span> <span class=s2>&#34;hamburger meat&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; bread&#34;</span> <span class=s2>&#34; spices&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>33</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;biscuits and crackers&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; beverages&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>34</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span> <span class=s2>&#34;beef&#34;</span> <span class=s2>&#34; berries&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>35</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;sweet&#34;</span> <span class=s2>&#34; grapes&#34;</span> <span class=s2>&#34; detergent&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>36</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;pastry&#34;</span> <span class=s2>&#34; soda&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>37</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;fruit/vegetable juice&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>38</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;canned beer&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>39</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;biscuits and crackers&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; dessert&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>40</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;fruit&#34;</span> <span class=s2>&#34; zwieback&#34;</span> <span class=s2>&#34; newspapers&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>41</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>6</span><span class=p>]</span> <span class=s2>&#34;sausage&#34;</span> <span class=s2>&#34; bread&#34;</span> <span class=s2>&#34; soda&#34;</span> <span class=s2>&#34; canned beer&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>42</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>13</span><span class=p>]</span> <span class=s2>&#34;crisps and nuts&#34;</span> <span class=s2>&#34; biscuits and crackers&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>43</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;berries&#34;</span> <span class=s2>&#34; yogurt&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>44</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;canned beer&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>45</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span> <span class=s2>&#34;butter milk&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=s2>&#34; cream cheese&#34;</span> <span class=s2>&#34; spread cheese&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>46</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;coffee&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>47</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;pastry&#34;</span> <span class=s2>&#34; bottled water&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>48</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;bread&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>49</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;misc. beverages&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>50</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span> <span class=s2>&#34;biscuits and crackers&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; butter&#34;</span> <span class=s2>&#34; curd&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>51</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;sausage&#34;</span> <span class=s2>&#34; bread&#34;</span> <span class=s2>&#34; cat food&#34;</span> <span class=s2>&#34; newspapers&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>52</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;canned beer&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>53</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;ham&#34;</span> <span class=s2>&#34; grapes&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; whole milk&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>54</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span> <span class=s2>&#34;turkey&#34;</span> <span class=s2>&#34; crisps and nuts&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; curd&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>55</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;whole milk&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=s2>&#34; processed cheese&#34;</span> <span class=s2>&#34; pickled vegetables&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>56</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;whole milk&#34;</span> <span class=s2>&#34; curd&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=s2>&#34; pastry&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>57</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;packaged fruit/vegetables&#34;</span> <span class=s2>&#34; brown bread&#34;</span> <span class=s2>&#34; canned beer&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>58</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span> <span class=s2>&#34;bread&#34;</span> <span class=s2>&#34; oil&#34;</span> <span class=s2>&#34; bottled water&#34;</span> <span class=s2>&#34; chewing gum&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>59</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>6</span><span class=p>]</span> <span class=s2>&#34;ham&#34;</span> <span class=s2>&#34; sweet&#34;</span> <span class=s2>&#34; whipped/sour cream&#34;</span> <span class=s2>&#34; ice cream&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>60</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;bread&#34;</span> <span class=s2>&#34; pastry&#34;</span> <span class=s2>&#34; sugar&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>61</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span> <span class=s2>&#34;milk chocolate&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; frozen vegetables&#34;</span> <span class=s2>&#34; canned fish&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>62</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;sausage&#34;</span> <span class=s2>&#34; pastry&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>63</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;sausage&#34;</span> <span class=s2>&#34; sweet&#34;</span> <span class=s2>&#34; whole milk&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>64</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;frankfurter&#34;</span> <span class=s2>&#34; crisps and nuts&#34;</span> <span class=s2>&#34; bread&#34;</span> <span class=s2>&#34; brown bread&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>65</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;bread&#34;</span> <span class=s2>&#34; pastry&#34;</span> <span class=s2>&#34; soda&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>66</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;whole milk&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>67</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;curd cheese&#34;</span> <span class=s2>&#34; coffee&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>68</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;red/blush wine&#34;</span> <span class=s2>&#34; newspapers&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>69</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;sausage&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; curd&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>70</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span> <span class=s2>&#34;crisps and nuts&#34;</span> <span class=s2>&#34; pip fruit&#34;</span> <span class=s2>&#34; berries&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>71</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;red/blush wine&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>72</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span> <span class=s2>&#34;whole milk&#34;</span> <span class=s2>&#34; butter&#34;</span> <span class=s2>&#34; margarine&#34;</span> <span class=s2>&#34; specialty fat&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>73</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span> <span class=s2>&#34;frankfurter&#34;</span> <span class=s2>&#34; fruit&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; domestic eggs&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>74</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;whole milk&#34;</span> <span class=s2>&#34; meat spreads&#34;</span> <span class=s2>&#34; soda&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>75</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;frozen potato products&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>76</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;milk chocolate&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; bread&#34;</span> <span class=s2>&#34; sugar&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>77</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;fruit&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; curd&#34;</span> <span class=s2>&#34; butter milk&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>78</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34;flour&#34;</span> <span class=s2>&#34; salt&#34;</span> <span class=s2>&#34; bottled water&#34;</span> <span class=s2>&#34; fruit/vegetable juice&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>79</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;sugar&#34;</span> <span class=s2>&#34; bottled water&#34;</span> <span class=s2>&#34; soda&#34;</span> <span class=s2>&#34; bottled beer&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>80</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;frozen meals&#34;</span> <span class=s2>&#34; coffee&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>81</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;milk chocolate&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>82</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span> <span class=s2>&#34;biscuits and crackers&#34;</span> <span class=s2>&#34; whole milk&#34;</span> <span class=s2>&#34; frozen vegetables&#34;</span> <span class=s2>&#34; domestic eggs&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>83</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;biscuits and crackers&#34;</span> <span class=s2>&#34; onions&#34;</span> <span class=s2>&#34; hard cheese&#34;</span> <span class=s2>&#34; frozen vegetables&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>84</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span> <span class=s2>&#34;herbs&#34;</span> <span class=s2>&#34; condensed milk&#34;</span> <span class=s2>&#34; frozen vegetables&#34;</span> <span class=s2>&#34; salt&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>85</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;bottled water&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>86</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span> <span class=s2>&#34;sausage&#34;</span> <span class=s2>&#34; biscuits and crackers&#34;</span> <span class=s2>&#34; onions&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>87</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;coffee&#34;</span> <span class=s2>&#34; newspapers&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>88</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;beef&#34;</span> <span class=s2>&#34; milk chocolate&#34;</span> <span class=s2>&#34; whipped/sour cream&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>89</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;berries&#34;</span> <span class=s2>&#34; yogurt&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>90</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;soda&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>91</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;berries&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>92</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;fruit/vegetable juice&#34;</span> <span class=s2>&#34; salty snack&#34;</span> <span class=s2>&#34; candles&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>93</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=s2>&#34;fruit&#34;</span> <span class=s2>&#34; butter milk&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=s2>&#34; cream cheese&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>94</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>]</span> <span class=s2>&#34;beef&#34;</span> <span class=s2>&#34; hamburger meat&#34;</span> <span class=s2>&#34; fruit&#34;</span> <span class=s2>&#34; berries&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>95</span>  <span class=p>:</span> <span class=n>chr</span> <span class=s2>&#34;detergent&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>96</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=s2>&#34;grapes&#34;</span> <span class=s2>&#34; photo/film&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>97</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>9</span><span class=p>]</span> <span class=s2>&#34;sausage&#34;</span> <span class=s2>&#34; sliced cheese&#34;</span> <span class=s2>&#34; bread&#34;</span> <span class=s2>&#34; brown bread&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>98</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span> <span class=s2>&#34;chicken&#34;</span> <span class=s2>&#34; hamburger meat&#34;</span> <span class=s2>&#34; fruit&#34;</span> <span class=s2>&#34; crisps and nuts&#34;</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>Trans</span> <span class=mi>99</span>  <span class=p>:</span> <span class=n>chr</span> <span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=s2>&#34;whole milk&#34;</span> <span class=s2>&#34; yogurt&#34;</span> <span class=s2>&#34; brown bread&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>list</span> <span class=n>output</span> <span class=n>truncated</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>some</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>list</span><span class=p>)</span> <span class=c1>#note: random sample; your results may vary</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>918</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;beef&#34;</span>            <span class=s2>&#34; fruit&#34;</span>          <span class=s2>&#34; UHT-milk&#34;</span>       <span class=s2>&#34; brown bread&#34;</span>    <span class=s2>&#34; soda&#34;</span>           <span class=s2>&#34; bottled beer&#34;</span>  
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=s2>&#34; canned beer&#34;</span>    <span class=s2>&#34; dark chocolate&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>1371</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;bottled beer&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>1563</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;bread&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>2440</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;shopping bags&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>3235</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;bottled water&#34;</span> <span class=s2>&#34; bottled beer&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>3260</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;frankfurter&#34;</span>             <span class=s2>&#34; milk chocolate&#34;</span>         <span class=s2>&#34; whole milk&#34;</span>             <span class=s2>&#34; spread cheese&#34;</span>         
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34; sugar&#34;</span>                  <span class=s2>&#34; soda&#34;</span>                   <span class=s2>&#34; bottled beer&#34;</span>           <span class=s2>&#34; house keeping products&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>8306</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;beef&#34;</span>                       <span class=s2>&#34; sweet&#34;</span>                     <span class=s2>&#34; grapes&#34;</span>                    <span class=s2>&#34; berries&#34;</span>                  
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=s2>&#34; biscuits and crackers&#34;</span>     <span class=s2>&#34; milk chocolate&#34;</span>            <span class=s2>&#34; packaged fruit/vegetables&#34;</span> <span class=s2>&#34; yogurt&#34;</span>                   
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=s2>&#34; newspapers&#34;</span>               
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>9069</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;berries&#34;</span>                <span class=s2>&#34; biscuits and crackers&#34;</span> <span class=s2>&#34; whipped/sour cream&#34;</span>    <span class=s2>&#34; soda&#34;</span>                 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>9315</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;whole milk&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=err>`</span><span class=n>Trans</span> <span class=mi>9404</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=s2>&#34;sausage&#34;</span>           <span class=s2>&#34; bottled water&#34;</span>    <span class=s2>&#34; canned beer&#34;</span>      <span class=s2>&#34; hygiene articles&#34;</span> <span class=s2>&#34; shopping bags&#34;</span>   
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>retail</span><span class=o>.</span><span class=n>trans</span> <span class=o>&lt;-</span> <span class=n>as</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>list</span><span class=p>,</span> <span class=s2>&#34;transactions&#34;</span><span class=p>)</span> <span class=c1>#takes a few seconds </span>
</span></span><span class=line><span class=cl><span class=n>Warning</span> <span class=n>message</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=n>asMethod</span><span class=p>(</span><span class=n>object</span><span class=p>)</span> <span class=p>:</span> <span class=n>removing</span> <span class=n>duplicated</span> <span class=n>items</span> <span class=ow>in</span> <span class=n>transactions</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>trans</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>transactions</span> <span class=n>as</span> <span class=n>itemMatrix</span> <span class=ow>in</span> <span class=n>sparse</span> <span class=n>format</span> <span class=n>with</span>
</span></span><span class=line><span class=cl> <span class=mi>9835</span> <span class=n>rows</span> <span class=p>(</span><span class=n>elements</span><span class=o>/</span><span class=n>itemsets</span><span class=o>/</span><span class=n>transactions</span><span class=p>)</span> <span class=ow>and</span>
</span></span><span class=line><span class=cl> <span class=mi>324</span> <span class=n>columns</span> <span class=p>(</span><span class=n>items</span><span class=p>)</span> <span class=ow>and</span> <span class=n>a</span> <span class=n>density</span> <span class=n>of</span> <span class=mf>0.01357711</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>most</span> <span class=n>frequent</span> <span class=n>items</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=n>whole</span> <span class=n>milk</span>  <span class=n>milk</span> <span class=n>chocolate</span>           <span class=n>bread</span>            <span class=n>soda</span>          <span class=n>yogurt</span>         <span class=p>(</span><span class=n>Other</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>           <span class=mi>1796</span>            <span class=mi>1782</span>            <span class=mi>1473</span>            <span class=mi>1421</span>            <span class=mi>1147</span>           <span class=mi>35645</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>element</span> <span class=p>(</span><span class=n>itemset</span><span class=o>/</span><span class=n>transaction</span><span class=p>)</span> <span class=n>length</span> <span class=n>distribution</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>sizes</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>3</span>    <span class=mi>4</span>    <span class=mi>5</span>    <span class=mi>6</span>    <span class=mi>7</span>    <span class=mi>8</span>    <span class=mi>9</span>   <span class=mi>10</span>   <span class=mi>11</span>   <span class=mi>12</span>   <span class=mi>13</span>   <span class=mi>14</span>   <span class=mi>15</span>   <span class=mi>16</span>   <span class=mi>17</span>   <span class=mi>18</span>   <span class=mi>19</span>   <span class=mi>20</span>   <span class=mi>21</span>   <span class=mi>22</span>   <span class=mi>23</span>   <span class=mi>24</span>   <span class=mi>25</span> 
</span></span><span class=line><span class=cl><span class=mi>2159</span> <span class=mi>1643</span> <span class=mi>1301</span> <span class=mi>1007</span>  <span class=mi>854</span>  <span class=mi>649</span>  <span class=mi>553</span>  <span class=mi>433</span>  <span class=mi>346</span>  <span class=mi>250</span>  <span class=mi>178</span>  <span class=mi>116</span>   <span class=mi>80</span>   <span class=mi>73</span>   <span class=mi>56</span>   <span class=mi>46</span>   <span class=mi>27</span>   <span class=mi>13</span>   <span class=mi>16</span>   <span class=mi>10</span>    <span class=mi>9</span>    <span class=mi>4</span>    <span class=mi>4</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl>  <span class=mi>27</span>   <span class=mi>28</span>   <span class=mi>29</span>   <span class=mi>32</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>3</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>Min</span><span class=o>.</span> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span>  <span class=n>Median</span>    <span class=n>Mean</span> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span>    <span class=n>Max</span><span class=o>.</span> 
</span></span><span class=line><span class=cl>  <span class=mf>1.000</span>   <span class=mf>2.000</span>   <span class=mf>3.000</span>   <span class=mf>4.399</span>   <span class=mf>6.000</span>  <span class=mf>32.000</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>includes</span> <span class=n>extended</span> <span class=n>item</span> <span class=n>information</span> <span class=o>-</span> <span class=n>examples</span><span class=p>:</span>
</span></span><span class=line><span class=cl>             <span class=n>labels</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=n>abrasive</span> <span class=n>cleaner</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=n>artif</span><span class=o>.</span> <span class=n>sweetener</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>    <span class=n>baby</span> <span class=n>cosmetics</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>includes</span> <span class=n>extended</span> <span class=n>transaction</span> <span class=n>information</span> <span class=o>-</span> <span class=n>examples</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>transactionID</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>       <span class=n>Trans</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>       <span class=n>Trans</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>       <span class=n>Trans</span> <span class=mi>3</span>
</span></span></code></pre></td></tr></table></div></div><p>Looking at the summary() of the resulting object, we see that the transaction-by-item matrix is 9,835 rows by 324 columns. Of those 3.1 million intersections, only 1% have positive data (density) because most items are not purchased in most transactions. Item whole milk appears the most frequently and occurs in 1,796 baskets of all transactions. 2,159 of the transactions contain only a single item (‚Äúsizes‚Äù = 1) and the median basket size is 3 items.</p><h3 id=232-retail-transaction-data-groceries>2.3.2 Retail Transaction Data: Groceries</h3><p>We now use apriori(data, parameters = &mldr;) to find association rules with the apriori algorithm. At a conceptual level, the apriori algorithm searches through the item sets that frequently occur in a list of transactions. For each item set, it evaluates the various possible rules that express associations among the items at or above a particular level of support, and then retains the rules that show confidence above some threshold value.
To control the extent that apriori() searches, we use the parameter=list() control to instruct the algorithm to search rules that have a minimum support of 0.01 (1% transactions) and extract the ones that further demonstrate a minimum confidence of 0.3. The resulting rules set is assigned to the groc.rules object:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>inspect</span><span class=p>(</span><span class=n>head</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>trans</span><span class=p>,</span><span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>items</span>                                                   <span class=n>transactionID</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>{</span> <span class=n>margarine</span><span class=p>,</span>  <span class=n>ready</span> <span class=n>soups</span><span class=p>,</span>  <span class=n>semi</span><span class=o>-</span><span class=n>finished</span> <span class=n>bread</span><span class=p>,</span> <span class=n>fruit</span><span class=p>}</span> <span class=n>Trans</span> <span class=mi>1</span>      
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=p>{</span> <span class=n>coffee</span><span class=p>,</span>  <span class=n>yogurt</span><span class=p>,</span> <span class=n>crisps</span> <span class=ow>and</span> <span class=n>nuts</span><span class=p>}</span>                     <span class=n>Trans</span> <span class=mi>2</span>      
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=p>{</span><span class=n>whole</span> <span class=n>milk</span><span class=p>}</span>                                            <span class=n>Trans</span> <span class=mi>3</span>      
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=c1># Finding rules</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>groc</span><span class=o>.</span><span class=n>rules</span> <span class=o>&lt;-</span> <span class=n>apriori</span><span class=p>(</span><span class=n>retail</span><span class=o>.</span><span class=n>trans</span><span class=p>,</span> <span class=n>parameter</span> <span class=o>=</span> <span class=n>list</span><span class=p>(</span><span class=n>supp</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>conf</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>target</span><span class=o>=</span><span class=s2>&#34;rules&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>Apriori</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Parameter</span> <span class=n>specification</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=n>confidence</span> <span class=n>minval</span> <span class=n>smax</span> <span class=n>arem</span>  <span class=n>aval</span> <span class=n>originalSupport</span> <span class=n>maxtime</span> <span class=n>support</span> <span class=n>minlen</span> <span class=n>maxlen</span> <span class=n>target</span>  <span class=n>ext</span>
</span></span><span class=line><span class=cl>        <span class=mf>0.3</span>    <span class=mf>0.1</span>    <span class=mi>1</span> <span class=n>none</span> <span class=n>FALSE</span>            <span class=n>TRUE</span>       <span class=mi>5</span>    <span class=mf>0.01</span>      <span class=mi>1</span>     <span class=mi>10</span>  <span class=n>rules</span> <span class=n>TRUE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Algorithmic</span> <span class=n>control</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=n>filter</span> <span class=n>tree</span> <span class=n>heap</span> <span class=n>memopt</span> <span class=nb>load</span> <span class=n>sort</span> <span class=n>verbose</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.1</span> <span class=n>TRUE</span> <span class=n>TRUE</span>  <span class=n>FALSE</span> <span class=n>TRUE</span>    <span class=mi>2</span>    <span class=n>TRUE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Absolute</span> <span class=n>minimum</span> <span class=n>support</span> <span class=n>count</span><span class=p>:</span> <span class=mi>98</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>set</span> <span class=n>item</span> <span class=n>appearances</span> <span class=o>...</span><span class=p>[</span><span class=mi>0</span> <span class=n>item</span><span class=p>(</span><span class=n>s</span><span class=p>)]</span> <span class=n>done</span> <span class=p>[</span><span class=mf>0.00</span><span class=n>s</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>set</span> <span class=n>transactions</span> <span class=o>...</span><span class=p>[</span><span class=mi>324</span> <span class=n>item</span><span class=p>(</span><span class=n>s</span><span class=p>),</span> <span class=mi>9835</span> <span class=n>transaction</span><span class=p>(</span><span class=n>s</span><span class=p>)]</span> <span class=n>done</span> <span class=p>[</span><span class=mf>0.01</span><span class=n>s</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>sorting</span> <span class=ow>and</span> <span class=n>recoding</span> <span class=n>items</span> <span class=o>...</span> <span class=p>[</span><span class=mi>97</span> <span class=n>item</span><span class=p>(</span><span class=n>s</span><span class=p>)]</span> <span class=n>done</span> <span class=p>[</span><span class=mf>0.00</span><span class=n>s</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>creating</span> <span class=n>transaction</span> <span class=n>tree</span> <span class=o>...</span> <span class=n>done</span> <span class=p>[</span><span class=mf>0.01</span><span class=n>s</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>checking</span> <span class=n>subsets</span> <span class=n>of</span> <span class=n>size</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=mi>4</span> <span class=n>done</span> <span class=p>[</span><span class=mf>0.00</span><span class=n>s</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>writing</span> <span class=o>...</span> <span class=p>[</span><span class=mi>118</span> <span class=n>rule</span><span class=p>(</span><span class=n>s</span><span class=p>)]</span> <span class=n>done</span> <span class=p>[</span><span class=mf>0.00</span><span class=n>s</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>creating</span> <span class=n>S4</span> <span class=n>object</span>  <span class=o>...</span> <span class=n>done</span> <span class=p>[</span><span class=mf>0.00</span><span class=n>s</span><span class=p>]</span><span class=o>.</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><p>&ldquo;sorting and recoding items &mldr; [97 item(s)] done [0.00s].&rdquo;: tells us that the rules found are using 97 of the total number of items. If this number is too small (only a tiny set of your items) or too large (almost all of them), then you might wish to adjust the support and confidence levels.</p></li><li><p>&ldquo;writing &mldr; [118 rule(s)] done [0.00s].&rdquo;: Next, check the number of rules found, as indicated on the ‚Äúwriting &mldr;‚Äù line. In this case, the algorithm found 118 rules. If this number is too low, it suggests the need to lower the support or confidence levels; if it is too high (such as many more rules than items), you might increase the support or confidence levels.</p></li></ul><p>Once we have a rule set from apriori(), we use inspect(rules) to examine the association rules. The complete list of 118 from above is too long to examine here, so we select a subset of them with high lift, lift > 3. We find that five of the rules in our set have lift greater than 3.0:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; inspect(subset(groc.rules, lift &gt; 3))
</span></span><span class=line><span class=cl>     lhs                                    rhs                      support    confidence coverage   lift      count
</span></span><span class=line><span class=cl>[1]  { sausage}                          =&gt; {frankfurter}            0.01006609 1.0000000  0.01006609 16.956897  99  
</span></span><span class=line><span class=cl>[2]  {sweet}                             =&gt; { biscuits and crackers} 0.01006609 0.3256579  0.03091002  4.085262  99  
</span></span><span class=line><span class=cl>[3]  { onions}                           =&gt; { milk chocolate}        0.01301474 0.5446809  0.02389426  3.006137 128  
</span></span><span class=line><span class=cl>[4]  { fruit}                            =&gt; { biscuits and crackers} 0.01128622 0.3074792  0.03670564  3.857217 111  
</span></span><span class=line><span class=cl>[5]  { butter,  milk chocolate}          =&gt; { whole milk}            0.01260803 0.5876777  0.02145399  3.218157 124  
</span></span><span class=line><span class=cl>[6]  { pip fruit,  whole milk}           =&gt; { milk chocolate}        0.01189629 0.5652174  0.02104728  3.119480 117  
</span></span><span class=line><span class=cl>[7]  { domestic eggs,  milk chocolate}   =&gt; { whole milk}            0.01230300 0.5654206  0.02175902  3.096276 121  
</span></span><span class=line><span class=cl>[8]  { crisps and nuts,  yogurt}         =&gt; { whole milk}            0.01047280 0.5953757  0.01759024  3.260312 103  
</span></span><span class=line><span class=cl>[9]  { crisps and nuts,  whole milk}     =&gt; { yogurt}                0.01047280 0.4186992  0.02501271  3.590154 103  
</span></span><span class=line><span class=cl>[10] { crisps and nuts,  yogurt}         =&gt; { milk chocolate}        0.01006609 0.5722543  0.01759024  3.158317  99  
</span></span><span class=line><span class=cl>[11] { crisps and nuts,  milk chocolate} =&gt; { yogurt}                0.01006609 0.3750000  0.02684291  3.215453  99  
</span></span><span class=line><span class=cl>[12] { crisps and nuts,  whole milk}     =&gt; { milk chocolate}        0.01372649 0.5487805  0.02501271  3.028763 135  
</span></span><span class=line><span class=cl>[13] { biscuits and crackers,  yogurt}   =&gt; { whole milk}            0.01230300 0.5960591  0.02064057  3.264054 121  
</span></span><span class=line><span class=cl>[14] { biscuits and crackers,  yogurt}   =&gt; { milk chocolate}        0.01148958 0.5566502  0.02064057  3.072197 113 
</span></span></code></pre></td></tr></table></div></div><p>The first rule tells us that if a transaction contains {sausage} then it is also relatively more likely to contain {frankfurter}. The support shows that the combination appears in 1% of baskets, and the lift shows that the combination is 17√ó more likely to occur together than one would expect from the individual rates of incidence alone.</p><p>A store might form several insights on the basis of such information. For instance, the store might create a display for frankfurter near the sausage to encourage shoppers who are examining sausage to purchase those frankfurter with them. It might also suggest putting coupons for frankfurter in the sausage area or featuring recipe cards somewhere in the store.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>plot(groc.rules)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_15.png %}</p><p>In that chart, we see that most rules involve item combinations that infrequently occur (that is, they have low support) while confidence is relatively smoothly distributed.</p><p>Simply showing points is not very useful, and a key feature with arulesViz is interactive plotting. In the above figure, there are some rules on the upper left with a high lift. We can use interactive plotting to inspect those rules. To do this, add interactive=TRUE to the plot() command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>plot(groc.rules, engine = &#34;plotly&#34;, interactive=TRUE)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_16.png %}</p><p>One rule tells us that the combination {crisps and nuts, yogurt} occurs in about 1.0 % of baskets (support=0.0105), and when it occurs, it highly likely includes {whole milk} (confidence= 0.595). The combination occurs 3 times more often than we would expect from the individual incidence rates of {crisps and nuts, yogurt} and {whole milk} considered separately (lift=3.26).</p><p>A common goal in market basket analysis is to find rules with high lift. We can find such rules easily by sorting the larger set of rules by lift. We extract the 15 rules with the highest lift using sort() to order the rules by lift and to take 50 from the head():</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; # Finding and Plotting Subsets of Rules
</span></span><span class=line><span class=cl>&gt; groc.hi &lt;- head(sort(groc.rules, by=&#34;lift&#34;), 15) 
</span></span><span class=line><span class=cl>&gt; inspect(groc.hi)
</span></span><span class=line><span class=cl>     lhs                                    rhs                      support    confidence coverage   lift      count
</span></span><span class=line><span class=cl>[1]  { sausage}                          =&gt; {frankfurter}            0.01006609 1.0000000  0.01006609 16.956897  99  
</span></span><span class=line><span class=cl>[2]  {sweet}                             =&gt; { biscuits and crackers} 0.01006609 0.3256579  0.03091002  4.085262  99  
</span></span><span class=line><span class=cl>[3]  { fruit}                            =&gt; { biscuits and crackers} 0.01128622 0.3074792  0.03670564  3.857217 111  
</span></span><span class=line><span class=cl>[4]  { crisps and nuts,  whole milk}     =&gt; { yogurt}                0.01047280 0.4186992  0.02501271  3.590154 103  
</span></span><span class=line><span class=cl>[5]  { biscuits and crackers,  yogurt}   =&gt; { whole milk}            0.01230300 0.5960591  0.02064057  3.264054 121  
</span></span><span class=line><span class=cl>[6]  { crisps and nuts,  yogurt}         =&gt; { whole milk}            0.01047280 0.5953757  0.01759024  3.260312 103  
</span></span><span class=line><span class=cl>[7]  { butter,  milk chocolate}          =&gt; { whole milk}            0.01260803 0.5876777  0.02145399  3.218157 124  
</span></span><span class=line><span class=cl>[8]  { crisps and nuts,  milk chocolate} =&gt; { yogurt}                0.01006609 0.3750000  0.02684291  3.215453  99  
</span></span><span class=line><span class=cl>[9]  { crisps and nuts,  yogurt}         =&gt; { milk chocolate}        0.01006609 0.5722543  0.01759024  3.158317  99  
</span></span><span class=line><span class=cl>[10] { pip fruit,  whole milk}           =&gt; { milk chocolate}        0.01189629 0.5652174  0.02104728  3.119480 117  
</span></span><span class=line><span class=cl>[11] { domestic eggs,  milk chocolate}   =&gt; { whole milk}            0.01230300 0.5654206  0.02175902  3.096276 121  
</span></span><span class=line><span class=cl>[12] { biscuits and crackers,  yogurt}   =&gt; { milk chocolate}        0.01148958 0.5566502  0.02064057  3.072197 113  
</span></span><span class=line><span class=cl>[13] { crisps and nuts,  whole milk}     =&gt; { milk chocolate}        0.01372649 0.5487805  0.02501271  3.028763 135  
</span></span><span class=line><span class=cl>[14] { onions}                           =&gt; { milk chocolate}        0.01301474 0.5446809  0.02389426  3.006137 128  
</span></span><span class=line><span class=cl>[15] { butter,  whole milk}              =&gt; { milk chocolate}        0.01260803 0.5414847  0.02328419  2.988497 124  
</span></span></code></pre></td></tr></table></div></div><p>Support and lift are identical for an item set regardless of the items‚Äô order within a rule (left-hand or right-
hand side of the rule). However, confidence reflects direction because it computes the occurrence of the right-hand set conditional on the left-hand side set.<br>A graph display of rules may be useful to seek themes and patterns at a higher level. We chart the top 15 rules byliftwithplot(&mldr; ,method=‚Äúgraph‚Äù):</p><p>{% asset_image final_17.png %}</p><p>The positioning of items on the resulting graph may differ for your system, but the item clusters should be similar. Each circle represents a rule, with inbound arrows coming from items on the left-hand side of
the rule and outbound arrows going to the right-hand side. The size (area) of the circle represents the rule‚Äôs support, and shade represents lift (darker indicates higher lift).</p><h1 id=3-managing-resources-trade-offs>3 Managing Resources Trade-offs</h1><h2 id=31-selecting-advertising-platforms>3.1 Selecting Advertising platforms</h2><h3 id=311-import-and-check-data>3.1.1 import and check data</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>spending.data &lt;- read.csv(&#34;7_advertising.csv&#34;)
</span></span><span class=line><span class=cl>str(spending.data)
</span></span><span class=line><span class=cl>plot(spending.data$radio, spending.data$sales)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_18.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>plot(spending.data$magazines, spending.data$sales)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_19.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>plot(spending.data$social_media, spending.data$sales)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_20.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>plot(spending.data$search_ads, spending.data$sales)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_21.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>plot(spending.data$tv, spending.data$sales)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_22.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>plot(spending.data$newspaper, spending.data$sales)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_23.png %}</p><h3 id=312-selecting-advertising-platforms>3.1.2 Selecting Advertising platforms</h3><h4 id=3121-line>3.1.2.1 line</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; ## line
</span></span><span class=line><span class=cl>&gt; regression_1 &lt;- lm(sales ~ radio + magazines + social_media + search_ads + tv + newspaper, data=spending.data) 
</span></span><span class=line><span class=cl>&gt; # 83.14% explained
</span></span><span class=line><span class=cl>&gt; summary(regression_1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl>lm(formula = sales ~ radio + magazines + social_media + search_ads + 
</span></span><span class=line><span class=cl>    tv + newspaper, data = spending.data)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residuals:
</span></span><span class=line><span class=cl>     Min       1Q   Median       3Q      Max 
</span></span><span class=line><span class=cl>-1389.11   -73.13    43.17   114.90   835.69 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Coefficients:
</span></span><span class=line><span class=cl>             Estimate Std. Error t value Pr(&gt;|t|)    
</span></span><span class=line><span class=cl>(Intercept)  323.0262    40.8171   7.914  1.9e-13 ***
</span></span><span class=line><span class=cl>radio         15.2914     1.0354  14.768  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>magazines     -0.5535     3.5231  -0.157    0.875    
</span></span><span class=line><span class=cl>social_media   1.8449     1.2796   1.442    0.151    
</span></span><span class=line><span class=cl>search_ads    -1.6499     2.0874  -0.790    0.430    
</span></span><span class=line><span class=cl>tv             4.6694     0.2177  21.447  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>newspaper      0.7353     0.9618   0.764    0.446    
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residual standard error: 214.3 on 193 degrees of freedom
</span></span><span class=line><span class=cl>Multiple R-squared:  0.8365,	Adjusted R-squared:  0.8314 
</span></span><span class=line><span class=cl>F-statistic: 164.5 on 6 and 193 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></td></tr></table></div></div><h4 id=3122-log>3.1.2.2 log</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; ## log
</span></span><span class=line><span class=cl>&gt; summary(spending.data$radio)
</span></span><span class=line><span class=cl>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
</span></span><span class=line><span class=cl>   0.04    9.30   22.00   23.23   36.35   79.60 
</span></span><span class=line><span class=cl>&gt; summary(spending.data$magazines)
</span></span><span class=line><span class=cl>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
</span></span><span class=line><span class=cl>  0.030   1.050   3.420   4.828   6.383  61.160 
</span></span><span class=line><span class=cl>&gt; summary(spending.data$social_media)
</span></span><span class=line><span class=cl>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
</span></span><span class=line><span class=cl>  0.245   7.050  18.137  22.289  33.523  90.800 
</span></span><span class=line><span class=cl>&gt; summary(spending.data$search_ads)
</span></span><span class=line><span class=cl>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
</span></span><span class=line><span class=cl> 0.1568  5.6442 11.6133 14.2485 21.4547 50.3014 
</span></span><span class=line><span class=cl>&gt; summary(spending.data$tv)
</span></span><span class=line><span class=cl>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
</span></span><span class=line><span class=cl>   0.70   74.38  149.75  147.04  218.82  296.40 
</span></span><span class=line><span class=cl>&gt; summary(spending.data$newspaper)
</span></span><span class=line><span class=cl>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
</span></span><span class=line><span class=cl>   0.30   12.75   25.75   30.55   45.10  114.00 
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; regression_2 &lt;- lm(log(sales) ~ log(radio) + log(magazines) + log(social_media) + log(search_ads) + log(tv) + log(newspaper), data=spending.data) 
</span></span><span class=line><span class=cl>&gt; # 90.15% explained
</span></span><span class=line><span class=cl>&gt; summary(regression_2)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl>lm(formula = log(sales) ~ log(radio) + log(magazines) + log(social_media) + 
</span></span><span class=line><span class=cl>    log(search_ads) + log(tv) + log(newspaper), data = spending.data)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residuals:
</span></span><span class=line><span class=cl>     Min       1Q   Median       3Q      Max 
</span></span><span class=line><span class=cl>-0.53768 -0.08809 -0.01695  0.07090  0.58515 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Coefficients:
</span></span><span class=line><span class=cl>                   Estimate Std. Error t value Pr(&gt;|t|)    
</span></span><span class=line><span class=cl>(Intercept)        5.066700   0.063064  80.342   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(radio)         0.143520   0.008449  16.986   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(magazines)     0.016958   0.015932   1.064   0.2885    
</span></span><span class=line><span class=cl>log(social_media)  0.024575   0.015334   1.603   0.1107    
</span></span><span class=line><span class=cl>log(search_ads)   -0.037193   0.016400  -2.268   0.0244 *  
</span></span><span class=line><span class=cl>log(tv)            0.364471   0.013843  26.329   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(newspaper)     0.001954   0.017739   0.110   0.9124    
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residual standard error: 0.13 on 193 degrees of freedom
</span></span><span class=line><span class=cl>Multiple R-squared:  0.9045,	Adjusted R-squared:  0.9015 
</span></span><span class=line><span class=cl>F-statistic: 304.7 on 6 and 193 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></td></tr></table></div></div><h4 id=3123-log-better>3.1.2.3 log better</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; regression &lt;- lm(log(sales) ~ log(radio) + log(tv), data=spending.data) 
</span></span><span class=line><span class=cl>&gt; # 89.93% explained
</span></span><span class=line><span class=cl>&gt; summary(regression)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl>lm(formula = log(sales) ~ log(radio) + log(tv), data = spending.data)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residuals:
</span></span><span class=line><span class=cl>     Min       1Q   Median       3Q      Max 
</span></span><span class=line><span class=cl>-0.53810 -0.09115 -0.01295  0.06795  0.58926 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Coefficients:
</span></span><span class=line><span class=cl>            Estimate Std. Error t value Pr(&gt;|t|)    
</span></span><span class=line><span class=cl>(Intercept) 5.098303   0.050058  101.85   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(radio)  0.146733   0.008299   17.68   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(tv)     0.356862   0.009271   38.49   &lt;2e-16 ***
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residual standard error: 0.1315 on 197 degrees of freedom
</span></span><span class=line><span class=cl>Multiple R-squared:  0.9003,	Adjusted R-squared:  0.8993 
</span></span><span class=line><span class=cl>F-statistic: 889.6 on 2 and 197 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></td></tr></table></div></div><h3 id=313-allocating-marketing-budget>3.1.3 Allocating Marketing Budget</h3><blockquote><p>Sum elasticity</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0.49 = 0.14 + 0.35
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Ratio of elasticity</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0.2857 = 0.14 / 0.49
</span></span></code></pre></td></tr></table></div></div><blockquote><p>TV of elasticity</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0.7143 = 0.35 / 0.49
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Obtain elasticities from model</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; mean(spending.data$radio)
</span></span><span class=line><span class=cl>[1] 23.2297
</span></span><span class=line><span class=cl>&gt; mean(spending.data$tv)
</span></span><span class=line><span class=cl>[1] 147.0425
</span></span><span class=line><span class=cl>&gt; mean(spending.data$sales)
</span></span><span class=line><span class=cl>[1] 1402.25
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; # radio
</span></span><span class=line><span class=cl>&gt; # A 1% increase in radio advertising results in a 0.26% increase in sales.
</span></span><span class=line><span class=cl>&gt; 0.143520 * (23.2297 / 1402.25)
</span></span><span class=line><span class=cl>[1] 0.002377555
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; # tv
</span></span><span class=line><span class=cl>&gt; # A 1% increase in tv advertising results in a 0.26% increase in sales.
</span></span><span class=line><span class=cl>&gt; 0.364471 * (147.0425 / 1402.25)
</span></span><span class=line><span class=cl>[1] 0.0382191
</span></span></code></pre></td></tr></table></div></div><h3 id=314-advertising-carryover-effect>3.1.4 Advertising Carryover Effect</h3><p>We are assumed to retain a 10% of your previous advertising stock.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; adstock &lt;- function(x, rate){
</span></span><span class=line><span class=cl>+   return(as.numeric(stats::filter(x=x, filter=rate, method=&#34;recursive&#34;)))
</span></span><span class=line><span class=cl>+ }
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; spending.data &lt;- spending.data %&gt;% mutate(tv_adstock = adstock(tv,0.1),
</span></span><span class=line><span class=cl>+                                           magazines_adstock = adstock(magazines, 0.1), 
</span></span><span class=line><span class=cl>+                                           social_media_adstock = adstock(social_media, 0.1), 
</span></span><span class=line><span class=cl>+                                           search_ads_adstock = adstock(search_ads, 0.1), 
</span></span><span class=line><span class=cl>+                                           newspaper_adstock = adstock(newspaper, 0.1), 
</span></span><span class=line><span class=cl>+                                           radio_adstock = adstock(radio, 0.1))
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; regression_with_stock &lt;- lm(log(sales) ~ log(radio_adstock) + log(magazines_adstock) + log(social_media_adstock) + log(search_ads_adstock) + log(tv_adstock) + log(newspaper_adstock), data=spending.data) 
</span></span><span class=line><span class=cl>&gt; # 90.15% explained
</span></span><span class=line><span class=cl>&gt; summary(regression_with_stock)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl>lm(formula = log(sales) ~ log(radio_adstock) + log(magazines_adstock) + 
</span></span><span class=line><span class=cl>    log(social_media_adstock) + log(search_ads_adstock) + log(tv_adstock) + 
</span></span><span class=line><span class=cl>    log(newspaper_adstock), data = spending.data)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residuals:
</span></span><span class=line><span class=cl>     Min       1Q   Median       3Q      Max 
</span></span><span class=line><span class=cl>-1.08867 -0.06993  0.00508  0.06916  0.53508 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Coefficients:
</span></span><span class=line><span class=cl>                           Estimate Std. Error t value Pr(&gt;|t|)    
</span></span><span class=line><span class=cl>(Intercept)                4.253505   0.098083  43.366   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(radio_adstock)         0.186030   0.013809  13.472   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(magazines_adstock)     0.010671   0.019567   0.545   0.5861    
</span></span><span class=line><span class=cl>log(social_media_adstock)  0.018066   0.020384   0.886   0.3766    
</span></span><span class=line><span class=cl>log(search_ads_adstock)   -0.040954   0.022445  -1.825   0.0696 .  
</span></span><span class=line><span class=cl>log(tv_adstock)            0.484510   0.019831  24.432   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(newspaper_adstock)     0.009142   0.023393   0.391   0.6964    
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residual standard error: 0.1566 on 193 degrees of freedom
</span></span><span class=line><span class=cl>Multiple R-squared:  0.8615,	Adjusted R-squared:  0.8572 
</span></span><span class=line><span class=cl>F-statistic:   200 on 6 and 193 DF,  p-value: &lt; 2.2e-16
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; spending.data &lt;- spending.data %&gt;% mutate(tv_adstock = adstock(tv,0.1),
</span></span><span class=line><span class=cl>+                                           radio_adstock = adstock(radio, 0.1))
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; regression_with_stock &lt;- lm(log(sales) ~ log(radio_adstock) + log(tv_adstock), data=spending.data) 
</span></span><span class=line><span class=cl>&gt; # 85.65% explained
</span></span><span class=line><span class=cl>&gt; summary(regression_with_stock)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl>lm(formula = log(sales) ~ log(radio_adstock) + log(tv_adstock), 
</span></span><span class=line><span class=cl>    data = spending.data)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residuals:
</span></span><span class=line><span class=cl>     Min       1Q   Median       3Q      Max 
</span></span><span class=line><span class=cl>-1.09358 -0.07401 -0.00318  0.07187  0.59975 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Coefficients:
</span></span><span class=line><span class=cl>                   Estimate Std. Error t value Pr(&gt;|t|)    
</span></span><span class=line><span class=cl>(Intercept)         4.30635    0.08387   51.34   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(radio_adstock)  0.18899    0.01318   14.34   &lt;2e-16 ***
</span></span><span class=line><span class=cl>log(tv_adstock)     0.47064    0.01503   31.30   &lt;2e-16 ***
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residual standard error: 0.157 on 197 degrees of freedom
</span></span><span class=line><span class=cl>Multiple R-squared:  0.858,	Adjusted R-squared:  0.8565 
</span></span><span class=line><span class=cl>F-statistic: 594.9 on 2 and 197 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></td></tr></table></div></div><h3 id=315-synergy-effect>3.1.5 Synergy Effect</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; # synergy effect
</span></span><span class=line><span class=cl>&gt; center &lt;- function(x) { scale(x, scale = F)}
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; regression &lt;- lm(log(sales) ~ log(radio) + log(magazines) + log(social_media) + log(search_ads) + log(tv) + log(newspaper) + log(radio) * log(tv), data=spending.data) 
</span></span><span class=line><span class=cl>&gt; summary(regression)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl>lm(formula = log(sales) ~ log(radio) + log(magazines) + log(social_media) + 
</span></span><span class=line><span class=cl>    log(search_ads) + log(tv) + log(newspaper) + log(radio) * 
</span></span><span class=line><span class=cl>    log(tv), data = spending.data)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residuals:
</span></span><span class=line><span class=cl>     Min       1Q   Median       3Q      Max 
</span></span><span class=line><span class=cl>-0.29003 -0.07859 -0.02022  0.04670  0.54257 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Coefficients:
</span></span><span class=line><span class=cl>                    Estimate Std. Error t value Pr(&gt;|t|)    
</span></span><span class=line><span class=cl>(Intercept)         5.880586   0.111464  52.758  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>log(radio)         -0.117384   0.032064  -3.661 0.000325 ***
</span></span><span class=line><span class=cl>log(magazines)      0.026573   0.013728   1.936 0.054378 .  
</span></span><span class=line><span class=cl>log(social_media)   0.029733   0.013181   2.256 0.025215 *  
</span></span><span class=line><span class=cl>log(search_ads)    -0.034111   0.014086  -2.422 0.016386 *  
</span></span><span class=line><span class=cl>log(tv)             0.182792   0.024784   7.375 4.79e-12 ***
</span></span><span class=line><span class=cl>log(newspaper)     -0.007208   0.015271  -0.472 0.637475    
</span></span><span class=line><span class=cl>log(radio):log(tv)  0.058409   0.006992   8.354 1.30e-14 ***
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residual standard error: 0.1116 on 192 degrees of freedom
</span></span><span class=line><span class=cl>Multiple R-squared:   0.93,	Adjusted R-squared:  0.9274 
</span></span><span class=line><span class=cl>F-statistic: 364.2 on 7 and 192 DF,  p-value: &lt; 2.2e-16
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; regression &lt;- lm(log(sales) ~ log(radio) + log(tv) + log(radio) * log(tv), data=spending.data) 
</span></span><span class=line><span class=cl>&gt; summary(regression)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl>lm(formula = log(sales) ~ log(radio) + log(tv) + log(radio) * 
</span></span><span class=line><span class=cl>    log(tv), data = spending.data)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residuals:
</span></span><span class=line><span class=cl>     Min       1Q   Median       3Q      Max 
</span></span><span class=line><span class=cl>-0.29435 -0.07741 -0.02310  0.05873  0.59461 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Coefficients:
</span></span><span class=line><span class=cl>                    Estimate Std. Error t value Pr(&gt;|t|)    
</span></span><span class=line><span class=cl>(Intercept)         5.870204   0.104963  55.926  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>log(radio)         -0.108507   0.032403  -3.349 0.000974 ***
</span></span><span class=line><span class=cl>log(tv)             0.184361   0.022818   8.080 6.53e-14 ***
</span></span><span class=line><span class=cl>log(radio):log(tv)  0.057335   0.007097   8.079 6.54e-14 ***
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residual standard error: 0.1142 on 196 degrees of freedom
</span></span><span class=line><span class=cl>Multiple R-squared:  0.9252,	Adjusted R-squared:  0.9241 
</span></span><span class=line><span class=cl>F-statistic: 808.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; spending.data &lt;- spending.data %&gt;% mutate(radio_log_centered = center(log(radio)),
</span></span><span class=line><span class=cl>+                                           tv_log_centered = center(log(tv)), 
</span></span><span class=line><span class=cl>+                                           newspaper_log_centered = center(log(newspaper)),
</span></span><span class=line><span class=cl>+                                           magazines_log_centered = center(log(magazines)),
</span></span><span class=line><span class=cl>+                                           social_media_log_centered = center(log(social_media)),
</span></span><span class=line><span class=cl>+                                           search_ads_log_centered = center(log(search_ads)))
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; regression &lt;- lm(log(sales) ~ radio_log_centered + magazines_log_centered + social_media_log_centered + search_ads_log_centered + tv_log_centered + newspaper_log_centered + radio_log_centered * tv_log_centered, data=spending.data) 
</span></span><span class=line><span class=cl>&gt; summary(regression)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl>lm(formula = log(sales) ~ radio_log_centered + magazines_log_centered + 
</span></span><span class=line><span class=cl>    social_media_log_centered + search_ads_log_centered + tv_log_centered + 
</span></span><span class=line><span class=cl>    newspaper_log_centered + radio_log_centered * tv_log_centered, 
</span></span><span class=line><span class=cl>    data = spending.data)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residuals:
</span></span><span class=line><span class=cl>     Min       1Q   Median       3Q      Max 
</span></span><span class=line><span class=cl>-0.29003 -0.07859 -0.02022  0.04670  0.54257 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Coefficients:
</span></span><span class=line><span class=cl>                                    Estimate Std. Error t value Pr(&gt;|t|)    
</span></span><span class=line><span class=cl>(Intercept)                         7.169892   0.007894 908.260  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>radio_log_centered                  0.155506   0.007395  21.027  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>magazines_log_centered              0.026573   0.013728   1.936   0.0544 .  
</span></span><span class=line><span class=cl>social_media_log_centered           0.029733   0.013181   2.256   0.0252 *  
</span></span><span class=line><span class=cl>search_ads_log_centered            -0.034111   0.014086  -2.422   0.0164 *  
</span></span><span class=line><span class=cl>tv_log_centered                     0.343443   0.012150  28.267  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>newspaper_log_centered             -0.007208   0.015271  -0.472   0.6375    
</span></span><span class=line><span class=cl>radio_log_centered:tv_log_centered  0.058409   0.006992   8.354  1.3e-14 ***
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residual standard error: 0.1116 on 192 degrees of freedom
</span></span><span class=line><span class=cl>Multiple R-squared:   0.93,	Adjusted R-squared:  0.9274 
</span></span><span class=line><span class=cl>F-statistic: 364.2 on 7 and 192 DF,  p-value: &lt; 2.2e-16
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>&gt; regression &lt;- lm(log(sales) ~ radio_log_centered + tv_log_centered + radio_log_centered * tv_log_centered, data=spending.data) 
</span></span><span class=line><span class=cl>&gt; summary(regression)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl>lm(formula = log(sales) ~ radio_log_centered + tv_log_centered + 
</span></span><span class=line><span class=cl>    radio_log_centered * tv_log_centered, data = spending.data)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residuals:
</span></span><span class=line><span class=cl>     Min       1Q   Median       3Q      Max 
</span></span><span class=line><span class=cl>-0.29435 -0.07741 -0.02310  0.05873  0.59461 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Coefficients:
</span></span><span class=line><span class=cl>                                   Estimate Std. Error t value Pr(&gt;|t|)    
</span></span><span class=line><span class=cl>(Intercept)                        7.169879   0.008074 888.050  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>radio_log_centered                 0.159367   0.007374  21.611  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>tv_log_centered                    0.342059   0.008256  41.429  &lt; 2e-16 ***
</span></span><span class=line><span class=cl>radio_log_centered:tv_log_centered 0.057335   0.007097   8.079 6.54e-14 ***
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Residual standard error: 0.1142 on 196 degrees of freedom
</span></span><span class=line><span class=cl>Multiple R-squared:  0.9252,	Adjusted R-squared:  0.9241 
</span></span><span class=line><span class=cl>F-statistic: 808.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></td></tr></table></div></div><h2 id=32-compare-groups>3.2 Compare groups</h2><h3 id=321-import-and-check-data>3.2.1 import and check data</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>ad</span><span class=o>.</span><span class=n>df</span> <span class=o>&lt;-</span> <span class=n>read</span><span class=o>.</span><span class=n>csv</span><span class=p>(</span><span class=s2>&#34;8_clickstream.csv&#34;</span><span class=p>,</span> <span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=n>TRUE</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>summary</span><span class=p>(</span><span class=n>ad</span><span class=o>.</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>visit_date</span>      <span class=n>condition</span>     <span class=n>time_spent_homepage_sec</span> <span class=n>clicked_article</span> 
</span></span><span class=line><span class=cl> <span class=mi>13</span><span class=o>/</span><span class=mi>04</span><span class=o>/</span><span class=mi>2020</span><span class=p>:</span> <span class=mi>1045</span>   <span class=n>quality</span><span class=p>:</span><span class=mi>15000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>46.10</span>           <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>0.0000</span>  
</span></span><span class=line><span class=cl> <span class=mi>23</span><span class=o>/</span><span class=mi>04</span><span class=o>/</span><span class=mi>2020</span><span class=p>:</span> <span class=mi>1042</span>   <span class=n>taste</span>  <span class=p>:</span><span class=mi>15000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>49.32</span>           <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>0.0000</span>  
</span></span><span class=line><span class=cl> <span class=mi>02</span><span class=o>/</span><span class=mi>04</span><span class=o>/</span><span class=mi>2020</span><span class=p>:</span> <span class=mi>1038</span>                   <span class=n>Median</span> <span class=p>:</span><span class=mf>50.00</span>           <span class=n>Median</span> <span class=p>:</span><span class=mf>1.0000</span>  
</span></span><span class=line><span class=cl> <span class=mi>31</span><span class=o>/</span><span class=mi>03</span><span class=o>/</span><span class=mi>2020</span><span class=p>:</span> <span class=mi>1033</span>                   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>50.00</span>           <span class=n>Mean</span>   <span class=p>:</span><span class=mf>0.6054</span>  
</span></span><span class=line><span class=cl> <span class=mi>15</span><span class=o>/</span><span class=mi>04</span><span class=o>/</span><span class=mi>2020</span><span class=p>:</span> <span class=mi>1031</span>                   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>50.67</span>           <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>1.0000</span>  
</span></span><span class=line><span class=cl> <span class=mi>27</span><span class=o>/</span><span class=mi>04</span><span class=o>/</span><span class=mi>2020</span><span class=p>:</span> <span class=mi>1029</span>                   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>54.02</span>           <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0000</span>  
</span></span><span class=line><span class=cl> <span class=p>(</span><span class=n>Other</span><span class=p>)</span>   <span class=p>:</span><span class=mi>23782</span>                                                           
</span></span><span class=line><span class=cl>  <span class=n>clicked_like</span>    <span class=n>clicked_share</span>    
</span></span><span class=line><span class=cl> <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>0.0000</span>   <span class=n>Min</span><span class=o>.</span>   <span class=p>:</span><span class=mf>0.00000</span>  
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>0.0000</span>   <span class=mi>1</span><span class=n>st</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>0.00000</span>  
</span></span><span class=line><span class=cl> <span class=n>Median</span> <span class=p>:</span><span class=mf>0.0000</span>   <span class=n>Median</span> <span class=p>:</span><span class=mf>0.00000</span>  
</span></span><span class=line><span class=cl> <span class=n>Mean</span>   <span class=p>:</span><span class=mf>0.1177</span>   <span class=n>Mean</span>   <span class=p>:</span><span class=mf>0.03143</span>  
</span></span><span class=line><span class=cl> <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>0.0000</span>   <span class=mi>3</span><span class=n>rd</span> <span class=n>Qu</span><span class=o>.</span><span class=p>:</span><span class=mf>0.00000</span>  
</span></span><span class=line><span class=cl> <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.0000</span>   <span class=n>Max</span><span class=o>.</span>   <span class=p>:</span><span class=mf>1.00000</span>  
</span></span><span class=line><span class=cl>                                   
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>str</span><span class=p>(</span><span class=n>ad</span><span class=o>.</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;data.frame&#39;</span><span class=p>:</span>	<span class=mi>30000</span> <span class=n>obs</span><span class=o>.</span> <span class=n>of</span>  <span class=mi>6</span> <span class=n>variables</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>visit_date</span>             <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>30</span> <span class=n>levels</span> <span class=s2>&#34;01/04/2020&#34;</span><span class=p>,</span><span class=s2>&#34;02/04/2020&#34;</span><span class=p>,</span><span class=o>..</span><span class=p>:</span> <span class=mi>30</span> <span class=mi>30</span> <span class=mi>30</span> <span class=mi>30</span> <span class=mi>30</span> <span class=mi>30</span> <span class=mi>30</span> <span class=mi>30</span> <span class=mi>30</span> <span class=mi>30</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>condition</span>              <span class=p>:</span> <span class=n>Factor</span> <span class=n>w</span><span class=o>/</span> <span class=mi>2</span> <span class=n>levels</span> <span class=s2>&#34;quality&#34;</span><span class=p>,</span><span class=s2>&#34;taste&#34;</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>time_spent_homepage_sec</span><span class=p>:</span> <span class=n>num</span>  <span class=mi>49</span> <span class=mf>48.9</span> <span class=mf>49.1</span> <span class=mf>49.3</span> <span class=mf>50.4</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>clicked_article</span>        <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>0</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>clicked_like</span>           <span class=p>:</span> <span class=ne>int</span>  <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>clicked_share</span>          <span class=p>:</span> <span class=ne>int</span>  <span class=mi>1</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>ad</span><span class=o>.</span><span class=n>df</span><span class=o>$</span><span class=n>clicked_article</span> <span class=o>&lt;-</span> <span class=n>factor</span><span class=p>(</span><span class=n>ad</span><span class=o>.</span><span class=n>df</span><span class=o>$</span><span class=n>clicked_article</span><span class=p>,</span> <span class=n>ordered</span> <span class=o>=</span> <span class=n>FALSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>ad</span><span class=o>.</span><span class=n>df</span><span class=o>$</span><span class=n>clicked_like</span> <span class=o>&lt;-</span> <span class=n>factor</span><span class=p>(</span><span class=n>ad</span><span class=o>.</span><span class=n>df</span><span class=o>$</span><span class=n>clicked_like</span><span class=p>,</span> <span class=n>ordered</span> <span class=o>=</span> <span class=n>FALSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>ad</span><span class=o>.</span><span class=n>df</span><span class=o>$</span><span class=n>clicked_share</span> <span class=o>&lt;-</span> <span class=n>factor</span><span class=p>(</span><span class=n>ad</span><span class=o>.</span><span class=n>df</span><span class=o>$</span><span class=n>clicked_share</span><span class=p>,</span> <span class=n>ordered</span> <span class=o>=</span> <span class=n>FALSE</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=322-descriptives-by-group>3.2.2 Descriptives by group</h3><h4 id=3221-seconds-spent-vary-for-two-versions-of-ads>3.2.2.1 seconds spent vary for two versions of ads.</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&gt;</span> <span class=c1># seconds spent vary for two versions of ads.</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>aggregate</span><span class=p>(</span><span class=n>time_spent_homepage_sec</span> <span class=o>~</span> <span class=n>condition</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>ad</span><span class=o>.</span><span class=n>df</span><span class=p>,</span> <span class=n>mean</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>condition</span> <span class=n>time_spent_homepage_sec</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=n>quality</span>                <span class=mf>49.99489</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>     <span class=n>taste</span>                <span class=mf>49.99909</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=3222-the-frequency-with-which-different-combinations-of-condition-and-like-occur>3.2.2.2 the frequency with which different combinations of condition and like occur</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; table(ad.df$condition, ad.df$clicked_article)
</span></span><span class=line><span class=cl>         
</span></span><span class=line><span class=cl>             0    1
</span></span><span class=line><span class=cl>  quality 5873 9127
</span></span><span class=line><span class=cl>  taste   5965 9035
</span></span><span class=line><span class=cl>&gt; table(ad.df$condition, ad.df$clicked_like)
</span></span><span class=line><span class=cl>         
</span></span><span class=line><span class=cl>              0     1
</span></span><span class=line><span class=cl>  quality 13964  1036
</span></span><span class=line><span class=cl>  taste   12506  2494
</span></span><span class=line><span class=cl>&gt; table(ad.df$condition, ad.df$clicked_share)
</span></span><span class=line><span class=cl>         
</span></span><span class=line><span class=cl>              0     1
</span></span><span class=line><span class=cl>  quality 14550   450
</span></span><span class=line><span class=cl>  taste   14507   493
</span></span></code></pre></td></tr></table></div></div><h3 id=323-visualization-by-group>3.2.3 Visualization by group</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; histogram(~ clicked_article | condition, data = ad.df)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_24.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; histogram(~ clicked_like | condition, data = ad.df)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_25.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; histogram(~ clicked_share | condition, data = ad.df)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_26.png %}</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; ad.mean &lt;- aggregate(time_spent_homepage_sec ~ condition, data = ad.df, mean) 
</span></span><span class=line><span class=cl>&gt; barchart(time_spent_homepage_sec ~ condition, data = ad.mean, col = &#34;grey&#34;)
</span></span></code></pre></td></tr></table></div></div><p>{% asset_image final_27.png %}</p><h3 id=324-statistical-tests>3.2.4 Statistical tests</h3><h4 id=3241-chisptest>3.2.4.1 chisp.test()</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; # chisp.test()
</span></span><span class=line><span class=cl>&gt; chisq.test(table(ad.df$clicked_article, ad.df$condition))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data:  table(ad.df$clicked_article, ad.df$condition)
</span></span><span class=line><span class=cl>X-squared = 1.1555, df = 1, p-value = 0.2824
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; chisq.test(table(ad.df$clicked_like, ad.df$condition))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data:  table(ad.df$clicked_like, ad.df$condition)
</span></span><span class=line><span class=cl>X-squared = 681.57, df = 1, p-value &lt; 2.2e-16
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; chisq.test(table(ad.df$clicked_share, ad.df$condition))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data:  table(ad.df$clicked_share, ad.df$condition)
</span></span><span class=line><span class=cl>X-squared = 1.9313, df = 1, p-value = 0.1646
</span></span></code></pre></td></tr></table></div></div><h4 id=3242-ttest>3.2.4.2 t.test()</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; # t.test()
</span></span><span class=line><span class=cl>&gt; t.test(time_spent_homepage_sec ~ condition, data = ad.df)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	Welch Two Sample t-test
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data:  time_spent_homepage_sec by condition
</span></span><span class=line><span class=cl>t = -0.36288, df = 29997, p-value = 0.7167
</span></span><span class=line><span class=cl>alternative hypothesis: true difference in means between group quality and group taste is not equal to 0
</span></span><span class=line><span class=cl>95 percent confidence interval:
</span></span><span class=line><span class=cl> -0.02691480  0.01850573
</span></span><span class=line><span class=cl>sample estimates:
</span></span><span class=line><span class=cl>mean in group quality   mean in group taste 
</span></span><span class=line><span class=cl>             49.99489              49.99909
</span></span></code></pre></td></tr></table></div></div><h4 id=3243-anova>3.2.4.3 anova</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; ad.aov.con &lt;- aov(time_spent_homepage_sec ~ condition, data = ad.df)
</span></span><span class=line><span class=cl>&gt; anova(ad.aov.con)
</span></span><span class=line><span class=cl>Analysis of Variance Table
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Response: time_spent_homepage_sec
</span></span><span class=line><span class=cl>             Df  Sum Sq Mean Sq F value Pr(&gt;F)
</span></span><span class=line><span class=cl>condition     1     0.1 0.13259  0.1317 0.7167
</span></span><span class=line><span class=cl>Residuals 29998 30204.2 1.00687
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/r%E8%AF%AD%E8%A8%80/>RËØ≠Ë®Ä</a>
<a href=/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/>Êï∞ÊçÆÂàÜÊûê</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/rweek9-managing-resource-trade-offs-ii-code/><div class=article-details><h2 class=article-title>R[week9] Managing Resource Trade-Offs II Code</h2></div></a></article><article><a href=/p/rweek8-managing-resource-trade-offs-code/><div class=article-details><h2 class=article-title>R[week8] Managing Resource Trade-Offs Code</h2></div></a></article><article><a href=/p/rweek8-managing-resource-trade-offs/><div class=article-details><h2 class=article-title>R[week8] Managing Resource Trade-Offs</h2></div></a></article><article><a href=/p/rweek7-managing-sustainable-competitive-advantage-code-ii/><div class=article-details><h2 class=article-title>R[week7] Managing Sustainable Competitive Advantage code II</h2></div></a></article><article><a href=/p/rweek7-managing-sustainable-competitive-advantage-lecture-ii/><div class=article-details><h2 class=article-title>R[week7] Managing Sustainable Competitive Advantage lecture II</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//weasley.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Kunkka</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>