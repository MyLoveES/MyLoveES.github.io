[{"content":"è¤èœ çº¢çƒ§æ’éª¨ è¥¿çº¢æŸ¿ç‚’é¸¡è›‹ è¥¿è‘«èŠ¦ç‚’è›‹ ç´ èœ çº¢çƒ§èŒ„å­ æ±¤ å†¬ç“œæ’éª¨æ±¤ å‡‰èœ å‡‰æ‹Œè‹¦èŠ ä¸»é£Ÿ æš‚æ— å†…å®¹\nå¤–å– æš‚æ— å†…å®¹\n","date":"2025-09-07T23:38:00Z","permalink":"https://MyLoveES.github.io/p/god-of-cookery-home-edition/","title":"God of Cookery - Home Edition"},{"content":"Immich 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 # # WARNING: To install Immich, follow our guide: https://immich.app/docs/install/docker-compose # # Make sure to use the docker-compose.yml of the current release: # # https://github.com/immich-app/immich/releases/latest/download/docker-compose.yml # # The compose file on main may not be compatible with the latest release. name: immich services: immich-server: container_name: immich_server image: ghcr.io/immich-app/immich-server:v1.135.3 # extends: # file: hwaccel.transcoding.yml # service: cpu # set to one of [nvenc, quicksync, rkmpp, vaapi, vaapi-wsl] for accelerated transcoding volumes: # Do not edit the next line. If you want to change the media storage location on your system, edit the value of UPLOAD_LOCATION in the .env file - /share/Container/container-station-data/application/immich/server/library:/usr/src/app/upload - /share/CACHEDEV1_DATA/Weasley/Pictures:/external/Weasley/Pictures:ro - /etc/localtime:/etc/localtime:ro environment: - TZ=Asia/Shanghai - DB_USERNAME=postgres - DB_PASSWORD=postgres - DB_DATABASE_NAME=immich ports: - \u0026#39;2283:2283\u0026#39; depends_on: - redis - database networks: - immich restart: always healthcheck: disable: false immich-machine-learning: container_name: immich_machine_learning # For hardware acceleration, add one of -[armnn, cuda, rocm, openvino, rknn] to the image tag. # Example tag: ${IMMICH_VERSION:-release}-cuda image: ghcr.io/immich-app/immich-machine-learning:v1.135.3 # extends: # uncomment this section for hardware acceleration - see https://immich.app/docs/features/ml-hardware-acceleration # file: hwaccel.ml.yml # service: cpu # set to one of [armnn, cuda, rocm, openvino, openvino-wsl, rknn] for accelerated inference - use the `-wsl` version for WSL2 where applicable volumes: - /share/Container/container-station-data/application/immich/machine_learning/model_cache:/cache restart: always networks: - immich healthcheck: disable: false redis: container_name: immich_redis image: docker.io/valkey/valkey:8-bookworm networks: - immich healthcheck: test: redis-cli ping || exit 1 restart: always database: container_name: immich_postgres image: ghcr.io/immich-app/postgres:14-vectorchord0.4.3-pgvectors0.2.0 environment: POSTGRES_PASSWORD: postgres POSTGRES_USER: postgres POSTGRES_DB: immich POSTGRES_INITDB_ARGS: \u0026#39;--data-checksums\u0026#39; # Uncomment the DB_STORAGE_TYPE: \u0026#39;HDD\u0026#39; var if your database isn\u0026#39;t stored on SSDs # DB_STORAGE_TYPE: \u0026#39;HDD\u0026#39; networks: - immich volumes: # Do not edit the next line. If you want to change the database storage location on your system, edit the value of DB_DATA_LOCATION in the .env file - /share/Container/container-station-data/application/immich/Postgres/data:/var/lib/postgresql/data restart: always volumes: model-cache: networks: immich: 1. æ¨¡å‹ä¸‹è½½ NASä¸Šç”±äºç½‘ç»œé—®é¢˜ï¼Œæ— æ³•ä»hfä¸ŠåŠ è½½å¯¹åº”çš„æ¨¡å‹ï¼Œéœ€è¦å…ˆä¸‹è½½åˆ°æœ¬åœ°ï¼Œå†æ‰‹åŠ¨ä¸Šä¼ åˆ°NASã€‚\n1 2 3 4 5 6 7 8 9 # ä¸‹è½½æ¨¡å‹ https://huggingface.co/immich-app ## buffalo_l ç”¨äºäººè„¸è¯†åˆ« huggingface-cli download immich-app/buffalo_l --local-dir immich-app-buffalo_l ## XLM-Roberta-Large-Vit-B-16Plusç”¨äºæ™ºèƒ½æœç´¢ huggingface-cli download immich-app/XLM-Roberta-Large-Vit-B-16Plus --local-dir immich-app-XLM-Roberta-Large-Vit-B-16Plus NASä¸Šæ¨¡å‹ç›®å½•ç»“æ„\n1 2 3 4 5 6 7 8 9 10 11 12 . |____model_cache | |____clip | | |____XLM-Roberta-Large-Vit-B-16Plus | | | |____textual | | | |____visual | | | |____.cache | |____facial-recognition | | |____buffalo_l | | | |____recognition | | | |____.cache | | | |____detection 2. immich é…ç½® ","date":"2025-07-07T00:00:00Z","permalink":"https://MyLoveES.github.io/p/disconas-immich/","title":"DiscoNAS Immich"},{"content":"Media Library 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 version: \u0026#34;3\u0026#34; services: jellyfin: image: nyanmisaka/jellyfin:250627-amd64 container_name: media_library_jellyfin environment: - PUID=0 - PGID=0 - TZ=Asia/Shanghai volumes: - /share/CACHEDEV1_DATA/Container/container-station-data/application/media_library/jellyfin/config:/config - /share/CACHEDEV1_DATA/Container/container-station-data/application/media_library/jellyfin/cache:/cache - /share/CACHEDEV1_DATA/Weasley/Videos/:/videos ports: - 8096:8096 - 8920:8920 devices: - /dev/dri:/dev/dri restart: unless-stopped nastool: # image: hsuyelin/nas-tools:3.4.1 image: razeencheng/nastool:2.9.1 container_name: media_library_nastool environment: - PUID=0 - PGID=0 - UMASK=000 - TZ=Asia/Shanghai - NASTOOL_AUTO_UPDATE=false - REPO_URL=https://ghproxy.com/https://github.com/hsuyelin/nas-tools.git # - ALPINE_MIRROR=mirrors.ustc.edu.cn # - LANG=C.UTF-8 # - NASTOOL_AUTO_UPDATE=false # - NASTOOL_CN_UPDATE=false # - NASTOOL_CONFIG=/config/config.yaml # - NASTOOL_VERSION=master # - PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin # - PYPI_MIRROR=https://pypi.tuna.tsinghua.edu.cn/simple # - REPO_URL=https://github.com/jxxghp/nas-tools.git # - WORKDIR=/nas-tools volumes: - /share/CACHEDEV1_DATA/Container/container-station-data/application/media_library/nastool/config:/config - /share/CACHEDEV1_DATA/Weasley/Videos/:/videos ports: - 3000:3000 restart: unless-stopped jackett: image: linuxserver/jackett:amd64-0.22.2132 container_name: media_library_jackett volumes: - /share/CACHEDEV1_DATA/Container/container-station-data/application/media_library/jackett/config:/config - /share/CACHEDEV1_DATA/Container/container-station-data/application/media_library/jackett/downloads:/downloads environment: - PUID=1000 - PGID=1000 - TZ=Asia/Shanghai - AUTO_UPDATE=true # - HOME=/root # - LSIO_FIRST_PARTY=true # - PATH=/lsiopy/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin # - S6_CMD_WAIT_FOR_SERVICES_MAXTIME=0 # - S6_STAGE2_HOOK=/docker-mods # - S6_VERBOSITY=1 # - TERM=xterm # - VIRTUAL_ENV=/lsiopy # - XDG_CONFIG_HOME=/config # - XDG_DATA_HOME=/config ports: - 9117:9117 restart: unless-stopped qBittorrent: image: superng6/qbittorrentee:5.1.1.10 container_name: media_library_qBittorrent environment: - PUID=1026 - PGID=100 - TZ=Asia/Shanghai - WEBUIPORT=8080 - ENABLE_DOWNLOADS_PERM_FIX=true restart: unless-stopped volumes: - /share/CACHEDEV1_DATA/Container/container-station-data/application/media_library/qBittorrent/config:/config - /share/CACHEDEV1_DATA/Weasley/Videos/:/downloads ports: - 8080:8080 - 26881:6881 - 26881:6881/udp 1. qBittorrent é»˜è®¤è´¦å·ï¼šadmin é»˜è®¤å¯†ç ï¼šéœ€è¦æŸ¥çœ‹ qBittorrent å®¹å™¨æ—¥å¿— 1.1 ä¿®æ”¹å¯†ç  1.2 ä¿®æ”¹ç«¯å£å· 1.3 ä¿®æ”¹ä¸‹è½½è·¯å¾„ 1.4 ä¿®æ”¹è¯­è¨€ 1.5 æ·»åŠ åˆ†ç±» 2. Jackett 2.1 è®°ä½ API KEY åé¢éœ€è¦é…ç½®åˆ° NASTOOL ä¸­\n2.2 æ·»åŠ å…¬å¼€çš„ INDEXER éœ€è¦ç­‰å¾…å‡ åˆ†é’Ÿï¼Œæ‰èƒ½æ·»åŠ å®Œ\n3. Jellyfin 3.1 æ·»åŠ åª’ä½“åº“ é€‰æ‹© NASTOOL é“¾æ¥åçš„ç›®å½• 3.2 ç”ŸæˆAPIå¯†é’¥ åé¢ç»™ NASTOOL ç”¨\n3.3 æŒ‡å®šè½¬ç  4. NASTOOL 4.1 TMDB https://www.themoviedb.org/\n4.2 åª’ä½“åº“ æ³¨æ„è¦ç”¨NASTOOLé“¾æ¥åçš„ç›®å½• 4.3 ç›®å½•åŒæ­¥ ä» ä¸‹è½½ç›®å½• åˆ° è½¬æ¢åçš„ç›®å½• 4.4 ç´¢å¼•å™¨ 4.5 ä¸‹è½½å™¨ 4.6 åª’ä½“æ’­æ”¾å™¨ 4.7 æœåŠ¡ å¯ä»¥æ‰‹åŠ¨ç›®å½•åŒæ­¥ï¼Œæˆ–è€…æ¸…ç†ç¼“å­˜ ","date":"2025-06-07T00:00:00Z","permalink":"https://MyLoveES.github.io/p/disconas-media-library/","title":"DiscoNAS Media Library"},{"content":"æ—¥æœ¬å…³è¥¿ï¼šäº¬éƒ½ä¸å¤§é˜ª å¤§å®¶å¥½ï¼Œä»Šå¤©æƒ³è·Ÿå¤§å®¶èŠèŠæˆ‘ä¹‹å‰å»æ—¥æœ¬äº¬éƒ½å’Œå¤§é˜ªç©çš„ä¸€äº›ä½“éªŒã€‚æ•´ä½“æ„Ÿè§‰æŒºèˆ’æœçš„ï¼Œä¸¤ä¸ªåŸå¸‚é£æ ¼å¾ˆä¸åŒï¼Œä¸€ä¸ªå®‰é™æœ‰å¤éŸµï¼Œä¸€ä¸ªçƒ­é—¹å……æ»¡æ´»åŠ›ï¼Œè€Œä¸”äº¤é€šã€åƒå–éƒ½ç‰¹åˆ«æ–¹ä¾¿ã€‚æˆ‘å°±æŒ‰æˆ‘ä»¬èµ°çš„é¡ºåºï¼Œè·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹æ—…ç¨‹ã€‚\nğŸš‰ äº¬éƒ½ï¼šèµ°èµ°åœåœçš„æ…¢æ—¶å…‰ æ¸…æ°´å¯º æ¸…æ°´å¯ºä½œä¸ºæ—¥æœ¬æœ€å…·ä»£è¡¨æ€§çš„ä½›æ•™å¤å¯ºä¹‹ä¸€ï¼Œå†å²å¯è¿½æº¯è‡³å…¬å…ƒ778å¹´ã€‚å¯ºåº™ä¾›å¥‰çš„æ˜¯åƒæ‰‹è§‚éŸ³ï¼Œè€Œé¾™åœ¨ä½›æ•™ä¸­å¸¸è¢«è§†ä¸ºå®ˆæŠ¤ç¥å…½ï¼Œé•‡å®ˆå±±é—¨ï¼Œé©±é‚ªé¿ç¾ã€‚ æ¸…æ°´èˆå° äº¬éƒ½çš„æ ‡å¿—ä¹‹ä¸€ã€‚æ‚¬ç©ºçš„å¤§æœ¨å°ï¼ˆå«â€œæ¸…æ°´èˆå°â€ï¼‰çœŸçš„å¾ˆç‰¹åˆ«ï¼Œæ˜¯å¤äººç”¨æœ¨å¤´å·§å¦™æ­å»ºèµ·æ¥çš„ï¼Œæ²¡ç”¨é’‰å­ï¼Œç«™åœ¨ä¸Šé¢çœ‹ä¸‹é¢çš„æ™¯è‰²ï¼Œè§†é‡éå¸¸å¼€é˜”ï¼Œèƒ½çœ‹åˆ°å¤§åŠä¸ªäº¬éƒ½ã€‚æˆ‘ä»¬å»çš„æ—¶å€™è™½ç„¶ä¸æ˜¯æ¨±èŠ±æˆ–çº¢å¶å­£ï¼Œä½†æ»¡çœ¼çš„ç»¿è‰²ä¹Ÿå¾ˆå…»çœ¼ã€‚æ„Ÿè§‰å®ƒå—æ¬¢è¿ï¼Œä¸€æ˜¯å› ä¸ºå†å²æ‚ ä¹…ã€å»ºç­‘ç‹¬ç‰¹ï¼ŒäºŒæ˜¯å› ä¸ºæ™¯è‰²ç¡®å®å¥½ï¼Œæ‹ç…§ä¹Ÿå¥½çœ‹ã€‚\nå¦å¤–ï¼Œè¿™ä¹Ÿæ˜¯æƒ…ä¾£ç…§åæ‰“å¡åœ°ï¼Œå› ä¸ºã€Šåä¾¦æ¢æŸ¯å—ã€‹é‡Œæ–°å…°å‡ºç°è¿‡è¿™é‡Œã€‚\nå‡Œäº‘ä¹‹é¾™ é€ å‹æ°”åŠ¿ç£…ç¤´ã€æå¯ŒåŠ¨æ„Ÿï¼ŒæƒåŠ›çš„è±¡å¾ã€‚\nã€ŒéŸ³ç¾½ç€‘å¸ƒã€ æ¥æ°´ç¥ˆç¦ã€‚\näºŒã€ä¸‰å¹´å‚ äºŒå¹´å‚ä¸ä¸‰å¹´å‚æ˜¯äº¬éƒ½æ¸…æ°´å¯ºé€šå¾€è¡—é“çš„ä¸¤æ¡ä¼ ç»Ÿå¡é“ï¼Œä»¥å¤è‰²å¤é¦™çš„çŸ³æ¿è·¯ã€å’Œé£èŒ¶å±‹ä¸æ‰‹å·¥åº—é“ºé—»åï¼Œæ˜¯ä½“éªŒäº¬éƒ½å¤éƒ½é£æƒ…çš„çƒ­é—¨æ­¥è¡Œè¡—ã€‚ä¼ è¯´ä¸­åœ¨ä¸‰å¹´å‚è·Œå€’ä¼šæœ‰ä¸‰å¹´å„è¿ï¼Œä¹Ÿä¸ºå…¶å¢æ·»ä¸€ä¸ç¥ç§˜è‰²å½©ã€‚\nä¼è§ç¨»è·å¤§ç¤¾ ä¼è§ç¨»è·å¤§ç¤¾æ˜¯ä½äºäº¬éƒ½çš„è‘—åç¥ç¤¾ï¼Œä»¥æ•°åƒåº§æœ±çº¢è‰²é¸Ÿå±…æ„æˆçš„â€œåƒæœ¬é¸Ÿå±…â€é—»åï¼Œä¾›å¥‰æŒç®¡äº”è°·ä¸°ç™»ä¸å•†ä¸šç¹è£çš„ç¨»è·ç¥ï¼Œæ˜¯æ—¥æœ¬æœ€å—æ¬¢è¿çš„å‚æ‹œèƒœåœ°ä¹‹ä¸€ã€‚ åƒæœ¬é¸Ÿå±… è¿™ä¸ªç¥ç¤¾æœ€ç‰¹åˆ«çš„å°±æ˜¯é‚£æ¡é•¿é•¿çš„â€œåƒæœ¬é¸Ÿå±…â€äº†ã€‚ä¸€åº§æ¥ä¸€åº§çš„çº¢è‰²é¸Ÿå±…æ²¿ç€å±±è·¯å¾€ä¸Šæ’ï¼Œå½¢æˆäº†ä¸€æ¡æœ›ä¸åˆ°å¤´çš„çº¢è‰²é€šé“ã€‚èµ°è¿›å»æ„Ÿè§‰æŒºç¥å¥‡çš„ï¼Œè¶Šå¾€å±±ä¸Šèµ°äººè¶Šå°‘ï¼Œä¹Ÿè¶Šå®‰é™ã€‚çˆ¬åˆ°ä¸€åŠå›å¤´çœ‹ï¼Œè¿˜èƒ½çœ‹åˆ°äº¬éƒ½çš„åŸå¸‚é£æ™¯ã€‚æ¯ä¸ªé¸Ÿå±…åé¢éƒ½å†™ç€æèµ è€…çš„åå­—å’Œå¿ƒæ„¿ï¼ŒæŒºæœ‰æ„æ€çš„ã€‚\nè¿™é‡Œæ‹ç…§ç¡®å®å¥½çœ‹ï¼Œç”µå½±ã€Šè‰ºä¼å›å¿†å½•ã€‹ä¹Ÿåœ¨è¿™é‡Œå–è¿‡æ™¯ã€‚\nç™»é¡¶ï¼Œéå¸¸ç®€é™‹çš„æ‰“å¡ç‚¹\nä½¿è€… ç‹ç‹¸ ç‹ç‹¸å› å…¶å¸¸å‡ºæ²¡äºç”°é—´åœ°å¤´ï¼Œè¢«è®¤ä¸ºæ˜¯ç¨»è·ç¥çš„â€œç¥ä½¿â€ã€‚ç›¸ä¼ ç‹ç‹¸æ‹¥æœ‰ç¥ç§˜åŠ›é‡ï¼Œèƒ½ç©¿æ¢­é˜´é˜³ç•Œï¼Œå¸®åŠ©ä¼ è¾¾ç¥è°•ã€é©±é‚ªä¿å¹³å®‰ã€‚å› æ­¤ç¥ç¤¾å†…å¸¸è§æ‰‹æŒé’¥åŒ™ã€å®ç ã€å·è½´ã€ç¨»ç©—çš„ç‹ç‹¸åƒã€‚\né¸­å· \u0026amp; å…«å‚ç¥ç¤¾ å‚æ™šåœ¨é¸­å·è¾¹æ•£æ­¥æ˜¯æˆ‘ä»¬åœ¨äº¬éƒ½æœ€æ”¾æ¾çš„æ—¶åˆ»ä¹‹ä¸€ã€‚æ²³æ°´å¾ˆå¹²å‡€ï¼Œä¸¤è¾¹ä¿®äº†å¾ˆå®½çš„æ­¥è¡Œé“ã€‚å½“åœ°äººä¸‰ä¸‰ä¸¤ä¸¤åœ°ååœ¨æ²³è¾¹çš„çŸ³é˜¶ä¸Šï¼ŒèŠå¤©ã€çœ‹é£æ™¯ã€ç­‰æ—¥è½ï¼Œæ„Ÿè§‰ç‰¹åˆ«ç”Ÿæ´»åŒ–ï¼ŒèŠ‚å¥å¾ˆæ…¢ã€‚\næ²¿ç€é¸­å·èµ°ä¸è¿œå°±æ˜¯å…«å‚ç¥ç¤¾ã€‚è¿™ä¸ªç¥ç¤¾å¥½åƒå¤§é—¨ä¸€ç›´å¼€ç€ï¼Œç™½å¤©æŒºçƒ­é—¹ï¼Œæ™šä¸Šå»å°±å®‰é™å¤šäº†ï¼Œç¯ç¬¼ç‚¹èµ·æ¥ï¼Œæ°›å›´å¾ˆå®é™ï¼Œè·Ÿç™½å¤©å¾ˆä¸ä¸€æ ·ã€‚\nå…«å‚ç¥ç¤¾æ˜¯äº¬éƒ½æœ€é‡è¦çš„ç¥ç¤¾ä¹‹ä¸€ï¼Œä½äºç¥‡å›­åœ°åŒºï¼Œä»¥ç¥ˆæ±‚å„é™¤ã€å¥åº·ä¸è‰¯ç¼˜é—»åï¼Œä¹Ÿæ˜¯æ¯å¹´ç¥‡å›­ç¥­çš„ä¸»åŠç¥ç¤¾ï¼Œæ·±å—å½“åœ°äººå’Œæ¸¸å®¢å–œçˆ±ã€‚ é‡‘é˜å¯º é‡‘é˜å¯ºï¼ˆæ­£å¼åç§°ä¸ºé¹¿è‹‘å¯ºï¼‰æ˜¯äº¬éƒ½è‘—åçš„ä¸–ç•Œæ–‡åŒ–é—äº§ï¼Œä»¥å…¶å¤–å¢™è´´æ»¡é‡‘ç®”çš„åä¸½ä¸‰é‡æ¥¼é˜å€’æ˜ åœ¨é•œæ¹–æ± ä¸­çš„ç»ç¾æ™¯è‰²è€Œé—»åï¼Œè±¡å¾ç€æ—¥æœ¬å®¤ç”ºæ—¶ä»£çš„æè‡´å®¡ç¾ä¸æƒåŠ›è£è€€ã€‚ åŒæ ·ï¼ŒæŸ¯å—ä¸­ä¹Ÿæœ‰å®ƒçš„èº«å½±\nå¾¡å®ˆ è™½é—¨ç¥¨é™„èµ \nç™½è›‡å†¢ æˆ‘ç§°ä¹‹ä¸º é›·å³°å¡”äº¬éƒ½åˆ†å¡”=MINIç‰ˆ\nè´µèˆ¹ç¥ç¤¾ å¦‚æœè§‰å¾—å¸‚åŒºäººå¤šï¼Œå¯ä»¥æŠ½åŠå¤©å»åŒ—è¾¹çš„è´µèˆ¹ç¥ç¤¾ï¼Œèº²ä¸ªæ¸…å‡€ã€‚å®ƒè—åœ¨å±±é‡Œï¼Œä¸€è·¯ç»¿æ ‘æˆè«ï¼Œå¤å¤©å»ç‰¹åˆ«å‡‰å¿«ã€‚æœ€å¸å¼•äººçš„æ˜¯å…¥å£é‚£æ¡çŸ³é˜¶è·¯ï¼Œä¸¤è¾¹æ’æ»¡äº†çº¢ç¯ç¬¼ï¼Œå‚æ™šäº®ç¯æ—¶æˆ–è€…é›¨å¤©ï¼Œæ°›å›´æ„Ÿç‰¹åˆ«å¥½ï¼Œå¾ˆé€‚åˆæ‹ç…§ã€‚\nè¿™é‡Œæ®è¯´æ±‚å§»ç¼˜æŒºçµçš„ï¼Œè¿˜å¯ä»¥ç©ä¸€ç§â€œæ°´å åœâ€ï¼Œç­¾çº¸æ”¾æ°´é‡Œä¼šæ˜¾å‡ºå­—æ¥ã€‚\näº¬éƒ½è½¦ç«™ äº¬éƒ½è½¦ç«™æœ¬èº«ä¹ŸæŒºæœ‰çœ‹å¤´çš„ï¼Œæ˜¯ä¸ªå¾ˆç°ä»£çš„å¤§å»ºç­‘ã€‚é‡Œé¢ä»€ä¹ˆéƒ½æœ‰ï¼šå•†åº—ã€é¤å…ã€è¿˜æœ‰ä¸ªå¤§é˜¶æ¢¯å¹¿åœºè®©äººä¼‘æ¯ã€‚\nåŒæ ·ï¼Œè¿™é‡Œä¹Ÿæ˜¯ã€Šè¿·å®«çš„åå­—è·¯å£ã€‹çš„å–æ™¯åœ°ã€‚\nåŠ¨æ¼« ç¯å¢ƒ éå¸¸å¹²å‡€ã€‚ä½ å¯ä»¥è¯´æ„æ—ï¼Œè¯»è€…åœ¨ç¾åŒ–å›½å¤–ï¼Œä½†æ˜¯ï¼Œäº¬éƒ½çœŸçš„éå¸¸éå¸¸éå¸¸éå¸¸å¹²å‡€ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¡—é“ä¸Šä¸å…è®¸è®¾ç½®åƒåœ¾æ¡¶ï¼Œè¿™èƒ½ä¸å¹²å‡€å—ï¼Ÿ\nğŸŒ† å¤§é˜ªï¼šçƒ­é—¹ä¸ç¾é£Ÿçš„èšé›†åœ° ä»äº¬éƒ½åè½¦å¾ˆå¿«åˆ°å¤§é˜ªï¼Œæ„Ÿè§‰ä¸€ä¸‹å­çƒ­é—¹èµ·æ¥äº†ï¼Œç‰¹åˆ«æ˜¯æ™šä¸Šï¼Œç¯ç«é€šæ˜ï¼Œå¾ˆæœ‰æ´»åŠ›ã€‚\nç¯çƒå½±åŸ (USJ)ï¼š å¤§é˜ªç¯çƒå½±åŸç¡®å®å¥½ç©ï¼Œå°¤å…¶æ˜¯é©¬é‡Œå¥¥å›­åŒºï¼Œåšå¾—å¤ªç”¨å¿ƒäº†ã€‚æˆ´ä¸ŠARæ‰‹ç¯ï¼Œé‚£äº›æ¸¸æˆé‡Œçš„åœºæ™¯å’Œé“å…·çœŸçš„èƒ½äº’åŠ¨ï¼Œæ„Ÿè§‰è‡ªå·±å°±åœ¨æ¸¸æˆä¸–ç•Œé‡Œã€‚åº“å·´åŸå ¡é‡Œçš„èµ›è½¦æ¸¸æˆå°¤å…¶åˆºæ¿€ã€‚å“ˆåˆ©æ³¢ç‰¹å›­åŒºä¹Ÿè¿˜åŸå¾—å¾ˆå¥½ã€‚ä¸è¿‡çƒ­é—¨é¡¹ç›®æ’é˜Ÿæ—¶é—´ç¡®å®é•¿ï¼Œå»ºè®®æå‰ç ”ç©¶ä¸‹å¿«é€Ÿç¥¨ï¼ˆExpress Passï¼‰ã€‚ä¸ºä»€ä¹ˆå¤§å®¶æ„¿æ„æ’é•¿é˜Ÿï¼Ÿæˆ‘è§‰å¾—ä¸»è¦æ˜¯æ²‰æµ¸æ„Ÿåšå¾—ç‰¹åˆ«å¥½ï¼Œè®©ä½ ä¸åªæ˜¯çœ‹ï¼Œè€Œæ˜¯èƒ½â€œå‚ä¸â€è¿›å»ï¼ŒåƒçœŸçš„è¿›å…¥äº†ç”µå½±æˆ–æ¸¸æˆçš„ä¸–ç•Œï¼Œå¤§äººå°å­©éƒ½èƒ½ç©å¾—å¾ˆå¼€å¿ƒã€‚\nç¥æˆ· é¡»ç£¨å±± å¦‚æœæ—¶é—´å……è£•ï¼Œå¯ä»¥ä»å¤§é˜ªåè½¦å»ç¥æˆ·çš„é¡»ç£¨å±±ï¼ˆå¤§çº¦1å°æ—¶ï¼‰ã€‚åç¼†è½¦ä¸Šå±±ï¼Œç«™åœ¨å±±é¡¶èƒ½åŒæ—¶çœ‹åˆ°æ¿‘æˆ·å†…æµ·å’Œå£®è§‚çš„æ˜çŸ³æµ·å³¡å¤§æ¡¥ï¼Œè§†é‡éå¸¸å¼€é˜”ã€‚å±±ä¸Šäººä¸å¤šï¼Œè¿˜æœ‰ä¸ªåŠ¨ç‰©å›­å’Œæ¤ç‰©å›­ï¼Œå±±ä¸‹æœ‰æµ·æ»©ï¼Œæ˜¯ä¸ªå¯ä»¥è¿œç¦»åŸå¸‚å–§åš£ã€è½»æ¾é€›é€›çš„å¥½åœ°æ–¹ã€‚\nå¿ƒæ–‹æ¡¥ \u0026amp; é“é¡¿å € è¿™é‡Œå°±æ˜¯å¤§é˜ªå¤œç”Ÿæ´»çš„ä¸­å¿ƒäº†ï¼Œç‰¹åˆ«çƒ­é—¹ã€‚æ»¡è¡—éƒ½æ˜¯å°åƒæ‘Šå’Œå•†åº—ã€‚ç« é±¼çƒ§å¤–çš®ç„¦è„†é‡Œé¢è½¯ç³¯ï¼Œå„ç§ä¸²çƒ§é¦™æ°”æ‰‘é¼»ï¼Œå¯ä¸½é¥¼ç”œåº¦åˆšå¥½ä¸è…»ï¼Œè¾¹èµ°è¾¹åƒå¾ˆæ»¡è¶³ã€‚é™¤äº†åƒçš„ï¼Œè¯å¦†åº—ä¹Ÿç‰¹åˆ«å¤šï¼Œåƒçœ¼è¯æ°´ã€å¸¸ç”¨è¯ã€é¢è†œã€æ—¥ç”¨å“ä»€ä¹ˆçš„ï¼Œç§ç±»å…¨ï¼Œä»·æ ¼ä¹Ÿæ¯”å›½å†…ä¾¿å®œä¸å°‘ï¼Œçœ‹åˆ°å¾ˆå¤šäººéƒ½æ˜¯ä¸€è¢‹å­ä¸€è¢‹å­åœ°ä¹°ã€‚æ™šä¸Šè¿™é‡Œäººè™½ç„¶å¤šï¼Œä½†ç§©åºæŒºå¥½ï¼Œæ˜¯ä¸€ç§çƒ­é—¹ä½†ä¸æ··ä¹±çš„æ„Ÿè§‰ã€‚è¿™é‡Œå—æ¬¢è¿å¾ˆç®€å•ï¼šä¸œè¥¿å¥½åƒä¸è´µï¼Œæ‹ç…§æœ‰ç‰¹è‰²ï¼ˆæ¯”å¦‚é‚£ä¸ªè‘—åçš„æ ¼åŠ›é«˜è·‘æ­¥äººæ‹›ç‰Œï¼‰ï¼Œä¹°ä¸œè¥¿ä¹Ÿå®æƒ æ–¹ä¾¿ã€‚\nğŸš‡ äº¤é€šä¸ä¾¿åˆ©ï¼šæ—…è¡Œä¸­çš„å°ç¡®å¹¸ å…¬å…±äº¤é€š æ—¥æœ¬çš„ç”µè½¦ï¼ˆåŒ…æ‹¬åœ°é“å’Œç«è½¦ï¼‰ç³»ç»Ÿå¾ˆå‘è¾¾ï¼Œä½†ä¹Ÿç¡®å®æœ‰ç‚¹å¤æ‚ã€‚åŒä¸€ä¸ªç«™å°å¯èƒ½æœ‰ä¸åŒé€Ÿåº¦çš„è½¦ï¼ˆæ™®é€šã€å¿«é€Ÿã€æ€¥è¡Œã€ç‰¹æ€¥ï¼‰ï¼Œä¸Šè½¦å‰ä¸€å®šè¦çœ‹æ¸…ç”µå­å±ä¸Šçš„ç›®çš„åœ°å’Œè½¦ç§ã€‚æ¢ä¹˜æœ‰æ—¶éœ€è¦èµ°ç‚¹è·¯ï¼Œç”šè‡³ä¸Šä¸‹æ¥¼ã€‚ç”¨Suicaæˆ–ICOCAè¿™ç§äº¤é€šå¡æœ€æ–¹ä¾¿ï¼Œåˆ·å¡è¿›å‡ºï¼Œè‡ªåŠ¨æ‰£è´¹ï¼Œçœå»ä¹°ç¥¨çš„éº»çƒ¦ã€‚å¼ºçƒˆæ¨èç”¨Google MapsæŸ¥è·¯çº¿ï¼Œä¼šå‘Šè¯‰ä½ åå“ªè¶Ÿè½¦ã€åœ¨å‡ å·ç«™å°ã€å‡ ç‚¹å‘è½¦ï¼Œéå¸¸å‡†ã€‚\næ–°å¹²çº¿ åŸå¸‚é—´ç§»åŠ¨åæ–°å¹²çº¿å¾ˆå¿«å¾ˆèˆ’æœã€‚è½¦å¢å¹²å‡€ï¼Œåº§ä½å®½æ•ï¼Œæ—¶é—´ä¹Ÿæå‡†ã€‚æˆ‘ä»¬åäº†å‡ æ¬¡ï¼Œä½“éªŒéƒ½å¾ˆå¥½ã€‚è½¦ä¸Šå¾ˆå®‰é™ï¼Œä¸å¤ªæœ‰äººå¤§å£°è¯´è¯æˆ–æ‰“ç”µè¯ã€‚è½¦ç«™ä¾¿åˆ©åº—å–çš„ä¾¿å½“é€‰æ‹©å¤šï¼Œå‘³é“ä¹Ÿä¸é”™ï¼Œå¯ä»¥å¸¦ä¸Šè½¦åƒã€‚\nä¾¿åˆ©åº— æ—¥æœ¬çš„ä¾¿åˆ©åº—ï¼ˆ7-11ã€Lawsonã€FamilyMartï¼‰çœŸæ˜¯æ—…è¡Œä¸­çš„æ•‘æ˜Ÿã€‚æ—©ä¸Šä¹°ä¸ªçƒ­å’–å•¡åŠ é¥­å›¢ï¼Œä¸­åˆé¥¿äº†æ¥ä¸ªä¾¿å½“æˆ–é¢åŒ…ï¼Œæ™šä¸Šå›å»å‰ä¹°ç‚¹é›¶é£Ÿæˆ–é¥®æ–™ï¼Œä¸€æ—¥ä¸‰é¤éƒ½èƒ½è§£å†³ã€‚å®ƒä»¬è¿˜èƒ½æ‰“å°ã€å–ç¥¨ã€å¯„å¿«é€’ã€å–é’±ï¼ˆATMæ”¯æŒé“¶è”å¡ï¼‰ï¼Œç”šè‡³èƒ½ä¹°æ™¯ç‚¹é—¨ç¥¨ï¼Œè¥ä¸šæ—¶é—´é•¿ï¼Œåˆ°å¤„éƒ½æœ‰ï¼Œå¹²å‡€åˆæ–¹ä¾¿ã€‚\nğŸ± åƒåƒå–å–ï¼šç®€å•ä½†æ»¡è¶³ ä¸€äººé£Ÿå‹å¥½ åœ¨æ—¥æœ¬åƒé¥­ï¼Œä¸€ä¸ªäººç‰¹åˆ«è‡ªåœ¨ã€‚å¾ˆå¤šé¤å…éƒ½æœ‰å§å°ä½ï¼Œèœå•ä¸Šå®šé£Ÿå¥—é¤ï¼ˆä¸€ä»½ä¸»èœ+ç±³é¥­+æ±¤+å°èœï¼‰å°±æ˜¯ä¸ºä¸€ä¸ªäººè®¾è®¡çš„ï¼Œåˆ†é‡åˆé€‚ï¼Œç‚¹é¤ä¹Ÿæ–¹ä¾¿ï¼Œä¸å°‘åº—é—¨å£è¿˜æœ‰è‡ªåŠ©ç‚¹é¤æœºï¼Œç¤¾æå‹å¥½ã€‚åƒé¥­æ—¶æ²¡äººå‚¬ä½ ï¼Œå¯ä»¥æ…¢æ…¢åƒã€‚\nå°è±¡æ·±åˆ»çš„ç¾é£Ÿ è±†è…å¥—é¤\nå’Œç‰›é¥­ï¼š\nå±…é…’å±‹çƒ§é¸Ÿï¼š\nå’Œç‰›è‡ªåŠ©ï¼š\nğŸŒ ä¸€ç‚¹ç‚¹æ„Ÿå— è¿™æ¬¡å…³è¥¿ä¹‹è¡Œï¼Œä»äº¬éƒ½çš„å¤å¯ºé¸Ÿå±…ï¼Œåˆ°å¤§é˜ªçš„ç¯çƒå½±åŸå’Œå¤œå¸‚ï¼Œæ„Ÿè§‰æŒºå……å®çš„ã€‚å°è±¡æœ€æ·±çš„æ˜¯ï¼Œåœ¨è¿™é‡Œæ—…è¡Œå¾ˆæ–¹ä¾¿ä¹Ÿå¾ˆèˆ’é€‚ã€‚ä¾¿åˆ©åº—è§£å†³äº†åŸºæœ¬éœ€æ±‚ï¼Œç”µè½¦å’Œæ–°å¹²çº¿å‡†æ—¶é«˜æ•ˆï¼Œç¾é£Ÿé€‰æ‹©å¤šè€Œä¸”å¯¹ç‹¬è‡ªæ—…è¡Œçš„äººå¾ˆå‹å¥½ã€‚\näº¬éƒ½é€‚åˆæ…¢æ…¢èµ°ï¼Œæ„Ÿå—å†å²å’Œå®é™ï¼›å¤§é˜ªåˆ™æ˜¯æ”¾å¼€äº†ç©å’Œåƒçš„åœ°æ–¹ã€‚å¦‚æœä½ ä¹Ÿæ‰“ç®—å»ï¼Œä¸å¦¨è¯•è¯•ï¼š\næ—©ä¸Šåœ¨ä¾¿åˆ©åº—è§£å†³æ—©é¤ï¼Œæ–¹ä¾¿å¿«æ·ã€‚ åä¸€æ¬¡éç‰¹æ€¥çš„æ™®é€šæˆ–å¿«é€Ÿç”µè½¦ï¼Œæ„Ÿå—ä¸‹å½“åœ°äººçš„é€šå‹¤ã€‚ åœ¨æ¸…æ°´å¯ºè¿™æ ·çš„åœ°æ–¹ï¼Œå›æƒ³ä¸‹çœ‹è¿‡çš„åŠ¨æ¼«åœºæ™¯ï¼ˆå¦‚æœä½ æ˜¯åŠ¨æ¼«è¿·çš„è¯ï¼‰ã€‚ æ‰¾ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªäººå®‰é™åœ°åƒä¸€ä»½å®šé£Ÿï¼Œæ…¢æ…¢æ„Ÿå—ã€‚ æ€»çš„æ¥è¯´ï¼Œè¿™æ˜¯ä¸€æ¬¡èŠ‚å¥æ¯”è¾ƒèˆ’ç¼“ä½†ä½“éªŒå¾ˆä¸°å¯Œçš„æ—…è¡Œã€‚å¸Œæœ›ä»¥åæœ‰æœºä¼šè¿˜èƒ½å†å»ã€‚ä¹Ÿæ¬¢è¿å¤§å®¶åˆ†äº«ä½ ä»¬çš„æ—¥æœ¬æ—…è¡Œç»éªŒï¼\n","date":"2025-05-07T00:00:00Z","permalink":"https://MyLoveES.github.io/p/kyoto-osaka/","title":"kyoto \u0026 osaka"},{"content":"äº‹ä»¶å¾ªç¯ ä¸€ã€äº‹ä»¶å¾ªç¯çš„æœ¬è´¨ï¼šä»å¿«é€’åˆ†æ‹£ä¸­å¿ƒè¯´èµ· 1.1 ç°å®ä¸–ç•Œç±»æ¯” 1 2 3 4 5 6 7 8 9 10 å‡è®¾ä½ ç»è¥ä¸€å®¶å¿«é€’åˆ†æ‹£ä¸­å¿ƒï¼š - **ä¼ ç»Ÿé˜»å¡æ¨¡å‹**ï¼ˆå¤šçº¿ç¨‹ï¼‰ï¼š æ¯ä¸ªåŒ…è£¹ï¼ˆè¯·æ±‚ï¼‰åˆ†é…ä¸€ä¸ªå·¥äººï¼ˆçº¿ç¨‹ï¼‰ å·¥äººå¿…é¡»å…¨ç¨‹è·Ÿè¸ªåŒ…è£¹ï¼šæ¥æ”¶ â†’ åˆ†æ‹£ â†’ è£…è½¦ å³ä½¿å·¥äºº90%æ—¶é—´åœ¨ç­‰å¾…è´§è½¦ï¼Œä¹Ÿä¸èƒ½å¤„ç†å…¶ä»–åŒ…è£¹ - **äº‹ä»¶å¾ªç¯æ¨¡å‹**ï¼š å°‘æ•°é«˜æ•ˆå·¥äººï¼ˆäº‹ä»¶å¾ªç¯çº¿ç¨‹ï¼‰ æ¯ä¸ªå·¥äººç®¡ç†å¤šä¸ªä¼ é€å¸¦ï¼ˆSocketé€šé“ï¼‰ å·¥äººåªå¤„ç†å°±ç»ªçš„åŒ…è£¹ï¼ˆå°±ç»ªçš„I/Oäº‹ä»¶ï¼‰ 1.2 ä¼ ç»Ÿæ¨¡å‹çš„ç“¶é¢ˆ äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰ï¼š ä¸€ç§ç¨‹åºç»“æ„ï¼Œé€šè¿‡æ— é™å¾ªç¯æŒç»­ç›‘å¬å¹¶åˆ†å‘I/Oäº‹ä»¶ï¼Œå…¶æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼š\näº‹ä»¶é˜Ÿåˆ—ï¼šå­˜å‚¨å¾…å¤„ç†äº‹ä»¶ï¼ˆæ–°è¿æ¥ã€æ•°æ®åˆ°è¾¾ç­‰ï¼‰ äº‹ä»¶åˆ†å‘å™¨ï¼šæ£€æµ‹å“ªäº›é€šé“ï¼ˆChannelï¼‰å·²å°±ç»ª äº‹ä»¶å¤„ç†å™¨ï¼šå¤„ç†å…·ä½“I/Oæ“ä½œçš„å›è°ƒå‡½æ•° äºŒã€å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼šäº‹ä»¶å¾ªç¯çš„\u0026quot;ç«çœ¼é‡‘ç›\u0026quot; 2.1 ä»BIOåˆ°NIOçš„æ¼”è¿› æ¨¡å‹ å·¥ä½œæ–¹å¼ èµ„æºæ¶ˆè€— é€‚ç”¨åœºæ™¯ BIO 1çº¿ç¨‹1è¿æ¥ï¼ˆé˜»å¡ç­‰å¾…ï¼‰ éšè¿æ¥æ•°çº¿æ€§å¢é•¿ ä½å¹¶å‘åœºæ™¯ select éå†æ‰€æœ‰fdæ£€æŸ¥çŠ¶æ€ O(n)æ—¶é—´å¤æ‚åº¦ å°‘é‡è¿æ¥ epoll å›è°ƒé€šçŸ¥å°±ç»ªäº‹ä»¶ O(1)æ—¶é—´å¤æ‚åº¦ ä¸‡çº§è¿æ¥ 2.2 epollçš„ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ› 2.2.1 çº¢é»‘æ ‘ç®¡ç†æ–‡ä»¶æè¿°ç¬¦é›† 1 2 3 4 5 6 7 8 // åˆ›å»ºepollå®ä¾‹ int epoll_fd = epoll_create1(0); // æ·»åŠ ç›‘æ§æè¿°ç¬¦ struct epoll_event event; event.events = EPOLLIN | EPOLLET; // è¾¹ç¼˜è§¦å‘æ¨¡å¼ event.data.fd = socket_fd; epoll_ctl(epoll_fd, EPOLL_CTL_ADD, socket_fd, \u0026amp;event); 2.2.1 å°±ç»ªåˆ—è¡¨ä¸äº‹ä»¶å›è°ƒ 1 2 3 4 5 6 7 8 9 // ç­‰å¾…äº‹ä»¶å‘ç”Ÿï¼ˆæ¯«ç§’çº§è¶…æ—¶ï¼‰ int num_events = epoll_wait(epoll_fd, events, MAX_EVENTS, -1); // å¤„ç†å°±ç»ªäº‹ä»¶ for (int i = 0; i \u0026lt; num_events; i++) { if (events[i].events \u0026amp; EPOLLIN) { handle_read(events[i].data.fd); } } 2.2.3 è§¦å‘æ¨¡å¼é€‰æ‹© æ°´å¹³è§¦å‘ï¼ˆLTï¼‰ï¼šåªè¦ç¼“å†²åŒºæœ‰æ•°æ®å°±ä¼šæŒç»­é€šçŸ¥ è¾¹ç¼˜è§¦å‘ï¼ˆETï¼‰ï¼šä»…åœ¨çŠ¶æ€å˜åŒ–æ—¶é€šçŸ¥ä¸€æ¬¡ï¼ˆæ€§èƒ½æ›´ä¼˜ï¼‰ ä¸‰ã€Nettyçš„äº‹ä»¶å¾ªç¯å®ç° 3.1 æ ¸å¿ƒç»„ä»¶å…³ç³»å›¾ 1 2 3 4 5 6 7 8 9 10 11 12 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ EventLoopGroup â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ NioEventLoop[] â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ Selector â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ (epollå®ä¾‹) â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ Task Queue â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 3.2 äº‹ä»¶å¾ªç¯çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 // ç®€åŒ–ç‰ˆäº‹ä»¶å¾ªç¯ä¼ªä»£ç  public void run() { while (!terminated) { // é˜¶æ®µ1ï¼šæ£€æµ‹I/Oäº‹ä»¶ int readyChannels = selector.select(timeout); // é˜¶æ®µ2ï¼šå¤„ç†I/Oäº‹ä»¶ if (readyChannels \u0026gt; 0) { Set\u0026lt;SelectionKey\u0026gt; keys = selector.selectedKeys(); for (SelectionKey key : keys) { if (key.isReadable()) { handleRead(key); } if (key.isWritable()) { handleWrite(key); } } keys.clear(); } // é˜¶æ®µ3ï¼šå¤„ç†å¼‚æ­¥ä»»åŠ¡ runAllTasks(); } } 3.3 å…³é”®æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µ I/Oæ¯”ä¾‹æ§åˆ¶ï¼šé€šè¿‡ioRatioå‚æ•°å¹³è¡¡I/Oä¸ä»»åŠ¡å¤„ç†æ—¶é—´ 1 2 // é»˜è®¤é…ç½®ï¼šI/Oæ“ä½œå ç”¨50%æ—¶é—´ NioEventLoopGroup group = new NioEventLoopGroup(4, new DefaultThreadFactory(), 50); ç›´æ¥å†…å­˜åˆ†é…ï¼šä½¿ç”¨ByteBufé¿å…JVMå †å†…å­˜æ‹·è´ é›¶æ‹·è´æŠ€æœ¯ï¼šæ–‡ä»¶ä¼ è¾“é€šè¿‡FileRegionç›´æ¥æ“ä½œå†…æ ¸ç¼“å†²åŒº å››ã€æ€§èƒ½å¯¹æ¯”ï¼šç†è®º vs ç°å® 4.1 ç†è®ºè®¡ç®—æ¨¡å‹ C10Ké—®é¢˜å…¬å¼æ¨å¯¼ï¼š ä¼ ç»Ÿæ¨¡å‹æ‰€éœ€çº¿ç¨‹æ•° = å¹¶å‘è¿æ¥æ•° Ã— (å¹³å‡ç­‰å¾…æ—¶é—´ / å¹³å‡å¤„ç†æ—¶é—´) å‡è®¾ï¼š\n10,000å¹¶å‘è¿æ¥ æ¯ä¸ªè¯·æ±‚95%æ—¶é—´åœ¨ç­‰å¾…ï¼ˆ19msç­‰å¾… + 1mså¤„ç†ï¼‰ ä¼ ç»Ÿæ¨¡å‹çº¿ç¨‹æ•° = 10,000 Ã— (19/1) = 190,000 â†’ å®Œå…¨ä¸å¯è¡Œ\näº‹ä»¶å¾ªç¯æ¨¡å‹çº¿ç¨‹æ•° = CPUæ ¸å¿ƒæ•°ï¼ˆå¦‚4çº¿ç¨‹ï¼‰â†’ è½»æ¾åº”å¯¹\näº”ã€ä»å†…æ ¸åˆ°åº”ç”¨ï¼šå…¨é“¾è·¯è§†è§’çœ‹äº‹ä»¶å¾ªç¯ 5.1 Linuxå†…æ ¸çš„å·¥ä½œæµç¨‹ 1 2 3 4 5 6 7 åº”ç”¨å±‚ï¼ˆJava NIOï¼‰ â†“ ç³»ç»Ÿè°ƒç”¨ï¼ˆepoll_ctl/epoll_waitï¼‰ VFSï¼ˆè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿå±‚ï¼‰ â†“ å›è°ƒæ³¨å†Œ ç½‘å¡é©±åŠ¨ â†“ ç¡¬ä»¶ä¸­æ–­ DMAç¼“å†²åŒº â†’ æ•°æ®å°±ç»ª â†’ è§¦å‘epollå›è°ƒ 5.2 ç°ä»£ç½‘ç»œæ ˆä¼˜åŒ– RSSï¼ˆæ¥æ”¶ç«¯æ‰©å±•ï¼‰ï¼šå¤šé˜Ÿåˆ—ç½‘å¡åˆ†æ•£ä¸­æ–­å‹åŠ› SO_REUSEPORTï¼šå…è®¸å¤šä¸ªSocketç›‘å¬åŒä¸€ç«¯å£ Kernel Bypassï¼šDPDK/XDKç­‰ç”¨æˆ·æ€ç½‘ç»œæ–¹æ¡ˆ å…­ã€æœ€ä½³å®è·µï¼šå¦‚ä½•æœ€å¤§åŒ–äº‹ä»¶å¾ªç¯æ•ˆç‡ 6.1 é…ç½®åŸåˆ™ 1 2 3 4 5 6 7 8 # æ¨èNettyé…ç½® server: netty: event-loop: boss-count: 1 # æ¥æ”¶è¿æ¥çº¿ç¨‹æ•° worker-count: cpu_cores * 2 # å¤„ç†I/Oçº¿ç¨‹æ•° max-initial-line-length: 8192 so-backlog: 1024 # ç­‰å¾…è¿æ¥é˜Ÿåˆ—å¤§å° 6.2 ç¦å¿Œäº‹é¡¹ âŒ åœ¨äº‹ä»¶å¾ªç¯çº¿ç¨‹æ‰§è¡Œé˜»å¡æ“ä½œ âŒ å¿˜è®°é‡Šæ”¾ByteBufå¯¼è‡´å†…å­˜æ³„æ¼ âŒ åœ¨Handlerä¸­å¤„ç†è€—æ—¶ä¸šåŠ¡é€»è¾‘ 6.3 ç›‘æ§æŒ‡æ ‡ 1 2 3 4 å…³é”®Metricï¼š reactor.netty.io.allocated.directï¼šç›´æ¥å†…å­˜ä½¿ç”¨é‡ reactor.netty.io.pending.tasksï¼šå¾…å¤„ç†ä»»åŠ¡æ•° reactor.netty.io.select.latencyï¼šselectæ“ä½œå»¶è¿Ÿ ","date":"2025-03-10T00:00:00Z","permalink":"https://MyLoveES.github.io/p/event-loop/","title":"Event Loop"},{"content":"å“åº”å¼ç¼–ç¨‹ vs ä¼ ç»ŸåŒæ­¥æ¨¡å‹ ä¸€ã€ä¼ ç»Ÿæ¨¡å‹çš„æ€§èƒ½å›°å¢ƒ 1.1 ç°å®ä¸­çš„ä¾‹å­ 1 2 3 4 å‡è®¾ä¸€ä¸ªé“¶è¡Œæœ‰10ä¸ªæŸœå°ï¼ˆçº¿ç¨‹æ± å¤§å°ä¸º10ï¼‰ï¼š - æ¯ä¸ªå®¢æˆ·ï¼ˆè¯·æ±‚ï¼‰éœ€è¦å ç”¨æŸœå°5åˆ†é’Ÿï¼ˆåŒ…å«ç­‰å¾…IOçš„æ—¶é—´ï¼‰ - å½“åŒæ—¶æœ‰100ä¸ªå®¢æˆ·æ—¶ï¼Œ90ä¸ªå®¢æˆ·å¿…é¡»æ’é˜Ÿç­‰å¾… - å³ä½¿æŸœå‘˜å®é™…å·¥ä½œæ—¶é—´åªæœ‰1åˆ†é’Ÿï¼ˆCPUè®¡ç®—ï¼‰ï¼Œå…¶ä»–4åˆ†é’Ÿéƒ½åœ¨ç­‰å¾…ï¼ˆIOé˜»å¡ï¼‰ 1.2 ä¼ ç»Ÿæ¨¡å‹çš„ç“¶é¢ˆ 1 2 3 4 5 6 7 8 9 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” è¯·æ±‚é˜Ÿåˆ— â†’ â”‚ çº¿ç¨‹æ±  â”‚ â†’ 1:1 â†’ â”‚ é˜»å¡IO â”‚ â”‚ (200çº¿ç¨‹) â”‚ â”‚ (DB/HTTP) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å…³é”®é—®é¢˜ï¼š - å‡è®¾CPUå¤„ç†æœ¬èº«éœ€è¦10msï¼Œè€Œä¸‹æ¸¸å“åº”å»¶è¿Ÿä»10mså‡è‡³500msæ—¶ï¼š ååé‡ä» 200/(0.01+0.01)=10,000 QPS æš´è·Œè‡³ 200/(0.5+0.01)=392 QPS çº¿ç¨‹èµ„æºæµªè´¹ï¼šå¤§é‡æ—¶é—´æµªè´¹åœ¨ç­‰å¾…IOï¼ˆæ•°æ®åº“ã€ç½‘ç»œè°ƒç”¨ï¼‰ é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼šçº¿ç¨‹æ± çˆ†æ»¡ï¼Œè¯·æ±‚æ’é˜Ÿï¼Œå“åº”å»¶è¿Ÿé£™å‡ ä¾‹å¦‚ï¼šTomcaté»˜è®¤200çº¿ç¨‹æ± ï¼Œä¸‹æ¸¸ASRå“åº”æ…¢æ—¶ï¼Œçº¿ç¨‹æ± è€—å°½ï¼Œæ–°çš„è¯·æ±‚æ— æ³•æ¥å—ï¼Œè§¦å‘Podé‡å¯ã€‚\näºŒã€WebFluxï¼šäº‹ä»¶é©±åŠ¨ 2.1 æ¶æ„å¯¹æ¯” 2.1.1 ä¼ ç»ŸServletæ¨¡å‹ 1 2 3 4 5 6 7 8 9 10 [å·¥ä½œæµç¨‹] 1. æ¥å—è¯·æ±‚ â†’ åˆ†é…çº¿ç¨‹ 2. çº¿ç¨‹æ‰§è¡Œ â†’ é˜»å¡ç­‰å¾… 3. è·å–ç»“æœ â†’ è¿”å›å“åº” 4. é‡Šæ”¾çº¿ç¨‹ [èµ„æºæ—¶é—´çº¿ç¤ºä¾‹] çº¿ç¨‹1ï¼šâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ï¼ˆ80%æ—¶é—´åœ¨ç­‰å¾…ï¼‰ çº¿ç¨‹2ï¼šâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ çº¿ç¨‹3ï¼šâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 2.1.2 WebFluxå“åº”å¼æ¨¡å‹ 1 2 3 4 5 6 7 8 9 10 [å·¥ä½œæµç¨‹] 1. æ¥å—è¯·æ±‚ â†’ æ³¨å†Œå›è°ƒ 2. ç«‹å³é‡Šæ”¾çº¿ç¨‹ â†’ å¤„ç†å…¶ä»–è¯·æ±‚ 3. ä¸‹æ¸¸å“åº”å°±ç»ª â†’ äº‹ä»¶å¾ªç¯è°ƒåº¦å¤„ç† 4. ç”Ÿæˆå“åº” â†’ æ— éœ€ç­‰å¾… [èµ„æºæ—¶é—´çº¿ç¤ºä¾‹] çº¿ç¨‹1ï¼šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆï¼ˆæŒç»­å¤„ç†äº‹ä»¶ï¼‰ çº¿ç¨‹2ï¼šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ï¼ˆä»…éœ€2-4ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼‰ 2.1.3 ä¼ ç»Ÿæ¨¡å‹ vs WebFluxæ¨¡å‹å¯¹æ¯” ç»´åº¦ ä¼ ç»Ÿæ¨¡å‹ï¼ˆServletï¼‰ WebFluxï¼ˆReactiveï¼‰ çº¿ç¨‹æ¨¡å‹ 1è¯·æ±‚1çº¿ç¨‹ï¼ˆé˜»å¡ï¼‰ å°‘é‡çº¿ç¨‹ + äº‹ä»¶å¾ªç¯ï¼ˆéé˜»å¡ï¼‰ èµ„æºæ¶ˆè€— é«˜ï¼ˆçº¿ç¨‹æ•°â‰ˆå¹¶å‘æ•°ï¼‰ ä½ï¼ˆçº¿ç¨‹æ•°â‰ˆCPUæ ¸å¿ƒæ•°ï¼‰ ç¼–ç¨‹èŒƒå¼ åŒæ­¥é˜»å¡ï¼ˆImperativeï¼‰ å¼‚æ­¥éé˜»å¡ï¼ˆDeclarativeï¼‰ ååé‡ç“¶é¢ˆ çº¿ç¨‹æ± å¤§å° CPU/ç½‘ç»œå¸¦å®½ 2.2 å“åº”å¼çš„å½¢è±¡åŒ–è§£é‡Š 1 2 3 4 5 6 7 // ä¼ ç»Ÿæ¨¡å‹ï¼šåŒæ­¥ç­‰å¾…ç»“æœï¼ˆçº¿ç¨‹è¢«é˜»å¡ï¼‰ String data = database.query(); // \u0026lt;- çº¿ç¨‹åœ¨è¿™é‡Œå¡ä½ï¼ response.send(data); // WebFluxï¼šè®¢é˜…æ•°æ®æµï¼ˆçº¿ç¨‹ç«‹å³é‡Šæ”¾ï¼‰ Mono\u0026lt;String\u0026gt; mono = database.reactiveQuery(); mono.subscribe(data -\u0026gt; response.send(data)); å…³é”®æœºåˆ¶ï¼š\näº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰ å°‘æ•°çº¿ç¨‹è½®è¯¢äº‹ä»¶é˜Ÿåˆ— å½“IOå°±ç»ªæ—¶è§¦å‘å›è°ƒï¼Œä¸ç©ºç­‰ èƒŒå‹ï¼ˆBackpressureï¼‰ ç”Ÿäº§è€…ï¼ˆPublisherï¼‰æ ¹æ®æ¶ˆè´¹è€…ï¼ˆSubscriberï¼‰çš„å¤„ç†èƒ½åŠ›åŠ¨æ€è°ƒæ•´æ•°æ®æµé€Ÿ æ•°æ®æµæ“ä½œç¬¦ ä½¿ç”¨Fluxï¼ˆ0-Nä¸ªå…ƒç´ ï¼‰å’ŒMonoï¼ˆ0-1ä¸ªå…ƒç´ ï¼‰ç»„åˆå¼‚æ­¥æ“ä½œ 1 2 3 4 5 6 7 webClient.get() .uri(\u0026#34;/api/users\u0026#34;) .retrieve() .bodyToFlux(User.class) .filter(user -\u0026gt; user.age \u0026gt; 18) .take(10) .subscribe(System.out::println); ä¸‰ã€WebFluxçš„ä¼˜åŠ¿ä¸ä»£ä»· 3.1 ä¼˜åŠ¿ï¼šä½•æ—¶é€‰æ‹©WebFlux åœºæ™¯ ä¼ ç»Ÿæ¨¡å‹ WebFlux åŸå›  æµå¼æ•°æ®ä¼ è¾“ï¼ˆæ—¥å¿—æ¨é€ï¼‰ âŒ âœ… å¤©ç„¶æ”¯æŒSSE/WebSocket CPUå¯†é›†å‹ä»»åŠ¡ âœ… âŒ éé˜»å¡æ¨¡å‹æ— ä¼˜åŠ¿ å¾®æœåŠ¡ç½‘å…³ï¼ˆèšåˆè¯·æ±‚ï¼‰ âš ï¸ âœ… å¼‚æ­¥ç»„åˆå¤šä¸ªæœåŠ¡å“åº” 3.2 ä»£ä»·ï¼šä½¿ç”¨WebFluxçš„æŒ‘æˆ˜ 3.2.1 ç¼–ç¨‹ä¹ æƒ¯ ä»\u0026quot;æŒ‰æ­¥éª¤æ‰§è¡Œ\u0026quot;åˆ°\u0026quot;å®šä¹‰æ•°æ®æµç®¡é“\u0026quot; è°ƒè¯•å›°éš¾ï¼šå †æ ˆè·Ÿè¸ªåŒ…å«å¤§é‡ååº”å¼æ“ä½œç¬¦ ä¸æ–¹ä¾¿çš„â€œä¸Šä¸‹æ–‡ä¼ é€’â€ï¼ˆéœ€è¦ä½¿ç”¨Reactorçš„Contextï¼Œä»¥åŠè‡ªå®šä¹‰WebFilterç­‰ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 Mono\u0026lt;String\u0026gt; data = webClient.get() .uri(\u0026#34;/api\u0026#34;) .retrieve() .bodyToMono(String.class) .flatMap(response -\u0026gt; Mono.deferContextual(ctx -\u0026gt; { String requestId = ctx.get(\u0026#34;requestId\u0026#34;); // ä»ä¸Šä¸‹æ–‡ä¸­è·å– return processResponse(response, requestId); }) ) .contextWrite(Context.of(\u0026#34;requestId\u0026#34;, \u0026#34;12345\u0026#34;)); // å†™å…¥ä¸Šä¸‹æ–‡ 3.2.2 ç”Ÿæ€é™åˆ¶ æ”¯æŒå“åº”å¼çš„ç»„ä»¶ ä¼ ç»Ÿé˜»å¡ç»„ä»¶ R2DBC JDBC WebClient RestTemplate è¾¾æ¢¦æ•°æ®åº“R2DBCå¤§å‘ï¼š https://note.youdao.com/s/K3VE8Se9 3.2.3 ä»£ç ç¤ºä¾‹ å››ã€æ€§èƒ½æµ‹è¯• äº”ã€æ€»ç»“ï¼šWebFluxä¸æ˜¯é“¶å¼¹ 5.1 ç»“è®º é€‚åˆï¼šIOå¯†é›†å‹ã€é«˜å¹¶å‘ã€å»¶è¿Ÿæ•æ„Ÿå‹ç³»ç»Ÿ ä¸é€‚åˆï¼šç®€å•CRUDåº”ç”¨ã€å¼ºä¾èµ–é˜»å¡ç”Ÿæ€çš„åœºæ™¯ æ ¸å¿ƒä»·å€¼ï¼šèµ„æºåˆ©ç”¨ç‡æå‡ï¼Œè€Œéç»å¯¹æ€§èƒ½ 5.2 å†³ç­– Checklist æ˜¯å¦â€œçœŸçš„â€æœ‰é«˜å¹¶å‘éœ€æ±‚ èƒ½å¦ä½¿ç”¨å“åº”å¼æ•°æ®åº“é©±åŠ¨ æ˜¯å¦æ‰¿æ‹…è°ƒè¯•å’Œç»´æŠ¤æˆæœ¬ ","date":"2025-03-09T00:00:00Z","permalink":"https://MyLoveES.github.io/p/why-reactor/","title":"Why Reactor"},{"content":"ä¸€ã€é¡¹ç›®ç”Ÿæˆ 1ã€Spring Boot CLI é¦–å…ˆï¼Œä½ éœ€è¦å®‰è£… Spring Boot CLIã€‚ä½ å¯ä»¥å‚è€ƒ Spring Boot å®˜æ–¹æ–‡æ¡£ä¸­çš„å®‰è£…æŒ‡å—ï¼šhttps://docs.spring.io/spring-boot/docs/current/reference/html/getting-started.html#getting-started.installing.cli 1 2 brew tap spring-io/tap brew install spring-boot åˆ›å»ºä¸€ä¸ªåŸºäº Gradle çš„ Spring Boot é¡¹ç›®ï¼š 1 spring init --build gradle-project --groupId=com.weasley --artifactId=mrsix --name=mrsix --description=\u0026#34;MrSix: Pipeline framework\u0026#34; mrsix äºŒã€å­æ¨¡å— 1) submodule-common 1 2 3 1) mkdir submodule-common 2) mkdir -p src/main/java/com/weasley/common 3) mkdir -p src/main/resources 2) submodule-domain 1 2 3 1) mkdir submodule-domain 2) mkdir -p src/main/java/com/weasley/domain 3) mkdir -p src/main/resources 3) submodule-application 1 2 3 1) mkdir submodule-application 2) mkdir -p src/main/java/com/weasley/application 3) mkdir -p src/main/resources 4) submodule-interface 1 2 3 1) mkdir submodule-interface 2) mkdir -p src/main/java/com/weasley/interface 3) mkdir -p src/main/resources 5) submodule-infrastructure 1 2 3 1) mkdir submodule-infrastructure 2) mkdir -p src/main/java/com/weasley/infrastructure 3) mkdir -p src/main/resources 2.1 gradle æ ¹ç›®å½• setting.gradle\n1 2 3 4 5 include \u0026#39;submodule-common\u0026#39; include \u0026#39;submodule-domain\u0026#39; include \u0026#39;submodule-application\u0026#39; include \u0026#39;submodule-interface\u0026#39; include \u0026#39;submodule-infrastructure\u0026#39; æ ¹ç›®å½• build.gradle\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 // å®šä¹‰é¡¹ç›®æ„å»ºæ‰€éœ€çš„ä»“åº“å’Œä¾èµ–é¡¹ // å®šä¹‰é¡¹ç›®æ„å»ºæ‰€éœ€çš„ä»“åº“å’Œä¾èµ–é¡¹ buildscript { repositories { mavenCentral() } dependencies { classpath(\u0026#39;org.springframework.boot:spring-boot-gradle-plugin:3.0.4\u0026#39;) } } plugins { id \u0026#39;java\u0026#39; id \u0026#39;groovy\u0026#39; id \u0026#39;java-library\u0026#39; id \u0026#39;org.springframework.boot\u0026#39; version \u0026#39;3.0.4\u0026#39; id \u0026#39;io.spring.dependency-management\u0026#39; version \u0026#39;1.1.0\u0026#39; } allprojects{ group = \u0026#39;com.weasley\u0026#39; version = \u0026#39;0.0.1-SNAPSHOT\u0026#39; sourceCompatibility = \u0026#39;17\u0026#39; repositories { mavenCentral() } dependencyManagement { imports { mavenBom \u0026#39;org.springframework.boot:spring-boot-dependencies:3.0.4\u0026#39; } } } subprojects { apply plugin: \u0026#39;java\u0026#39; apply plugin: \u0026#39;java-library\u0026#39; apply plugin: \u0026#39;groovy\u0026#39; apply plugin: \u0026#39;org.springframework.boot\u0026#39; apply plugin: \u0026#39;io.spring.dependency-management\u0026#39; dependencies {} tasks.named(\u0026#39;test\u0026#39;) { useJUnitPlatform() } } 2.2 maven 1 mvn archetype:generate -DgroupId=com.weasley -DartifactId=sdk-common -Dversion=1.0.0 -DinteractiveMode=false ä¸‰ã€å¢åŠ é€šç”¨ä¾èµ– 1. spring-boot-devtools 1 developmentOnly \u0026#39;org.springframework.boot:spring-boot-devtools\u0026#39; 2. lombok 1 2 compileOnly \u0026#39;org.projectlombok:lombok:1.18.20\u0026#39; annotationProcessor \u0026#39;org.projectlombok:lombok:1.18.20\u0026#39; 3. spring-boot-configuration-processor 1 annotationProcessor \u0026#34;org.springframework.boot:spring-boot-configuration-processor\u0026#34; 4. validation 1 implementation group: \u0026#39;org.springframework.boot\u0026#39;, name: \u0026#39;spring-boot-starter-validation\u0026#39;, version: \u0026#39;3.0.4\u0026#39; 5. mapstruct 1 2 implementation \u0026#39;org.mapstruct:mapstruct:1.5.3.Final\u0026#39; annotationProcessor \u0026#39;org.mapstruct:mapstruct-processor:1.5.3.Final\u0026#39; 6. knife4j 1 implementation group: \u0026#39;com.github.xiaoymin\u0026#39;, name: \u0026#39;knife4j-openapi3-jakarta-spring-boot-starter\u0026#39;, version: \u0026#39;4.0.0\u0026#39; 7. mybatis plus 1 2 3 4 implementation group: \u0026#39;com.baomidou\u0026#39;, name: \u0026#39;mybatis-plus-boot-starter\u0026#39;, version: \u0026#39;3.5.3.1\u0026#39; implementation group: \u0026#39;com.baomidou\u0026#39;, name: \u0026#39;mybatis-plus-generator\u0026#39;, version: \u0026#39;3.5.3.1\u0026#39; implementation group: \u0026#39;org.freemarker\u0026#39;, name: \u0026#39;freemarker\u0026#39;, version: \u0026#39;2.3.31\u0026#39; implementation group: \u0026#39;mysql\u0026#39;, name: \u0026#39;mysql-connector-java\u0026#39;, version: \u0026#39;8.0.32\u0026#39; 8. spock 1 2 testImplementation group: \u0026#39;org.spockframework\u0026#39;, name: \u0026#39;spock-core\u0026#39;, version: \u0026#39;2.3-groovy-4.0\u0026#39; testImplementation group: \u0026#39;org.spockframework\u0026#39;, name: \u0026#39;spock-spring\u0026#39;, version: \u0026#39;2.3-groovy-4.0\u0026#39; 9. h2 1 testImplementation group: \u0026#39;com.h2database\u0026#39;, name: \u0026#39;h2\u0026#39;, version: \u0026#39;2.1.214\u0026#39; 10. embedded-redis 1 2 3 testImplementation (group: \u0026#39;it.ozimov\u0026#39;, name: \u0026#39;embedded-redis\u0026#39;, version: \u0026#39;0.7.3\u0026#39;) { exclude group: \u0026#39;org.slf4j\u0026#39;, module: \u0026#39;slf4j-simple\u0026#39; } 11. actuator 1 implementation group: \u0026#39;org.springframework.boot\u0026#39;, name: \u0026#39;spring-boot-starter-actuator\u0026#39;, version: \u0026#39;3.0.5\u0026#39; 12. redission 1 implementation group: \u0026#39;org.redisson\u0026#39;, name: \u0026#39;redisson-spring-boot-starter\u0026#39;, version: \u0026#39;3.20.0\u0026#39; 13. caffeine 1 implementation group: \u0026#39;com.github.ben-manes.caffeine\u0026#39;, name: \u0026#39;caffeine\u0026#39;, version: \u0026#39;3.1.5\u0026#39; 14. hutool-core 1 2 implementation group: \u0026#39;cn.hutool\u0026#39;, name: \u0026#39;hutool-core\u0026#39;, version: \u0026#39;5.8.15\u0026#39; implementation group: \u0026#39;cn.hutool\u0026#39;, name: \u0026#39;hutool-extra\u0026#39;, version: \u0026#39;5.8.16\u0026#39; 15. minio 1 implementation group: \u0026#39;io.minio\u0026#39;, name:\u0026#39;minio\u0026#39;, version: \u0026#39;8.4.3\u0026#39; 16. vavr 1 implementation group: \u0026#39;io.vavr\u0026#39;, name: \u0026#39;vavr\u0026#39;, version: \u0026#39;0.10.4\u0026#39; 17. apm 1 implementation group: \u0026#39;org.apache.skywalking\u0026#39;, name: \u0026#39;apm-toolkit-logback-1.x\u0026#39;, version: \u0026#39;8.15.0\u0026#39; 18. json-path 1 implementation group: \u0026#39;com.jayway.jsonpath\u0026#39;, name: \u0026#39;json-path\u0026#39;, version: \u0026#39;2.8.0\u0026#39; æ·»åŠ æ•°æ®åº“è¡¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 import com.baomidou.mybatisplus.generator.FastAutoGenerator; import com.baomidou.mybatisplus.generator.config.OutputFile; import com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine; import org.junit.jupiter.api.Test; import java.util.Collections; public class CodeGenerator { @Test public void generator() { FastAutoGenerator.create(\u0026#34;jdbc:mysql://localhost:3306/file_center?serverTimezone=Asia/Shanghai\u0026#34;, \u0026#34;\u0026#34;, \u0026#34;\u0026#34;) .globalConfig(builder -\u0026gt; { builder.author(\u0026#34;baomidou\u0026#34;) // è®¾ç½®ä½œè€… .enableSwagger() // å¼€å¯ swagger æ¨¡å¼ .fileOverride() // è¦†ç›–å·²ç”Ÿæˆæ–‡ä»¶ .outputDir(\u0026#34;/Users/disco/Downloads/outputFileCenter\u0026#34;); // æŒ‡å®šè¾“å‡ºç›®å½• }) .packageConfig(builder -\u0026gt; { builder.parent(\u0026#34;com.baomidou.mybatisplus.samples.generator\u0026#34;) // è®¾ç½®çˆ¶åŒ…å .moduleName(\u0026#34;system\u0026#34;) // è®¾ç½®çˆ¶åŒ…æ¨¡å—å .pathInfo(Collections.singletonMap(OutputFile.xml, \u0026#34;/Users/disco/Downloads/outputFileCenter\u0026#34;)); // è®¾ç½®mapperXmlç”Ÿæˆè·¯å¾„ }) .strategyConfig(builder -\u0026gt; { builder.addInclude(Collections.emptyList()); // è®¾ç½®éœ€è¦ç”Ÿæˆçš„è¡¨å // .addTablePrefix(\u0026#34;t_\u0026#34;, \u0026#34;c_\u0026#34;); // è®¾ç½®è¿‡æ»¤è¡¨å‰ç¼€ }) .templateEngine(new FreemarkerTemplateEngine()) // ä½¿ç”¨Freemarkerå¼•æ“æ¨¡æ¿ï¼Œé»˜è®¤çš„æ˜¯Velocityå¼•æ“æ¨¡æ¿ .execute(); } } ","date":"2025-03-06T00:00:00Z","permalink":"https://MyLoveES.github.io/p/build-spring-web-project/","title":"Build spring web project"},{"content":" R: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\nå¸‚åœºåˆ†æå¸ˆç»å¸¸ç ”ç©¶ä¸åŒç¾¤ä½“ä¹‹é—´çš„å·®å¼‚:\næŒ‰äººç¾¤å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼šç”·æ€§æˆ–å¥³æ€§æ›´å€¾å‘äºè®¢é˜…æˆ‘ä»¬çš„æœåŠ¡ï¼Ÿå“ªä¸ªäººå£ç»Ÿè®¡åˆ†æ®µæœ€æœ‰èƒ½åŠ›è´­ä¹°æˆ‘ä»¬çš„äº§å“ï¼Ÿè¯¥äº§å“æ›´å—æˆ¿ä¸»è¿˜æ˜¯ç§Ÿæˆ·çš„é’çï¼Ÿ æŒ‰åœ°ç†ä½ç½®å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼šAåœ°åŒºçš„è¡¨ç°æ˜¯å¦ä¼˜äºBåœ°åŒºï¼Ÿ æŒ‰å®éªŒæ“ä½œå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼šå¹¿å‘Šç‰ˆæœ¬Açš„è½¬åŒ–ç‡æ˜¯å¦é«˜äºå¹¿å‘Šç‰ˆæœ¬Bï¼Ÿ æŒ‰æ—¶é—´å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼šç±»ä¼¼é‚®ä»¶æˆ–ä¿ƒé”€æ´»åŠ¨åï¼ŒåŒåº—é”€å”®æ˜¯å¦å¢åŠ äº†ï¼Ÿ\nåœ¨æ‰€æœ‰è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªæ•°æ®ç»„ä¸å¦ä¸€ä¸ªæ•°æ®ç»„è¿›è¡Œæ¯”è¾ƒï¼Œä»¥è¯†åˆ«æ•ˆåº”ã€‚æœ¬æ•™ç¨‹æ¢è®¨äº†å¸‚åœºè¥é”€ä¸­ç»å¸¸å‡ºç°çš„è¿™äº›æ¯”è¾ƒç±»å‹ã€‚ 1 Descriptives by group æˆ‘ä»¬ä½¿ç”¨æ¶ˆè´¹è€…ç»†åˆ†æ•°æ®ã€‚æˆ‘ä»¬å¯¹ä¸¤ä¸ªæ–°å¼€å‘çš„å¹¿å‘Šï¼ˆå™äº‹å‹ vs. ä¿¡æ¯å‹ï¼‰çš„æ•ˆæœæ„Ÿå…´è¶£ï¼Œå¹¶æ”¶é›†äº†æ¥è‡ª300åå—è®¿è€…çš„æ•°æ®ï¼ŒåŒ…æ‹¬ä»–ä»¬çš„å¹´é¾„ã€æ€§åˆ«ã€å­å¥³æ•°é‡ã€æ˜¯å¦å–œæ¬¢å¹¿å‘Šä»¥åŠä»–ä»¬åœ¨é¡µé¢ä¸ŠèŠ±è´¹çš„æ—¶é—´ã€‚åœ¨è¿™äº›æ•°æ®ä¸­ï¼Œæ¯ä¸ªå—è®¿è€…æ¥è‡ªæˆ‘ä»¬çš„å››ä¸ªæ¶ˆè´¹è€…ç»†åˆ†ä¹‹ä¸€ï¼šéƒŠåŒºæ··åˆã€éƒ½å¸‚æ½®æµã€æ—…è¡Œè€…æˆ–æ™‹å‡ä¸­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026gt; ad.df \u0026lt;- read.csv(\u0026#34;Data_Compare_Groups.csv\u0026#34;, stringsAsFactors = TRUE) \u0026gt; summary(ad.df) condition like seconds_spent age gender kids segment control :159 likeNo :260 Min. : 0.69 Min. :19.00 Female:157 Min. :0.00 Moving up : 70 treatment:141 likeYes: 40 1st Qu.: 39.66 1st Qu.:33.00 Male :143 1st Qu.:0.00 Suburb mix:100 Median : 52.02 Median :39.50 Median :1.00 Travelers : 80 Mean : 50.98 Mean :41.17 Mean :1.27 Urban hip : 50 3rd Qu.: 61.41 3rd Qu.:48.00 3rd Qu.:2.00 Max. :114.28 Max. :80.00 Max. :7.00 \u0026gt; str(ad.df) \u0026#39;data.frame\u0026#39;:\t300 obs. of 7 variables: $ condition : Factor w/ 2 levels \u0026#34;control\u0026#34;,\u0026#34;treatment\u0026#34;: 1 2 2 1 2 2 1 1 1 2 ... $ like : Factor w/ 2 levels \u0026#34;likeNo\u0026#34;,\u0026#34;likeYes\u0026#34;: 1 1 1 1 1 1 1 1 1 1 ... $ seconds_spent: num 49.5 35.5 44.2 81 79.3 ... $ age : int 47 31 43 37 41 43 38 28 44 35 ... $ gender : Factor w/ 2 levels \u0026#34;Female\u0026#34;,\u0026#34;Male\u0026#34;: 2 2 2 1 1 2 2 2 1 1 ... $ kids : int 2 1 0 1 3 4 3 0 1 0 ... $ segment : Factor w/ 4 levels \u0026#34;Moving up\u0026#34;,\u0026#34;Suburb mix\u0026#34;,..: 2 2 2 2 2 2 2 2 2 2 ... æˆ‘ä»¬å¯¹å¹¿å‘Šçš„ä¸¤ä¸ªç‰ˆæœ¬åœ¨è¯¸å¦‚æµè§ˆæ—¶é•¿å’Œå–œæ¬¢ç¨‹åº¦ç­‰æŒ‡æ ‡ä¸Šçš„å˜åŒ–æ„Ÿå…´è¶£ã€‚\nä¸€ç§ä¸´æ—¶çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ•°æ®æ¡†ç´¢å¼•ï¼šæ‰¾åˆ°ç¬¦åˆæŸäº›æ¡ä»¶çš„è¡Œï¼Œç„¶åå–å¦ä¸€ä¸ªç»Ÿè®¡é‡çš„å¹³å‡å€¼ã€‚ä¾‹å¦‚ï¼Œè¦æ‰¾å‡ºå™äº‹å‹å¹¿å‘Šï¼ˆå¤„ç†ç»„ï¼‰çš„å¹³å‡æ€»æµè§ˆæ—¶é•¿ã€‚\n1 2 3 4 5 6 \u0026gt; mean(ad.df$seconds_spent[ad.df$condition == \u0026#34;treatment\u0026#34;]) [1] 55.01809 \u0026gt; # We could further narrow the cases to Moving up respondents who are in the treatment condition: \u0026gt; mean(ad.df$seconds_spent[ad.df$condition == \u0026#34;trea ...\u0026#34; ... [TRUNCATED] [1] 50.21652 1.1 aggregate() å½“ä½ æƒ³è¦æ‰¾åˆ°å¤šä¸ªç»„çš„å€¼æ—¶ï¼Œä¸€ä¸ªæ›´é€šç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨aggregate()å‡½æ•°ã€‚\n1 2 3 4 \u0026gt; aggregate(ad.df$seconds_spent, list(ad.df$condition), mean) Group.1 x 1 control 47.39132 2 treatment 55.01809 1.2 Basic formula syntax Ré€šè¿‡å…¬å¼è§„èŒƒæä¾›äº†æè¿°å˜é‡ä¹‹é—´å…³ç³»çš„æ ‡å‡†æ–¹æ³•ã€‚ä¸€ä¸ªå…¬å¼ä½¿ç”¨æ³¢æµªçº¿ï¼ˆ~ï¼‰è¿ç®—ç¬¦å°†å·¦ä¾§çš„å“åº”å˜é‡ä¸å³ä¾§çš„è§£é‡Šå˜é‡åˆ†å¼€ã€‚åŸºæœ¬å½¢å¼æ˜¯ï¼š\n1 y ~ xï¼ˆç®€å•å…¬å¼ï¼‰ è¿™åœ¨Rçš„è®¸å¤šæƒ…å¢ƒä¸­ä½¿ç”¨ï¼Œå…¶ä¸­å“åº”å’Œè§£é‡Šçš„å«ä¹‰å–å†³äºæƒ…å†µã€‚ä¾‹å¦‚ï¼Œåœ¨çº¿æ€§å›å½’ä¸­ï¼Œä¸Šè¿°ç®€å•å…¬å¼å°†yå»ºæ¨¡ä¸ºxçš„çº¿æ€§å‡½æ•°ã€‚åœ¨aggregate()å‘½ä»¤çš„æƒ…å†µä¸‹ï¼Œæ•ˆæœæ˜¯æ ¹æ®xçš„æ°´å¹³å¯¹yè¿›è¡Œèšåˆã€‚ è®©æˆ‘ä»¬å®è·µä¸€ä¸‹ã€‚ä¸ä½¿ç”¨aggregate(ad.dfsecondsspent,list(ad.dfcondition), mean)çš„æ–¹å¼ï¼Œè€Œæ˜¯ä½¿ç”¨é€šç”¨å½¢å¼aggregate(formula, data, FUN)ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å‘Šè¯‰Râ€œåœ¨æ•°æ®é›†ad.dfä¸­æŒ‰ç…§æ¡ä»¶å–seconds_spentï¼Œå¹¶å¯¹æ¯ä¸ªç»„åº”ç”¨å¹³å‡å‡½æ•°â€ã€‚\n1 2 3 4 \u0026gt; aggregate(seconds_spent ~ condition, data = ad.df, mean) condition seconds_spent 1 control 47.39132 2 treatment 55.01809 1.3 Descriptives for two-way groups åœ¨å¸‚åœºè¥é”€ä¸­çš„ä¸€ä¸ªå¸¸è§ä»»åŠ¡æ˜¯äº¤å‰åˆ¶è¡¨ï¼Œæ ¹æ®ä¸¤ä¸ªï¼ˆæˆ–æ›´å¤šï¼‰å› ç´ å°†å®¢æˆ·åˆ†æˆç»„ã€‚å…¬å¼è¯­æ³•ä½¿å¾—é€šè¿‡æŒ‡å®šå¤šä¸ªè§£é‡Šå˜é‡æ¥è®¡ç®—äº¤å‰åˆ¶è¡¨å˜å¾—å®¹æ˜“ï¼š\ny ~ x1 + x2 + . . . (Multiple variable formula)\n1.3.1 Means åˆ©ç”¨è¿™ç§æ ¼å¼ä¸aggregate()ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š\n1 2 3 4 5 6 7 8 9 10 \u0026gt; aggregate(seconds_spent ~ segment + condition, data = ad.df, mean) segment condition seconds_spent 1 Moving up control 54.49787 2 Suburb mix control 54.93308 3 Travelers control 63.18900 4 Urban hip control 21.33800 5 Moving up treatment 50.21652 6 Suburb mix treatment 55.14312 7 Travelers treatment 62.08533 8 Urban hip treatment 23.05800 ç°åœ¨ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªæ®µå’Œæ¡ä»¶çš„ç»„åˆéƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„ç»„ï¼Œå¹¶ä¸”å¯ä»¥å¼€å§‹çœ‹åˆ°seconds_spentä¸æ®µå’Œæ¡ä»¶å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚\næˆ‘ä»¬å¯ä»¥å°†ç»“æœåˆ†é…ç»™ä¸€ä¸ªæ•°æ®æ¡†å¯¹è±¡å¹¶è¿›è¡Œç´¢å¼•ï¼š\n1 agg.data \u0026lt;- aggregate(seconds_spent ~ segment + condition, data = ad.df, mean) aggregate()å‘½ä»¤å…è®¸æˆ‘ä»¬è®¡ç®—è¿ç»­å˜é‡çš„å‡½æ•°ï¼Œä¾‹å¦‚seconds_spentæˆ–likeçš„å¹³å‡å€¼ï¼Œé€‚ç”¨äºä»»ä½•å› ç´ çš„ç»„åˆï¼ˆå¦‚æ®µã€æ¡ä»¶ç­‰ï¼‰ã€‚è¿™æ˜¯å¸‚åœºç ”ç©¶ä¸­çš„ä¸€ä¸ªå¸¸è§ä»»åŠ¡ï¼Œè®¸å¤šå…¬å¸ä¸“é—¨ç”Ÿäº§äº¤å‰åˆ¶è¡¨ã€‚\n1.3.2 Frequencies 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; table(ad.df$condition, ad.df$like) likeNo likeYes control 137 22 treatment 123 18 \u0026gt; table(ad.df$segment, ad.df$like) likeNo likeYes Moving up 56 14 Suburb mix 94 6 Travelers 70 10 Urban hip 40 10 æˆ‘ä»¬å¯ä»¥å°†è®¡æ•°ç›¸åŠ ä»¥æ‰¾åˆ°å®ƒä»¬çš„æ€»æ•°ã€‚ä¾‹å¦‚ï¼Œkidsæ˜¯ä¸€ä¸ªè®¡æ•°å˜é‡ï¼›å¦‚æœä¸€ä¸ªå—è®¿è€…æŠ¥å‘Šæœ‰3ä¸ªå­©å­ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªè®¡æ•°ä¸º3ï¼Œæˆ‘ä»¬å¯ä»¥å°†è®¡æ•°ç›¸åŠ ä»¥å¾—åˆ°æ¯ä¸ªæ®µä¸­æŠ¥å‘Šçš„å­©å­æ€»æ•°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨aggregate(. . . , sum)ï¼š\n1 2 3 4 5 6 \u0026gt; aggregate(kids ~ segment, data = ad.df, sum) segment kids 1 Moving up 134 2 Suburb mix 192 3 Travelers 0 4 Urban hip 55 ç»“æœæ˜¾ç¤ºï¼Œâ€œéƒ½å¸‚ä¸Šå‡â€å—è®¿è€…æŠ¥å‘Šäº†æ€»å…±55ä¸ªå­©å­ï¼Œè€Œâ€œæ—…è¡Œè€…â€æ²¡æœ‰æŠ¥å‘Šã€‚\n2 Visualization by group 2.1 Visualizing frequencies and proportions LatticeåŒ…æä¾›äº†ä¸€ä¸ªæœ‰ç”¨çš„è§£å†³æ–¹æ¡ˆï¼šhistogram (formula, data, type)ã€‚å®ƒç†è§£å…¬å¼çš„æ¦‚å¿µï¼ŒåŒ…æ‹¬å¯¹å› å­è¿›è¡Œæ¡ä»¶åˆ’åˆ†ï¼ˆ\u0026quot; | \u0026ldquo;ï¼‰ï¼Œè¿™æ„å‘³ç€æ ¹æ®å› å­å°†ç»˜å›¾åˆ†æˆå¤šä¸ªé¢æ¿ã€‚\n1 histogram(~ like | condition, data = ad.df) ç»“æœæ˜¾ç¤ºï¼Œä¸¤ä¸ªå¹¿å‘Šç‰ˆæœ¬ç”Ÿæˆçš„å–œæ¬¢ç¨‹åº¦ç›¸ä¼¼ã€‚\nä½ ä¼šæ³¨æ„åˆ°åœ¨è¿™ä¸ªå…¬å¼ä¸­ï¼Œæ³¢æµªçº¿ï¼ˆ~ï¼‰å‰é¢æ²¡æœ‰å“åº”å˜é‡ï¼Œåªæœ‰å®ƒåé¢çš„è§£é‡Šå˜é‡ï¼ˆconditionï¼‰ã€‚histogram()é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦ç»˜åˆ¶æ¯ä¸ªå–œæ¬¢ç¨‹åº¦æ°´å¹³ä¸Šçš„äººç¾¤æ¯”ä¾‹ã€‚æˆ‘ä»¬åœ¨æ¡ä»¶ä¸Šè¿›è¡Œäº†ç»˜å›¾ï¼Œå‘Šè¯‰histogramä¸ºæ¯ä¸ªæ®µç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„ç›´æ–¹å›¾ã€‚ histogram()çš„é»˜è®¤æ–¹å¼æ˜¯åœ¨æ¯ä¸ªç»„å†…ç»˜åˆ¶æ¯”ä¾‹ï¼Œä½¿å¾—å€¼ç›¸å¯¹äºç»„çš„å¤§å°ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦å®é™…è®¡æ•°ï¼Œå¯ä»¥åŒ…å«å‚æ•°type = \u0026ldquo;count\u0026rdquo;ã€‚\n{% asset_image R_week9_code_2.png %}\næˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨â€œ+â€åœ¨å¤šä¸ªå› ç´ ä¸Šæ·»åŠ æ¡ä»¶ã€‚ä¾‹å¦‚ï¼Œæ¯ä¸ªæ®µå†…çš„è®¢é˜…è€…æ¯”ä¾‹å¦‚ä½•æ ¹æ®ä½æˆ¿æ‰€æœ‰æƒæ¥è®¡ç®—ï¼Ÿ\n{% asset_image R_week9_code_3.png %}\nç»“æœå‘Šè¯‰æˆ‘ä»¬ï¼Œæ ¹æ®å¹¿å‘Šæ¡ä»¶åœ¨æ®µå†…çš„å–œæ¬¢ç¨‹åº¦å·®å¼‚å¾ˆå°ã€‚è¿™æ„å‘³ç€ä¸¤ä¸ªå¹¿å‘Šç‰ˆæœ¬åœ¨å–œæ¬¢ç¨‹åº¦ä¸Šäº§ç”Ÿçš„å·®å¼‚å¾ˆå°ã€‚\n2.2 Visualizing continuous data åœ¨å‰é¢çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ç»˜åˆ¶è®¡æ•°å’Œæ¯”ä¾‹ã€‚é‚£ä¹ˆè¿ç»­æ•°æ®å‘¢ï¼Ÿæˆ‘ä»¬å¦‚ä½•ç»˜åˆ¶æˆ‘ä»¬æ•°æ®ä¸­æŒ‰æ¡ä»¶åˆ†ç»„çš„æ€»æµè§ˆæ—¶é—´ï¼Ÿä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨aggregate()æ¥æ‰¾åˆ°å¹³å‡æ€»æ—¶é—´ï¼Œç„¶åä½¿ç”¨latticeåŒ…ä¸­çš„barchart()æ¥ç»˜åˆ¶è®¡ç®—å‡ºçš„å€¼ï¼š\n1 2 3 \u0026gt; ad.mean \u0026lt;- aggregate(seconds_spent ~ condition, data = ad.df, mean) \u0026gt; barchart(seconds_spent ~ condition, data = ad.mean, col = \u0026#34;grey\u0026#34;) {% asset_image R_week9_code_4.png %}\næˆ‘ä»¬å¦‚ä½•è¿›ä¸€æ­¥æŒ‰æ®µæ‹†åˆ†æ•°æ®ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»å¯¹æ•°æ®è¿›è¡Œèšåˆï¼Œä»¥åœ¨å…¬å¼ä¸­åŒ…æ‹¬ä¸¤ä¸ªå› ç´ ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡æ·»åŠ å‚æ•°groups=factorï¼Œå‘Šè¯‰barchart()ä½¿ç”¨æ®µä½œä¸ºåˆ†ç»„å˜é‡ã€‚\n1 2 3 \u0026gt; ad.seconds.agg \u0026lt;- aggregate (seconds_spent ~ condition + segment, data = ad.df, mean) \u0026gt; barchart(seconds_spent ~ condition, data = ad.seconds.agg ,groups = segment, auto.key=TRUE) {% asset_image R_week9_code_5.png %}\nç”¨äºæ¯”è¾ƒä¸åŒç»„çš„è¿ç»­æ•°æ®å€¼ï¼ˆå¦‚ä¸åŒç»„çš„seconds_spentï¼‰çš„æ›´å…·ä¿¡æ¯æ€§çš„å›¾è¡¨æ˜¯ç®±çº¿å›¾ã€‚ç®±çº¿å›¾æ¯”æŸ±çŠ¶å›¾æ›´å¥½ï¼Œå› ä¸ºå®ƒæ˜¾ç¤ºäº†æ›´å¤šå…³äºå€¼åˆ†å¸ƒçš„ä¿¡æ¯ã€‚\n{% asset_image R_week9_code_6.png %}\n2.2.1 bwplot() * å¯¹äºç®±çº¿å›¾çš„æ›´å¥½é€‰æ‹©æ˜¯latticeåŒ…ä¸­çš„bwplot()å‘½ä»¤ï¼Œå®ƒæä¾›äº†æ›´æ¼‚äº®çš„å›¾è¡¨ï¼Œå¹¶ä¸”å…è®¸å¤šå› ç´ æ¡ä»¶åŒ–ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œbwplot()ä½¿ç”¨çš„æ¨¡å‹å…¬å¼æ–¹å‘ä¸ä½ å¯èƒ½æœŸæœ›çš„ç›¸åï¼›ä½ å†™çš„æ˜¯condition ~ seconds_spentã€‚æˆ‘ä»¬æŒ‰æ®µç»˜åˆ¶æ°´å¹³ç®±çº¿å›¾å¦‚ä¸‹ï¼š\n1 bwplot(condition ~ seconds_spent, data = ad.df, horizontal = TRUE, xlab = \u0026#34;Total seconds spent\u0026#34;) {% asset_image R_week9_code_7.png %}\næˆ‘ä»¬å¯ä»¥å°†å¤„ç†æ¡ä»¶ä½œä¸ºä¸€ä¸ªæ¡ä»¶å˜é‡ï¼š\n1 bwplot(condition ~ seconds_spent | segment, data = ad.df, horizontal = TRUE, xlab = \u0026#34;seconds_spent\u0026#34;) {% asset_image R_week9_code_8.png %}\nå¯¹äºæŒ‰æ®µå’Œå¹¿å‘Šæ¡ä»¶åˆ†ç»„çš„æ€»æµè§ˆæ—¶é•¿çš„æ¡ä»¶åŒ–å›¾è¡¨æ˜¾ç¤ºï¼Œæ—…è¡Œè€…ç»†åˆ†ä¸­å¤„äºå¤„ç†ç»„çš„äººçš„æ€»æµè§ˆæ—¶é•¿åˆ†å¸ƒæ¯”å¤„äºå¯¹ç…§ç»„çš„äººçš„åˆ†å¸ƒè¦å®½å¾—å¤šã€‚\n3 Statistical tests é™¤äº†ä½¿ç”¨ä¸Šé¢æè¿°çš„ç»„å¹³å‡å€¼å’Œäº¤å‰åˆ¶è¡¨æ€»ç»“ç»„é—´çš„å·®å¼‚å¤–ï¼Œä¸€ä¸ªä¼˜ç§€çš„åˆ†æå¸ˆèƒ½å¤Ÿä½¿ç”¨ç»Ÿè®¡æ£€éªŒæ¥ç¡®å®šå·®å¼‚æ˜¯å¦çœŸå®ï¼Œæˆ–è€…å¯èƒ½æ˜¯ç”±äºæ•°æ®ä¸­çš„å¾®å°å˜åŒ–ï¼ˆâ€œå™ªéŸ³â€ï¼‰é€ æˆçš„ã€‚æˆ‘ä»¬åº”è¯¥ä¸“æ³¨äºå¸®åŠ©è¯†åˆ«çœŸå®å·®å¼‚çš„ç»Ÿè®¡æ£€éªŒã€‚\n3.1 Testing group frequencies: chisq.test() å¡æ–¹æ£€éªŒç”¨äºé¢‘ç‡è®¡æ•°ï¼Œä¾‹å¦‚ç”±tableäº§ç”Ÿçš„è®¡æ•°ã€‚å¡æ–¹æ£€éªŒç¡®å®šå•å…ƒæ ¼ä¸­çš„é¢‘ç‡æ˜¯å¦ä¸åŸºäºå®ƒä»¬çš„æ€»è®¡æ•°çš„é¢„æœŸå€¼æ˜¾ç€ä¸åŒã€‚åœ¨Rä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨chisq.test()å‘½ä»¤ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œchisq.test()æ“ä½œåœ¨ä¸€ä¸ªè¡¨ä¸Šã€‚\nå–œæ¬¢è¡Œä¸ºæ˜¯å¦ç‹¬ç«‹äºæ¡ä»¶ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æˆ‘ä»¬çš„æ•°æ®ä¸­ï¼Œå—è®¿è€…æ— è®ºçœ‹åˆ°å“ªä¸ªç‰ˆæœ¬çš„å¹¿å‘Šï¼Œä»–ä»¬éƒ½åŒæ ·å¯èƒ½å–œæ¬¢å—ï¼Ÿæˆ‘ä»¬æ„å»ºä¸€ä¸ªäºŒç»´è¡¨å¹¶å¯¹å…¶è¿›è¡Œæµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; table(ad.df$like, ad.df$condition) control treatment likeNo 137 123 likeYes 22 18 \u0026gt; chisq.test(table(ad.df$like, ad.df$condition)) Pearson\u0026#39;s Chi-squared test with Yates\u0026#39; continuity correction data: table(ad.df$like, ad.df$condition) X-squared = 0.010422, df = 1, p-value = 0.9187 åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé›¶å‡è®¾æ˜¯å› ç´ ä¹‹é—´æ²¡æœ‰å…³è”ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå•å…ƒæ ¼ä¸­çš„è®¡æ•°ä¸è¾¹é™…æ¯”ä¾‹ä¸€æ ·ç¬¦åˆé¢„æœŸã€‚åŸºäºè¾ƒé«˜çš„på€¼ï¼Œæˆ‘ä»¬æ— æ³•æ‹’ç»é›¶å‡è®¾ï¼Œå¹¶å¾—å‡ºç»“è®ºï¼šå› ç´ ä¹‹é—´æ²¡æœ‰å…³è”ï¼Œå–œæ¬¢ä¸æ¡ä»¶åœ¨æˆ‘ä»¬çš„æ•°æ®ä¸­æ˜¯ç‹¬ç«‹çš„ã€‚å–œæ¬¢å’Œæ¡ä»¶ä¹‹é—´æ²¡æœ‰å…³ç³»ã€‚\n3.2 Testing group means: t.test() tæ£€éªŒæ¯”è¾ƒä¸€ä¸ªæ ·æœ¬çš„å¹³å‡å€¼ä¸å¦ä¸€ä¸ªæ ·æœ¬çš„å¹³å‡å€¼ï¼ˆæˆ–ä¸ä¸€ä¸ªç‰¹å®šå€¼ï¼Œå¦‚0ï¼‰ä¹‹é—´çš„å·®å¼‚ã€‚é‡è¦çš„æ˜¯ï¼Œå®ƒæ¯”è¾ƒäº†å®Œå…¨ä¸¤ç»„æ•°æ®çš„å¹³å‡å€¼ã€‚ä¾‹å¦‚ï¼Œåœ¨æ•°æ®ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¯¢é—®ä¸¤ç§å¹¿å‘Šæ¡ä»¶ä¹‹é—´çš„æ€»æµè§ˆæ—¶é—´æ˜¯å¦æœ‰æ‰€ä¸åŒã€‚\næˆ‘ä»¬ä½¿ç”¨t.test(formula, data)æµ‹è¯•ä¸¤ç»„ä¹‹é—´çš„æµè§ˆæ—¶é—´ï¼ˆå¤„ç†ç»„ vs. æ§åˆ¶ç»„ï¼‰çš„å·®å¼‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; t.test(seconds_spent ~ condition, data = ad.df) Welch Two Sample t-test data: seconds_spent by condition t = -3.3297, df = 286.45, p-value = 0.0009832 alternative hypothesis: true difference in means between group control and group treatment is not equal to 0 95 percent confidence interval: -12.135137 -3.118392 sample estimates: mean in group control mean in group treatment 47.39132 55.01809 åœ¨t.test()è¾“å‡ºä¸­æœ‰å‡ ä¸ªé‡è¦çš„ä¿¡æ¯ï¼š\ntç»Ÿè®¡é‡ä¸º-3.12ï¼Œpå€¼ä¸º0.0010ã€‚è¿™æ„å‘³ç€æ‹’ç»äº†æ²¡æœ‰å¹¿å‘Šæ¡ä»¶ä¸‹æµè§ˆæ—¶é—´å·®å¼‚çš„é›¶å‡è®¾ã€‚è¿™è¡¨æ˜åœ¨å¤„ç†ç»„çœ‹åˆ°å¹¿å‘Šç‰ˆæœ¬çš„äººèŠ±è´¹äº†æ›´é•¿çš„æ—¶é—´ã€‚ å·®å¼‚çš„95%ç½®ä¿¡åŒºé—´ä¸º-12.14åˆ°-3.12ã€‚æˆ‘ä»¬å¯ä»¥æœ‰95%çš„ä¿¡å¿ƒè®¤ä¸ºç»„ä¹‹é—´çš„å·®å¼‚åœ¨è¿™äº›å€¼ä¹‹é—´ã€‚ æˆ‘ä»¬æ•°æ®çš„æ ·æœ¬å‡å€¼ï¼šæ§åˆ¶æ¡ä»¶ä¸‹çš„å¹³å‡æ€»æµè§ˆæ—¶é—´ä¸º47.39132ï¼Œå¤„ç†æ¡ä»¶ä¸‹ä¸º55.01809ã€‚ åœ¨æ—…è¡Œè€…ç»†åˆ†ä¸­çš„å·®å¼‚å¦‚ä½•ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿‡æ»¤æ•°æ®=å­é›†æ•°æ®, æ¡ä»¶é€‰æ‹©åªæœ‰æ—…è¡Œè€…ï¼Œå¹¶é‡å¤æµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; t.test(seconds_spent ~ condition, data = subset(ad.df, segment == \u0026#34;Travelers\u0026#34;)) Welch Two Sample t-test data: seconds_spent by condition t = 0.22758, df = 52.758, p-value = 0.8209 alternative hypothesis: true difference in means between group control and group treatment is not equal to 0 95 percent confidence interval: -8.624575 10.831909 sample estimates: mean in group control mean in group treatment 63.18900 62.08533 ç½®ä¿¡åŒºé—´ä»-8.62åˆ°10.83åŒ…å«äº†0ï¼Œå¹¶ä¸”på€¼ä¸º0.82ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¾—å‡ºç»“è®ºï¼Œåœ¨æˆ‘ä»¬çš„æ•°æ®ä¸­ï¼Œæ—…è¡Œè€…ä¸­ä¸¤ä¸ªæ¡ä»¶ä¹‹é—´çš„å¹³å‡æµè§ˆæ—¶é—´æ²¡æœ‰æ˜¾è‘—å·®å¼‚ã€‚\n3.3 Testing multiple-group means: ANOVA æ–¹å·®åˆ†æï¼ˆANOVAï¼‰æ¯”è¾ƒå¤šä¸ªç»„çš„å¹³å‡å€¼ã€‚é›¶å‡è®¾æ˜¯å¤šä¸ªå¹³å‡å€¼ä¹‹é—´æ²¡æœ‰å·®å¼‚ã€‚\nANOVAå¯ä»¥å¤„ç†å•ä¸ªå› ç´ ï¼ˆç§°ä¸ºå•å› ç´ ANOVAï¼‰ã€ä¸¤ä¸ªå› ç´ ï¼ˆåŒå› ç´ ï¼‰ã€ä»¥åŠæ›´é«˜é˜¶çš„å› ç´ ï¼ŒåŒ…æ‹¬å› ç´ ä¹‹é—´çš„äº¤äº’ä½œç”¨ã€‚\nANOVAçš„åŸºæœ¬Rå‘½ä»¤æ˜¯aov(formula, data)æ¥è®¾ç½®æ¨¡å‹ï¼Œç„¶åæ˜¯anova(model)æ¥æ˜¾ç¤ºæ ‡å‡†çš„ANOVAæ±‡æ€»ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼šæµè§ˆæ—¶é—´ä¸æ¡ä»¶ã€æ®µæˆå‘˜èµ„æ ¼æˆ–ä¸¤è€…ä¹‹é—´æ˜¯å¦ç›¸å…³ï¼Ÿæˆ‘ä»¬å¯ä»¥å°†seconds_spentå»ºæ¨¡ä¸ºå¯¹æ¡ä»¶çš„å“åº”ï¼š\n1 2 3 4 5 6 7 8 9 10 11 \u0026gt; ad.aov.con \u0026lt;- aov(seconds_spent ~ condition, data = ad.df) \u0026gt; anova(ad.aov.con) Analysis of Variance Table Response: seconds_spent Df Sum Sq Mean Sq F value Pr(\u0026gt;F) condition 1 4347 4346.9 11.195 0.0009251 *** Residuals 298 115706 388.3 --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 åœ¨ä¸¤ä¸ªæ¡ä»¶ä¹‹é—´çš„æµè§ˆæ—¶é—´å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼ˆä¸æˆ‘ä»¬ä»tæ£€éªŒä¸­å¾—å‡ºçš„ç»“è®ºç›¸åŒï¼‰ã€‚\nä¸ºäº†æµ‹è¯•æµè§ˆæ—¶é—´æ˜¯å¦åŒæ—¶å—åˆ°æ¡ä»¶å’Œæ®µçš„å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸¤ä¸ªå› ç´ éƒ½æ·»åŠ åˆ°ANOVAæ¨¡å‹ä¸­è¿›è¡Œæµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 \u0026gt; anova(aov(seconds_spent ~ segment + condition, data = ad.df)) # combine two commands Analysis of Variance Table Response: seconds_spent Df Sum Sq Mean Sq F value Pr(\u0026gt;F) segment 3 55237 18412.2 83.8824 \u0026lt;2e-16 *** condition 1 64 63.9 0.2913 0.5898 Residuals 295 64753 219.5 --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 ç»“æœè¡¨æ˜ï¼Œå½“æˆ‘ä»¬å°è¯•ç”¨æ®µå’Œæ¡ä»¶æ¥è§£é‡Šæ€»æµè§ˆæ—¶é—´çš„å·®å¼‚æ—¶ï¼Œæ®µæ˜¯ä¸€ä¸ªæ˜¾è‘—çš„é¢„æµ‹å› å­ï¼Œä½†æ¡ä»¶ä¸æ˜¯ä¸€ä¸ªæ˜¾è‘—çš„é¢„æµ‹å› å­ã€‚ç„¶è€Œï¼Œå…ˆå‰çš„ç»“æœè¡¨æ˜æ¡ä»¶æ˜¯æ˜¾è‘—çš„ã€‚è¿™ç§å·®å¼‚æ˜¯ä»€ä¹ˆï¼Ÿè¿™æ„å‘³ç€æ®µå’Œæ¡ä»¶ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œä¸”æ®µæˆå‘˜èµ„æ ¼å•ç‹¬å°±è¶³ä»¥æ•æ‰åˆ°æ•ˆåº”ã€‚æ¡ä»¶ä»…ä»…æ¯”æ®µè§£é‡Šäº†ç¨å¾®å¤šä¸€ç‚¹ã€‚\n3.3.1 Visualize ANOVA result å¯è§†åŒ–ANOVAç»“æœçš„ä¸€ä¸ªå¥½æ–¹æ³•æ˜¯ç»˜åˆ¶ç»„å‡å€¼çš„ç½®ä¿¡åŒºé—´ã€‚æˆ‘ä»¬ä½¿ç”¨multcompï¼ˆå¤šé‡æ¯”è¾ƒï¼‰åŒ…å’Œå®ƒçš„glht(model)ï¼ˆä¸€èˆ¬çº¿æ€§å‡è®¾ï¼‰å‘½ä»¤ã€‚\né»˜è®¤çš„aov()æ¨¡å‹å…·æœ‰ä¸€ä¸ªæˆªè·é¡¹ï¼ˆå¯¹åº”äºä¸€ä¸ªæ®µï¼‰ï¼Œè€Œæ‰€æœ‰å…¶ä»–æ®µç›¸å¯¹äºè¯¥æˆªè·é¡¹ã€‚è¿™å¯èƒ½ä¼šè®©å†³ç­–è€…æˆ–å®¢æˆ·éš¾ä»¥ç†è§£ï¼Œå› æ­¤æˆ‘ä»¬å‘ç°æœ€å¥½é€šè¿‡åœ¨æ¨¡å‹å…¬å¼ä¸­æ·»åŠ â€œ0â€æ¥ç§»é™¤æˆªè·é¡¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; ad.aov \u0026lt;- aov (seconds_spent ~ 0 + segment, data = ad.df) \u0026gt; glht(ad.aov) General Linear Hypotheses Linear Hypotheses: Estimate segmentMoving up == 0 53.09 segmentSuburb mix == 0 55.03 segmentTravelers == 0 62.36 segmentUrban hip == 0 21.68 åœ¨ç§»é™¤æˆªè·é¡¹åï¼Œglht()ä¸ºæˆ‘ä»¬æä¾›äº†æ¯ä¸ªæ®µçš„å‡å€¼ã€‚æˆ‘ä»¬ä½¿ç”¨plot()å‡½æ•°ç»˜åˆ¶å®ƒï¼Œä½¿ç”¨par(mar =. . . )å‘½ä»¤ä¸ºé•¿è½´æ ‡ç­¾æ·»åŠ ä¸€äº›é¢å¤–çš„è¾¹è·ï¼š\n1 2 3 # cex.axis = 0.8 makes the axis labels smaller to 80%. \u0026gt; plot(glht(ad.aov), + xlab = \u0026#34;Total seconds spent\u0026#34;, main = \u0026#34;Average seconds spent by Segment (95% CI)\u0026#34;, cex.axis = 0.8) ç‚¹è¡¨ç¤ºæ¯ä¸ªæ®µçš„å‡å€¼ï¼Œæ¡å½¢å›¾åæ˜ äº†ç½®ä¿¡åŒºé—´ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ªæ®µä¸­å¹³å‡æµè§ˆæ—¶é—´çš„ç½®ä¿¡åŒºé—´ã€‚å¾ˆæ˜æ˜¾ï¼Œéƒ½å¸‚æ½®æµæ®µæˆå‘˜çš„å¹³å‡æµè§ˆæ—¶é—´æ˜æ˜¾ä½äºå…¶ä»–ä¸‰ç»„ã€‚\n3.4 Testing group means: lm() ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨lm()å›å½’æ¥æ¯”è¾ƒç»„ï¼Œå½“å“åº”å˜é‡æ˜¯è¿ç»­å˜é‡æ—¶ï¼Œæ¯”å¦‚æ€»æµè§ˆæ—¶é—´ã€‚ åˆ†ç»„å˜é‡ï¼ˆå› å­ï¼‰å¿…é¡»è¢«é‡æ–°ç¼–ç ä¸ºè™šæ‹Ÿå˜é‡ï¼ˆå³å–0å’Œ1ä¸ºå€¼çš„å˜é‡ï¼‰ã€‚ä¾‹å¦‚ï¼Œå› å­â€œæ¡ä»¶â€ï¼ˆåŒ…æ‹¬â€œå¯¹ç…§â€å’Œâ€œå¤„ç†â€ï¼‰åº”è¯¥è¢«é‡æ–°ç¼–ç ä¸ºâ€œdummy_condition: 0 = å¯¹ç…§ï¼Œ1 = å¤„ç†â€ã€‚\nå…·æœ‰å¤šäºä¸¤ä¸ªæ°´å¹³çš„å› å­ï¼ˆnï¼‰åº”è¯¥ä½¿ç”¨å¤šä¸ªè™šæ‹Ÿå˜é‡ï¼ˆn-1ï¼‰è¿›è¡Œé‡æ–°ç¼–ç ã€‚ä¾‹å¦‚ï¼Œæ®µæœ‰å››ä¸ªæ°´å¹³ï¼Œå¯ä»¥ä½¿ç”¨ä¸‰ä¸ªè™šæ‹Ÿå˜é‡è¿›è¡Œé‡æ–°ç¼–ç ï¼šdummy_sï¼Œdummy_uï¼Œdummy_tï¼š\n1 2 3 4 éƒŠåŒºæ··åˆï¼šdummy_s = 1ï¼Œdummy_u = 0ï¼Œdummy_t = 0 éƒ½å¸‚æ½®æµï¼šdummy_s = 0ï¼Œdummy_u = 1ï¼Œdummy_t = 0 æ—…è¡Œè€…ï¼šdummy_s = 0ï¼Œdummy_u = 0ï¼Œdummy_t = 1 æ™‹å‡ä¸­ï¼šdummy_s = 0ï¼Œdummy_u = 0ï¼Œdummy_t = 0ï¼ˆå‚è€ƒæ°´å¹³ï¼‰ è™šæ‹Ÿå˜é‡åº”è¯¥ä½œä¸ºé¢„æµ‹å˜é‡è¾“å…¥æ¨¡å‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026gt; ad.df.reg \u0026lt;- ad.df %\u0026gt;% + mutate(dummy_condition = ifelse(condition == \u0026#34;treatment\u0026#34;,1,0), + dummy_s = ifelse(segment == \u0026#34;Suburb mix\u0026#34;,1,0), .... [TRUNCATED] \u0026gt; regression \u0026lt;- lm(seconds_spent ~ dummy_condition, data = ad.df.reg) \u0026gt; summary(regression) Call: lm(formula = seconds_spent ~ dummy_condition, data = ad.df.reg) Residuals: Min 1Q Median 3Q Max -54.33 -11.02 0.97 12.10 66.07 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 47.391 1.563 30.327 \u0026lt; 2e-16 *** dummy_condition 7.627 2.279 3.346 0.000925 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 19.7 on 298 degrees of freedom Multiple R-squared: 0.03621,\tAdjusted R-squared: 0.03297 F-statistic: 11.2 on 1 and 298 DF, p-value: 0.0009251 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026gt; regression \u0026lt;- lm(seconds_spent ~ dummy_s + dummy_u + dummy_t, data = ad.df.reg) \u0026gt; summary(regression) Call: lm(formula = seconds_spent ~ dummy_s + dummy_u + dummy_t, data = ad.df.reg) Residuals: Min 1Q Median 3Q Max -61.671 -7.059 -0.442 6.281 51.919 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 53.091 1.769 30.017 \u0026lt; 2e-16 *** dummy_s 1.943 2.306 0.842 0.400214 dummy_u -31.409 2.740 -11.463 \u0026lt; 2e-16 *** dummy_t 9.270 2.422 3.828 0.000158 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 14.8 on 296 degrees of freedom Multiple R-squared: 0.4601,\tAdjusted R-squared: 0.4546 F-statistic: 84.08 on 3 and 296 DF, p-value: \u0026lt; 2.2e-16 3.5 Difference-in-Difference 1 2 3 4 5 6 7 \u0026gt; panel.df.raw \u0026lt;- read.csv(\u0026#34;Data_Panel.csv\u0026#34;, stringsAsFactors = TRUE) \u0026gt; str(panel.df.raw) \u0026#39;data.frame\u0026#39;:\t70 obs. of 3 variables: $ market: Factor w/ 7 levels \u0026#34;A\u0026#34;,\u0026#34;B\u0026#34;,\u0026#34;C\u0026#34;,\u0026#34;D\u0026#34;,..: 1 1 1 1 1 1 1 1 1 1 ... $ year : int 2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 ... $ profit: num 13428 -18997 -112 26458 30083 ... åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå˜é‡æ¥æŒ‡ç¤ºæ²»ç–—å¼€å§‹çš„æ—¶é—´ã€‚å‡è®¾æ²»ç–—å§‹äº2014å¹´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ2014å¹´ä¹‹å‰çš„å¹´ä»½å°†å–å€¼ä¸º0ï¼Œ2014å¹´ä¹‹åçš„å¹´ä»½å°†å–å€¼ä¸º1ã€‚\n1 2 \u0026gt; panel.df\u0026lt;-panel.df.raw %\u0026gt;% + mutate(time = ifelse(panel.df.raw$year \u0026gt;= 2014, 1, 0)) ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå˜é‡æ¥è¯†åˆ«æ¥å—æ²»ç–—çš„ç¾¤ä½“ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¸‚åœº5ã€6å’Œ7æ˜¯æ²»ç–—ç»„ï¼ˆ=1ï¼‰ã€‚å¸‚åœº1-4æ²¡æœ‰å—åˆ°å½±å“ï¼ˆ=0ï¼‰ã€‚\n1 2 3 4 panel.df\u0026lt;-panel.df %\u0026gt;% mutate(treatment = ifelse(panel.df$market == \u0026#34;E\u0026#34; | panel.df$market== \u0026#34;F\u0026#34; | panel.df$market == \u0026#34;G\u0026#34;, 1, 0)) åˆ›å»ºä¸€ä¸ªæ—¶é—´å’Œå—æ²»ç–—ä¹‹é—´çš„äº¤äº’é¡¹ã€‚æˆ‘ä»¬å°†è¿™ä¸ªäº¤äº’é¡¹ç§°ä¸ºâ€œdidâ€ã€‚\n1 2 3 4 5 6 7 8 9 10 \u0026gt; panel.df\u0026lt;-panel.df %\u0026gt;% mutate(did = time * treatment) \u0026gt; str(panel.df) \u0026#39;data.frame\u0026#39;:\t70 obs. of 6 variables: $ market : Factor w/ 7 levels \u0026#34;A\u0026#34;,\u0026#34;B\u0026#34;,\u0026#34;C\u0026#34;,\u0026#34;D\u0026#34;,..: 1 1 1 1 1 1 1 1 1 1 ... $ year : int 2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 ... $ profit : num 13428 -18997 -112 26458 30083 ... $ time : num 0 0 0 0 1 1 1 1 1 1 ... $ treatment: num 0 0 0 0 0 0 0 0 0 0 ... $ did : num 0 0 0 0 0 0 0 0 0 0 ... 3.5.1 Estimating the DID estimator 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026gt; didreg \u0026lt;- lm(profit ~ treatment + time + did, data = panel.df) \u0026gt; summary(didreg) Call: lm(formula = profit ~ treatment + time + did, data = panel.df) Residuals: Min 1Q Median 3Q Max -97675 -16228 1167 13928 68071 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 3581 7382 0.485 0.6292 treatment 17760 11276 1.575 0.1200 time 22894 9530 2.402 0.0191 * did -25195 14557 -1.731 0.0882 . --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 29530 on 66 degrees of freedom Multiple R-squared: 0.08273,\tAdjusted R-squared: 0.04104 F-statistic: 1.984 on 3 and 66 DF, p-value: 0.1249 â€œdidâ€çš„ç³»æ•°æ˜¯å·®å¼‚ä¸­çš„å·®å¼‚ä¼°è®¡é‡ã€‚æ²»ç–—æ•ˆåº”åœ¨10%çš„æ˜¾è‘—æ€§æ°´å¹³ä¸‹å…·æœ‰è¾¹é™…æ„ä¹‰ï¼Œæ²»ç–—æ•ˆåº”ä¸ºè´Ÿã€‚\n4 Takeaways åœ¨æè¿°å’Œå¯è§†åŒ–ç»„æ•°æ®æ—¶ï¼š\naggregate()æ›´å¼ºå¤§ï¼›å®ƒç†è§£å…¬å¼æ¨¡å‹ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªå¯é‡ç”¨çš„ã€å¯ç´¢å¼•çš„å¯¹è±¡æ¥å­˜å‚¨ç»“æœã€‚ é¢‘ç‡å¯ä»¥ä½¿ç”¨table()å‡½æ•°æ‰¾åˆ°ã€‚ å¯¹äºæŸä¸ªå› å­çš„æ¯”ä¾‹å’Œå‡ºç°é¢‘ç‡çš„å›¾è¡¨ï¼ŒlatticeåŒ…ä¸­çš„histogram()å‘½ä»¤éå¸¸åˆé€‚ã€‚ å¯¹äºå› å­çš„è¿ç»­æ•°æ®ç»˜å›¾ï¼Œå¯ä»¥ä½¿ç”¨barchart()ï¼Œæˆ–è€…æ›´å¥½çš„æ˜¯ä½¿ç”¨box-and-whiskers plotsï¼ˆç®±çº¿å›¾ï¼‰å’Œboxplot()ã€‚latticeåŒ…é€šè¿‡å…¬å¼è§„èŒƒå’Œbwplot()å‘½ä»¤æ‰©å±•äº†è¿™æ ·çš„ç»˜å›¾åˆ°å¤šä¸ªå› å­ã€‚ åœ¨è¿›è¡Œç»„é—´å·®å¼‚çš„ç»Ÿè®¡æµ‹è¯•æ—¶ï¼š\nchisq.test()å‡½æ•°ç”¨äºåœ¨è¡¨æ ¼æ•°æ®ä¸Šæ‰¾åˆ°ç½®ä¿¡åŒºé—´ï¼Œå¹¶è¿›è¡Œå‡è®¾æ£€éªŒã€‚ t.test()æ˜¯æ£€éªŒä¸¤ç»„ï¼ˆæˆ–ä¸€ç»„å’Œä¸€ä¸ªå›ºå®šå€¼ï¼‰å‡å€¼å·®å¼‚çš„å¸¸è§æ–¹æ³•ã€‚ æ–¹å·®åˆ†æï¼ˆANOVAï¼‰æ˜¯ä¸€ç§æ›´ä¸€èˆ¬çš„æ–¹æ³•ï¼Œç”¨äºæµ‹è¯•ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå› ç´ è¯†åˆ«çš„å¤šä¸ªç»„ä¹‹é—´çš„å‡å€¼å·®å¼‚ã€‚åŸºæœ¬æ¨¡å‹ä½¿ç”¨aov()æ‹Ÿåˆï¼Œå¸¸è§çš„æ±‡æ€»ç»Ÿè®¡é‡ä½¿ç”¨anova()æŠ¥å‘Šã€‚ anova()å‘½ä»¤è¿˜å¯ä»¥ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæˆ–æ›´å¤šANOVAæ¨¡å‹æˆ–å…¶ä»–çº¿æ€§æ¨¡å‹ï¼Œå‰ææ˜¯å®ƒä»¬æ˜¯åµŒå¥—æ¨¡å‹ã€‚ ä»multicompåŒ…ä¸­ç»˜åˆ¶glht()å¯¹è±¡æ˜¯å¯è§†åŒ–ANOVAæ¨¡å‹ç½®ä¿¡åŒºé—´çš„å¥½æ–¹æ³•ã€‚ çº¿æ€§å›å½’lm()æ˜¯æ£€æŸ¥ç»„é—´å·®å¼‚çš„æ›´ä¸€èˆ¬çš„æ–¹æ³•ã€‚å¯¹äºåˆ†ç»„å˜é‡ï¼Œè™šæ‹Ÿç¼–ç å¾ˆé‡è¦ã€‚ å·®å¼‚-å·®å¼‚æ˜¯é€šè¿‡æ£€æŸ¥æ²»ç–—å’Œæ—¶é—´ä¹‹é—´çš„äº¤äº’é¡¹ç³»æ•°æ¥æµ‹è¯•çš„ã€‚ ","date":"2024-04-03T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek9-managing-resource-trade-offs-ii-code/","title":"R[week9] Managing Resource Trade-Offs II Code"},{"content":" R: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\n1 Marketing Effectiveness and Resource Allocation Leverage historical data to quantify the effectiveness of marketing actions.\n1 2 3 4 5 6 7 8 9 \u0026gt; spending.data \u0026lt;- read_xls(\u0026#34;advertising spending 1.xls\u0026#34;) \u0026gt; str(spending.data) tibble [200 Ã— 5] (S3: tbl_df/tbl/data.frame) $ week : num [1:200] 1 2 3 4 5 6 7 8 9 10 ... $ tv : num [1:200] 230.1 44.5 17.2 151.5 180.8 ... $ radio : num [1:200] 37.8 39.3 45.9 41.3 10.8 48.9 32.8 19.6 2.1 2.6 ... $ newspaper: num [1:200] 69.2 45.1 69.3 58.5 58.4 75 23.5 11.6 1 21.2 ... $ sales : num [1:200] 22.1 10.4 9.3 18.5 12.9 7.2 11.8 13.2 4.8 10.6 ... æ•°æ®åŒ…å«æ¯å‘¨çš„é”€å”®é¢ä»¥åŠç”µè§†ã€å¹¿æ’­å’ŒæŠ¥çº¸å¹¿å‘Šè´¹ç”¨ï¼ˆä»¥åƒè‹±é•‘è®¡ï¼‰ã€‚\n1.1 Does radio advertising affect sales for an electronics brand? Visualizing the data\n1 2 # scatter plot plot(spending.data$radio, spending.data$sales) {% asset_image R_week8_code_1.png %}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026gt; # Correlation between radio advertising and sales \u0026gt; cor(spending.data$radio, spending.data$sales) [1] 0.5762226 \u0026gt; regression \u0026lt;- lm(sales ~ radio, data = spending.data) \u0026gt; summary(regression) Call: lm(formula = sales ~ radio, data = spending.data) Residuals: Min 1Q Median 3Q Max -15.7305 -2.1324 0.7707 2.7775 8.1810 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 9.31164 0.56290 16.542 \u0026lt;2e-16 *** radio 0.20250 0.02041 9.921 \u0026lt;2e-16 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 4.275 on 198 degrees of freedom Multiple R-squared: 0.332,\tAdjusted R-squared: 0.3287 F-statistic: 98.42 on 1 and 198 DF, p-value: \u0026lt; 2.2e-16 é—®é¢˜ï¼šå¦‚æœæˆ‘åœ¨å¹¿æ’­å¹¿å‘Šä¸ŠèŠ±è´¹ 40,000 è‹±é•‘ï¼Œæˆ‘å°†å–å‡ºå¤šå°‘ï¼Ÿç­”æ¡ˆï¼š17.31 = 9.31 +0.20 * 40\n1.2 Accounting for multiple predictors: multiple linear regression 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026gt; regression \u0026lt;- lm(sales ~ radio + tv, data=spending.data) \u0026gt; summary(regression) Call: lm(formula = sales ~ radio + tv, data = spending.data) Residuals: Min 1Q Median 3Q Max -8.7977 -0.8752 0.2422 1.1708 2.8328 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 2.92110 0.29449 9.919 \u0026lt;2e-16 *** radio 0.18799 0.00804 23.382 \u0026lt;2e-16 *** tv 0.04575 0.00139 32.909 \u0026lt;2e-16 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 1.681 on 197 degrees of freedom Multiple R-squared: 0.8972,\tAdjusted R-squared: 0.8962 F-statistic: 859.6 on 2 and 197 DF, p-value: \u0026lt; 2.2e-16 1.3 Allocating marketing budgets 1.3.1 Ratio of elasticities method What is elasticity? % change in the response variable for a 1% change in the predictor variable Example: the % change in sales for a 1% change in advertising spending Let us start with an example:\nImage that you have a Â£100,000 budget to spend on advertising A 1% increase in online advertising increases sales by 0.12% A 1% increase in offline advertising increases sales by 0.08% å¦‚ä½•ä½¿ç”¨å¼¹æ€§ç³»æ•°æ³•ï¼Ÿ\næ€»å¼¹æ€§ç³»æ•°ï¼š0.12 + 0.08 = 0.20ã€‚ å¼¹æ€§ç³»æ•°æ¯”ç‡ï¼š åœ¨çº¿å¹¿å‘Šï¼š0.12/0.20 = 60% çº¿ä¸‹å¹¿å‘Šï¼š0.08/0.20 = 40%\nå»ºè®®ï¼šå°†60%ï¼ˆÂ£60,000ï¼‰çš„é¢„ç®—åˆ†é…ç»™åœ¨çº¿å¹¿å‘Šï¼Œ40%ï¼ˆÂ£40,000ï¼‰çš„é¢„ç®—åˆ†é…ç»™çº¿ä¸‹å¹¿å‘Šã€‚ 1.3.2 How to obtain elasticities from a linear regression model? å¹¿å‘Šå¼¹æ€§ = å¹¿å‘Šä¼°ç®—å€¼ * (åŸºçº¿å¹¿å‘Š/åŸºçº¿é”€å”®) åŸºçº¿å¹¿å‘Š = å¹³å‡å¹¿æ’­å¹¿å‘Šæ”¯å‡ºï¼ˆ=23.26ï¼‰ Baseline Sales = average sales (=14.02) What is the elasticity of radio advertising? (0.32) A 1% increase in radio advertising results in a 0.32% increase in sales. 1 2 3 4 5 6 7 8 \u0026gt; mean(spending.data$radio) [1] 23.264 \u0026gt; mean(spending.data$sales) [1] 14.0225 \u0026gt; 0.19 * (23.26/14.02) [1] 0.3152211 2 Marketing Mix Modelling 2.1 Modelling non-linear returns on investment å‡è®¾å¹¿å‘Šåœ¨åˆå§‹é¢„ç®—ä¸º50ä¸‡è‹±é•‘çš„æƒ…å†µä¸‹åœ¨1å‘¨å†…æ’­å‡ºï¼Œæ—¨åœ¨æé«˜è‹±å›½æ¶ˆè´¹è€…å¯¹Airbnbä½œä¸ºä¸€ä¸ªåŒ…å®¹æ€§å“ç‰Œçš„è®¤çŸ¥ï¼ŒåŒæ—¶å¢åŠ è®¿é—®Airbnbç½‘ç«™å’Œé¢„è®¢çš„æµé‡ã€‚\nç”±äºè¯¥å¹¿å‘Šæ´»åŠ¨çš„ç»“æœï¼ŒAirbnbçš„é¢„è®¢é‡å¢åŠ äº†1%ã€‚\nä¸€å¹´åï¼ŒAirbnbå†³å®šå†æ¬¡è¿›è¡Œä¸€åœºç›¸ä¼¼çš„å¹¿å‘Šæ´»åŠ¨ï¼ŒåŒæ ·æŒç»­1å‘¨ï¼Œä½†å°†é¢„ç®—ç¿»å€è‡³100ä¸‡è‹±é•‘ï¼Œå¸Œæœ›é¢„è®¢é‡ä¼šå¢åŠ 2%ã€‚ ä½ è®¤ä¸ºä¼šå‘ç”Ÿè¿™ç§æƒ…å†µå—ï¼Ÿä¸ºä»€ä¹ˆï¼ˆä¸ºä»€ä¹ˆä¸ï¼‰ï¼Ÿ\n\u0026ldquo;ç”µè§†å’Œå¹¿å‘Šä¹‹é—´çš„å…³ç³»æ˜¯å¦çº¿æ€§ï¼Ÿ\u0026rdquo;\n1 plot(spending.data$tv, spending.data$sales) {% asset_image R_week8_code_2.png %}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 \u0026gt; summary(spending.data$sales) Min. 1st Qu. Median Mean 3rd Qu. Max. 1.60 10.38 12.90 14.02 17.40 27.00 \u0026gt; summary(spending.data$tv) Min. 1st Qu. Median Mean 3rd Qu. Max. 0.70 74.38 149.75 147.04 218.82 296.40 \u0026gt; summary(spending.data$radio) Min. 1st Qu. Median Mean 3rd Qu. Max. 0.000 9.975 22.900 23.264 36.525 49.600 \u0026gt; summary(spending.data$newspaper) Min. 1st Qu. Median Mean 3rd Qu. Max. 0.30 12.75 25.75 30.55 45.10 114.00 \u0026gt; regression \u0026lt;- lm(log(sales) ~ log(radio+0.01) + log(tv) + log(newspaper), data=spending.data) \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ log(radio + 0.01) + log(tv) + log(newspaper), data = spending.data) Residuals: Min 1Q Median 3Q Max -0.45346 -0.08881 -0.01746 0.06781 0.78863 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 0.479773 0.052031 9.221 \u0026lt;2e-16 *** log(radio + 0.01) 0.144177 0.007865 18.333 \u0026lt;2e-16 *** log(tv) 0.349297 0.008857 39.437 \u0026lt;2e-16 *** log(newspaper) 0.017488 0.009306 1.879 0.0617 . --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1254 on 196 degrees of freedom Multiple R-squared: 0.9098,\tAdjusted R-squared: 0.9084 F-statistic: 658.7 on 3 and 196 DF, p-value: \u0026lt; 2.2e-16 æˆ‘ä»¬å·²ç»å°†0.01æ·»åŠ åˆ°å¹¿æ’­çš„å€¼ä¸Šï¼Œå› ä¸ºå¹¿æ’­çš„æœ€å°å€¼æ˜¯0ï¼Œè¿™æ ·åšä¼šå¯¼è‡´å¯¹logï¼ˆå¹¿æ’­ï¼‰çš„æ— æ•ˆç»“æœã€‚\nå“ªä¸ªæ¨¡å‹æ›´å¥½ï¼Œçº¿æ€§æ¨¡å‹è¿˜æ˜¯å¯¹æ•°-å¯¹æ•°æ¨¡å‹ï¼Ÿ\nç»˜åˆ¶å˜é‡ä¹‹é—´çš„å…³ç³»å›¾ æ¯”è¾ƒçº¿æ€§æ¨¡å‹å’Œå¯¹æ•°-å¯¹æ•°æ¨¡å‹çš„æ‹Ÿåˆæƒ…å†µ å¦‚ä½•è§£é‡Šç³»æ•°ï¼Ÿ\nå¹¿æ’­å¹¿å‘Šçš„å¢åŠ 1%å¯¼è‡´é”€å”®é¢å¢åŠ 0.14%ã€‚ ç”µè§†å¹¿å‘Šçš„å¢åŠ 1%å¯¼è‡´é”€å”®é¢å¢åŠ 0.35%ã€‚ Coefficients are elasticities!\nSummary\n1 2 3 4 5 6 7 8 9 Linear â€¢ Equation: Y = Î²0 + Î²1X â€¢ Interpretation: One unit change in X leads to beta1 unit change in Y â€¢ When to use? Linear relation between X and Y Log-Log â€¢ Equation: log(Y) = Î²0 + Î²1log(X) â€¢ Interpretation: One percent change in X leads to Î²1 percent change in Y â€¢ When to use? A non-linear relation between X and Y Which one to use? â€¢ Plot the data to learn about the relation between X and Y. â€¢ Estimate both models and identify the best fitting model 2.2 Modelling media synergy è¥é”€ç»„åˆå·¥å…·çš„ç»¼åˆä½¿ç”¨å¯ä»¥äº§ç”ŸååŒæ•ˆåº”ã€‚ å½“å¤šç§åª’ä½“çš„è”åˆå½±å“è¶…è¿‡å®ƒä»¬å„è‡ªéƒ¨åˆ†çš„æ€»å’Œæ—¶ï¼Œå°±ä¼šäº§ç”ŸååŒæ•ˆåº”ã€‚ Is TV advertising more effective in the presence of radio advertising?\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026gt; regression \u0026lt;- lm(log(sales) ~ log(radio+0.01) + log(tv) + log(newspaper) + log(radio+0.01)*log(tv), data=spending.data) \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ log(radio + 0.01) + log(tv) + log(newspaper) + log(radio + 0.01) * log(tv), data = spending.data) Residuals: Min 1Q Median 3Q Max -0.29117 -0.06889 -0.02084 0.05787 0.74453 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 1.347498 0.101811 13.235 \u0026lt; 2e-16 *** log(radio + 0.01) -0.152661 0.032200 -4.741 4.10e-06 *** log(tv) 0.153799 0.022032 6.981 4.49e-11 *** log(newspaper) 0.019947 0.007741 2.577 0.0107 * log(radio + 0.01):log(tv) 0.066311 0.007043 9.415 \u0026lt; 2e-16 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1043 on 195 degrees of freedom Multiple R-squared: 0.938,\tAdjusted R-squared: 0.9367 F-statistic: 737 on 4 and 195 DF, p-value: \u0026lt; 2.2e-16 ä½¿ç”¨ä¸­å¿ƒåŒ–å˜é‡\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \u0026gt; center \u0026lt;- function(x) { scale(x, scale = F)} # scale = F, means only center not standardize \u0026gt; spending.data \u0026lt;- spending.data %\u0026gt;% mutate(radio_log_centered = center(log(radio+0.01)), + tv_log_centered .... [TRUNCATED] \u0026gt; regression \u0026lt;- lm(log(sales) ~ radio_log_centered + tv_log_centered + newspaper_log_centered + + radio_log_centered*tv_log_centere .... [TRUNCATED] \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ radio_log_centered + tv_log_centered + newspaper_log_centered + radio_log_centered * tv_log_centered, data = spending.data) Residuals: Min 1Q Median 3Q Max -0.29117 -0.06889 -0.02084 0.05787 0.74453 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 2.561748 0.007376 347.306 \u0026lt;2e-16 *** radio_log_centered 0.157146 0.006681 23.521 \u0026lt;2e-16 *** tv_log_centered 0.337076 0.007476 45.086 \u0026lt;2e-16 *** newspaper_log_centered 0.019947 0.007741 2.577 0.0107 * radio_log_centered:tv_log_centered 0.066311 0.007043 9.415 \u0026lt;2e-16 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1043 on 195 degrees of freedom Multiple R-squared: 0.938,\tAdjusted R-squared: 0.9367 F-statistic: 737 on 4 and 195 DF, p-value: \u0026lt; 2.2e-16 2.3 Modelling carryover effects åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å‡è®¾åœ¨ç»™å®šæ—¶é—´æ®µå†…çš„å¹¿å‘Šåªä¼šå½±å“è¯¥æ—¶é—´æ®µå†…çš„é”€å”®ã€‚å®é™…ä¸Šï¼Œæ¶ˆè´¹è€…å¯¹å¹¿å‘Šçš„ååº”å¯èƒ½ä¼šæœ‰å»¶è¿Ÿã€‚ä¸è€ƒè™‘å»¶è¿Ÿæ•ˆåº”å¯èƒ½ä¼šå¯¼è‡´å¹¿å‘Šå¼¹æ€§ç³»æ•°è¢«ä½ä¼°ã€‚\nå¹¿å‘Šå­˜é‡åº¦é‡äº†å¹¿å‘Šåœ¨å½“å‰æ—¶é—´æ®µä¹‹å¤–çš„å½±å“ã€‚\nå¹¿å‘Šå­˜é‡èƒŒåçš„ç†è®ºæ˜¯ï¼Œè¥é”€æ›å…‰åœ¨æ¶ˆè´¹è€…å¿ƒä¸­å»ºç«‹äº†æ„è¯†ã€‚è¿™ç§æ„è¯†ä¸ä¼šåœ¨æ¶ˆè´¹è€…çœ‹åˆ°å¹¿å‘Šåç«‹å³æ¶ˆå¤±ï¼Œè€Œæ˜¯ç•™å­˜åœ¨ä»–ä»¬çš„è®°å¿†ä¸­ã€‚è®°å¿†ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œå‡å¼±ï¼Œå› æ­¤å¹¿å‘Šå­˜é‡ä¸­å­˜åœ¨è¡°å‡éƒ¨åˆ†ã€‚\n1 Adstockt = Advertisingt + Î»Adstocktâˆ’1 åœ¨æ¯ä¸ªæ—¶é—´æ®µä¸­ï¼Œä½ è¢«è®¤ä¸ºä¼šä¿ç•™å‰ä¸€ä¸ªå¹¿å‘Šå­˜é‡çš„ä¸€éƒ¨åˆ†ï¼ˆÎ»ï¼‰ã€‚\nä¾‹å¦‚ï¼Œå¦‚æœÎ»ç­‰äº0.3ï¼Œåˆ™æ¥è‡ªä¸€ä¸ªæ—¶é—´æ®µä¹‹å‰çš„å¹¿å‘Šå­˜é‡åœ¨å½“å‰æ—¶é—´æ®µä»ç„¶å…·æœ‰30%çš„å½±å“ã€‚\nHow to do this in R?\nâ€œrate = 0.1â€ sets Î» to 0.1 (i.e. 10%) You can empirically test multiple values of Î». 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \u0026gt; adstock \u0026lt;- function(x, rate){ + return(as.numeric(stats::filter(x=x, filter=rate, method=\u0026#34;recursive\u0026#34;))) + } \u0026gt; # filter() function from stats package applies linear filtering to a univariate time series \u0026gt; \u0026gt; spending.data \u0026lt;- spending.data %\u0026gt;% mutate(tv_adstoc .... [TRUNCATED] \u0026gt; regression \u0026lt;- lm(log(sales) ~ log(radio+0.01) + log(tv_adstock) + log(newspaper), data=spending.data) \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ log(radio + 0.01) + log(tv_adstock) + log(newspaper), data = spending.data) Residuals: Min 1Q Median 3Q Max -0.96605 -0.08394 -0.00081 0.07966 0.81860 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) -0.09547 0.08418 -1.134 0.2581 log(radio + 0.01) 0.13177 0.01008 13.074 \u0026lt;2e-16 *** log(tv_adstock) 0.45582 0.01542 29.567 \u0026lt;2e-16 *** log(newspaper) 0.02219 0.01190 1.865 0.0637 . --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1604 on 196 degrees of freedom Multiple R-squared: 0.8523,\tAdjusted R-squared: 0.8501 F-statistic: 377.1 on 3 and 196 DF, p-value: \u0026lt; 2.2e-16 2.4 Predictive accuracy * 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026gt; # Total number of rows in the data frame \u0026gt; n \u0026lt;- nrow(spending.data) \u0026gt; # Number of rows for the training set (80% of the dataset) \u0026gt; n_train \u0026lt;- round(0.80 * n) # Training data \u0026gt; spending.data.train \u0026lt;- subset(spending.data, week \u0026lt;= n_train) # Holdout data \u0026gt; spending.data.holdout \u0026lt;- subset(spending.data, week \u0026gt; n_train) \u0026gt; # Estimation on training data \u0026gt; regression \u0026lt;- lm(log(sales) ~ log(radio_adstock) + log(tv_adstock) + log(newspaper_adstock), data=spending.data.trai .... [TRUNCATED] \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ log(radio_adstock) + log(tv_adstock) + log(newspaper_adstock), data = spending.data.train) Residuals: Min 1Q Median 3Q Max -0.95544 -0.06206 -0.00140 0.07359 0.60782 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) -0.37264 0.09377 -3.974 0.000108 *** log(radio_adstock) 0.19215 0.01473 13.048 \u0026lt; 2e-16 *** log(tv_adstock) 0.47022 0.01566 30.031 \u0026lt; 2e-16 *** log(newspaper_adstock) 0.02057 0.01545 1.332 0.184852 --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1483 on 156 degrees of freedom Multiple R-squared: 0.8812,\tAdjusted R-squared: 0.8789 F-statistic: 385.6 on 3 and 156 DF, p-value: \u0026lt; 2.2e-16 1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; # Predict sales on holdout data \u0026gt; spending.data.holdout$predicted_sales_log \u0026lt;- + predict(object =regression, newdata = spending.data.holdout) \u0026gt; # Convert predicted log sales to actual sales \u0026gt; spending.data.holdout$predicted_sales \u0026lt;- exp(spending.data.holdout$predicted_sales_log) \u0026gt; # Quantify predictive accuracy: Mean Average Percentage Error (MAPE) \u0026gt; mape \u0026lt;- mean(abs((spending.data.holdout$sales -spending.data.holdout$predicte .... [TRUNCATED] \u0026gt; mape # Reflects the average percentage error in a given week [1] 0.1010304 1 2 3 4 5 6 \u0026gt; # Plot actual versus predicted sales \u0026gt; plot(spending.data.holdout$week, spending.data.holdout$sales, type=\u0026#34;l\u0026#34;, col=\u0026#34;blue\u0026#34;) # Plot actual sales \u0026gt; lines(spending.data.holdout$week,spending.data.holdout$predicted_sales, type = \u0026#34;l\u0026#34;, col = \u0026#34;red\u0026#34;) # Add predicted sales \u0026gt; legend(\u0026#34;topleft\u0026#34;, legend=c(\u0026#34;Actual sales\u0026#34;, \u0026#34;Predicted sales\u0026#34;), col=c(\u0026#34;blue\u0026#34;, \u0026#34;red\u0026#34;), lty = 1:2, cex=0.6) {% asset_image R_week8_code_3.png %}\n","date":"2024-04-02T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek8-managing-resource-trade-offs-code/","title":"R[week8] Managing Resource Trade-Offs Code"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\n0. Learning Objectives å¸‚åœºè¥é”€é—®é¢˜ ç®¡ç†èµ„æºæƒè¡¡ åˆ†æå·¥å…· å¸‚åœºå®éªŒ å¸‚åœºååº”æ¨¡å‹ 0.1 Framework for Managing Resource Trade-Offs {% asset_image R_week8_lecture_1.png %}\n0.2 Attribution Approach æŒ‡å®šå½’å› æ¨¡å‹ï¼Œä½¿å…¬å¸èƒ½å¤Ÿäº†è§£èµ„æºå¢åŠ çš„ç¡®åˆ‡ç¾å…ƒå½±å“ï¼Œè¿˜å¯ä»¥å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š\nè¥é”€æŠ•èµ„çš„ç›¸å¯¹ç¾å…ƒä»·å€¼å½±å“æ˜¯å¤šå°‘ï¼Ÿ ä»€ä¹ˆæ˜¯åˆ©æ¶¦æœ€å¤§åŒ–çš„æŠ•èµ„æ°´å¹³ï¼Ÿ é€šè¿‡ä½¿ç”¨å½’å› æ¨¡å‹ï¼Œç®¡ç†è€…å¯ä»¥å°†èµ„æºåˆ†é…åˆ°ä¼˜åŒ–ä»–ä»¬æœŸæœ›çš„ç»“æœï¼Œé¿å…æµªè´¹æˆ–ä¾èµ–äºä»»æ„å¯å‘å¼æ–¹æ³•ã€‚\nè¿™äº›å½’å› æ¨¡å‹ä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼š\nå¸‚åœºååº”æ¨¡å‹ï¼ˆè¥é”€ç»„åˆæ¨¡å‹ï¼‰ å®éªŒ 1. Market Response Model ç¬¬ä¸€éƒ¨åˆ†ï¼šè¥é”€æ•ˆæœå’Œèµ„æºåˆ†é…\nä¸ºä»€ä¹ˆ/å¦‚ä½•è¡¡é‡è¥é”€æŠ•èµ„å›æŠ¥ï¼Ÿ åˆ†é…è¥é”€é¢„ç®— ç¬¬äºŒéƒ¨åˆ†ï¼šè¥é”€ç»„åˆå»ºæ¨¡\nçº¿æ€§å›å½’å»ºæ¨¡ è¥é”€ç»„åˆå·¥å…·ä¹‹é—´çš„ååŒå»ºæ¨¡ æºå¸¦æ•ˆåº”å»ºæ¨¡ è¯„ä¼°æ¨¡å‹ 1.1 Why Measure Returns on Marketing Investment? {% asset_image R_week8_lecture_2.png %}\n1.2 What are market response models? How it Works? åˆ©ç”¨è¿‡å»çš„æ•°æ®æ­ç¤ºè¥é”€èµ„æºå’Œä¸šç»©ä¹‹é—´çš„å…³ç³»ï¼Œå“åº”æ¨¡å‹æä¾›äº†ä¸¤ä¸ªä¸»è¦çš„è§è§£ã€‚ è¥é”€èµ„æºå’Œç»“æœä¹‹é—´å…³ç³»çš„å½¢çŠ¶ï¼ˆå‡¹å½¢æˆ–å‡¸å½¢ï¼‰ã€‚ å¦‚æœè¥é”€æŠ•å…¥å¢åŠ 1%ï¼Œè´¢åŠ¡ä¸šç»©ä¼šå‘ç”Ÿå¤šå¤§å˜åŒ–ï¼Œä¹Ÿç§°ä¸ºè¥é”€å¼¹æ€§ã€‚ 1.3 How to Measure Return on Marketing Investment {% asset_image R_week8_lecture_3.png %}\n1.4 The Basics: Simple linear regression 1.4.1 Example1: Radio Ads for Sales {% asset_image R_week8_lecture_7.png %}\nSales = a+ b1 Radio advertising\n{% asset_image R_week8_lecture_4.png %}\nDoes radio advertising affects sales for an electronics brand?\n{% asset_image R_week8_lecture_5.png %}\nPredict sales\n{% asset_image R_week8_lecture_6.png %}\n1.4.2 Radio and TV ads for sales {% asset_image R_week8_lecture_8.png %}\nSales =a+ b1 Radio advertising + b2 TV advertising\n{% asset_image R_week8_lecture_9.png %}\n{% asset_image R_week8_lecture_10.png %}\n{% asset_image R_week8_lecture_11.png %}\n1.5 Allocating Marketing Budgets å¼¹æ€§ç³»æ•°æ˜¯ä»€ä¹ˆï¼Ÿ é¢„æµ‹å˜é‡å˜åŒ–1%ï¼Œå“åº”å˜é‡å˜åŒ–çš„ç™¾åˆ†æ¯” ä¾‹å¦‚ï¼šå¹¿å‘Šæ”¯å‡ºå˜åŒ–1%ï¼Œé”€å”®å˜åŒ–çš„ç™¾åˆ†æ¯” {% asset_image R_week8_lecture_12.png %}\n1.6 Modelling log-log Returns on Investment {% asset_image R_week8_lecture_13.png %}\n{% asset_image R_week8_lecture_14.png %}\n{% asset_image R_week8_lecture_15.png %}\n1.7 Modelling Media Synergy ç»„åˆä½¿ç”¨è¥é”€ç»„åˆå·¥å…·å¯ä»¥äº§ç”ŸååŒæ•ˆåº”ã€‚ å½“å¤šç§åª’ä½“çš„è”åˆå½±å“è¶…è¿‡å®ƒä»¬å„è‡ªéƒ¨åˆ†çš„æ€»å’Œæ—¶ï¼Œå°±ä¼šäº§ç”ŸååŒæ•ˆåº”ã€‚ {% asset_image R_week8_lecture_16.png %}\n1.8 Modelling carryover effects åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å‡è®¾åœ¨ç»™å®šæ—¶é—´æ®µå†…çš„å¹¿å‘Šåªä¼šå½±å“è¯¥æ—¶é—´æ®µå†…çš„é”€å”®ã€‚\nå®é™…ä¸Šï¼Œæ¶ˆè´¹è€…å¯¹å¹¿å‘Šçš„ååº”å¯èƒ½ä¼šæœ‰å»¶è¿Ÿã€‚\nä¸è€ƒè™‘ä¼ é€’æ•ˆåº”å¯èƒ½ä¼šå¯¼è‡´ä½ä¼°å¹¿å‘Šå¼¹æ€§ã€‚\nå¹¿å‘Šå‚¨å­˜æŒ‡æ ‡è¡¡é‡äº†å½“å‰æ—¶é—´æ®µä¹‹åçš„å¹¿å‘Šæ•ˆåº”\nå¹¿å‘Šå‚¨å­˜t = å½“æœŸå¹¿å‘Št + Î» * å¹¿å‘Šå‚¨å­˜t-1\nåœ¨æ¯ä¸ªæ—¶é—´æ®µä¸­ï¼Œä½ å‡è®¾ä¿ç•™ä½ ä¹‹å‰å¹¿å‘Šå‚¨å­˜çš„ä¸€éƒ¨åˆ†ï¼ˆÎ»ï¼‰\nä¾‹å¦‚ï¼Œå¦‚æœÎ»ç­‰äº0.3ï¼Œåˆ™æ¥è‡ªä¸€ä¸ªæ—¶é—´æ®µä¹‹å‰çš„å¹¿å‘Šå‚¨å­˜åœ¨å½“å‰æ—¶é—´æ®µä»ç„¶æœ‰30%çš„å½±å“\nHow to calculate Adstock levels?\nAdstockt= Advertisingt+ Î»Adstockt-1\n{% asset_image R_week8_lecture_17.png %}\nDo it in R\n{% asset_image R_week8_lecture_18.png %}\n1.9 Building and Evaluating Market Response Model {% asset_image R_week8_lecture_19.png %}\n1.10 Takeaways æ‰€æœ‰èµ„æºéƒ½æ˜¯æœ‰é™çš„ã€‚ç®¡ç†è€…å¿…é¡»åœ¨èµ„æºä¹‹é—´è¿›è¡Œæƒè¡¡ï¼Œä»¥åˆ¶å®šæœ‰æ•ˆçš„è¥é”€ç­–ç•¥ã€‚ ç®¡ç†èµ„æºæƒè¡¡çš„æ–¹æ³•å·²ç»ä»çº¯å¯å‘å¼çš„æ—¶ä»£å‘å±•åˆ°æ•°æ®åŒ–æ—¶ä»£ï¼Œç®¡ç†è€…ä¾é ç»Ÿè®¡æ¨¡å‹å’Œè¯¦ç»†ä¿¡æ¯ã€‚ åŸºäºå“åº”æ¨¡å‹çš„å½’å› æ–¹æ³•æ•æ‰äº†è¿‡å»è¥é”€èµ„æºå’Œè¿‡å»ç»“æœä¹‹é—´çš„å…³ç³»ã€‚ç„¶ååˆ©ç”¨è¿‡å»çš„æ•°æ®å¯ä»¥æ­ç¤ºè¥é”€èµ„æºå’Œç»©æ•ˆä¹‹é—´çš„å…³ç³»ã€‚ 2. Marketing Experiment Marketing experiment AB testing Multivariate testing Natural experiment Research examples è¥é”€å®éªŒæµ‹è¯•å®¢æˆ·å¯¹è¥é”€å†³ç­–çš„ååº”ï¼ŒåŒæ—¶æ’é™¤å…¶ä»–å¯èƒ½å­˜åœ¨çš„æ··æ‚å› ç´ ï¼Œè¿™äº›å› ç´ åœ¨æ¯”è¾ƒå¤„ç†ç»„å’Œå¯¹ç…§ç»„æ—¶å¯èƒ½å­˜åœ¨ã€‚\nä½•æ—¶ä½¿ç”¨ï¼Ÿ ç¡®å®šç‰¹å®šè¥é”€æŠ•èµ„ä¸å®¢æˆ·æˆ–å…¬å¸ç»“æœä¹‹é—´æ˜¯å¦å­˜åœ¨ç›´æ¥å…³ç³»ã€‚ æ ¹æ®å®ƒä»¬çš„è´¢åŠ¡å½±å“ï¼ˆä¾‹å¦‚ï¼Œé”€å”®é¢å¢é•¿ï¼‰åœ¨ä¸€ç»„æŠ•èµ„ç­–ç•¥å’Œç­–ç•¥ä¸­è¿›è¡Œé€‰æ‹©ã€‚ 2.1 Marketing Experiment: Components å®éªŒå½’å› æ–¹æ³•æ¶‰åŠå¹²é¢„ã€ç»“æœã€å¤„ç†æ¡ä»¶çš„è®¾è®¡ä»¥åŠå¯¹ç…§æ¡ä»¶ã€‚ å†³å®šæµ‹è¯•å“ªäº›å› ç´ è‡³å…³é‡è¦ï¼Œå®éªŒå¾ˆå¿«å°±ä¼šå˜å¾—éå¸¸å¤æ‚ã€‚ Component Definition Intervention A key marketing action whose effectiveness the firm seeks to document Outcome The key marketing gain for the firm implementing the experiment Treatment When, where, and to whom the firm administers the intervention Control A region, customer, or situation similar to the experimental intervention that remains unchanged during the experimental process 2.2 Marketing Experiment: How it works å®éªŒæ—¨åœ¨å»ºç«‹è‡ªå˜é‡ï¼ˆè¥é”€æŠ•èµ„ï¼‰å’Œç»“æœä¹‹é—´çš„å…³ç³»ã€‚\nå¿…é¡»å»ºç«‹ä¸€ä¸ªè‰¯å¥½çš„å¤„ç†ç»„å’Œæ¯”è¾ƒï¼ˆå¯¹ç…§ï¼‰ç»„ã€‚å¤„ç†ç»„æ˜¯æ¥å—è¯¥å¤„ç†çš„å—è¯•è€…ç¾¤ä½“ï¼ˆä¾‹å¦‚ï¼Œæ¶ˆè´¹è€…ã€é”€å”®äººå‘˜ï¼‰ã€‚å¯¹ç…§ç»„ä¿æŒå› æœå› ç´ ä¸å˜ï¼ˆä¾‹å¦‚ï¼Œå‘å¦ä¸€ç»„é”€å”®äººå‘˜æ”¯ä»˜çš„ä½£é‡‘ä¿æŒä¸å˜ï¼‰ã€‚ å¤„ç†ç»„å’Œå¯¹ç…§ç»„åœ¨æ‰€æœ‰å…¶ä»–æ–¹é¢å¿…é¡»ç›¸ä¼¼ï¼ˆä¾‹å¦‚ï¼Œæ ·æœ¬å¤§å°ã€äººå£æ„æˆã€é”€å”®åŠ¨æœºã€ç»éªŒï¼‰ã€‚åœ¨è¯•éªŒæ¡ä»¶å’Œå¯¹ç…§æ¡ä»¶ä¹‹é—´ï¼Œæ‰€æœ‰å…¶ä»–å› ç´ ï¼ˆè‡³å°‘æ˜¯å…¬å¸å¯æ§åˆ¶çš„å› ç´ ï¼‰éƒ½è¢«æœ‰æ„åœ°ä¿æŒä¸å˜ï¼Œè¿™äº›å› ç´ å¯èƒ½ä¼šå½±å“ç»“æœï¼ˆä¾‹å¦‚ï¼Œé”€å”®ï¼‰ã€‚ ä¸ºäº†è¾¾åˆ°è¿™ä¸ªæ ‡å‡†ï¼Œé€šå¸¸ä½¿ç”¨éšæœºåˆ†é…ã€‚é€šè¿‡éšæœºåˆ†é…ï¼Œä»æ¦‚ç‡æ„ä¹‰ä¸Šæ¥è¯´ï¼Œå—è¯•è€…æ¥å—å¤„ç†çš„æœºä¼šåœ¨ä¸åŒç»„ä¹‹é—´æ˜¯ç›¸ç­‰çš„ã€‚ 1 2 3 4 5 6 7 ğ‘Œ ğ‘– = ğ›½0 + ğ›½1ğ‘‡ğ‘– + ğœ€ğ‘– - ğ‘Œ ğ‘– æ˜¯æ„Ÿå…´è¶£çš„å› å˜é‡ï¼› - ğ‘‡ğ‘– å¦‚æœä¸»ä½“iè¢«åˆ†é…åˆ°å¤„ç†ç»„ï¼Œåˆ™ç¼–ç ä¸º1ï¼Œå¦åˆ™ä¸º0ï¼Œ - ç³»æ•° ğ›½1 æ˜¯å¤„ç†æ•ˆåº”ã€‚ - ğœ€ğ‘– æ•æ‰éšæœºç»Ÿè®¡è¯¯å·®ã€‚ - ğ›½0 æ˜¯æˆªè·ã€‚ åœ¨è¿›è¡Œå®éªŒåï¼Œå¦‚æœ ğ›½1 åœ¨ç»Ÿè®¡ä¸Šæ˜¾è‘—ï¼Œåˆ™å¤„ç†æ•ˆåº”æ˜¯åˆæ³•çš„ã€‚\næ ¹æ®åˆ†æçš„ç›®æ ‡ï¼Œå®éªŒå¯ä»¥é‡‡ç”¨ä¸¤ç§ä¸åŒçš„è®¾è®¡ï¼š\nâ€œåéªŒâ€è®¾è®¡ï¼šåœ¨å®¢æˆ·æ¥å—è¥é”€æ´»åŠ¨åï¼Œæµ‹é‡è¥é”€è¡Œä¸ºå¯¹å®¢æˆ·è¡Œä¸ºçš„å½±å“ã€‚ â€œå‰åå¯¹ç…§â€è®¾è®¡ï¼šåœ¨å®¢æˆ·æ¥å—è¥é”€æ´»åŠ¨ä¹‹å‰å’Œä¹‹åï¼Œæµ‹é‡è¥é”€è¡Œä¸ºçš„å½±å“ã€‚ 2.3 Marketing Experiment: Example é²œèŠ±é€è´§å…¬å¸DFGæ­£åœ¨è¿›è¡Œå­£åº¦è¥é”€é¢„ç®—ä¼šè®®ã€‚ä¸€ä½ç»ç†æŒ‡å‡ºå…¬å¸æ¯å¹´åœ¨å¹¿å‘Šä¸ŠèŠ±è´¹äº†25ä¸‡ç¾å…ƒï¼Œè´¨ç–‘æ˜¯å¦åˆç†ï¼Œæˆ–è€…DFGæ˜¯å¦èŠ±è´¹è¿‡å¤šã€‚åœ¨éšåçš„å†…éƒ¨è®¨è®ºä¸­ï¼Œä¸€äº›ç»ç†åšæŒè®¤ä¸ºåœ°æ–¹ç”µè§†å¹¿å‘Šå¯¹äºå»ºç«‹å“ç‰Œèµ„äº§å’Œäº§ç”Ÿæ”¶å…¥è‡³å…³é‡è¦ï¼›è€Œå¦ä¸€äº›åˆ™è®¤ä¸ºå…¬å¸èŠ±è´¹è¿‡å¤šã€‚\n2.3.1 Marketing Experiment: â€œafter-onlyâ€ DFGå†³å®šè¿›è¡Œä¸€é¡¹å—æ§çš„è¥é”€å®éªŒã€‚å°†å¤„ç†ç»„å’Œå¯¹ç…§ç»„åŒ¹é…åœ¨å·²çŸ¥å±æ€§ä¸Šï¼ˆä¾‹å¦‚äººå£ç»Ÿè®¡å­¦ç‰¹å¾ï¼‰ã€‚\n{% asset_image R_week9_lecture_1.png %}\n2.3.2 Marketing Experiment: â€œbefore-and-afterâ€ DFGå†³å®šé‡‡ç”¨æ§åˆ¶çš„è¥é”€å®éªŒï¼Œé‡‡ç”¨å‰åå¯¹ç…§çš„è®¾è®¡ã€‚\n{% asset_image R_week9_lecture_2.png %}\n2.3.3 Case éšæœºåˆ†é…é¡¾å®¢ åˆ†æ æ¯”è¾ƒå„ç»„ä»¥ç¡®å®šå‡å€¼å·®å¼‚æ˜¯å¦æ˜¾è‘— Tæ£€éªŒ/æ–¹å·®åˆ†æ/å›å½’ {% asset_image R_week9_lecture_3.png %}\n2.3.4 68-95-99.7 rule {% asset_image R_week9_lecture_4.png %}\n2.3.5 GOGOGO å…¬å¸ä¼°è®¡äº†ä¸‰ä¸ªå›å½’æ–¹ç¨‹ï¼Œä»ä¸‰ä¸ªä¸åŒçš„æ¨¡å‹ä¸­è·å¾—äº†ç³»æ•° ğ›½1ï¼Œåˆ†åˆ«æ•æ‰äº†ç”±äºåœ°æ–¹ç”µè§†å¹¿å‘Šå¢åŠ è€Œå¯¼è‡´çš„å“ç‰ŒçŸ¥ååº¦ã€å“ç‰Œå›å¿†ç‡å’Œé”€å”®çš„ç»Ÿè®¡å˜åŒ–ã€‚ åœ¨æ¯ä¸ªå›å½’ä¸­ï¼Œå¤„ç†æ•ˆåº”éƒ½æ˜¯æ˜¾è‘—çš„ï¼š å½“DFGå¢åŠ å…¶åœ°æ–¹ç”µè§†å¹¿å‘Šæ—¶ï¼Œå¤„ç†åŒºåŸŸçš„å“ç‰ŒçŸ¥ååº¦ã€å“ç‰Œå›å¿†ç‡å’Œé”€å”®åˆ†åˆ«å¢é•¿äº†1.5ï¼…ã€3.2ï¼…å’Œ3ï¼…ï¼ˆä¸å¯¹ç…§ç»„ç›¸æ¯”ï¼‰ã€‚ DFGæ¯å¹´é”€å”®é¢ä¸º2500ä¸‡ç¾å…ƒï¼Œå› æ­¤è¯¥å®éªŒä½¿å…¬å¸çš„å†³ç­–è€…å¯¹åœ°æ–¹ç”µè§†å¹¿å‘Šå¸¦æ¥çš„é”€å”®å¢é•¿æ›´æœ‰ä¿¡å¿ƒã€‚å› æ­¤ï¼Œä¸€é¡¹å®éªŒå¸®åŠ©è§£å†³äº†DFGå†…éƒ¨çš„å†²çªã€‚ 2.4 A/B testing ä½¿ç”¨å®éªŒè®¾è®¡æ¯”è¾ƒä¸€ä¸ªè®¾è®¡çš„ä¸¤ä¸ªæˆ–æ›´å¤šå˜ä½“\næ–°æƒ³æ³• è¿è¡Œå®éªŒ åˆ†æç»“æœ é€‰æ‹©è·èƒœçš„æƒ³æ³• å¼ºå¤§ä¸”å¹¿æ³›ä½¿ç”¨çš„æŒ‡æ ‡\nè½¬åŒ–ç‡ï¼ˆä¾‹å¦‚ç‚¹å‡»ç‡ï¼‰ å‚ä¸ç‡ï¼ˆä¾‹å¦‚ç‚¹èµã€åˆ†äº«ï¼‰ åœç•™æ—¶é—´ï¼ˆä¾‹å¦‚åœ¨é¦–é¡µåœç•™çš„ç§’æ•°ï¼‰ 2.5 Multivariate testing {% asset_image R_week9_lecture_5.png %}\n2.6 Natural Experiments: when to use æˆ‘ä»¬å¹¶ä¸æ€»æ˜¯èƒ½å¤Ÿè¿›è¡ŒéšæœºåŒ– æ”¿ç­–ä¸Šçš„æ„å¤–å˜åŒ–å¯ä»¥è¢«è§†ä¸ºâ€œè‡ªç„¶å®éªŒâ€ã€‚ä¾‹å¦‚ï¼Œå¯¹ä¸€äº›å¸‚åœºå¼•å…¥äº†æ–°çš„é€€è´§æ”¿ç­–ã€‚ å³ä½¿åœ¨è‡ªç„¶å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ç¡®å®šå“ªä¸ªæ˜¯å¤„ç†ç»„ï¼Œå“ªä¸ªæ˜¯å¯¹ç…§ç»„ å¤„ç†ç»„ï¼šå—æ”¿ç­–å˜åŒ–å½±å“çš„ç»„ï¼›ä¾‹å¦‚ï¼Œé€€è´§æ”¿ç­–å‘ç”Ÿå˜åŒ–çš„å¸‚åœºã€‚ å¯¹ç…§ç»„ï¼šä¸å—æ”¿ç­–å˜åŒ–å½±å“çš„ç»„ï¼›ä¾‹å¦‚ï¼Œé€€è´§æ”¿ç­–ä¿æŒä¸å˜çš„å¸‚åœºã€‚ 2.6.1 Natural Experiments: Difference-in-Difference {% asset_image R_week9_lecture_6.png %}\nå·®å¼‚ä¸­çš„å·®å¼‚ï¼ˆDiDï¼‰è¯•å›¾é€šè¿‡ç ”ç©¶è‡ªç„¶å®éªŒä¸­å¤„ç†ç»„ä¸å¯¹ç…§ç»„ä¹‹é—´çš„å¤„ç†å¯¹ç»“æœå˜é‡çš„å·®å¼‚æ•ˆåº”ï¼Œæ¥æ¨¡æ‹Ÿå®éªŒç ”ç©¶è®¾è®¡ã€‚ DiDåˆ©ç”¨é¢æ¿æ•°æ®æ¥æµ‹é‡éšæ—¶é—´å‘ç”Ÿçš„å¤„ç†ç»„å’Œå¯¹ç…§ç»„ä¹‹é—´ç»“æœå˜é‡çš„å˜åŒ–å·®å¼‚ã€‚ 1 2 3 4 5 6 7 8 9 10 11 ğ‘Œ ğ‘– = ğ›½0 + ğ›½1tğ‘– + ğ›½2Tğ‘– + ğ›½3 ğ‘‡ğ‘– Ã— ğ‘¡ğ‘– + ğœ€ğ‘– - ğ‘Œ ğ‘–æ˜¯ä¾èµ–å˜é‡; - ğ‘¡ğ‘–å¦‚æœæ˜¯ä»‹å…¥åï¼Œåˆ™ç¼–ç ä¸º1ï¼Œå¦‚æœæ˜¯ä»‹å…¥å‰ï¼Œåˆ™ç¼–ç ä¸º0ï¼› - ğ›½1æ˜¯æ§åˆ¶ç»„å’Œå¤„ç†ç»„å…±åŒçš„æ—¶é—´è¶‹åŠ¿; - ğ‘‡ğ‘–å¦‚æœä¸»ä½“iåˆ†é…åˆ°å¤„ç†ç»„ï¼Œåˆ™ç¼–ç ä¸º1ï¼Œå¦åˆ™ä¸º0ï¼Œ - ğ›½2æ˜¯å¤„ç†æ•ˆåº”ã€‚ - äº¤äº’é¡¹ğ‘‡ğ‘– Ã— ğ‘¡ğ‘–æ˜¯DiDé¡¹ - ğ›½3æ˜¯çœŸå®æ•ˆåº”ã€‚ - ğœ€ğ‘–æ•è·äº†éšæœºç»Ÿè®¡è¯¯å·® - ğ›½0æ˜¯æˆªè· 3 Takeaways å®éªŒè¯„ä¼°å› æœå…³ç³» é€šå¸¸ä½¿ç”¨Tæ£€éªŒã€æ–¹å·®åˆ†ææˆ–çº¿æ€§å›å½’æ¥æ¯”è¾ƒç»„ï¼Œä»¥æµ‹è¯•å·®å¼‚æ˜¯å¦æ˜¾è‘— ç½‘ç»œå®éªŒï¼ˆA/Bæµ‹è¯•ï¼‰æˆæœ¬è¾ƒä½ä¸”é€Ÿåº¦è¾ƒå¿« â€’ å®éªŒæˆæœ¬å¯ä»¥æ˜¯å¯å˜çš„ï¼Œè€Œä¸æ˜¯å›ºå®šçš„ å·®å¼‚ä¸­çš„å·®å¼‚ç”¨äºæ£€éªŒå‡†å®éªŒï¼Œå¦‚è‡ªç„¶å®éªŒã€‚å®ƒæµ‹é‡äº†å¤„ç†ç»„å’Œå¯¹ç…§ç»„åœ¨ä¸€æ®µæ—¶é—´å†…ç»“æœå˜é‡çš„å˜åŒ–å·®å¼‚ ","date":"2024-04-01T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek8-managing-resource-trade-offs/","title":"R[week8] Managing Resource Trade-Offs"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\nå¸‚åœºè¥é”€äººå‘˜é€šå¸¸å¸Œæœ›ä»äº¤æ˜“ä¸­æå–è§è§£ã€‚å…³è”è§„åˆ™åˆ†æè¯•å›¾ä»åºå¤§ã€ç¨€ç–çš„æ•°æ®é›†ä¸­æ‰¾åˆ°ä¸€ç»„æœ‰ä¿¡æ¯é‡çš„æ¨¡å¼ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåŒ…å«è¶…è¿‡ 80,000 ç¬”å¸‚åœºè´­ç‰©ç¯®äº¤æ˜“å’Œ 16,000 ä¸ªç‹¬ç‰¹é¡¹ç›®çš„çœŸå®æ•°æ®é›†æ¥å±•ç¤ºå…³è”è§„åˆ™ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ¢è®¨è§„åˆ™æŒ–æ˜åœ¨äº¤æ˜“æ•°æ®ä¸­çš„æ½œåœ¨ç”¨é€”ï¼Œå¹¶ä½¿ç”¨å…³è”è§„åˆ™æ¥æ¢ç´¢è¿™äº›äº¤æ˜“æ•°æ®ä¸­çš„æ¨¡å¼ã€‚\n1 The Basics of Association Rules å…³è”è§„åˆ™æŒ–æ˜çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå½“äº‹ä»¶ä¸€èµ·å‘ç”Ÿçš„é¢‘ç‡è¶…è¿‡äº†å®ƒä»¬å„è‡ªå‘ç”Ÿç‡çš„é¢„æœŸæ—¶ï¼Œè¿™ç§å…±åŒå‘ç”Ÿå°±æ˜¯ä¸€ä¸ªæœ‰è¶£çš„æ¨¡å¼ã€‚\nç†è§£å…³è”è§„åˆ™éœ€è¦ä¸€äº›æœ¯è¯­ã€‚\nâ€¢ å…³è”ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸¤ä¸ªæˆ–æ›´å¤šäº‹ç‰©çš„å…±åŒå‘ç”Ÿã€‚ä¾‹å¦‚ï¼Œçƒ­ç‹—å¯èƒ½ä¸è…Œèœã€çƒ­ç‹—é¢åŒ…ã€è‹æ‰“æ°´ã€è–¯ç‰‡å’Œç•ªèŒ„é…±å‘ˆæ­£ç›¸å…³ã€‚ä½†æ˜¯å…³è”ä¸ä¸€å®šå¼ºçƒˆã€‚åœ¨åƒ Costco è¿™æ ·é”€å”®ä»çƒ­ç‹—åˆ°ç”µè§†ç­‰å„ç§å•†å“çš„å•†åº—ä¸­ï¼Œæ‰€æœ‰å•†å“éƒ½ä¸å…¶ä»–å•†å“ç›¸å…³è”ï¼Œä½†å…¶ä¸­å¤§å¤šæ•°å…³è”å¹¶ä¸å¼ºçƒˆã€‚ä¸€ç»„é¡¹ç›®æ˜¯ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªé¡¹ç›®çš„ç»„åˆï¼Œå¯ä»¥å†™æˆ {é¡¹ç›®1ï¼Œé¡¹ç›®2ï¼Œ\u0026hellip;}ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªé›†åˆå¯èƒ½æ˜¯ {è…Œèœ} æˆ– {çƒ­ç‹—ï¼Œè‹æ‰“æ°´ï¼Œè–¯ç‰‡}ã€‚\nâ€¢ ä¸€æ¬¡äº¤æ˜“åŒ…å«åœ¨ä¸€ä¸ªè§‚å¯Ÿä¸­å…±åŒå‡ºç°çš„ä¸€ç»„é¡¹ç›®ã€‚åœ¨å¸‚åœºè¥é”€ä¸­ï¼Œä¸€ä¸ªäº¤æ˜“å•ä½æ˜¯å¸‚åœºè´­ç‰©ç¯®ï¼Œå³ä¸€æ¬¡è´­ä¹°æˆ–è€ƒè™‘è´­ä¹°çš„ä¸€ç»„ç‰©å“ã€‚\nä»»ä½•å…±åŒå‡ºç°çš„æ•°æ®ç‚¹éƒ½è¢«è§†ä¸ºä¸€æ¬¡äº¤æ˜“ï¼Œå³ä½¿åœ¨æ­¤æƒ…å¢ƒä¸­ä½¿ç”¨æœ¯è¯­â€œäº¤æ˜“â€ä¼¼ä¹æœ‰äº›ä¸å¯»å¸¸ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·åœ¨ä¼šè¯æœŸé—´è®¿é—®çš„ç½‘é¡µé›†åˆåœ¨è¿™ä¸ªæ„ä¹‰ä¸Šæ˜¯ä¸€æ¬¡äº¤æ˜“ã€‚\nâ€¢ è§„åˆ™è¡¨ç¤ºäº†ä¸€ç»„é¡¹ç›®åœ¨å¦ä¸€ç»„é¡¹ç›®çš„æ¡ä»¶ä¸‹åœ¨äº¤æ˜“ä¸­çš„å‘ç”Ÿæƒ…å†µã€‚åœ¨è§„åˆ™ {è…Œèœ} â‡’ {çƒ­ç‹—} ä¸­ï¼Œè¡¨ç¤ºå¦‚æœé¡¾å®¢è´­ä¹°è…Œèœï¼Œä»–ä»¬ä¹Ÿå¾ˆå¯èƒ½è´­ä¹°çƒ­ç‹—ã€‚\nè§„åˆ™å¯ä»¥è¡¨è¾¾å¤šä¸ªé¡¹ç›®ä¹‹é—´çš„å…³ç³»ï¼›ä¾‹å¦‚ï¼Œ{è…Œèœï¼Œç•ªèŒ„é…±ï¼ŒèŠ¥æœ«ï¼Œè–¯ç‰‡} â‡’ {çƒ­ç‹—ï¼Œæ±‰å ¡è‚‰é¥¼ï¼Œçƒ­ç‹—é¢åŒ…ï¼Œè‹æ‰“æ°´ï¼Œå•¤é…’}ã€‚åœ¨è¿™ç§æ„ä¹‰ä¸Šï¼Œæ¡ä»¶å¹¶ä¸æ„å‘³ç€å› æœå…³ç³»ï¼Œåªæ˜¯ä¸€ç§å…³è”ï¼Œæ— è®ºæ˜¯å¼ºè¿˜æ˜¯å¼±ã€‚\nå…³è”è§„åˆ™é€šå¸¸ä½¿ç”¨ä¸‰ç§å¸¸è§çš„åº¦é‡æ¥è¡¨ç¤ºï¼Œè¿™äº›åº¦é‡åæ˜ äº†æ¡ä»¶æ¦‚ç‡çš„è§„åˆ™ã€‚\nâ€¢ ä¸€ç»„é¡¹ç›®çš„æ”¯æŒåº¦æ˜¯åŒ…å«è¯¥ç»„é¡¹ç›®çš„æ‰€æœ‰äº¤æ˜“çš„æ¯”ä¾‹ã€‚å¦‚æœ {çƒ­ç‹—ï¼Œè‹æ‰“æ°´} å‡ºç°åœ¨ 200 ç¬”äº¤æ˜“ä¸­çš„ 10 ç¬”ä¸­ï¼Œé‚£ä¹ˆæ”¯æŒåº¦({çƒ­ç‹—ï¼Œè‹æ‰“æ°´}) = 0.05ã€‚è¿™å¹¶ä¸å½±å“è¿™ 10 ç¬”äº¤æ˜“æ˜¯å¦è¿˜åŒ…å«å…¶ä»–é¡¹ç›®ï¼›æ”¯æŒåº¦æ˜¯é’ˆå¯¹æ¯ä¸ªå”¯ä¸€çš„é¡¹ç›®ç»„åˆå•ç‹¬å®šä¹‰çš„ã€‚\nâ€¢ ç½®ä¿¡åº¦æ˜¯è§„åˆ™ä¸­æ‰€æœ‰é¡¹ç›®å…±åŒå‡ºç°çš„æ”¯æŒåº¦ï¼Œæ¡ä»¶æ˜¯å·¦ä¾§é›†åˆå•ç‹¬çš„æ”¯æŒåº¦ã€‚å› æ­¤ï¼Œç½®ä¿¡åº¦(X â‡’ Y) = æ”¯æŒåº¦(X âˆ© Y)/æ”¯æŒåº¦(X)ï¼ˆå…¶ä¸­â€œâˆ©â€è¡¨ç¤ºâ€œå’Œâ€ï¼‰ã€‚è€ƒè™‘è§„åˆ™ {è…Œèœ} â‡’ {çƒ­ç‹—}ã€‚å¦‚æœ{è…Œèœ}å‡ºç°åœ¨ 1% çš„äº¤æ˜“ä¸­ï¼ˆå³æ”¯æŒåº¦({è…Œèœ}) = 0.01ï¼‰ï¼Œå¹¶ä¸”{è…Œèœï¼Œçƒ­ç‹—}å‡ºç°åœ¨ 0.5% çš„äº¤æ˜“ä¸­ï¼Œé‚£ä¹ˆç½®ä¿¡åº¦({è…Œèœ} â‡’ {çƒ­ç‹—}) = 0.005/0.01 = 0.5ã€‚æ¢å¥è¯è¯´ï¼Œçƒ­ç‹—åœ¨è…Œèœå‡ºç°çš„æƒ…å†µä¸‹æœ‰50%çš„å¯èƒ½æ€§ä¹Ÿä¼šå‡ºç°ã€‚\nâ€¢ æå‡åº¦è¡¡é‡äº†ä¸€ä¸ªé›†åˆçš„æ”¯æŒåº¦åœ¨æ¯ä¸ªå…ƒç´ çš„è”åˆæ”¯æŒåº¦çš„æ¡ä»¶ä¸‹çš„æƒ…å†µï¼Œå³æå‡åº¦(X â‡’ Y) = æ”¯æŒåº¦(X âˆ© Y)/(æ”¯æŒåº¦(X) * æ”¯æŒåº¦(Y))ã€‚ç»§ç»­çƒ­ç‹—çš„ä¾‹å­ï¼Œå¦‚æœæ”¯æŒåº¦({è…Œèœ}) = 0.01ï¼Œæ”¯æŒåº¦({çƒ­ç‹—}) = 0.01ï¼Œæ”¯æŒåº¦({è…Œèœï¼Œçƒ­ç‹—}) = 0.005ï¼Œé‚£ä¹ˆæå‡åº¦({è…Œèœ â‡’ çƒ­ç‹—}) = 0.005/(0.01 * 0.01) = 50ã€‚æ¢å¥è¯è¯´ï¼Œç»„åˆ {è…Œèœï¼Œçƒ­ç‹—} å‡ºç°çš„é¢‘ç‡æ˜¯ä¸¤ä¸ªé¡¹ç›®ç‹¬ç«‹å‡ºç°æ—¶çš„ 50 å€ã€‚\nè¿™ä¸‰ç§åº¦é‡å‘Šè¯‰æˆ‘ä»¬ä¸åŒçš„ä¿¡æ¯ã€‚å½“æˆ‘ä»¬æœç´¢è§„åˆ™æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æ¯ä¸ªåº¦é‡ä¸Šéƒ½è¶…è¿‡ä¸€ä¸ªæœ€å°é˜ˆå€¼ï¼šæ‰¾åˆ°åœ¨äº¤æ˜“ä¸­ç›¸å¯¹é¢‘ç¹å‘ç”Ÿçš„é¡¹ç›®é›†ï¼ˆæ”¯æŒï¼‰ï¼Œæ˜¾ç¤ºå¼ºæœ‰åŠ›çš„æ¡ä»¶å…³ç³»ï¼ˆç½®ä¿¡åº¦ï¼‰ï¼Œå¹¶ä¸”æ¯”éšæœºå‘ç”Ÿæ›´å¸¸è§ï¼ˆæå‡åº¦ï¼‰ã€‚\nåœ¨å®è·µä¸­ï¼Œåˆ†æäººå‘˜ä¼šå°†æ‰€éœ€æ”¯æŒåº¦çš„æ°´å¹³è®¾ç½®ä¸ºè¯¸å¦‚ 0.01ã€0.10ã€0.20 ç­‰å…·æœ‰æ„ä¹‰å’Œå¯¹ä¸šåŠ¡æœ‰ç”¨çš„å€¼ï¼Œè€ƒè™‘åˆ°æ•°æ®ç‰¹å¾ï¼ˆå¦‚é¡¹ç›®é›†çš„å¤§å°ï¼‰ã€‚åŒæ ·ï¼Œæ‰€éœ€çš„ç½®ä¿¡åº¦æ°´å¹³å¯èƒ½æ˜¯é«˜çš„ï¼ˆå¦‚ 0.8ï¼‰æˆ–ä½çš„ï¼ˆå¦‚ 0.2ï¼‰ï¼Œå–å†³äºæ•°æ®å’Œä¸šåŠ¡ã€‚å¯¹äºæå‡åº¦ï¼Œè¾ƒé«˜çš„å€¼é€šå¸¸æ›´å¥½ï¼Œè‚¯å®šåº”è¯¥é«˜äº 1.0ï¼Œå°½ç®¡æˆ‘ä»¬å¿…é¡»æ³¨æ„å…·æœ‰å·¨å¤§æå‡åº¦çš„å¼‚å¸¸å€¼ã€‚\n2 Retail Transaction Data: Groceries æˆ‘ä»¬è¦æ£€æŸ¥çš„æ•°æ®é›†åŒ…å«è¶…å¸‚äº¤æ˜“æ•°æ®ã€‚æˆ‘ä»¬é¦–å…ˆæ£€æŸ¥çš„æ˜¯ arules è½¯ä»¶åŒ…ä¸­åŒ…å«çš„ä¸€ä¸ªå°å‹æ•°æ®é›†ã€‚å°½ç®¡è§„æ¨¡è¾ƒå°ï¼Œä½†è¿™ä¸ªæ•°æ®é›†å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºé¡¹ç›®æ ‡è®°æœ‰ç±»åˆ«åç§°ï¼Œä½¿å…¶æ›´æ˜“äºé˜…è¯»ã€‚ç„¶åï¼Œæˆ‘ä»¬è½¬å‘ä¸€ä¸ªæ¥è‡ªè¶…å¸‚è¿é”åº—çš„è¾ƒå¤§æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†çš„æ•°æ®è¢«ä¼ªè£…ï¼Œä½†æ›´å…¸å‹äºå¤§å‹æ•°æ®é›†ã€‚\n2.1 Data: Groceries æˆ‘ä»¬å°†ä½¿ç”¨ arules è½¯ä»¶åŒ…ä¸­çš„ Groceries æ•°æ®é›†æ¥è¯´æ˜å…³è”è§„åˆ™çš„ä¸€èˆ¬æ¦‚å¿µã€‚è¿™ä¸ªæ•°æ®é›†åŒ…å«ä¸€èµ·è´­ä¹°çš„å•†å“åˆ—è¡¨ï¼ˆå³å¸‚åœºè´­ç‰©ç¯®ï¼‰ï¼Œå…¶ä¸­çš„å•ä¸ªé¡¹ç›®è¢«è®°å½•ä¸ºç±»åˆ«æ ‡ç­¾ï¼Œè€Œä¸æ˜¯äº§å“åç§°ã€‚åœ¨ç»§ç»­ä¹‹å‰ï¼Œæ‚¨åº”è¯¥å®‰è£… arules å’Œ arulesViz è½¯ä»¶åŒ…ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026gt; data(\u0026#34;Groceries\u0026#34;) \u0026gt; summary(Groceries) transactions as itemMatrix in sparse format with 9835 rows (elements/itemsets/transactions) and 169 columns (items) and a density of 0.02609146 most frequent items: whole milk other vegetables rolls/buns soda yogurt (Other) 2513 1903 1809 1715 1372 34055 element (itemset/transaction) length distribution: sizes 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 26 27 28 29 32 2159 1643 1299 1005 855 645 545 438 350 246 182 117 78 77 55 46 29 14 14 9 11 4 6 1 1 1 1 3 1 Min. 1st Qu. Median Mean 3rd Qu. Max. 1.000 2.000 3.000 4.409 6.000 32.000 includes extended item information - examples: labels level2 level1 1 frankfurter sausage meat and sausage 2 sausage sausage meat and sausage 3 liver loaf sausage meat and sausage \u0026gt; inspect(head(Groceries,3)) items [1] {citrus fruit, semi-finished bread, margarine, ready soups} [2] {tropical fruit, yogurt, coffee} [3] {whole milk} 2.2 Finding rules ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ apriori(data, parameters = \u0026hellip;) å‡½æ•°æ¥ä½¿ç”¨ Apriori ç®—æ³•æŸ¥æ‰¾å…³è”è§„åˆ™ã€‚åœ¨æ¦‚å¿µå±‚é¢ä¸Šï¼ŒApriori ç®—æ³•æœç´¢åœ¨ä¸€ç³»åˆ—äº¤æ˜“ä¸­é¢‘ç¹å‡ºç°çš„é¡¹ç›®é›†ã€‚å¯¹äºæ¯ä¸ªé¡¹ç›®é›†ï¼Œå®ƒè¯„ä¼°åœ¨ç‰¹å®šæ”¯æŒåº¦æ°´å¹³æˆ–ä»¥ä¸Šè¡¨è¾¾é¡¹ç›®ä¹‹é—´å…³è”çš„å„ç§å¯èƒ½è§„åˆ™ï¼Œç„¶åä¿ç•™æ˜¾ç¤ºç½®ä¿¡åº¦è¶…è¿‡æŸä¸ªé˜ˆå€¼çš„è§„åˆ™ã€‚\nä¸ºäº†æ§åˆ¶ apriori() çš„æœç´¢èŒƒå›´ï¼Œæˆ‘ä»¬ä½¿ç”¨å‚æ•° list() æ¥æŒ‡ç¤ºç®—æ³•æœç´¢å…·æœ‰æœ€å°æ”¯æŒåº¦ 0.01ï¼ˆ1% çš„äº¤æ˜“ï¼‰çš„è§„åˆ™ï¼Œå¹¶æå–é‚£äº›è¿›ä¸€æ­¥è¡¨ç°å‡ºæœ€å°ç½®ä¿¡åº¦ 0.3 çš„è§„åˆ™ã€‚ç”Ÿæˆçš„è§„åˆ™é›†è¢«èµ‹å€¼ç»™ groc.rules å¯¹è±¡ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026gt; groc.rules \u0026lt;- apriori(Groceries, parameter = list(supp=0.01, conf=0.3, target=\u0026#34;rules\u0026#34;)) Apriori Parameter specification: confidence minval smax arem aval originalSupport maxtime support minlen maxlen target ext 0.3 0.1 1 none FALSE TRUE 5 0.01 1 10 rules TRUE Algorithmic control: filter tree heap memopt load sort verbose 0.1 TRUE TRUE FALSE TRUE 2 TRUE Absolute minimum support count: 98 set item appearances ...[0 item(s)] done [0.00s]. set transactions ...[169 item(s), 9835 transaction(s)] done [0.00s]. sorting and recoding items ... [88 item(s)] done [0.00s]. creating transaction tree ... done [0.00s]. checking subsets of size 1 2 3 4 done [0.00s]. writing ... [125 rule(s)] done [0.00s]. creating S4 object ... done [0.00s]. 2.3 Inspecting rules è¦è§£é‡Šä¸Šé¢ apriori() çš„ç»“æœï¼Œæœ‰ä¸¤ä¸ªå…³é”®çš„äº‹æƒ…éœ€è¦æ£€æŸ¥ã€‚\nâ€¢ é¦–å…ˆï¼Œæ£€æŸ¥è¿›å…¥è§„åˆ™çš„é¡¹ç›®æ•°é‡ï¼Œè¿™åœ¨è¾“å‡ºè¡Œâ€œsorting and recoding items \u0026hellip;â€ä¸­æ˜¾ç¤ºï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å‘Šè¯‰æˆ‘ä»¬æ‰¾åˆ°çš„è§„åˆ™ä½¿ç”¨äº†æ€»å…± 88 ä¸ªé¡¹ç›®ä¸­çš„æ•°é‡ã€‚å¦‚æœè¿™ä¸ªæ•°å­—å¤ªå°ï¼ˆåªæœ‰ä½ çš„é¡¹ç›®çš„ä¸€ä¸ªå°é›†åˆï¼‰æˆ–å¤ªå¤§ï¼ˆå‡ ä¹å…¨éƒ¨ï¼‰ï¼Œé‚£ä¹ˆä½ å¯èƒ½å¸Œæœ›è°ƒæ•´æ”¯æŒåº¦å’Œç½®ä¿¡åº¦æ°´å¹³ã€‚ â€¢ æ¥ä¸‹æ¥ï¼Œæ£€æŸ¥æ‰¾åˆ°çš„è§„åˆ™æ•°é‡ï¼Œå¦‚â€œwriting \u0026hellip;â€è¡Œæ‰€ç¤ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç®—æ³•æ‰¾åˆ°äº† 125 æ¡è§„åˆ™ã€‚å¦‚æœè¿™ä¸ªæ•°å­—å¤ªä½ï¼Œé‚£ä¹ˆè¯´æ˜éœ€è¦é™ä½æ”¯æŒåº¦æˆ–ç½®ä¿¡åº¦æ°´å¹³ï¼›å¦‚æœå¤ªé«˜ï¼ˆä¾‹å¦‚æ¯”é¡¹ç›®æ•°å¤šå¾ˆå¤šçš„è§„åˆ™ï¼‰ï¼Œä½ å¯èƒ½éœ€è¦å¢åŠ æ”¯æŒåº¦æˆ–ç½®ä¿¡åº¦æ°´å¹³ã€‚\nä¸€æ—¦æˆ‘ä»¬ä» apriori() è·å¾—äº†ä¸€ç»„è§„åˆ™é›†ï¼Œæˆ‘ä»¬ä½¿ç”¨ inspect(rules) æ¥æ£€æŸ¥å…³è”è§„åˆ™ã€‚ä¸Šé¢çš„å®Œæ•´åˆ—è¡¨æœ‰ 125 æ¡è§„åˆ™ï¼Œå¤ªé•¿äº†ï¼Œè¿™é‡Œæ— æ³•å…¨éƒ¨æ£€æŸ¥ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©å…·æœ‰é«˜æå‡åº¦ï¼ˆlift \u0026gt; 3ï¼‰çš„éƒ¨åˆ†è§„åˆ™å­é›†ã€‚æˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„è§„åˆ™é›†ä¸­æœ‰äº”æ¡è§„åˆ™çš„æå‡åº¦å¤§äº 3.0ï¼š\n1 2 3 4 5 6 7 \u0026gt; inspect(subset(groc.rules, lift \u0026gt; 3)) lhs rhs support confidence coverage lift count [1] {beef} =\u0026gt; {root vegetables} 0.01738688 0.3313953 0.05246568 3.040367 171 [2] {citrus fruit, root vegetables} =\u0026gt; {other vegetables} 0.01037112 0.5862069 0.01769192 3.029608 102 [3] {citrus fruit, other vegetables} =\u0026gt; {root vegetables} 0.01037112 0.3591549 0.02887646 3.295045 102 [4] {tropical fruit, root vegetables} =\u0026gt; {other vegetables} 0.01230300 0.5845411 0.02104728 3.020999 121 [5] {tropical fruit, other vegetables} =\u0026gt; {root vegetables} 0.01230300 0.3427762 0.03589222 3.144780 121 ç¬¬ä¸€æ¡è§„åˆ™å‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æœä¸€æ¬¡äº¤æ˜“åŒ…å« {ç‰›è‚‰}ï¼Œé‚£ä¹ˆå®ƒä¹Ÿæ›´æœ‰å¯èƒ½åŒ…å« {æ ¹èœç±»è”¬èœ}â€”â€”æˆ‘ä»¬å‡è®¾è¿™ä¸ªç±»åˆ«åŒ…æ‹¬åœŸè±†å’Œæ´‹è‘±ç­‰é¡¹ç›®ã€‚æ”¯æŒåº¦æ˜¾ç¤ºè¯¥ç»„åˆå‡ºç°åœ¨ 1.7% çš„è´­ç‰©ç¯®ä¸­ï¼Œæå‡åº¦æ˜¾ç¤ºè¯¥ç»„åˆå…±åŒå‡ºç°çš„å¯èƒ½æ€§æ˜¯å•ç‹¬å‡ºç°çš„å‘ç”Ÿç‡çš„ 3 å€ã€‚\næ ¹æ®è¿™æ ·çš„ä¿¡æ¯ï¼Œå•†åº—å¯èƒ½ä¼šå¾—å‡ºå‡ ä¸ªè§è§£ã€‚ä¾‹å¦‚ï¼Œå•†åº—å¯ä»¥åœ¨ç‰›è‚‰æŸœå°é™„è¿‘è®¾ç½®ä¸€ä¸ªåœŸè±†å’Œæ´‹è‘±çš„é™ˆåˆ—ï¼Œä»¥é¼“åŠ±æ­£åœ¨æŸ¥çœ‹ç‰›è‚‰çš„è´­ç‰©è€…è´­ä¹°è¿™äº›è”¬èœï¼Œæˆ–è€…è€ƒè™‘ä½¿ç”¨å®ƒä»¬çš„é£Ÿè°±ã€‚å®ƒè¿˜å¯ä»¥å»ºè®®å°†ç‰›è‚‰çš„ä¼˜æƒ åˆ¸æ”¾åœ¨æ ¹èœç±»è”¬èœåŒºï¼Œæˆ–è€…åœ¨å•†åº—çš„æŸä¸ªåœ°æ–¹å±•ç¤ºé£Ÿè°±å¡ã€‚\n2.4 Plot rules ä¸ºäº†äº†è§£è§„åˆ™çš„åˆ†å¸ƒæƒ…å†µï¼Œæˆ‘ä»¬åŠ è½½ arulesViz è½¯ä»¶åŒ…ï¼Œç„¶åä½¿ç”¨ plot() å‡½æ•°ç»˜åˆ¶è§„åˆ™é›†ï¼Œæ ¹æ®ç½®ä¿¡åº¦ï¼ˆY è½´ï¼‰å’Œæ”¯æŒåº¦ï¼ˆX è½´ï¼‰ç»˜åˆ¶è§„åˆ™ï¼Œå¹¶æ ¹æ®æå‡åº¦è°ƒæ•´ç‚¹çš„æ·±æµ…ä»¥è¡¨ç¤ºè§„åˆ™çš„é‡è¦æ€§ã€‚\n1 \u0026gt; plot(groc.rules) {% asset_image R_week7_code_plot1.png %}\nåœ¨è¯¥å›¾è¡¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¤§å¤šæ•°è§„åˆ™æ¶‰åŠå¾ˆå°‘å‘ç”Ÿçš„é¡¹ç›®ç»„åˆï¼ˆå³æ”¯æŒåº¦ä½ï¼‰ï¼Œè€Œç½®ä¿¡åº¦ç›¸å¯¹å¹³ç¨³åˆ†å¸ƒã€‚\nç®€å•åœ°æ˜¾ç¤ºç‚¹å¹¶ä¸æ˜¯éå¸¸æœ‰ç”¨ï¼ŒarulesViz çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§æ˜¯äº¤äº’å¼ç»˜å›¾ã€‚åœ¨ä¸Šè¿°å›¾ä¸­ï¼Œæœ‰ä¸€äº›è§„åˆ™ä½äºå·¦ä¸Šè§’ï¼Œå…·æœ‰å¾ˆé«˜çš„æå‡åº¦ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨äº¤äº’å¼ç»˜å›¾æ¥æ£€æŸ¥è¿™äº›è§„åˆ™ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œå°† interactive=TRUE æ·»åŠ åˆ° plot() å‘½ä»¤ä¸­ï¼š\n1 \u0026gt; plot(groc.rules, engine = \u0026#34;plotly\u0026#34;) {% asset_image R_week7_code_plot2.png %}\nåœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œæ‚¨å¯ä»¥æ£€æŸ¥è§„åˆ™çš„åŒºåŸŸã€‚ä¸ºæ­¤ï¼Œè¯·åœ¨æ„Ÿå…´è¶£çš„åŒºåŸŸçš„ä¸€ä¸ªè§’è½å•å‡»ä¸€æ¬¡ï¼Œç„¶ååœ¨ç›¸åçš„è§’è½å†æ¬¡å•å‡»ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ”¾å¤§åŠŸèƒ½æ”¾å¤§è¯¥åŒºåŸŸæˆ–ä½¿ç”¨æ£€æŸ¥åŠŸèƒ½åˆ—å‡ºè¯¥åŒºåŸŸçš„è§„åˆ™ã€‚å®Œæˆåï¼Œè¯·å•å‡»ç»“æŸã€‚\næˆ‘ä»¬é€‰æ‹©äº†å·¦ä¸Šè§’çš„åŒºåŸŸï¼Œå¹¶æ”¾å¤§äº†è¯¥åŒºåŸŸã€‚ç„¶åï¼Œæˆ‘ä»¬ä»æ”¾å¤§çš„åŒºåŸŸä¸­é€‰æ‹©äº†å‡ æ¡è§„åˆ™ï¼Œå¹¶å•å‡»æ£€æŸ¥ä»¥å°†å®ƒä»¬æ˜¾ç¤ºåœ¨æ§åˆ¶å°ä¸­ã€‚åœ¨è¯¥å­åŒºåŸŸä¸­æœ‰ä¸ƒæ¡è§„åˆ™ã€‚è¿™æ˜¾ç¤ºäº†ä¸¤æ¡é«˜æå‡åº¦çš„è§„åˆ™ã€‚\nå…¶ä¸­ä¸€æ¡è§„åˆ™å‘Šè¯‰æˆ‘ä»¬ï¼Œç»„åˆ {æŸ‘æ©˜ç±»æ°´æœï¼Œæ ¹èœç±»è”¬èœ} åœ¨å¤§çº¦ 1.0% çš„è´­ç‰©ç¯®ä¸­å‡ºç°ï¼ˆæ”¯æŒåº¦=0.0104ï¼‰ï¼Œå½“å®ƒå‡ºç°æ—¶ï¼Œé«˜åº¦å¯èƒ½åŒ…å« {å…¶ä»–è”¬èœ}ï¼ˆç½®ä¿¡åº¦=0.586ï¼‰ã€‚è¯¥ç»„åˆçš„å‡ºç°é¢‘ç‡æ¯”æˆ‘ä»¬ä»å•ç‹¬è€ƒè™‘ {æŸ‘æ©˜ç±»æ°´æœï¼Œæ ¹èœç±»è”¬èœ} å’Œ {å…¶ä»–è”¬èœ} çš„ä¸ªä½“å‘ç”Ÿç‡é¢„æœŸçš„è¦å¤š 3 å€ï¼ˆæå‡åº¦=3.03ï¼‰ã€‚\nè¿™æ ·çš„ä¿¡æ¯å¯ä»¥ç”¨äºå¤šç§æ–¹å¼ã€‚å¦‚æœæˆ‘ä»¬å°†äº¤æ˜“ä¸å®¢æˆ·ä¿¡æ¯é…å¯¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨äºå®šå‘é‚®å¯„æˆ–ç”µå­é‚®ä»¶å»ºè®®ã€‚å¯¹äºç»å¸¸ä¸€èµ·é”€å”®çš„å•†å“ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·è°ƒæ•´ä»·æ ¼å’Œåˆ©æ¶¦ç‡ï¼›ä¾‹å¦‚ï¼Œå°†ä¸€ä¸ªå•†å“æ‰“æŠ˜é”€å”®ï¼ŒåŒæ—¶æé«˜å¦ä¸€ä¸ªå•†å“çš„ä»·æ ¼ã€‚æˆ–è€…æ”¶é“¶å‘˜å¯èƒ½ä¼šé—®å®¢æˆ·ï¼šâ€œæ‚¨æ˜¯å¦éœ€è¦é…ä¸€äº›å…¶ä»–è”¬èœï¼Ÿâ€\n2.5 Finding and Plotting Subsets of Rules åœ¨å¸‚åœºè´­ç‰©ç¯®åˆ†æä¸­ï¼Œä¸€ä¸ªå¸¸è§çš„ç›®æ ‡æ˜¯æ‰¾åˆ°æå‡åº¦é«˜çš„è§„åˆ™ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹æå‡åº¦æ’åºæ¥è½»æ¾æ‰¾åˆ°è¿™æ ·çš„è§„åˆ™ã€‚æˆ‘ä»¬ä½¿ç”¨ sort() å‡½æ•°å¯¹è§„åˆ™æŒ‰æå‡åº¦æ’åºï¼Œå¹¶ä»å¤´éƒ¨å–å‡ºå‰ 15 æ¡è§„åˆ™ï¼Œä»¥æå–æå‡åº¦æœ€é«˜çš„ 15 æ¡è§„åˆ™ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026gt; groc.hi \u0026lt;- head(sort(groc.rules, by=\u0026#34;lift\u0026#34;), 15) \u0026gt; inspect(groc.hi) lhs rhs support confidence coverage lift count [1] {citrus fruit, other vegetables} =\u0026gt; {root vegetables} 0.01037112 0.3591549 0.02887646 3.295045 102 [2] {tropical fruit, other vegetables} =\u0026gt; {root vegetables} 0.01230300 0.3427762 0.03589222 3.144780 121 [3] {beef} =\u0026gt; {root vegetables} 0.01738688 0.3313953 0.05246568 3.040367 171 [4] {citrus fruit, root vegetables} =\u0026gt; {other vegetables} 0.01037112 0.5862069 0.01769192 3.029608 102 [5] {tropical fruit, root vegetables} =\u0026gt; {other vegetables} 0.01230300 0.5845411 0.02104728 3.020999 121 [6] {other vegetables, whole milk} =\u0026gt; {root vegetables} 0.02318251 0.3097826 0.07483477 2.842082 228 [7] {whole milk, curd} =\u0026gt; {yogurt} 0.01006609 0.3852140 0.02613116 2.761356 99 [8] {root vegetables, rolls/buns} =\u0026gt; {other vegetables} 0.01220132 0.5020921 0.02430097 2.594890 120 [9] {root vegetables, yogurt} =\u0026gt; {other vegetables} 0.01291307 0.5000000 0.02582613 2.584078 127 [10] {tropical fruit, whole milk} =\u0026gt; {yogurt} 0.01514997 0.3581731 0.04229792 2.567516 149 [11] {yogurt, whipped/sour cream} =\u0026gt; {other vegetables} 0.01016777 0.4901961 0.02074225 2.533410 100 [12] {other vegetables, whipped/sour cream} =\u0026gt; {yogurt} 0.01016777 0.3521127 0.02887646 2.524073 100 [13] {tropical fruit, other vegetables} =\u0026gt; {yogurt} 0.01230300 0.3427762 0.03589222 2.457146 121 [14] {root vegetables, whole milk} =\u0026gt; {other vegetables} 0.02318251 0.4740125 0.04890696 2.449770 228 [15] {whole milk, whipped/sour cream} =\u0026gt; {yogurt} 0.01087951 0.3375394 0.03223183 2.419607 107 æ”¯æŒåº¦å’Œæå‡åº¦å¯¹äºä¸€ä¸ªé¡¹ç›®é›†æ¥è¯´æ˜¯ç›¸åŒçš„ï¼Œæ— è®ºåœ¨è§„åˆ™çš„å·¦ä¾§è¿˜æ˜¯å³ä¾§ï¼ˆå³æ‰‹æˆ–å·¦æ‰‹ï¼‰å†…çš„é¡¹ç›®çš„é¡ºåºå¦‚ä½•ã€‚ç„¶è€Œï¼Œç½®ä¿¡åº¦åæ˜ äº†æ–¹å‘ï¼Œå› ä¸ºå®ƒè®¡ç®—äº†å³æ‰‹é›†åˆåœ¨å·¦æ‰‹é›†åˆæ¡ä»¶ä¸‹çš„å‡ºç°æƒ…å†µã€‚\nè§„åˆ™çš„å›¾å½¢æ˜¾ç¤ºå¯èƒ½å¯¹å¯»æ‰¾æ›´é«˜å±‚æ¬¡çš„ä¸»é¢˜å’Œæ¨¡å¼å¾ˆæœ‰ç”¨ã€‚æˆ‘ä»¬ä½¿ç”¨ plot(\u0026hellip;, method=\u0026ldquo;graph\u0026rdquo;) æ¥ç»˜åˆ¶æŒ‰æå‡åº¦æ’åçš„å‰ 15 æ¡è§„åˆ™çš„å›¾å½¢æ˜¾ç¤ºï¼š\n{% asset_image R_week7_code_plot3.png %}\nç»“æœå›¾ä¸­é¡¹ç›®çš„ä½ç½®å¯èƒ½å› æ‚¨çš„ç³»ç»Ÿè€Œå¼‚ï¼Œä½†é¡¹ç›®é›†ç¾¤åº”è¯¥æ˜¯ç›¸ä¼¼çš„ã€‚æ¯ä¸ªåœ†åœˆä»£è¡¨ä¸€æ¡è§„åˆ™ï¼Œå…¶ä¸­æ¥è‡ªè§„åˆ™å·¦ä¾§é¡¹çš„å…¥ç«™ç®­å¤´ï¼ŒæŒ‡å‘å³ä¾§é¡¹çš„å‡ºç«™ç®­å¤´ã€‚åœ†åœˆçš„å¤§å°ï¼ˆé¢ç§¯ï¼‰è¡¨ç¤ºè§„åˆ™çš„æ”¯æŒåº¦ï¼Œè€Œé¢œè‰²çš„æ·±æµ…è¡¨ç¤ºæå‡åº¦ï¼ˆé¢œè‰²è¶Šæ·±è¡¨ç¤ºæå‡åº¦è¶Šé«˜ï¼‰ã€‚\n3 Supermarket Data ç°åœ¨æˆ‘ä»¬å°†è°ƒæŸ¥æ¥è‡ªæ¯”åˆ©æ—¶ä¸€å®¶è¶…å¸‚è¿é”åº—çš„æ›´å¤§è§„æ¨¡çš„é›¶å”®äº¤æ˜“æ•°æ®ä¸­çš„å…³è”æƒ…å†µã€‚è¿™ä¸ªæ•°æ®é›†åŒ…æ‹¬ä¸€èµ·è´­ä¹°çš„å•†å“çš„è´­ç‰©ç¯®ï¼Œå…¶ä¸­æ¯æ¡è®°å½•éƒ½åŒ…æ‹¬ä»»æ„ç¼–å·çš„å•†å“ç¼–å·ï¼Œæ²¡æœ‰å•†å“æè¿°ï¼ˆä¸ºäº†ä¿æŠ¤è¯¥è¿é”åº—çš„ä¸“æœ‰æ•°æ®ï¼‰ã€‚è¿™ä¸ªæ•°æ®é›†æ˜¯ç”±Brijsç­‰äººå…¬å¼€æä¾›çš„ã€‚\n3.1 Data Preparation First we use readLines() to get the data from where it is hosted:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 \u0026gt; retail.raw \u0026lt;- readLines(\u0026#34;retail.dat\u0026#34;) \u0026gt; head(retail.raw) [1] \u0026#34;0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026#34; [2] \u0026#34;30 31 32 \u0026#34; [3] \u0026#34;33 34 35 \u0026#34; [4] \u0026#34;36 37 38 39 40 41 42 43 44 45 46 \u0026#34; [5] \u0026#34;38 39 47 48 \u0026#34; [6] \u0026#34;38 39 48 49 50 51 52 53 54 55 56 57 58 \u0026#34; \u0026gt; tail(retail.raw) [1] \u0026#34;48 201 255 278 407 479 767 824 986 1395 1598 2022 2283 2375 6725 13334 14006 14099 \u0026#34; [2] \u0026#34;39 875 2665 2962 12959 14070 14406 15518 16379 \u0026#34; [3] \u0026#34;39 41 101 346 393 413 479 522 586 635 695 799 1466 1786 1994 2449 2830 3035 3591 3722 6217 11493 12129 13033 \u0026#34; [4] \u0026#34;2310 4267 \u0026#34; [5] \u0026#34;39 48 2528 \u0026#34; [6] \u0026#34;32 39 205 242 1393 \u0026#34; \u0026gt; summary(retail.raw) Length Class Mode 88162 character character è¯¥å¯¹è±¡ä¸­çš„æ¯ä¸€è¡Œè¡¨ç¤ºä¸€ç¯®å­è´­ç‰©ä¸­ä¸€èµ·è´­ä¹°çš„å•†å“ã€‚åœ¨æ¯ä¸€è¡Œå†…ï¼Œå•†å“è¢«åˆ†é…äº†ä»»æ„çš„æ•°å­—ï¼Œè¿™äº›æ•°å­—ä»0å¼€å§‹ï¼Œéšç€åç»­äº¤æ˜“çš„éœ€è¦é€æ¸å¢åŠ æ–°çš„å•†å“ç¼–å·ã€‚\næ•°æ®åŒ…æ‹¬ 88,162 ä¸ªäº¤æ˜“ï¼Œç¬¬ä¸€ä¸ªè´­ç‰©ç¯®æœ‰ 30 ä¸ªå•†å“ï¼ˆç¼–å·ä¸º 0-29ï¼‰ï¼Œç¬¬äºŒä¸ªæœ‰ 3 ä¸ªå•†å“ï¼Œä¾æ­¤ç±»æ¨ã€‚åœ¨ tail() ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ€åä¸€ä¸ªè´­ç‰©ç¯®æœ‰ 5 ä¸ªå•†å“ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†å•†å“ï¼Œå¦‚ 32ã€39ã€205 å’Œ 242 å·ï¼Œç¼–å·è¾ƒä½ï¼Œåæ˜ äº†è¿™äº›ç‰¹å®šå•†å“æœ€åˆå‡ºç°åœ¨æ•°æ®é›†çš„æ—©æœŸäº¤æ˜“ä¸­ã€‚\nåœ¨è¿™ç§æ–‡æœ¬æ ¼å¼ä¸­ï¼Œæ•°æ®è¿˜ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼›æˆ‘ä»¬å¿…é¡»é¦–å…ˆå°†æ¯ä¸ªäº¤æ˜“æ–‡æœ¬è¡Œæ‹†åˆ†æˆå•ç‹¬çš„å•†å“ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ strsplit(lines, \u0026quot; \u0026ldquo;)ã€‚è¿™ä¸ªå‘½ä»¤åœ¨æ¯ä¸ªç©ºæ ¼å­—ç¬¦ï¼ˆ\u0026rdquo; \u0026ldquo;ï¼‰å¤„å°†æ¯ä¸€è¡Œæ‹†åˆ†ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; retail.list \u0026lt;- strsplit(retail.raw, \u0026#34; \u0026#34;) \u0026gt; names(retail.list) \u0026lt;- paste(\u0026#34;Trans\u0026#34;, 1:length(retail.list)) \u0026gt; str(retail.list) List of 88162 $ Trans 1 : chr [1:30] \u0026#34;0\u0026#34; \u0026#34;1\u0026#34; \u0026#34;2\u0026#34; \u0026#34;3\u0026#34; ... $ Trans 2 : chr [1:3] \u0026#34;30\u0026#34; \u0026#34;31\u0026#34; \u0026#34;32\u0026#34; $ Trans 3 : chr [1:3] \u0026#34;33\u0026#34; \u0026#34;34\u0026#34; \u0026#34;35\u0026#34; $ Trans 4 : chr [1:11] \u0026#34;36\u0026#34; \u0026#34;37\u0026#34; \u0026#34;38\u0026#34; \u0026#34;39\u0026#34; ... $ Trans 5 : chr [1:4] \u0026#34;38\u0026#34; \u0026#34;39\u0026#34; \u0026#34;47\u0026#34; \u0026#34;48\u0026#34; $ Trans 6 : chr [1:13] \u0026#34;38\u0026#34; \u0026#34;39\u0026#34; \u0026#34;48\u0026#34; \u0026#34;49\u0026#34; ... $ Trans 7 : chr [1:6] \u0026#34;32\u0026#34; \u0026#34;41\u0026#34; \u0026#34;59\u0026#34; \u0026#34;60\u0026#34; ... 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 \u0026gt; some(retail.list) #note: random sample; your results may vary $`Trans 1458` [1] \u0026#34;32\u0026#34; \u0026#34;38\u0026#34; \u0026#34;39\u0026#34; \u0026#34;48\u0026#34; \u0026#34;370\u0026#34; \u0026#34;371\u0026#34; \u0026#34;373\u0026#34; \u0026#34;931\u0026#34; $`Trans 5763` [1] \u0026#34;41\u0026#34; \u0026#34;79\u0026#34; \u0026#34;186\u0026#34; \u0026#34;251\u0026#34; \u0026#34;374\u0026#34; \u0026#34;389\u0026#34; \u0026#34;751\u0026#34; \u0026#34;3532\u0026#34; \u0026#34;4993\u0026#34; \u0026#34;5344\u0026#34; $`Trans 13502` [1] \u0026#34;39\u0026#34; \u0026#34;41\u0026#34; \u0026#34;279\u0026#34; \u0026#34;475\u0026#34; \u0026#34;1516\u0026#34; \u0026#34;1739\u0026#34; \u0026#34;1960\u0026#34; \u0026#34;3281\u0026#34; \u0026#34;5354\u0026#34; \u0026#34;6128\u0026#34; $`Trans 27697` [1] \u0026#34;7797\u0026#34; \u0026#34;11864\u0026#34; $`Trans 27864` [1] \u0026#34;39\u0026#34; \u0026#34;956\u0026#34; \u0026#34;1783\u0026#34; \u0026#34;1907\u0026#34; \u0026#34;3185\u0026#34; \u0026#34;4208\u0026#34; $`Trans 29944` [1] \u0026#34;32\u0026#34; \u0026#34;39\u0026#34; \u0026#34;48\u0026#34; \u0026#34;12136\u0026#34; $`Trans 50578` [1] \u0026#34;597\u0026#34; \u0026#34;727\u0026#34; \u0026#34;1907\u0026#34; \u0026#34;14031\u0026#34; $`Trans 62789` [1] \u0026#34;1163\u0026#34; \u0026#34;3497\u0026#34; \u0026#34;3941\u0026#34; \u0026#34;5685\u0026#34; \u0026#34;12968\u0026#34; \u0026#34;15148\u0026#34; $`Trans 67790` [1] \u0026#34;4165\u0026#34; \u0026#34;4398\u0026#34; \u0026#34;14098\u0026#34; $`Trans 77780` [1] \u0026#34;18\u0026#34; \u0026#34;32\u0026#34; \u0026#34;39\u0026#34; \u0026#34;41\u0026#34; \u0026#34;262\u0026#34; \u0026#34;418\u0026#34; \u0026#34;438\u0026#34; \u0026#34;864\u0026#34; \u0026#34;913\u0026#34; \u0026#34;1342\u0026#34; \u0026#34;1696\u0026#34; \u0026#34;1872\u0026#34; \u0026#34;2077\u0026#34; \u0026#34;2856\u0026#34; \u0026#34;5740\u0026#34; \u0026#34;10423\u0026#34; [17] \u0026#34;10939\u0026#34; \u0026#34;15832\u0026#34; ä½¿ç”¨ str()ï¼Œæˆ‘ä»¬ç¡®è®¤åˆ—è¡¨æœ‰ 88,162 ä¸ªæ¡ç›®ï¼Œå¹¶ä¸”å•ä¸ªæ¡ç›®çœ‹èµ·æ¥åˆé€‚ã€‚ä½¿ç”¨ some() ä»æ•´ä¸ªè¾ƒå¤§çš„é›†åˆä¸­å¯¹ä¸€äº›äº¤æ˜“è¿›è¡ŒæŠ½æ ·ï¼Œä»¥è¿›è¡Œé¢å¤–ç¡®è®¤ã€‚\nç„¶åï¼Œæˆ‘ä»¬å°†å…¶è½¬æ¢ä¸º transactions å¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥å¢å¼ºæˆ‘ä»¬å¤„ç†æ•°æ®çš„æ–¹å¼å¹¶åŠ é€Ÿ arules æ“ä½œã€‚è¦ä»åˆ—è¡¨è½¬æ¢ä¸º transactionsï¼Œæˆ‘ä»¬ä½¿ç”¨ as(. . . , \u0026ldquo;transactions\u0026rdquo;) æ¥è½¬æ¢å¯¹è±¡ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 \u0026gt; retail.trans \u0026lt;- as(retail.list, \u0026#34;transactions\u0026#34;) #takes a few seconds \u0026gt; summary(retail.trans) transactions as itemMatrix in sparse format with 88162 rows (elements/itemsets/transactions) and 16470 columns (items) and a density of 0.0006257289 most frequent items: 39 48 38 32 41 (Other) 50675 42135 15596 15167 14945 770058 element (itemset/transaction) length distribution: sizes 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 3016 5516 6919 7210 6814 6163 5746 5143 4660 4086 3751 3285 2866 2620 2310 2115 1874 1645 1469 1290 1205 981 887 819 684 586 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 582 472 480 355 310 303 272 234 194 136 153 123 115 112 76 66 71 60 50 44 37 37 33 22 24 21 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 71 73 74 76 21 10 11 10 9 11 4 9 7 4 5 2 2 5 3 3 1 1 1 1 Min. 1st Qu. Median Mean 3rd Qu. Max. 1.00 4.00 8.00 10.31 14.00 76.00 includes extended item information - examples: labels 1 0 2 1 3 10 includes extended transaction information - examples: transactionID 1 Trans 1 2 Trans 2 3 Trans 3 æŸ¥çœ‹ç»“æœå¯¹è±¡çš„ summary()ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°äº¤æ˜“-å•†å“çŸ©é˜µæ˜¯ 88,162 è¡Œä¹˜ä»¥ 16,470 åˆ—ã€‚åœ¨è¿™ 14 äº¿ä¸ªäº¤å‰ç‚¹ä¸­ï¼Œåªæœ‰ 0.06% æœ‰æ­£æ•°æ®ï¼ˆå¯†åº¦ï¼‰ï¼Œå› ä¸ºå¤§å¤šæ•°å•†å“åœ¨å¤§å¤šæ•°äº¤æ˜“ä¸­éƒ½æ²¡æœ‰è¢«è´­ä¹°ã€‚å•†å“ 39 å‡ºç°æœ€é¢‘ç¹ï¼Œåœ¨ 50,675 ä¸ªç¯®å­ä¸­å‡ºç°ï¼Œè¶…è¿‡äº†æ‰€æœ‰äº¤æ˜“çš„ä¸€åŠã€‚3,016 ä¸ªäº¤æ˜“åªåŒ…å«ä¸€ä¸ªå•†å“ï¼ˆâ€œsizesâ€ = 1ï¼‰ï¼Œä¸­ä½ç¯®å­å¤§å°ä¸º 8 ä¸ªå•†å“ã€‚\n3.2 Exercise: Please now use the prepared supermarket data to do the market basket analysis, finding and visualizing the association rules.\n4 Key Point å…³è”è§„åˆ™æ˜¯æ¢ç´¢æ•°æ®é›†ä¸­å…³ç³»çš„å¼ºå¤§æ–¹æ³•ã€‚\nâ€¢ å…³è”è§„åˆ™é€šå¸¸ä¸ç¨€ç–æ•°æ®é›†ä¸€èµ·ä½¿ç”¨ï¼Œè¿™äº›æ•°æ®é›†å…·æœ‰è®¸å¤šè§‚å¯Ÿç»“æœï¼Œä½†æ¯ä¸ªè§‚å¯Ÿç»“æœçš„ä¿¡æ¯å¾ˆå°‘ã€‚åœ¨å¸‚åœºè¥é”€ä¸­ï¼Œè¿™æ˜¯å¸‚åœºç¯®å­å’Œç±»ä¼¼çš„äº¤æ˜“æ•°æ®çš„å…¸å‹ç‰¹å¾ã€‚\nâ€¢ arules è½¯ä»¶åŒ…æ˜¯ R ä¸­ç”¨äºå…³è”è§„åˆ™çš„æ ‡å‡†è½¯ä»¶åŒ…ã€‚arules æä¾›äº†å¤„ç†ç¨€ç–æ•°æ®å’ŒæŸ¥æ‰¾è§„åˆ™çš„æ”¯æŒï¼Œè€Œ arulesViz è½¯ä»¶åŒ…åˆ™æä¾›äº†å¯è§†åŒ–æ–¹æ³•ã€‚\nâ€¢ è¯„ä¼°å…³è”è§„åˆ™çš„æ ¸å¿ƒæŒ‡æ ‡æ˜¯æ”¯æŒåº¦ï¼ˆé¢‘ç‡ï¼‰ã€ç½®ä¿¡åº¦ï¼ˆå…±åŒå‘ç”Ÿï¼‰å’Œæå‡åº¦ï¼ˆçº¯ç²¹å¶ç„¶æƒ…å†µä¸‹çš„å…±åŒå‘ç”Ÿï¼‰ã€‚é™¤äº†æå‡åº¦åº”è¯¥ç•¥é«˜äº 1.0 å¤–ï¼Œå®ƒä»¬æ²¡æœ‰ç»å¯¹å€¼çš„è¦æ±‚ã€‚è§£é‡Šå–å†³äºå¯¹ç±»ä¼¼æ•°æ®çš„ç»éªŒä»¥åŠç‰¹å®šä¸šåŠ¡é—®é¢˜çš„å®ç”¨æ€§ã€‚\nâ€¢ å…³è”è§„åˆ™çš„å…¸å‹å·¥ä½œæµç¨‹åŒ…æ‹¬ï¼š\nå¯¼å…¥åŸå§‹æ•°æ®ï¼Œå¹¶ä½¿ç”¨ as(data, \u0026ldquo;transactions\u0026rdquo;) å°†å…¶è½¬æ¢ä¸º transactions å¯¹è±¡ï¼Œä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚ ä½¿ç”¨ apriori(transactions, support= , confidence= , target=\u0026ldquo;rules\u0026rdquo;) æŸ¥æ‰¾ä¸€ç»„å…³è”è§„åˆ™ã€‚ ä½¿ç”¨ plot(. . . , interactive=TRUE) ç»˜åˆ¶ç»“æœè§„åˆ™å¹¶æ£€æŸ¥è§„åˆ™ã€‚ é€šè¿‡é€‰æ‹©è§„åˆ™çš„å­é›†æ¥å¯»æ‰¾æ¨¡å¼ï¼Œä¾‹å¦‚å…·æœ‰æœ€é«˜æå‡åº¦çš„è§„åˆ™ï¼Œå¹¶ä½¿ç”¨ plot(. . . , method=\u0026ldquo;graph\u0026rdquo;) è¿›è¡Œå¯è§†åŒ–ã€‚ 5 CODE 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 library(\u0026#34;arules\u0026#34;) # processing of regression output library(\u0026#34;arulesViz\u0026#34;) # used for report compilation and table display library(\u0026#34;grid\u0026#34;) # very popular plotting library ggplot2 library(\u0026#34;car\u0026#34;) # multinomial logit library(\u0026#34;plotly\u0026#34;) # ConfusionMatrix # è·å–å½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• file_dir \u0026lt;- dirname(parent.frame(2)$ofile) print(file_dir) # å°†å·¥ä½œç›®å½•è®¾ç½®ä¸ºå½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• setwd(file_dir) data(\u0026#34;Groceries\u0026#34;) summary(Groceries) inspect(head(Groceries,3)) groc.rules \u0026lt;- apriori(Groceries, parameter = list(supp=0.01, conf=0.3, target=\u0026#34;rules\u0026#34;)) inspect(subset(groc.rules, lift \u0026gt; 3)) plot(groc.rules) plot(groc.rules, engine = \u0026#34;plotly\u0026#34;) groc.hi \u0026lt;- head(sort(groc.rules, by=\u0026#34;lift\u0026#34;), 15) inspect(groc.hi) plot(groc.hi, method=\u0026#34;graph\u0026#34;) retail.raw \u0026lt;- readLines(\u0026#34;retail.dat\u0026#34;) head(retail.raw) tail(retail.raw) summary(retail.raw) retail.list \u0026lt;- strsplit(retail.raw, \u0026#34; \u0026#34;) names(retail.list) \u0026lt;- paste(\u0026#34;Trans\u0026#34;, 1:length(retail.list)) str(retail.list) some(retail.list) #note: random sample; your results may vary rm(retail.raw) retail.trans \u0026lt;- as(retail.list, \u0026#34;transactions\u0026#34;) #takes a few seconds summary(retail.trans) rm(retail.list) #remove retail.list as it is not needed anymore. ","date":"2024-03-31T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek7-managing-sustainable-competitive-advantage-code-ii/","title":"R[week7] Managing Sustainable Competitive Advantage code II"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\nä¸€ã€Market Basket Analysis å¸‚åœºè´­ç‰©ç¯®åˆ†æ\n1 2 3 4 5 åœ¨å¸‚åœºè¥é”€é¢†åŸŸå¸¸ç”¨çš„æ•°æ®åˆ†ææŠ€æœ¯ï¼Œä¹Ÿè¢«ç§°ä¸ºå…³è”è§„åˆ™åˆ†ææˆ–è€…å…³è”åˆ†æã€‚å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯å‘ç°äº§å“æˆ–æœåŠ¡ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œå³é¡¾å®¢åœ¨è´­ä¹°æŸä¸€é¡¹äº§å“æˆ–æœåŠ¡çš„åŒæ—¶ï¼Œå¾€å¾€ä¹Ÿä¼šè´­ä¹°å¦ä¸€é¡¹äº§å“æˆ–æœåŠ¡ã€‚é€šè¿‡åˆ†æè¿™äº›è´­ä¹°è¡Œä¸ºï¼Œå¸‚åœºè¥é”€äººå‘˜å¯ä»¥æ›´å¥½åœ°äº†è§£é¡¾å®¢çš„è´­ä¹°åå¥½å’Œè¡Œä¸ºæ¨¡å¼ï¼Œä»è€Œåˆ¶å®šæ›´åŠ ç²¾å‡†çš„è¥é”€ç­–ç•¥ã€‚ å¸‚åœºè´­ç‰©ç¯®åˆ†æçš„åŸºæœ¬åŸç†æ˜¯åˆ©ç”¨å…³è”è§„åˆ™æ¥æè¿°ä¸åŒäº§å“æˆ–æœåŠ¡ä¹‹é—´çš„å…³ç³»ã€‚å…³è”è§„åˆ™é€šå¸¸é‡‡ç”¨â€œå¦‚æœ...é‚£ä¹ˆ...â€çš„å½¢å¼ï¼Œå…¶ä¸­ä¸€ä¸ªé¡¹ç›®é›†åˆï¼ˆæˆ–ç§°ä¸ºé¡¹é›†ï¼‰çš„å‡ºç°è¢«è®¤ä¸ºæ˜¯å¦ä¸€ä¸ªé¡¹ç›®é›†åˆçš„å……åˆ†æ¡ä»¶ã€‚ä¾‹å¦‚ï¼Œâ€œå¦‚æœé¡¾å®¢è´­ä¹°äº†æ´—å‘æ°´ï¼Œé‚£ä¹ˆä»–ä»¬ä¹Ÿæœ‰å¯èƒ½è´­ä¹°æŠ¤å‘ç´ â€ã€‚ åœ¨Rè¯­è¨€ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€äº›åŒ…å¦‚\u0026#34;arules\u0026#34;æ¥è¿›è¡Œå¸‚åœºè´­ç‰©ç¯®åˆ†æã€‚è¿™äº›åŒ…æä¾›äº†ä¸€ç³»åˆ—å‡½æ•°æ¥å‘ç°é¢‘ç¹é¡¹é›†ï¼ˆå³ç»å¸¸åŒæ—¶å‡ºç°çš„äº§å“ç»„åˆï¼‰ä»¥åŠå…³è”è§„åˆ™ã€‚é€šè¿‡åˆ†æè¿™äº›è§„åˆ™ï¼Œä½ å¯ä»¥æ´å¯Ÿé¡¾å®¢çš„è´­ä¹°è¡Œä¸ºæ¨¡å¼ï¼Œå¹¶æ®æ­¤è¿›è¡Œæ›´æœ‰é’ˆå¯¹æ€§çš„è¥é”€æ´»åŠ¨ã€‚ â€¢ å¸‚åœºè´­ç‰©ç¯®åˆ†æï¼Œåˆç§°äº²å’Œæ€§åˆ†æï¼Œæ ¹æ®å®ƒä»¬åœ¨æ•°æ®é›†ä¸­çš„å…±åŒå‡ºç°ï¼Œæ­ç¤ºä¸åŒå®ä½“ä¹‹é—´çš„æœ‰æ„ä¹‰çš„ç›¸å…³æ€§ã€‚ â€¢ å®ƒç”Ÿæˆæ»¡è¶³é¢„å®šä¹‰æ ‡å‡†çš„å…³è”è§„åˆ™ï¼Œä»¥è¯†åˆ«é¢‘ç¹é¡¹ç›®é›†ä¸­æœ€é‡è¦çš„å…³ç³»ï¼Œå¹¶å¸®åŠ©æ­ç¤ºå¤§æ•°æ®ä¸­çš„éšè—æ¨¡å¼ã€‚\n1.1 Benefits of Market Basket Analysis â€¢ When you understand product relationships and purchase sequences, you can identify and track customers who have bought a given product and deliver tailored messages to them. â€¢ With personalization, youâ€™re also able to create more effective marketing campaigns.\n1 2 å½“æ‚¨äº†è§£äº§å“å…³ç³»å’Œè´­ä¹°é¡ºåºæ—¶ï¼Œæ‚¨å¯ä»¥è¯†åˆ«å’Œè·Ÿè¸ªè´­ä¹°ç‰¹å®šäº§å“çš„å®¢æˆ·ï¼Œå¹¶å‘ä»–ä»¬å‘é€å®šåˆ¶çš„æ¶ˆæ¯ã€‚ é€šè¿‡ä¸ªæ€§åŒ–ï¼Œæ‚¨è¿˜èƒ½å¤Ÿåˆ›å»ºæ›´æœ‰æ•ˆçš„è¥é”€æ´»åŠ¨ã€‚ â€¢ Market basket analysis might tell a retailer that customers often purchase shampoo and conditioner together, so putting both items on promotion at the same time would not create a significant increase in revenue, while a promotion involving just one of the items would likely drive sales of the other.\n1 å¸‚åœºè´­ç‰©ç¯®åˆ†æå¯èƒ½å‘Šè¯‰é›¶å”®å•†ï¼Œé¡¾å®¢ç»å¸¸ä¸€èµ·è´­ä¹°æ´—å‘æ°´å’ŒæŠ¤å‘ç´ ï¼Œå› æ­¤åŒæ—¶ä¿ƒé”€è¿™ä¸¤ç§å•†å“ä¸ä¼šæ˜¾è‘—å¢åŠ æ”¶å…¥ï¼Œè€Œä»…ä¿ƒé”€å…¶ä¸­ä¸€ç§å•†å“å¯èƒ½ä¼šæ¨åŠ¨å¦ä¸€ç§å•†å“çš„é”€å”®ã€‚ â€¢ Inventory management\n1 åº“å­˜ç®¡ç†, å­˜å‚¨é€‚é‡çš„ç›¸å…³äº§å“ â€¢ Refine marketing\n1 ä¼˜åŒ–è¥é”€ï¼Œæ ¹æ®å®¢æˆ·é—´çš„äº²å’Œå…³ç³»æ¥å®šä½å¸‚åœºç»†åˆ† äºŒã€Key terms ä¸€ä¸ªé¡¹ç›®é›†æ˜¯ç”±å½¢æˆå…³è”è§„åˆ™çš„æ‰€æœ‰é¡¹ç›®çš„åˆ—è¡¨è¡¨ç¤ºã€‚\nä¸€ä¸ªå…³è”è§„åˆ™ï¼Œ{é¢åŒ…ï¼Œé¸¡è›‹} =\u0026gt; {ç‰›å¥¶}ï¼Œæˆ–æ›´æ™®éçš„ {X} =\u0026gt; {Y}ï¼Œè¡¨æ˜å¦‚æœé¡¾å®¢ä¸€èµ·è´­ä¹°é¢åŒ…å’Œé¸¡è›‹ï¼Œä»–ä»¬å¾ˆå¯èƒ½ä¹Ÿä¼šè´­ä¹°ç‰›å¥¶ã€‚\nâ€¢ Support is a measure of absolute frequency.\n1 25% çš„æ”¯æŒåº¦è¡¨ç¤ºåœ¨æ‰€æœ‰äº¤æ˜“ä¸­ï¼Œé¢åŒ…ã€é¸¡è›‹å’Œç‰›å¥¶ä¸€èµ·è´­ä¹°çš„é¢‘ç‡ä¸º 25%ã€‚ â€¢ Confidence is a measure of correlative frequency.\n1 60% çš„ç½®ä¿¡åº¦è¡¨ç¤ºè´­ä¹°äº†é¢åŒ…å’Œé¸¡è›‹çš„äººä¸­ï¼Œæœ‰ 60% ä¹Ÿè´­ä¹°äº†ç‰›å¥¶ã€‚ â€¢ Lift is a measure of the strength of association between the products on the left and right hand side of the rule.\n1 2 3 4 5 æå‡åº¦æ˜¯å·¦ä¾§å’Œå³ä¾§è§„åˆ™ä¸­äº§å“ä¹‹é—´å…³è”å¼ºåº¦çš„åº¦é‡ã€‚ è§„åˆ™ä¸­æ‰€æœ‰é¡¹ç›®ä¸€èµ·å‡ºç°çš„æ¦‚ç‡é™¤ä»¥å·¦ä¾§å’Œå³ä¾§é¡¹ç›®å•ç‹¬å‡ºç°çš„æ¦‚ç‡çš„ä¹˜ç§¯ï¼Œå°±å¾—åˆ°äº†æå‡åº¦ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœé¢åŒ…ã€é¸¡è›‹å’Œç‰›å¥¶ä¸€èµ·å‡ºç°åœ¨æ‰€æœ‰äº¤æ˜“çš„ 2.5% ä¸­ï¼Œé¢åŒ…å’Œé¸¡è›‹ä¸€èµ·å‡ºç°åœ¨ 10% çš„äº¤æ˜“ä¸­ï¼Œç‰›å¥¶åœ¨ 8% çš„äº¤æ˜“ä¸­å‡ºç°ï¼Œé‚£ä¹ˆæå‡åº¦å°†ä¸ºï¼š0.025/(0.1*0.08) = 3.125ã€‚ æå‡åº¦è¶Šå¤§ï¼Œä¸¤ä¸ªäº§å“ä¹‹é—´çš„è”ç³»è¶Šç´§å¯†ã€‚æå‡åº¦å¤§äº1è¡¨ç¤ºé¢åŒ…å’Œé¸¡è›‹çš„å­˜åœ¨å¢åŠ äº†ç‰›å¥¶ä¹Ÿå‡ºç°åœ¨äº¤æ˜“ä¸­çš„æ¦‚ç‡ã€‚ â€¢ Association Rule: {X â†’ Y} is a representation of finding Y on the basket which has X on it\nâ€¢ Itemset: {X,Y} is a representation of the list of all items which form the association rule\nâ€¢ Support: Fraction of transactions containing the itemset\nâ€¢ Confidence: Probability of occurrence of {Y} given {X} is present\nâ€¢ Lift: Ratio of confidence to baseline probability of occurrence of {Y}\n1 2 3 4 5 â€¢ å…³è”è§„åˆ™ï¼š{X â†’ Y} è¡¨ç¤ºåœ¨åŒ…å« X çš„è´­ç‰©ç¯®ä¸­æ‰¾åˆ° Y çš„è¡¨ç¤ºã€‚ â€¢ é¡¹ç›®é›†ï¼š{X,Y} æ˜¯å½¢æˆå…³è”è§„åˆ™çš„æ‰€æœ‰é¡¹ç›®çš„åˆ—è¡¨è¡¨ç¤ºã€‚ â€¢ æ”¯æŒåº¦ï¼šåŒ…å«è¯¥é¡¹ç›®é›†çš„äº¤æ˜“çš„æ¯”ä¾‹ã€‚ â€¢ ç½®ä¿¡åº¦ï¼šåœ¨ {X} å­˜åœ¨çš„æƒ…å†µä¸‹ {Y} å‘ç”Ÿçš„æ¦‚ç‡ã€‚ â€¢ æå‡åº¦ï¼šç½®ä¿¡åº¦ä¸ {Y} åŸºçº¿å‘ç”Ÿæ¦‚ç‡çš„æ¯”å€¼ã€‚ {% asset_image R_week7_schemas.png %}\n","date":"2024-03-30T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek7-managing-sustainable-competitive-advantage-lecture-ii/","title":"R[week7] Managing Sustainable Competitive Advantage lecture II"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\nå‡è®¾ä¸€å®¶å…¬å¸æ­£åœ¨å¼€å‘ä¸€æ¬¾æ–°ç³»åˆ—çš„å¹³æ¿ç”µè„‘ï¼Œå¹¶è¯•å›¾ç¡®å®šå¹³æ¿ç”µè„‘çš„å°ºå¯¸åº”è¯¥æœ‰å¤šå¤§ï¼Œä»¥åŠåº”è¯¥å…·æœ‰ä½•ç§ç±»å‹çš„å­˜å‚¨å’Œå†…å­˜ã€‚ ä¸ºäº†æ”¯æŒè¿™ä¸ªå†³å®šï¼Œäº†è§£å®¢æˆ·å¯¹è¿™äº›ä¸åŒç‰¹å¾çš„ä»·å€¼ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚\nå®¢æˆ·å–œæ¬¢è¿˜æ˜¯ä¸å–œæ¬¢å¤§å±å¹•å°ºå¯¸ï¼Ÿ å¦‚æœä»–ä»¬å–œæ¬¢ï¼Œä»–ä»¬æ„¿æ„ä¸ºæ›´å¤§å°ºå¯¸çš„å±å¹•æ”¯ä»˜å¤šå°‘æ›´å¤šçš„è´¹ç”¨ï¼Ÿ æ˜¯å¦æœ‰ä¸€äº›å®¢æˆ·ç¾¤ä½“æ¯”å…¶ä»–å®¢æˆ·æ›´å–œæ¬¢å¤§å±å¹•ï¼Ÿ 1. Choice-Based Conjoint Analysis Data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026gt; cbc.df\u0026lt;-read.csv(\u0026#34;Data_Conjoint_Choice.csv\u0026#34;, stringsAsFactors = TRUE) \u0026gt; str(cbc.df) \u0026#39;data.frame\u0026#39;:\t6165 obs. of 10 variables: $ ConsumerId : int 1 1 1 1 1 1 1 1 1 1 ... $ ChoiceSetId : int 1 1 1 2 2 2 3 3 3 4 ... $ AlternativeIdInSet: int 1 2 3 1 2 3 1 2 3 1 ... $ Choice : int 1 0 0 1 0 0 0 0 1 1 ... $ Brand : Factor w/ 5 levels \u0026#34;Galaxy\u0026#34;,\u0026#34;iPad\u0026#34;,..: 2 5 3 2 5 4 5 3 1 2 ... $ Size : Factor w/ 4 levels \u0026#34;sz10inch\u0026#34;,\u0026#34;sz7inch\u0026#34;,..: 2 1 4 3 1 2 3 4 1 4 ... $ Storage : Factor w/ 4 levels \u0026#34;st128gb\u0026#34;,\u0026#34;st16gb\u0026#34;,..: 3 4 2 3 1 4 4 2 1 2 ... $ Ram : Factor w/ 3 levels \u0026#34;r1gb\u0026#34;,\u0026#34;r2gb\u0026#34;,..: 3 2 2 1 3 1 1 3 2 3 ... $ Battery : Factor w/ 3 levels \u0026#34;b7h\u0026#34;,\u0026#34;b8h\u0026#34;,\u0026#34;b9h\u0026#34;: 1 3 2 2 1 3 1 3 3 1 ... $ Price : int 499 399 499 399 299 199 199 399 499 299 ... \u0026gt; head(cbc.df) ConsumerId ChoiceSetId AlternativeIdInSet Choice Brand Size Storage Ram Battery Price 1 1 1 1 1 iPad sz7inch st32gb r4gb b7h 499 2 1 1 2 0 Surface sz10inch st64gb r2gb b9h 399 3 1 1 3 0 Kindle sz9inch st16gb r2gb b8h 499 4 1 2 1 1 iPad sz8inch st32gb r1gb b8h 399 5 1 2 2 0 Surface sz10inch st128gb r4gb b7h 299 6 1 2 3 0 Nexus sz7inch st64gb r1gb b9h 199 cbc.df ä¸­çš„å‰ä¸‰è¡Œæè¿°äº†å¯¹å—è®¿è€…1æå‡ºçš„ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚é€‰æ‹©åˆ—æ˜¾ç¤ºè¯¥å—è®¿è€…é€‰æ‹©äº†ç¬¬ä¸€ä¸ªå¤‡é€‰æ–¹æ¡ˆã€‚ ConsumerId è¡¨ç¤ºå›ç­”è¿™ä¸ªé—®é¢˜çš„å—è®¿è€…ã€‚ ChoiceSetId è¡¨ç¤ºè¿™å‰ä¸‰è¡Œæ˜¯ç¬¬ä¸€ä¸ªé—®é¢˜çš„é…ç½®æ–‡ä»¶ã€‚ChoiceSetId ç¼–å· 1:15 æ˜¯ä¸ºå—è®¿è€…1ï¼Œç„¶å 15:30 æ˜¯ä¸ºå—è®¿è€…2ï¼Œä¾æ­¤ç±»æ¨ã€‚ AlternativeIdInSet è¡¨ç¤ºç¬¬ä¸€è¡Œæ˜¯å¤‡é€‰æ–¹æ¡ˆ1ï¼Œç¬¬äºŒè¡Œæ˜¯å¤‡é€‰æ–¹æ¡ˆ2ï¼Œç¬¬ä¸‰è¡Œæ˜¯å¤‡é€‰æ–¹æ¡ˆ3ã€‚ Choice è¡¨ç¤ºå—è®¿è€…é€‰æ‹©äº†å“ªä¸ªå¤‡é€‰æ–¹æ¡ˆï¼›å¯¹äºæ¯ä¸ªé€‰æ‹©é—®é¢˜ä¸­è¢«æŒ‡å®šä¸ºé¦–é€‰å¤‡é€‰æ–¹æ¡ˆçš„é…ç½®æ–‡ä»¶ï¼Œå®ƒçš„å€¼ä¸º1ã€‚ ç°åœ¨é‡è¦çš„æ˜¯ä¼°è®¡ä¸€ä¸ªå®Œæ•´çš„é€‰æ‹©æ¨¡å‹ã€‚ä»»ä½•å»ºæ¨¡çš„ç¬¬ä¸€æ­¥æ˜¯ä½¿ç”¨åŸºæœ¬æè¿°æ€§ç»Ÿè®¡äº†è§£æ•°æ®ã€‚æˆ‘ä»¬ä»æ‘˜è¦å¼€å§‹:\n1 2 3 4 5 6 7 8 \u0026gt; summary(cbc.df) ConsumerId ChoiceSetId AlternativeIdInSet Choice Brand Size Storage Ram Battery Price Min. : 1 Min. : 1 Min. :1 Min. :0.0000 Galaxy :1263 sz10inch:1371 st128gb:1376 r1gb:2192 b7h:1918 Min. :169.0 1st Qu.: 35 1st Qu.: 514 1st Qu.:1 1st Qu.:0.0000 iPad :1538 sz7inch :1767 st16gb :1370 r2gb:2055 b8h:2055 1st Qu.:199.0 Median : 69 Median :1028 Median :2 Median :0.0000 Kindle :1119 sz8inch :1520 st32gb :1774 r4gb:1918 b9h:2192 Median :299.0 Mean : 69 Mean :1028 Mean :2 Mean :0.3333 Nexus :1104 sz9inch :1507 st64gb :1645 Mean :307.5 3rd Qu.:103 3rd Qu.:1542 3rd Qu.:3 3rd Qu.:1.0000 Surface:1141 3rd Qu.:399.0 Max. :137 Max. :2055 Max. :3 Max. :1.0000 Max. :499.0 æˆ‘ä»¬çœ‹åˆ°æ¯ä¸ªå±æ€§æ°´å¹³åœ¨é—®é¢˜ä¸­å‡ºç°äº†å¤šå°‘æ¬¡ã€‚æ€»ç»“é€‰æ‹©æ•°æ®çš„ä¸€ä¸ªæ›´å…·ä¿¡æ¯é‡çš„æ–¹å¼æ˜¯è®¡ç®—é€‰æ‹©è®¡æ•°ï¼Œè¿™æ˜¯å—è®¿è€…åœ¨æ¯ä¸ªç‰¹å¾æ°´å¹³ä¸Šé€‰æ‹©å¤‡é€‰æ–¹æ¡ˆçš„æ¬¡æ•°çš„äº¤å‰è¡¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ xtabs() è½»æ¾åœ°å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚\n1 2 3 4 \u0026gt; xtabs(Choice~Price, data=cbc.df) Price 169 199 299 399 499 688 472 329 365 201 è¡¨æ ¼çš„è¡Œè¡¨ç¤ºé€‰æ‹©ï¼ˆChoiceï¼‰ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé€‰æ‹©æ˜¯ä¸€ä¸ªäºŒå…ƒå˜é‡ï¼ˆ1 æˆ– 0ï¼‰ã€‚ è¡¨æ ¼çš„åˆ—è¡¨ç¤ºä»·æ ¼ï¼ˆPriceï¼‰ï¼Œåˆ—ä¸­çš„æ•°å€¼è¡¨ç¤ºè¯¥ä»·æ ¼ä¸‹è¢«é€‰æ‹©çš„æ¬¡æ•°ã€‚ å…·ä½“åˆ°ç»“æœçš„è§£é‡Šå¦‚ä¸‹ï¼š åœ¨ä»·æ ¼ä¸º 169 çš„æƒ…å†µä¸‹ï¼Œè¢«é€‰æ‹©äº† 688 æ¬¡ã€‚\nåœ¨ä»·æ ¼ä¸º 199 çš„æƒ…å†µä¸‹ï¼Œè¢«é€‰æ‹©äº† 472 æ¬¡ã€‚\nåœ¨ä»·æ ¼ä¸º 299 çš„æƒ…å†µä¸‹ï¼Œè¢«é€‰æ‹©äº† 329 æ¬¡ã€‚\nåœ¨ä»·æ ¼ä¸º 399 çš„æƒ…å†µä¸‹ï¼Œè¢«é€‰æ‹©äº† 365 æ¬¡ã€‚\nåœ¨ä»·æ ¼ä¸º 499 çš„æƒ…å†µä¸‹ï¼Œè¢«é€‰æ‹©äº† 201 æ¬¡ã€‚\nå—è®¿è€…æ›´ç»å¸¸é€‰æ‹©å”®ä»·ä¸º Â£169 çš„å¹³æ¿ç”µè„‘ï¼Œè€Œä¸æ˜¯å”®ä»·ä¸º Â£299 æˆ– Â£499 çš„å¹³æ¿ç”µè„‘ã€‚\nå¦‚æœæˆ‘ä»¬è®¡ç®—å°ºå¯¸å±æ€§çš„è®¡æ•°ï¼Œæˆ‘ä»¬ä¼šå‘ç°é€‰æ‹©åœ¨ 7 è‹±å¯¸ã€8 è‹±å¯¸å’Œ 10 è‹±å¯¸ä¹‹é—´æ›´åŠ å¹³è¡¡ï¼Œè€Œåœ¨ 9 è‹±å¯¸ä¸Šé€‰æ‹©æ›´å¤šã€‚\nxtabs()\nç”¨äºåˆ›å»ºäº¤å‰è¡¨ï¼ˆContingency Tableï¼‰çš„å‡½æ•°ã€‚äº¤å‰è¡¨æ˜¯ä¸€ç§ç”¨äºå±•ç¤ºä¸¤ä¸ªæˆ–å¤šä¸ªåˆ†ç±»å˜é‡ä¹‹é—´å…³ç³»çš„è¡¨æ ¼ï¼Œé€šå¸¸æ˜¾ç¤ºäº†æ¯ä¸ªç»„åˆçš„é¢‘æ•°æˆ–é¢‘ç‡ã€‚\n1 2 3 4 \u0026gt; xtabs(Choice~Size, data=cbc.df) Size sz10inch sz7inch sz8inch sz9inch 475 535 472 573 åœ¨ä¼°è®¡é€‰æ‹©æ¨¡å‹ä¹‹å‰ï¼Œå§‹ç»ˆé¼“åŠ±ä¸ºæ¯ä¸ªå±æ€§è®¡ç®—é€‰æ‹©è®¡æ•°ã€‚\n2. Prepare the data æˆ‘ä»¬ç°åœ¨å¯ä»¥ä¼°è®¡æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé€‰æ‹©æ¨¡å‹äº†ã€‚é€šè¿‡æ‹Ÿåˆé€‰æ‹©æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç²¾ç¡®åœ°æµ‹é‡æ¯ä¸ªå±æ€§ä¸å—è®¿è€…é€‰æ‹©çš„å…³è”ç¨‹åº¦ã€‚ æˆ‘ä»¬ä½¿ç”¨ mlogit åŒ…ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨ install.packages() å®‰è£…ã€‚mlogit ä¼°è®¡æœ€åŸºæœ¬å’Œå¸¸ç”¨çš„é€‰æ‹©æ¨¡å‹ï¼Œå³å¤šé¡¹é€»è¾‘å›å½’æ¨¡å‹ã€‚\n2.1 Define reference levels - used when estimating model 1 2 3 4 5 cbc.df$Brand \u0026lt;- relevel(cbc.df$Brand, ref = \u0026#34;Nexus\u0026#34;) cbc.df$Size \u0026lt;- relevel(cbc.df$Size, ref = \u0026#34;sz7inch\u0026#34;) cbc.df$Storage \u0026lt;- relevel(cbc.df$Storage, ref = \u0026#34;st16gb\u0026#34;) cbc.df$Ram \u0026lt;- relevel(cbc.df$Ram, ref = \u0026#34;r1gb\u0026#34;) cbc.df$Battery \u0026lt;- relevel(cbc.df$Battery, ref = \u0026#34;b7h\u0026#34;) 2.2 Define data format mlogit è¦æ±‚é€‰æ‹©æ•°æ®å…·æœ‰ç‰¹å®šçš„æ•°æ®æ ¼å¼ã€‚æˆ‘ä»¬ä½¿ç”¨ dfidx åŒ…ä¸­çš„ dfidx å‡½æ•°æ¥æ•´ç†æ ¼å¼ã€‚\nchoice å‚æ•°æŒ‡ç¤ºåŒ…å«å“åº”æ•°æ®çš„åˆ—ã€‚åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œchoice = â€œChoiceâ€ã€‚ idx å‚æ•°æŒ‡ç¤ºå¤‡é€‰æ–¹æ¡ˆçš„ç»“æ„ã€‚åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªç´¢å¼•è¡¨ç¤ºé€‰æ‹©é›†å’Œæ¶ˆè´¹è€…çš„åˆ—ï¼Œç¬¬äºŒä¸ªç´¢å¼•è¡¨ç¤ºæ¯ä¸ªé€‰æ‹©é›†ä¸­å¤‡é€‰æ–¹æ¡ˆçš„åˆ—ã€‚ 1 cbc.mlogit \u0026lt;- dfidx(cbc.df, choice=\u0026#34;Choice\u0026#34;, idx=list(c(\u0026#34;ChoiceSetId\u0026#34;, \u0026#34;ConsumerId\u0026#34;), \u0026#34;AlternativeIdInSet\u0026#34;)) 3 Multinomial conjoint model estimation with mlogit() å½“æˆ‘ä»¬è¿è¡Œæ¨¡å‹æ—¶ï¼Œå®ƒä¼šé€‰æ‹©æ¯ä¸ªç¦»æ•£å±æ€§çš„å‚è€ƒæ°´å¹³ã€‚å‚è€ƒæ°´å¹³çš„æ•ˆç”¨è¢«å½’ä¸€åŒ–ä¸ºé›¶ã€‚æˆ‘ä»¬åœ¨æ•°æ®åŠ è½½é˜¶æ®µä¸ºæ¯ä¸ªç¦»æ•£å±æ€§æŒ‡å®šäº†ä¸€ä¸ªå‚è€ƒæ°´å¹³ã€‚è¿™äº›å‚è€ƒæ°´å¹³æ˜¯ Nexusã€7 è‹±å¯¸å±å¹•ã€16GB ç¡¬ç›˜ã€1GB å†…å­˜ã€7 å°æ—¶ç”µæ± ã€‚æˆ‘ä»¬å°†ä»·æ ¼è§†ä¸ºè¿ç»­å˜é‡ï¼Œå› æ­¤ä¸éœ€è¦æŒ‡å®šå‚è€ƒæ°´å¹³ã€‚\nè¯¥æ¨¡å‹å‡å®šæ²¡æœ‰è¯¯å·®é¡¹çš„å¤‡é€‰æ–¹æ¡ˆ j çš„æ•ˆç”¨å¦‚ä¸‹æ‰€ç¤ºã€‚\n$$ V_j = \\beta_{11}[ \\text{Brand} = \\text{Galaxy}] + \\beta_{12}[ \\text{Brand} = \\text{iPad}] + \\beta_{13}[ \\text{Brand} = \\text{Kindle}] + \\beta_{14}[ \\text{Brand} = \\text{Surface}] + \\beta_{21}[ \\text{Screen} = \\text{10inch}] + \\beta_{22}[ \\text{Screen} = \\text{9inch}] + \\beta_{23}[ \\text{Screen} = \\text{8inch}] + \\beta_{31}[ \\text{Storage} = \\text{128gb}] + \\beta_{32}[ \\text{Storage} = \\text{64gb}] + \\beta_{33}[ \\text{Storage} = \\text{32gb}] + \\beta_{41}[ \\text{RAM} = \\text{4gb}] + \\beta_{42}[ \\text{RAM} = \\text{2gb}] + \\beta_{51}[ \\text{Battery} = \\text{9h}] + \\beta_{52}[ \\text{Battery} = \\text{8h}] + \\beta_6 \\text{Price} $$å…¶ä¸­ï¼Œ$ U_j = V_j + error $ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰ 15 ä¸ªå‚æ•° $ \\beta $ éœ€è¦ä¼°è®¡ã€‚\nå‡è®¾ç‹¬ç«‹çš„æå€¼è¯¯å·®åˆ†å¸ƒï¼Œæ¶ˆè´¹è€…ä»¥æ¦‚ç‡ä»ä¸‰ä¸ªå¤‡é€‰æ–¹æ¡ˆä¸­é€‰æ‹©å¤‡é€‰æ–¹æ¡ˆ jã€‚\n$$ p_j = \\frac{\\exp(V_j)}{\\sum_{k=1}^{3} \\exp(V_k)}, \\quad \\text{for } j \\in \\{1,2,3\\} $$æ˜¾ç„¶ï¼Œ$ p_1 + p_2 + p_3 = 1 $ æˆ‘ä»¬å®é™…ä¼°è®¡æ¨¡å‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026gt; model\u0026lt;-mlogit(Choice ~ 0+Brand+Size+Storage+Ram+Battery+Price, data=cbc.mlogit) \u0026gt; kable(summary(model)$CoefTable) | | Estimate| Std. Error| z-value| Pr(\u0026gt;\u0026amp;#124;z\u0026amp;#124;)| |:--------------|----------:|----------:|----------:|------------------:| |BrandGalaxy | 0.3378857| 0.0925056| 3.652596| 0.0002596| |BrandiPad | 0.9780287| 0.0937336| 10.434136| 0.0000000| |BrandKindle | 0.2630105| 0.0996254| 2.639995| 0.0082907| |BrandSurface | 0.1450365| 0.0938521| 1.545373| 0.1222560| |Sizesz10inch | 0.3240632| 0.0841953| 3.848949| 0.0001186| |Sizesz8inch | 0.1890775| 0.0829232| 2.280151| 0.0225987| |Sizesz9inch | 0.4355415| 0.0808408| 5.387644| 0.0000001| |Storagest128gb | 0.5897703| 0.0870533| 6.774822| 0.0000000| |Storagest32gb | 0.2168719| 0.0829213| 2.615395| 0.0089124| |Storagest64gb | 0.5782183| 0.0808259| 7.153877| 0.0000000| |Ramr2gb | 0.3189348| 0.0672579| 4.741970| 0.0000021| |Ramr4gb | 0.6357438| 0.0645225| 9.853053| 0.0000000| |Batteryb8h | 0.1299599| 0.0651501| 1.994777| 0.0460672| |Batteryb9h | 0.1253824| 0.0650588| 1.927216| 0.0539528| |Price | -0.0050888| 0.0002752| -18.488626| 0.0000000| 3.1 Meaning of parameters åœ¨ä¼°è®¡åï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ¯ä¸ªç¦»æ•£å±æ€§çš„æ¯ä¸ªæ°´å¹³ï¼ˆé™¤äº†å‚è€ƒæ°´å¹³ï¼‰çš„ç³»æ•°ä¼°è®¡ã€‚è¿™æ ·çš„ç³»æ•°æ•è·äº†ä¸å‚è€ƒç›¸æ¯”å±æ€§æ°´å¹³çš„ç›¸å¯¹æ•ˆç”¨æˆ–éƒ¨åˆ†ä»·å€¼ã€‚ä¾‹å¦‚ï¼Œåœ¨å“ç‰Œå±æ€§çš„æƒ…å†µä¸‹ï¼Œå“ç‰ŒiPadç³»æ•°ç»™å‡ºäº†iPadç›¸å¯¹äºNexusï¼ˆå‚è€ƒå“ç‰Œï¼‰çš„å“ç‰Œç›¸å¯¹æ•ˆç”¨çš„ä¼°è®¡ã€‚\næ­£å·å‘Šè¯‰æˆ‘ä»¬ï¼Œå¹³å‡è€Œè¨€ï¼Œå®¢æˆ·æ›´å–œæ¬¢iPadè€Œä¸æ˜¯Nexusï¼Œå› ä¸ºè¾ƒå¤§çš„ä¼°è®¡è¡¨ç¤ºæ›´å¼ºçš„åå¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®¢æˆ·éå¸¸å–œæ¬¢64GBå­˜å‚¨ï¼ˆç›¸å¯¹äºåŸºæœ¬æ°´å¹³ï¼Œå³16GBï¼‰ã€‚è¿™äº›å‚æ•°ä¼°è®¡å€¼æ˜¯åœ¨logitåˆ»åº¦ä¸Šçš„ã€‚\nåœ¨è¿ç»­ä»·æ ¼çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå•ä¸€çš„ç³»æ•°ï¼Œå®ƒæ•æ‰åˆ°å½“ä»·æ ¼å¢åŠ ä¸€å•ä½ï¼ˆ$1ï¼‰æ—¶å¤‡é€‰æ–¹æ¡ˆçš„æ•ˆç”¨å¦‚ä½•å˜åŒ–ï¼ŒåŒæ—¶ä¿æŒå¤‡é€‰æ–¹æ¡ˆçš„æ‰€æœ‰å…¶ä»–ç‰¹å¾ä¸å˜ã€‚\n3.2 Model fit æœ‰äººå¯èƒ½ä¼šæƒ³çŸ¥é“åå¥½æ˜¯å¦ä»…å—å“ç‰Œæ•ˆåº”é©±åŠ¨ã€‚æˆ‘ä»¬å¯ä»¥ä¼°è®¡ä¸€ä¸ªåªæœ‰å“ç‰Œä½œä¸ºé¢„æµ‹å˜é‡çš„æ¨¡å‹ã€‚\n1 \u0026gt; model.constraint \u0026lt;-mlogit(Choice ~ 0+Brand, data = cbc.mlogit) mlogit() ç”¨äºæ‹Ÿåˆå¤šé¡¹ Logit æ¨¡å‹ã€‚å¤šé¡¹ Logit æ¨¡å‹æ˜¯ä¸€ç§ç”¨äºå¤„ç†å¤šåˆ†ç±»é—®é¢˜çš„ç»Ÿè®¡æ¨¡å‹ï¼Œé€šå¸¸ç”¨äºè§£é‡Šå’Œé¢„æµ‹ä¸ªä½“é€‰æ‹©ä¸åŒç±»åˆ«çš„æ¦‚ç‡ã€‚\nç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ lrtest æ¥æ¯”è¾ƒè¿™ä¸¤ä¸ªæ¨¡å‹ã€‚\n1 2 3 4 5 6 7 8 9 10 \u0026gt; lrtest(model, model.constraint) Likelihood ratio test Model 1: Choice ~ 0 + Brand + Size + Storage + Ram + Battery + Price Model 2: Choice ~ 0 + Brand #Df LogLik Df Chisq Pr(\u0026gt;Chisq) 1 15 -1938.9 2 4 -2218.0 -11 558.29 \u0026lt; 2.2e-16 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 lrtest() ç”¨äºè¿›è¡Œä¸¤ä¸ªçº¿æ€§å›å½’æ¨¡å‹ä¹‹é—´çš„ Likelihood Ratio Testï¼ˆä¼¼ç„¶æ¯”æ£€éªŒï¼‰ã€‚Likelihood Ratio Test ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå…·æœ‰ä¸åŒå¤æ‚åº¦çš„æ¨¡å‹æ˜¯å¦åœ¨è§£é‡Šæ•°æ®æ–¹é¢æœ‰æ˜¾è‘—çš„å·®å¼‚ã€‚\n4. Interpreting Conjoint Analysis Findings é€šå¸¸å¾ˆéš¾ç›´æ¥è§£é‡Šé€‰æ‹©æ¨¡å‹çš„éƒ¨åˆ†æ•ˆç”¨ä¼°è®¡ã€‚ç³»æ•°å¤„äºä¸€ä¸ªä¸ç†Ÿæ‚‰çš„å°ºåº¦ä¸Šï¼ˆå³logï¼‰ï¼Œå®ƒä»¬è¡¡é‡äº†å„ä¸ªæ°´å¹³çš„ç›¸å¯¹åå¥½ï¼Œè¿™ä½¿å¾—å®ƒä»¬å¾ˆéš¾ç†è§£ã€‚å› æ­¤ï¼Œå¤§å¤šæ•°é€‰æ‹©æ¨¡å‹åå¥½ä¸“æ³¨äºä½¿ç”¨æ¨¡å‹è¿›è¡Œé€‰æ‹©ä»½é¢é¢„æµ‹æˆ–è®¡ç®—æ¯ä¸ªå±æ€§çš„æ”¯ä»˜æ„æ„¿ï¼Œè€Œä¸æ˜¯å‘ˆç°ç³»æ•°ã€‚\n4.1 Predicted Market Share æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä¼°è®¡çš„å‚æ•°æ¥é¢„æµ‹æ•°æ®ä¸­ä¸åŒå¤‡é€‰æ–¹æ¡ˆçš„é€‰æ‹©æ¦‚ç‡ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ‰“å°å‡ºæ•°æ®ä¸­å‰å…­ä¸ªé€‰æ‹©é›†çš„é¢„æµ‹ã€‚\n1 2 3 4 5 6 7 8 9 10 \u0026gt; kable(head(predict(model,cbc.mlogit))) | 1| 2| 3| |---------:|---------:|---------:| | 0.3717263| 0.4405521| 0.1877216| | 0.2367797| 0.4718620| 0.2913583| | 0.4760867| 0.2974319| 0.2264814| | 0.3730366| 0.4456505| 0.1813129| | 0.3984632| 0.1618560| 0.4396807| | 0.3791075| 0.2506170| 0.3702755| ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æµ‹é‡æ•´ä¸ªæ•°æ®é›†ä¸­é¢„æµ‹çš„å‡†ç¡®æ€§ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026gt; predicted_alternative \u0026lt;- apply(predict(model,cbc.mlogit),1,which.max) \u0026gt; selected_alternative \u0026lt;- cbc.mlogit$AlternativeIdInSet[cbc.mlogit$Choice\u0026gt;0] \u0026gt; confusionMatrix(table(predicted_alternative,selected_alternative),positive = \u0026#34;1\u0026#34;) Confusion Matrix and Statistics selected_alternative predicted_alternative 1 2 3 1 362 158 130 2 164 449 149 3 136 160 347 Overall Statistics Accuracy : 0.5635 95% CI : (0.5417, 0.5851) No Information Rate : 0.3732 P-Value [Acc \u0026gt; NIR] : \u0026lt;2e-16 Kappa : 0.343 Mcnemar\u0026#39;s Test P-Value : 0.8875 Statistics by Class: Class: 1 Class: 2 Class: 3 Sensitivity 0.5468 0.5854 0.5543 Specificity 0.7933 0.7570 0.7929 Pos Pred Value 0.5569 0.5892 0.5397 Neg Pred Value 0.7865 0.7541 0.8024 Prevalence 0.3221 0.3732 0.3046 Detection Rate 0.1762 0.2185 0.1689 Detection Prevalence 0.3163 0.3708 0.3129 Balanced Accuracy 0.6700 0.6712 0.6736 è¯·æ³¨æ„ï¼Œå¦‚æœé¢„æµ‹æ˜¯éšæœºçš„ï¼Œå‡†ç¡®ç‡å°†ä¸º33.3%ï¼ˆå¯¹äºä¸‰ä¸ªå¤‡é€‰æ–¹æ¡ˆï¼‰ã€‚æˆ‘ä»¬çš„ç®€å•æ¨¡å‹æ¯”è¿™è¦å¥½å¾—å¤šï¼Œå°½ç®¡å®ƒå¹¶ä¸å®Œç¾ã€‚\n4.2 Conjoint simulator ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨æ¨¡å‹å‚æ•°åœºæ™¯æ¥é¢„æµ‹åœ¨å‡è®¾å¸‚åœºæ¡ä»¶ä¸‹ä»»æ„ä¸€ç»„äº§å“çš„å¸‚åœºä»½é¢ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026gt; predict.share \u0026lt;- function(model, d) { + temp \u0026lt;- model.matrix(update(model$formula, 0 ~ .), data = d)[,-1] # generate dummy matri + u \u0026lt;- temp%*% .... [TRUNCATED] \u0026gt; # hypothetical base market structure with 4 alternatives in the market \u0026gt; d.base \u0026lt;- cbc.df[c(44,34,33,40),c(\u0026#34;Brand\u0026#34;,\u0026#34;Size\u0026#34;,\u0026#34;Storage\u0026#34;,\u0026#34;Ram\u0026#34;, \u0026#34;Battery\u0026#34; .... [TRUNCATED] \u0026gt; d.base \u0026lt;- cbind(d.base,as.vector(predict.share(model,d.base))) \u0026gt; colnames(d.base)[7] \u0026lt;- \u0026#34;Predicted.Share\u0026#34; \u0026gt; rownames(d.base) \u0026lt;- c() \u0026gt; kable(d.base) |Brand |Size |Storage |Ram |Battery | Price| Predicted.Share| |:-------|:--------|:-------|:----|:-------|-----:|---------------:| |iPad |sz7inch |st64gb |r2gb |b8h | 399| 0.3423928| |Galaxy |sz10inch |st32gb |r2gb |b7h | 299| 0.2540301| |Surface |sz10inch |st64gb |r1gb |b7h | 399| 0.1313854| |Kindle |sz7inch |st32gb |r1gb |b9h | 169| 0.2721917| 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026gt; # hypothetical market structure after Galaxy gets a RAM upgrade \u0026gt; d.new \u0026lt;- d.base \u0026gt; d.new[2, \u0026#39;Ram\u0026#39;] \u0026lt;- \u0026#34;r4gb\u0026#34; \u0026gt; d.new$Predicted.Share \u0026lt;- as.vector(predict.share(model,d.new)) \u0026gt; kable(d.new) |Brand |Size |Storage |Ram |Battery | Price| Predicted.Share| |:-------|:--------|:-------|:----|:-------|-----:|---------------:| |iPad |sz7inch |st64gb |r2gb |b8h | 399| 0.3127768| |Galaxy |sz10inch |st32gb |r4gb |b7h | 299| 0.3185544| |Surface |sz10inch |st64gb |r1gb |b7h | 399| 0.1200209| |Kindle |sz7inch |st32gb |r1gb |b9h | 169| 0.2486479| 4.3 Willingness to pay éå¸¸é‡è¦çš„æ˜¯ï¼Œä½¿ç”¨å‚æ•°ä¼°è®¡ï¼Œæˆ‘ä»¬é€šè¿‡é™¤ä»¥è¯¥å±æ€§çš„ç³»æ•°æ¥ä¸ºæ‰€é€‰å±æ€§æ°´å¹³ä¼°è®¡ï¼Œæ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä¼°è®¡ä»·æ ¼çš„å˜åŒ–å°†å¯¼è‡´ç”±äºé—®é¢˜å±æ€§æ°´å¹³å˜åŒ–è€Œå¼•èµ·çš„æ•ˆç”¨å˜åŒ–çš„ç­‰ä»·ç‰©ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å‘ç°ï¼Œæ™®é€šæ¶ˆè´¹è€…åœ¨é€‰æ‹©æ˜¯å¦è´­ä¹° Galaxy å’Œæ”¯ä»˜é¢å¤– $125.8 ä¹‹é—´å¤„äºä¸­ç«‹çŠ¶æ€ï¼Œæˆ–è€…è´­ä¹° iPadã€‚æ¢å¥è¯è¯´ï¼Œæ™®é€šæ¶ˆè´¹è€…æ„¿æ„æ”¯ä»˜é«˜è¾¾ $125.8 æ¥è·å– iPad è€Œä¸æ˜¯ Nexusï¼ŒåŒæ—¶ä¿æŒæ‰€æœ‰å…¶ä»–ç‰¹å¾ä¸å˜ã€‚\n4.3.1 What is the brand value of iPad relative to Galaxy? å“ç‰Œèµ„äº§ - ä» Galaxy å‡çº§åˆ° iPad çš„ç¾å…ƒä»·å€¼\n1 2 3 \u0026gt; (coef(model)[\u0026#34;BrandiPad\u0026#34;]-coef(model)[\u0026#34;BrandGalaxy\u0026#34;]) / (-coef(model)[\u0026#34;Price\u0026#34;]) BrandiPad 125.7944 coef()\næå–æ¨¡å‹ç³»æ•°çš„å‡½æ•°ï¼Œå¯ä»¥ç”¨äºæå–çº¿æ€§å›å½’ã€é€»è¾‘å›å½’ã€å¤šé¡¹å¼å›å½’ç­‰æ¨¡å‹çš„ç³»æ•°ã€‚\n4.3.2 Willingness to Pay for an Attribute Upgrade ä» 1GB å‡çº§åˆ° 4GB RAM çš„ç¾å…ƒä»·å€¼ï¼ˆ1GB æ˜¯å‚è€ƒæ°´å¹³ã€‚å› æ­¤å…¶ç³»æ•°ä¸º0ï¼‰ã€‚\n1 2 3 \u0026gt; coef(model)[\u0026#34;Sizesz9inch\u0026#34;] / (-coef(model)[\u0026#34;Price\u0026#34;]) Sizesz9inch 85.5882 5. Code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 library(\u0026#34;xtable\u0026#34;) # processing of regression output library(\u0026#34;knitr\u0026#34;) # used for report compilation and table display library(\u0026#34;ggplot2\u0026#34;) # very popular plotting library ggplot2 library(\u0026#34;mlogit\u0026#34;) # multinomial logit library(\u0026#34;caret\u0026#34;) # ConfusionMatrix # è·å–å½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• file_dir \u0026lt;- dirname(parent.frame(2)$ofile) print(file_dir) # å°†å·¥ä½œç›®å½•è®¾ç½®ä¸ºå½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• setwd(file_dir) cbc.df\u0026lt;-read.csv(\u0026#34;Data_Conjoint_Choice.csv\u0026#34;, stringsAsFactors = TRUE) str(cbc.df) head(cbc.df) summary(cbc.df) xtabs(Choice~Price, data=cbc.df) xtabs(Choice~Size, data=cbc.df) cbc.df$Brand \u0026lt;- relevel(cbc.df$Brand, ref = \u0026#34;Nexus\u0026#34;) cbc.df$Size \u0026lt;- relevel(cbc.df$Size, ref = \u0026#34;sz7inch\u0026#34;) cbc.df$Storage \u0026lt;- relevel(cbc.df$Storage, ref = \u0026#34;st16gb\u0026#34;) cbc.df$Ram \u0026lt;- relevel(cbc.df$Ram, ref = \u0026#34;r1gb\u0026#34;) cbc.df$Battery \u0026lt;- relevel(cbc.df$Battery, ref = \u0026#34;b7h\u0026#34;) library(dfidx) #install if needed cbc.mlogit \u0026lt;- dfidx(cbc.df, choice=\u0026#34;Choice\u0026#34;, idx=list(c(\u0026#34;ChoiceSetId\u0026#34;, \u0026#34;ConsumerId\u0026#34;), \u0026#34;AlternativeIdInSet\u0026#34;)) model\u0026lt;-mlogit(Choice ~ 0+Brand+Size+Storage+Ram+Battery+Price, data=cbc.mlogit) kable(summary(model)$CoefTable) model.constraint \u0026lt;-mlogit(Choice ~ 0+Brand, data = cbc.mlogit) lrtest(model, model.constraint) kable(head(predict(model,cbc.mlogit))) predicted_alternative \u0026lt;- apply(predict(model,cbc.mlogit),1,which.max) selected_alternative \u0026lt;- cbc.mlogit$AlternativeIdInSet[cbc.mlogit$Choice\u0026gt;0] confusionMatrix(table(predicted_alternative,selected_alternative),positive = \u0026#34;1\u0026#34;) predict.share \u0026lt;- function(model, d) { temp \u0026lt;- model.matrix(update(model$formula, 0 ~ .), data = d)[,-1] # generate dummy matri u \u0026lt;- temp%*%model$coef[colnames(temp)] # calculate utilities; %*% is matrix multiplicati probs \u0026lt;- t(exp(u)/sum(exp(u))) # calculate probabilities colnames(probs) \u0026lt;- paste(\u0026#34;alternative\u0026#34;, colnames(probs)) return(probs) } # hypothetical base market structure with 4 alternatives in the market d.base \u0026lt;- cbc.df[c(44,34,33,40),c(\u0026#34;Brand\u0026#34;,\u0026#34;Size\u0026#34;,\u0026#34;Storage\u0026#34;,\u0026#34;Ram\u0026#34;, \u0026#34;Battery\u0026#34;,\u0026#34;Price\u0026#34;)] d.base \u0026lt;- cbind(d.base,as.vector(predict.share(model,d.base))) colnames(d.base)[7] \u0026lt;- \u0026#34;Predicted.Share\u0026#34; rownames(d.base) \u0026lt;- c() kable(d.base) # hypothetical market structure after Galaxy gets a RAM upgrade d.new \u0026lt;- d.base d.new[2, \u0026#39;Ram\u0026#39;] \u0026lt;- \u0026#34;r4gb\u0026#34; d.new$Predicted.Share \u0026lt;- as.vector(predict.share(model,d.new)) kable(d.new) (coef(model)[\u0026#34;BrandiPad\u0026#34;]-coef(model)[\u0026#34;BrandGalaxy\u0026#34;]) / (-coef(model)[\u0026#34;Price\u0026#34;]) coef(model)[\u0026#34;Sizesz9inch\u0026#34;] / (-coef(model)[\u0026#34;Price\u0026#34;]) ","date":"2024-03-29T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek6-managing-sustainable-competitive-advantage-code/","title":"R[week6] Managing Sustainable Competitive Advantage code"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\näº†è§£é€šè¿‡æä¾›åˆ›æ–°äº§å“æ¥ç®¡ç†å¯æŒç»­ç«äº‰ä¼˜åŠ¿ï¼ˆSCAï¼‰çš„é‡è¦æ€§ èƒ½å¤Ÿè¿›è¡Œå…±åŒåˆ†æä»¥è¯„ä¼°æ–°äº§å“/æœåŠ¡çš„å¼€å‘ 1. Innovation Offering åˆ›æ–°çš„æ–°äº§å“æœ‰åŠ©äºä¼ä¸šå»ºç«‹å’Œç»´æŒå¯æŒç»­ç«äº‰ä¼˜åŠ¿ï¼Œå¹¶é˜»ç¢å› ç«äº‰å¯¹æ‰‹ä¸æ–­å¯¹ä¼ä¸šçš„æˆåŠŸåšå‡ºååº”è€Œäº§ç”Ÿçš„ç«äº‰æ”»å‡»ï¼ˆMP#3ï¼‰ã€‚ æä¾›æ˜¯ä¸€ä¸ªæœ‰æ„å¹¿æ³›çš„æœ¯è¯­ï¼Œæ¶µç›–äº†ä¼ä¸šæä¾›çš„æ—¢æœ‰å½¢äº§å“åˆæœ‰æ— å½¢æœåŠ¡ã€‚ åˆ›æ–°æ˜¯â€œé€šè¿‡åˆ›é€ æ€§åœ°æ”¹å˜ä¸šåŠ¡çš„ä¸€ä¸ªæˆ–å¤šä¸ªç»´åº¦ï¼Œä¸ºå®¢æˆ·åˆ›é€ å®è´¨æ€§çš„æ–°ä»·å€¼â€ã€‚ åˆ›æ–°çš„å…³é”®æ–¹é¢ æ¯”äº§å“æˆ–æŠ€æœ¯åˆ›æ–°æ›´å¹¿æ³› å¿…é¡»ä¸ºå®¢æˆ·åˆ›é€ æ–°ä»·å€¼ æ¶‰åŠå¯¼è‡´å·®å¼‚åŒ–å’Œå¯æŒç»­ç«äº‰ä¼˜åŠ¿çš„å˜åŒ– æ˜Ÿå·´å…‹ã€æˆ´å°”å’ŒiPodåˆ›é€ äº†å¯æŒç»­ç«äº‰ä¼˜åŠ¿ã€‚ 1.1 Benefits of Innovation and Offeringâ€™s Equity åˆ›æ–°å’Œäº§å“ä»·å€¼çš„æƒç›Š\næä¾›çš„æƒç›ŠæŒ‡çš„æ˜¯äº§å“æˆ–æœåŠ¡æ€§èƒ½ä¸ºå®¢æˆ·æä¾›çš„æ ¸å¿ƒä»·å€¼ã€‚ é€šè¿‡å»ºç«‹æä¾›çš„æƒç›Šï¼Œä¸€ä¸ªåˆ›æ–°çš„å…¬å¸å¯ä»¥ä½¿ç«äº‰å¯¹æ‰‹æ›´éš¾ä¾µå…¥å…¶ä¸šåŠ¡ã€‚ æ–°çš„äº§å“å¾€å¾€ä¼šæ¿€åŠ±å®¢æˆ·ä»ç«äº‰å¯¹æ‰‹è½¬å‘åˆ›æ–°å…¬å¸ï¼Œä»¥è·å¾—æ–°äº§å“çš„ä½¿ç”¨æƒé™ã€‚ æ–°çš„äº§å“è¿˜å¯ä»¥å¸®åŠ©å…¬å¸è·å¾—æ–°å®¢æˆ·æˆ–è¿›å…¥æ–°å¸‚åœºï¼Œå°¤å…¶æ˜¯å½“å®ƒä»¬æä¾›ç±»ä¼¼æ€§èƒ½ä½†ä»·æ ¼æ›´ä½æ—¶ã€‚ æä¾›æ–°çš„åˆ›æ–°äº§å“å¾€å¾€ä¼šå¢å¼ºå…¬å¸çš„å“ç‰Œå½¢è±¡ï¼Œå³ä½¿å®¢æˆ·æ²¡æœ‰è´­ä¹°æ–°äº§å“ã€‚ 1.2 Stage-Gate Design Review Process for Effective Product Development é˜¶æ®µé—¨è®¾è®¡å®¡æŸ¥æµç¨‹ç”¨äºæœ‰æ•ˆçš„äº§å“å¼€å‘\nConcept and Definition\næ¦‚å¿µä¸å®šä¹‰é˜¶æ®µåŒ…æ‹¬å¯¹æ‰€æœ‰æ½œåœ¨æƒ³æ³•è¿›è¡Œåˆæ­¥ç­›é€‰ã€æ¦‚å¿µè¯„ä¼°ã€é¡¹ç›®å®šä¹‰å’Œå¯è¡Œæ€§è¯„ä¼°ã€‚ Design and Development\nè®¾è®¡ä¸å¼€å‘é˜¶æ®µåŒ…æ‹¬äº§å“å’Œæµç¨‹çš„è®¾è®¡ä¸å¼€å‘ã€‚è¿˜åŒ…æ‹¬è´¢åŠ¡å¯è¡Œæ€§è€ƒè™‘ï¼ŒåŒ…æ‹¬ä»·æ ¼ç‚¹å’Œå®¢æˆ·æ¥å—åº¦çš„æµ‹è¯•ã€‚ Validation and Production\néªŒè¯ä¸ç”Ÿäº§é˜¶æ®µåŒ…æ‹¬æŒç»­çš„å¸‚åœºæ¨å‡ºè§„åˆ’ã€äº§å“åˆ¶é€ å’Œæµç¨‹éªŒè¯ã€‚ä¹Ÿå¯èƒ½åŒ…æ‹¬æµ‹è¯•è¥é”€å’Œå¯åŠ¨è®¡åˆ’çš„è¯„ä¼°ã€‚ Final Audit\nå®¡è®¡é˜¶æ®µåŒ…æ‹¬æœ€ç»ˆäº§å“å’Œäº§å“è¯„ä¼°ã€‚é€šå¸¸è¿˜åŒ…æ‹¬å¯¹ä¸€äº›åæ€ 1.3 Research Approaches for Designing and Launching New Offerings è®¾è®¡å’Œæ¨å‡ºæ–°äº§å“çš„ç ”ç©¶æ–¹æ³•\nåœ¨å¼€å‘æ—©æœŸï¼Œå®šæ€§æŠ€æœ¯å¦‚è§‚å¯Ÿã€ç„¦ç‚¹å°ç»„å’Œå®¢æˆ·è®¿è°ˆéå¸¸æœ‰æ•ˆï¼›å®ƒä»¬èƒ½æ­ç¤ºä¸€äº›é‡è¦çš„æ–°éœ€æ±‚ï¼Œæˆ–è€…æ˜¯å…¬å¸ä¸çŸ¥é“çš„éœ€æ±‚ã€‚ ä¸ºäº†é¿å…æ–°äº§å“é«˜å¤±è´¥ç‡å¸¦æ¥çš„é£é™©ï¼Œå…¬å¸å¯ä»¥é‡‡ç”¨ä¸åŒçš„æŠ€æœ¯æ¥æå‡å†³ç­–æ°´å¹³ï¼Œé¿å…ä¸æˆåŠŸçš„æ¨å‡ºï¼Œå¦‚å…±åŒåˆ†æ 2. Choice-Based Conjoint Analysis 2.1 Product design task äº§å“å¯ä»¥è¢«çœ‹ä½œæ˜¯å±æ€§æ°´å¹³æˆ–ç‰¹å¾çš„æ†ç»‘ã€‚ äº§å“ç‰¹å¾ä¸ºæ¶ˆè´¹è€…æä¾›ä»·å€¼ {% asset_image week6_lec_1.png %}\næœ€ä½³è®¾è®¡æ¶‰åŠé€‰æ‹©äº§å“çš„å±æ€§æ°´å¹³ï¼Œä»¥æœ€å¤§åŒ–ç›®æ ‡ å…¸å‹ç›®æ ‡ å¸‚åœºä»½é¢ ç›ˆåˆ©èƒ½åŠ› æœ€ä½³è®¾è®¡æ˜¯åŸºäºå¯¹æ¶ˆè´¹è€…åå¥½çš„åˆ†æ 2.2 conjoint analysis å…±åŒåˆ†ææœ‰åŠ©äºä½¿æ–°äº§å“â€œæ›´â€æˆåŠŸ äº§å“ä¼˜åŠ¿æ¨åŠ¨è´¢åŠ¡æˆåŠŸ äº§å“è®¾è®¡éœ€è¦åšå‡ºæƒè¡¡å†³ç­–ï¼ˆä»·æ ¼ã€æ€§èƒ½ã€å°ºå¯¸ã€ä½ç½®ã€åŠŸèƒ½ç­‰ï¼‰ å…±åŒåˆ†ææ˜¯ä¸€ç§æ–¹æ³•ï¼Œç”¨äº ç†è§£æ¶ˆè´¹è€…åœ¨äº§å“å±æ€§å’Œç‰¹å¾ä¹‹é—´åšå‡ºæƒè¡¡ æµ‹é‡äº§å“å±æ€§å¯¹æ¶ˆè´¹è€…çš„é‡è¦æ€§ ä½¿ç”¨å…±åŒåˆ†æï¼Œè¥é”€äººå‘˜å¯ä»¥å°†äº§å“è§†ä¸ºå±æ€§æ†ç»‘åŒ…ï¼Œç„¶åç¡®å®šå“ªç§å±æ€§ç»„åˆæœ€é€‚åˆæ»¡è¶³å®¢æˆ·çš„åå¥½ï¼Œä»è€Œè®¾è®¡å’Œå¼€å‘æ–°äº§å“ã€‚\nä½•æ—¶ä½¿ç”¨ï¼Ÿ è¯†åˆ«å®¢æˆ·ä¸ºæ–°äº§å“æ„¿æ„åšå‡ºçš„äº§å“å±æ€§æƒè¡¡ é¢„æµ‹æè®®çš„æ–°äº§å“ï¼ˆå³å±æ€§æ†ç»‘ï¼‰çš„å¸‚åœºä»½é¢å’Œå½±å“ ç¡®å®šå®¢æˆ·æ„¿æ„ä¸ºæ–°äº§å“æ”¯ä»˜çš„é‡‘é¢ 2.3 Conceptual Underpinnings of Conjoint Analysis å…±åŒåˆ†æçš„æ¦‚å¿µåŸºç¡€\næ¶ˆè´¹è€…åœ¨å±æ€§æ°´å¹³ä¸Šçš„æ•ˆç”¨ä¸åŒ äº§å“çš„æ•ˆç”¨ = å…¶å±æ€§æ°´å¹³çš„æ•ˆç”¨ä¹‹å’Œ $$ U = u(\\text{ProcessorLevel}) + u(\\text{RamLevel}) + u(\\text{HardDiskLevel}) + u(\\text{PriceLevel}) + \\ldots $$ å¯ä»¥é€šè¿‡æ¶ˆè´¹è€…å¯¹äº§å“é…ç½®çš„è¯„ä¼°æ¥æµ‹é‡æ•ˆç”¨ å¯ä»¥åˆ©ç”¨æ•ˆç”¨ä¼°è®¡æ¥é¢„æµ‹æ–°äº§å“çš„å¸‚åœºä»½é¢ 2.4 Conjoint Analysis Process è®¾è®¡ç ”ç©¶ é€‰æ‹©å±æ€§å’Œæ°´å¹³ï¼ˆèŒƒå›´å’Œæ•°é‡ï¼‰ åˆ¶å®šäº§å“é…ç½®ï¼ˆæœ€å¤šä¸è¶…è¿‡16ä¸ªï¼‰ æ”¶é›†å—è®¿è€…æ•°æ® è®¾è®¡æ•°æ®æ”¶é›†å·¥å…· è·å–å—è®¿è€…å¯¹é…ç½®çš„åå¥½æˆ–è¯„çº§ åˆ†ææ•°æ® è®¡ç®—éƒ¨åˆ†æ•ˆç”¨å€¼ è¯„ä¼°äº§å“è®¾è®¡é€‰é¡¹ è¯„ä¼°å¸‚åœºæ¨¡æ‹Ÿ è¯„ä¼°ä¸åŒçš„é€‰æ‹©è§„åˆ™ 2. Multinomial Logistic Regression (MNL) Model å¤šé¡¹é€»è¾‘å›å½’ï¼ˆMNLï¼‰æ¨¡å‹\næ¯ä¸ªå¤‡é€‰æ–¹æ¡ˆå¯¹æ¶ˆè´¹è€…éƒ½æœ‰ä¸€ä¸ªæ•ˆç”¨ æ•ˆç”¨æ˜¯äº§å“å±æ€§çš„å‡½æ•° å®ƒæ˜¯å¯¹å¹³æ¿ç”µè„‘å¸å¼•åŠ›çš„è¡¡é‡ åœ¨é¢å¯¹é€‰æ‹©é›†æ—¶ï¼Œæ¶ˆè´¹è€…é€‰æ‹©å…·æœ‰æœ€å¤§æ•ˆç”¨çš„å¹³æ¿ç”µè„‘ 2.1 Every Attribute Level has a Sub-Utility (Part-Worth) æ¯ä¸ªå±æ€§æ°´å¹³éƒ½æœ‰ä¸€ä¸ªå­æ•ˆç”¨ï¼ˆéƒ¨åˆ†æ•ˆç”¨ï¼‰\nä¾‹å¦‚ï¼Œæ¯ä¸ªå“ç‰Œçš„ä»·å€¼ä¸ºï¼š Galaxyï¼š$Î²_{Gal}$ iPadï¼š$Î²_{iPad}$ Kindleï¼š$Î²_{Kind}$ Surfaceï¼š$Î²_{Surf}$ Nexusï¼š0ï¼ˆå‚è€ƒå€¼ï¼‰ Î²å€¼æ˜¯ä»æ•°æ®ä¸­ä¼°è®¡çš„å‚æ•° $$ V_j = Î²_{iPad} \\times iPad_j + Î²_{Gal} \\times Gal_j + Î²_{Kind} \\times Kind_j + Î²_{Surf} \\times Surf_j\nÎ²_{10} \\times 10inch_j + Î²_{9} \\times 9inch_j + Î²_{8} \\times 8inch_j Î²_{128gbhd} \\times 128gbhd_j + Î²_{64gbhd} \\times 64gbhd_j + Î²_{32gbhd} \\times 32gbhd_j Î²_{ram4} \\times ram4gb_j + Î²_{ram2} \\times ram2gb_j Î²_{batt9} \\times batt9hrs_j + Î²_{batt8} \\times batt8hrs_j Î²_{price} \\times Price_j $$ {% asset_image week6_lec_2.png %}\nåœ¨ä½¿ç”¨ MNLï¼ˆMultinomial Logitï¼‰æ¨¡å‹è¿›è¡Œå‚æ•°ä¼°è®¡æ—¶ï¼Œé€šå¸¸ä¼šè·å¾—ä¸€äº›ç»Ÿè®¡é‡æ¥è¯„ä¼°æ¨¡å‹å‚æ•°çš„æ˜¾è‘—æ€§ã€‚åœ¨ç»Ÿè®¡è½¯ä»¶ä¸­ï¼Œä¾‹å¦‚ R æˆ– Python ä¸­ï¼Œè¿™äº›ç»Ÿè®¡é‡é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªï¼š\nEstimateï¼šè¡¨ç¤ºæ¨¡å‹å‚æ•°çš„ä¼°è®¡å€¼ã€‚å®ƒæ˜¯åœ¨æ¨¡å‹æ‹Ÿåˆè¿‡ç¨‹ä¸­è®¡ç®—å‡ºæ¥çš„å‚æ•°å€¼ï¼Œä»£è¡¨äº†æ¯ä¸ªè‡ªå˜é‡å¯¹å› å˜é‡çš„å½±å“ç¨‹åº¦ã€‚\nStd.Errorï¼šè¡¨ç¤ºæ¨¡å‹å‚æ•°ä¼°è®¡å€¼çš„æ ‡å‡†è¯¯å·®ã€‚æ ‡å‡†è¯¯å·®æ˜¯å¯¹æ¨¡å‹å‚æ•°ä¼°è®¡å€¼çš„ä¸ç¡®å®šæ€§è¿›è¡Œçš„ä¸€ä¸ªåº¦é‡ï¼Œå®ƒè¶Šå°è¡¨ç¤ºæ¨¡å‹å‚æ•°ä¼°è®¡å€¼è¶Šå¯é ã€‚\nt-valueï¼šè¡¨ç¤ºæ¨¡å‹å‚æ•°ä¼°è®¡å€¼ä¸é›¶çš„åå·®é™¤ä»¥æ ‡å‡†è¯¯å·®çš„ç»“æœï¼Œç§°ä¸º $t$ å€¼ã€‚$t$ å€¼ç”¨äºæ£€éªŒæ¨¡å‹å‚æ•°çš„æ˜¾è‘—æ€§ï¼Œå¦‚æœ $t$ å€¼çš„ç»å¯¹å€¼è¶Šå¤§ï¼Œè¡¨æ˜æ¨¡å‹å‚æ•°è¶Šæ˜¾è‘—ã€‚\nPr(\u0026gt;|t|)ï¼šè¡¨ç¤º $t$ å€¼å¯¹åº”çš„ $p$ å€¼ï¼Œå³æ£€éªŒæ¨¡å‹å‚æ•°çš„æ˜¾è‘—æ€§æ°´å¹³ã€‚$p$ å€¼æ˜¯åœ¨åŸå‡è®¾æˆç«‹çš„æƒ…å†µä¸‹è§‚å¯Ÿåˆ°çš„ $t$ å€¼æˆ–æ›´æç«¯æƒ…å†µçš„æ¦‚ç‡ã€‚å¦‚æœ $p$ å€¼å°äºé¢„å…ˆè®¾å®šçš„æ˜¾è‘—æ€§æ°´å¹³ï¼ˆä¾‹å¦‚ $0.05$ï¼‰ï¼Œåˆ™å¯ä»¥æ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºæ¨¡å‹å‚æ•°æ˜¯æ˜¾è‘—çš„ã€‚\n2.2 Tablet Conjoint (sub) Utilities (Î² Parameters Estimates) å¹³æ¿ç”µè„‘å…±åŒåˆ†ææ•ˆç”¨ï¼ˆÎ²å‚æ•°ä¼°è®¡ï¼‰\nå‚è€ƒæ°´å¹³ç”¨ç°è‰²æ ‡è®° {% asset_image week6_lec_3.png %}\nåœ¨é€‰æ‹©ä»»åŠ¡ç¤ºä¾‹ä¸­ï¼Œå¹³æ¿ç”µè„‘1å’Œ2çš„æ•ˆç”¨\n{% asset_image week6_lec_4.png %}\nChoice Probabilities $p_1 = \\frac{exp(V_1)}{exp(V_1) + exp(V_2) + exp(V_3)}$ $p_2 = \\frac{exp(V_2)}{exp(V_1) + exp(V_2) + exp(V_3)}$ $p_3 = \\frac{exp(V_3)}{exp(V_1) + exp(V_2) + exp(V_3)}$\n$0 \\leq p_i \\leq 1, \\forall i$\n$\\sigma_i p_i = 1$ or $p_1 + p_2 + p_3 = 1$\nPredicted Market Share å‡è®¾å¸‚åœºä¸Šæœ‰è¿™ä¸‰æ¬¾å¹³æ¿ç”µè„‘ï¼š {% asset_image week6_lec_5.png %}\nHit Rate: Choice Prediction Accuracy {% asset_image week6_lec_5.png %}\nConjoint Simulator 2GB RAM å‡çº§å¯¹ Galaxy å¸‚åœºä»½é¢çš„å½±å“: {% asset_image week6_lec_7.png %}\nWhat is the Brand Value of iPad Relative to Galaxy? ç›¸å¯¹äº Galaxyï¼ŒiPad çš„å“ç‰Œä»·å€¼æ˜¯å¤šå°‘ï¼Ÿ $$ Î²_iPad - Î²_Galaxy â‰ˆ 0.6401 $$$$ iPad çš„ä»·å€¼ = (Î²_iPad - Î²_Galaxy) / |Î²_Price| = 0.6401 * $196.54 = $125.80 $$ä¸€ä¸ªæ™®é€šæ¶ˆè´¹è€…åœ¨é€‰æ‹©è´­ä¹° Galaxy å¹³æ¿ç”µè„‘å†æ”¯ä»˜é¢å¤– $125.80 å’Œè´­ä¹° iPad ä¹‹é—´ä¼šæ„Ÿåˆ°æ— æ‰€è°“ã€‚\nç±»ä¼¼çš„æŠ€æœ¯ç»å¸¸åœ¨è¯‰è®¼ä¸­ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼Œä¸‰æ˜Ÿå¯¹è‹¹æœï¼šhttps://www.greenbook.org/mr/market-research-methodology/how-apple-samsung-and-conjoint-came-together/\nWillingness to Pay for an Attribute Upgrade å¯¹å±æ€§å‡çº§çš„æ”¯ä»˜æ„æ„¿:\n$$ Î²_{4gbRAM} â‰ˆ 0.6357 $$ $$ Î²_{1gbRAM} = 0 $$4GB Ram Value = 0.6357*$196.54= $124.94\nä¸€ä¸ªæ™®é€šæ¶ˆè´¹è€…æ„¿æ„æ”¯ä»˜é«˜è¾¾ $124.94 ä» 1gb å‡çº§åˆ° 4gb RAMï¼Œä¿æŒæ‰€æœ‰å…¶ä»–å±æ€§ä¸å˜ã€‚\n3. Takeaways å…±åŒåˆ†æå¯ä»¥é€šè¿‡å¸®åŠ©ç®¡ç†è€…æ ¹æ®æ¶ˆè´¹è€…å¯¹å„ç§äº§å“å±æ€§çš„ä»·å€¼æ¥å®šä¹‰æœ€ä½³äº§å“ï¼Œä»è€Œä¿ƒè¿›æ–°äº§å“çš„è®¾è®¡å’Œæ¨å‡ºã€‚ å…±åŒåˆ†ææ˜¯è¡Œä¸šä¸­æœ€æµè¡Œçš„è¥é”€åˆ†æå·¥å…· å…±åŒåˆ†ææœ‰ä¸åŒç±»å‹ é€‰æ‹©å‹å…±åŒåˆ†æ â€’ åœ¨è¡Œä¸šä¸­ä½¿ç”¨æœ€å¹¿æ³›ï¼Œå¯ä»¥çº³å…¥æ— é€‰æ‹©æ›¿ä»£æ–¹æ¡ˆä»¥æ›´å¥½åœ°æ•æ‰éœ€æ±‚ ","date":"2024-03-28T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek6-managing-sustainable-competitive-advantage-lecture/","title":"R[week6] Managing Sustainable Competitive Advantage lecture"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\n1. Customer Lifetime Value (CLV) 1.1 The Marketing Problem æˆ‘ä»¬éœ€è¦äº†è§£æˆ‘ä»¬çš„å®¢æˆ·ï¼Œæˆ–è€…çŸ¥é“æŸä¸ªç‰¹å®šçš„å®¢æˆ·æ˜¯å¦ä¸æˆ‘ä»¬çš„ç»„ç»‡ç›¸å…³ã€‚å› æ­¤ï¼š\næˆ‘ä»¬æƒ³çŸ¥é“å®¢æˆ·ä¸ºç»„ç»‡åˆ›é€ äº†å¤šå°‘ä»·å€¼ã€‚ æˆ‘ä»¬æƒ³çŸ¥é“ç”Ÿæˆçš„ä»·å€¼å°†å¦‚ä½•æ¼”å˜ã€‚ æˆ‘ä»¬å¸Œæœ›æ ¹æ®ä»·å€¼å¯¹å®¢æˆ·è¿›è¡Œç»†åˆ†ã€‚ è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹ä¸åŒçš„å®¢æˆ·ç¾¤ä½“æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚ 1.2 Customer Lifetime Value (CLV) è§£å†³ä¸šåŠ¡é—®é¢˜çš„æŠ€æœ¯æ˜¯ç†è§£å®¢æˆ·çš„ä»·å€¼ã€‚æˆ‘ä»¬æœ‰å¾ˆå¤šæ–¹æ³•æ¥äº†è§£å®¢æˆ·çš„ä»·å€¼ã€‚å…¶ä¸­æœ€ç›¸å…³çš„ä¹‹ä¸€æ˜¯å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ï¼ˆCLVï¼‰ã€‚\nåˆ›å»ºä¸€ä¸ªä»…åŒ…å«å›ºå®šé…¸åº¦å¤§äºæˆ–ç­‰äº8çš„è‘¡è„é…’çš„æ•°æ®æ¡†ã€‚ åˆ›å»ºä¸€ä¸ªä»…åŒ…å«å“è´¨ä¸º7çš„è‘¡è„é…’çš„æ•°æ®æ¡†ã€‚ åˆ›å»ºä¸€ä¸ªä»…åŒ…å«2åˆ—ï¼ˆpHå’Œå“è´¨ï¼‰çš„æ•°æ®æ¡†ã€‚ åˆ›å»ºä¸€ä¸ªä»…åŒ…å«2åˆ—ï¼ˆpHå’Œå“è´¨ï¼‰çš„æ•°æ®æ¡†ï¼Œå…¶ä¸­è‘¡è„é…’æŒ‰ç…§pHçš„å‡åºæ’åºã€‚ åˆ›å»ºä¸€ä¸ªä»…åŒ…å«2åˆ—ï¼ˆpHå’Œå“è´¨ï¼‰çš„æ•°æ®æ¡†ï¼Œå…¶ä¸­è‘¡è„é…’æŒ‰ç…§å“è´¨çš„é™åºæ’åºã€‚ åˆ›å»ºä¸€ä¸ªä»…åŒ…å«æ²¡æœ‰æŸ æª¬é…¸çš„è‘¡è„é…’çš„æ•°æ®æ¡†ï¼Œå¹¶æŒ‰ç…§å“è´¨çš„é™åºæ’åºã€‚ åˆ›å»ºä¸€ä¸ªçº¢è‘¡è„é…’æ•°æ®é›†çš„ç‰ˆæœ¬ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªé¢å¤–çš„åˆ—ï¼Œè¯¥åˆ—åŒ…å«é…’ç²¾å«é‡ä¹˜ä»¥å¯†åº¦ã€‚ åˆ›å»ºä¸€ä¸ªæ€»ç»“çº¢è‘¡è„é…’æ•°æ®é›†ä¸­æ¯ä¸ªå˜é‡çš„æ•°æ®æ¡†ã€‚CLV æ˜¯ä¼ä¸šä¸å®¢æˆ·æ•´ä¸ªå…³ç³»ä¸­è·å¾—çš„æ‰€æœ‰ä»·å€¼çš„é¢„æµ‹ã€‚æ‰€æœ‰å®¢æˆ·ç”Ÿæˆçš„ä»·å€¼ç§°ä¸ºå®¢æˆ·æƒç›Šï¼Œç”¨äºè¯„ä¼°å…¬å¸ã€‚\nä¸»è¦æ¦‚å¿µã€‚å½±å“å®¢æˆ·ä»·å€¼çš„å› ç´ å¾ˆå¤šï¼Œåœ¨ CLV è®¡ç®—ä¸­å¿…é¡»è€ƒè™‘å…¶ä¸­çš„ä¸€äº›ï¼š\nç°é‡‘æµï¼šå®¢æˆ·ä¸ç»„ç»‡çš„å…³ç³»æœŸé—´å¯¹ç»„ç»‡äº§ç”Ÿçš„æ”¶å…¥çš„å‡€ç°å€¼ã€‚ ç”Ÿå‘½å‘¨æœŸï¼šä¸ç»„ç»‡çš„å…³ç³»æŒç»­çš„æ—¶é—´ã€‚ ç»´æŠ¤æˆæœ¬ï¼šç¡®ä¿æ¯ä½å®¢æˆ·çš„æ”¶å…¥æµé‡çš„ç›¸å…³æˆæœ¬ã€‚ é£é™©æˆæœ¬ï¼šä¸å®¢æˆ·ç›¸å…³çš„é£é™©ã€‚ è·å–æˆæœ¬ï¼šè·å–æ–°å®¢æˆ·æ‰€éœ€çš„æˆæœ¬å’ŒåŠªåŠ›ã€‚ ä¿ç•™æˆæœ¬ï¼šä¿ç•™æ–°å®¢æˆ·æ‰€éœ€çš„æˆæœ¬å’ŒåŠªåŠ›ã€‚ æ¨èä»·å€¼ï¼šå®¢æˆ·åœ¨å…¶å½±å“èŒƒå›´å†…å¯¹å…¬å¸æ”¶å…¥çš„æ¨èå½±å“ã€‚ ç»†åˆ†æ”¹è¿›ï¼šå®¢æˆ·ä¿¡æ¯åœ¨æ”¹è¿›å®¢æˆ·ç»†åˆ†æ¨¡å‹ä¸­çš„ä»·å€¼ã€‚ CLV\n$$ CLV = \\sum_{t=0}^{T} \\frac{(p_t - c_t) r_t}{(1 + i)^t} - AC $$å…¶ä¸­ï¼Œ\n$p_t$ è¡¨ç¤ºæ—¶é—´ $t$ å®¢æˆ·æ”¯ä»˜çš„ä»·æ ¼ï¼Œ $c_t$ è¡¨ç¤ºæ—¶é—´ $t$ çš„å®¢æˆ·æœåŠ¡ç›´æ¥æˆæœ¬ï¼Œ $i$ è¡¨ç¤ºå…¬å¸çš„æŠ˜ç°ç‡æˆ–èµ„é‡‘æˆæœ¬ã€‚ $r$ è¡¨ç¤ºå®¢æˆ·åœ¨æ—¶é—´ $t$ è¿”å›è´­ä¹°æˆ–ä¿æŒæ´»è·ƒçš„æ¦‚ç‡ï¼Œ $AC$ è¡¨ç¤ºè·å–å®¢æˆ·çš„æˆæœ¬ï¼Œ $T$ è¡¨ç¤ºç”¨äºä¼°ç®—å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ï¼ˆCLVï¼‰çš„æ—¶é—´èŒƒå›´ã€‚ A simplification\nè®©æˆ‘ä»¬å‡è®¾ $ p $ å’Œ $ c $ æ˜¯å¸¸æ•°å€¼ï¼Œè€Œ $ r $ æ˜¯éšæ—¶é—´é€’å‡çš„å‡½æ•°ï¼Œé‚£ä¹ˆå…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š\n$$ CLV = \\sum_{t=0}^{\\infty} \\frac{m \\cdot r^t}{(1 + i)^t} - AC = m \\cdot \\left( \\frac{r}{1 + i - r} \\right) - AC $$å…¶ä¸­ï¼Œ$ p - c = m $ è¡¨ç¤ºåˆ©æ¶¦ï¼Œ$ r $ è¡¨ç¤ºä¿ç•™ç‡ï¼Œ$ i $ è¡¨ç¤ºæŠ˜ç°ç‡ã€‚\næœ€ç»ˆè€ƒè™‘ï¼š\né€šå¸¸ï¼Œæˆ‘ä»¬ä¼šä¸ºå…¬å¼ä¸­çš„æ¯ä¸ªæ¦‚å¿µæ‹¥æœ‰ä¸€ä¸ªæ•°æ®é›†ã€‚ æˆ‘ä»¬éœ€è¦ä¼°è®¡å…¶ä½™çš„æ•°å€¼ã€‚ å› æ­¤ï¼Œé‡è¦çš„æ˜¯è¦è®°ä½ï¼šæˆ‘ä»¬å¯¹æœªæ¥çš„é¢„æµ‹èƒ½åŠ›å—åˆ°æˆ‘ä»¬è¿‡å»ç»éªŒçš„é™åˆ¶ã€‚ 1.3 Implementation Process and Use Cases å®æ–½è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š\nè®¨è®º CLV æ˜¯å¦é€‚åˆä½œä¸ºæˆ‘ä»¬ä¸šåŠ¡çš„æŒ‡æ ‡ è¾¨åˆ«å’Œç†è§£æ•°æ®æºå’Œå…ƒæ•°æ® æå–ã€è½¬æ¢ã€æ¸…ç†å’ŒåŠ è½½æ•°æ® é€‰æ‹© CLV æ–¹æ³• åˆ†æç»“æœå¹¶è°ƒæ•´å‚æ•° å±•ç¤ºå¹¶è§£é‡Šç»“æœ CLVå¸¸ç”¨äºï¼š\nåŸºäºCLVåˆ¶å®šå¸‚åœºæˆ˜ç•¥ åŸºäºCLVçš„å®¢æˆ·ç»†åˆ† è·¨æ®µè½è¿›è¡Œé¢„æµ‹å’Œå®¢æˆ·æ¼”å˜åˆ†æ åŸºäºCLVåˆ›å»ºä¸åŒçš„æ²Ÿé€šã€æœåŠ¡å’Œå¿ è¯šè®¡åˆ’ å”¤é†’â€œéæ´»è·ƒâ€å®¢æˆ· ä¼°ç®—å…¬å¸çš„ä»·å€¼ï¼ˆåœ¨æ”¶è´­æƒ…å†µä¸‹ï¼Œä¾‹å¦‚åˆåˆ›å…¬å¸ï¼‰ 1.4 ARPU/ARPA as CLV approximation å¹³å‡ç”¨æˆ·æ”¶å…¥ï¼ˆARPUï¼‰æˆ–å¹³å‡è´¦æˆ·æ”¶å…¥ï¼ˆARPAï¼‰å¯ç”¨äºè®¡ç®—å†å²CLVã€‚ è¿‡ç¨‹å¦‚ä¸‹ï¼š\nè®¡ç®—æ¯ä½å®¢æˆ·æ¯æœˆçš„å¹³å‡æ”¶å…¥ï¼ˆå³æ€»æ”¶å…¥/å®¢æˆ·åŠ å…¥çš„æœˆä»½æ•°ï¼‰ å°†å®ƒä»¬ç›¸åŠ  ä¹˜ä»¥12æˆ–24ä»¥è·å¾—ä¸€å¹´æˆ–ä¸¤å¹´çš„CLVã€‚ ç»ƒä¹ ï¼šå‡è®¾Josepå’ŒLauraæ˜¯æ‚¨å”¯ä¸€çš„å®¢æˆ·ï¼Œä»–ä»¬çš„è´­ä¹°æƒ…å†µå¦‚ä¸‹ï¼š\nCustomer Name Purchase Date Amount Josep Jan 1, 2023 $150 Josep May 1, 2023 $45 Josep May 15, 2023 $50 Laura Jun 15, 2023 $100 Laura Jun 15, 2023 $75 Laura Jun 30, 2023 $100 å‡è®¾ä»Šå¤©æ˜¯2023å¹´7æœˆ1æ—¥ã€‚\nJosepçš„å¹³å‡æ¯æœˆæ”¶å…¥æ˜¯ (150 + 50 + 100) / 6 = 50ï¼Œ\nLauraçš„å¹³å‡æ¯æœˆæ”¶å…¥æ˜¯ (45 + 75 + 100) / 2 = 110ã€‚\nå°†è¿™ä¸¤ä¸ªæ•°å­—ç›¸åŠ ï¼Œå¾—åˆ°æ¯ä½å®¢æˆ·çš„å¹³å‡æœˆæ”¶å…¥ä¸º 160 / 2 = 80ã€‚è¦æ‰¾åˆ°12ä¸ªæœˆæˆ–24ä¸ªæœˆçš„CLVï¼Œå°†è¯¥æ•°å­—ä¹˜ä»¥12æˆ–24ã€‚\nARPUæ–¹æ³•çš„å¥½å¤„æ˜¯è®¡ç®—ç®€å•ï¼Œä½†å®ƒæ²¡æœ‰è€ƒè™‘åˆ°å®¢æˆ·è¡Œä¸ºçš„å˜åŒ–ã€‚\n1.5 How to implement CLV in R 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; CLV.df \u0026lt;- read_excel(\u0026#34;Data_CLV.xlsx\u0026#34;, sheet = \u0026#34;Ex2\u0026#34;) \u0026gt; CLV.df # A tibble: 7 Ã— 6 t active p c i r \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; 1 1 200 375 20 0.01 0.91 2 2 165 375 20 0.01 0.825 3 3 150 375 20 0.01 0.75 4 4 176 375 20 0.01 0.88 5 5 178 375 20 0.01 0.89 6 6 150 375 20 0.01 0.75 7 7 135 375 20 0.01 0.675 tï¼šè¡¨ç¤ºæ—¶é—´ï¼Œé€šå¸¸è¡¨ç¤ºè§‚å¯ŸæœŸçš„é•¿åº¦æˆ–é¢„æµ‹çš„æ—¶é—´æ®µã€‚å®ƒå¯ä»¥ä»¥å¤©ã€æœˆã€å¹´ç­‰ä¸ºå•ä½ã€‚\nactiveï¼šè¡¨ç¤ºå®¢æˆ·æ˜¯å¦æ´»è·ƒã€‚åœ¨ CLV æ¨¡å‹ä¸­ï¼Œé€šå¸¸å°†å®¢æˆ·åˆ†ä¸ºæ´»è·ƒå®¢æˆ·å’Œä¸æ´»è·ƒå®¢æˆ·ï¼Œæ ¹æ®ä»–ä»¬åœ¨è§‚å¯ŸæœŸå†…çš„è´­ä¹°è¡Œä¸ºæˆ–è€…æ´»åŠ¨é¢‘ç‡è¿›è¡Œåˆ†ç±»ã€‚\npï¼šè¡¨ç¤ºå®¢æˆ·è´­ä¹°æˆ–è€…æ¶ˆè´¹çš„æ€»é¢ã€‚å®ƒæ˜¯å®¢æˆ·åœ¨è§‚å¯ŸæœŸå†…è´­ä¹°çš„äº§å“æˆ–æœåŠ¡çš„æ€»é¢åº¦ï¼Œä¹Ÿç§°ä¸ºå®¢æˆ·ä»·å€¼ã€‚\ncï¼šè¡¨ç¤ºå®¢æˆ·è·å–æˆ–è€…ç•™å­˜çš„æˆæœ¬ã€‚è¿™åŒ…æ‹¬äº†è·å–æ–°å®¢æˆ·çš„è¥é”€æˆæœ¬ã€ç»´æŠ¤ç°æœ‰å®¢æˆ·çš„æˆæœ¬ä»¥åŠæœåŠ¡å®¢æˆ·çš„æˆæœ¬ç­‰ã€‚\niï¼šè¡¨ç¤ºæŠ˜ç°ç‡æˆ–è´´ç°ç‡ã€‚åœ¨ CLV æ¨¡å‹ä¸­ï¼Œé€šå¸¸ä½¿ç”¨æŠ˜ç°ç‡æ¥è€ƒè™‘æ—¶é—´ä»·å€¼çš„æ¦‚å¿µï¼Œå³æœªæ¥æ”¶å…¥çš„ç°å€¼ã€‚\nrï¼šè¡¨ç¤ºç•™å­˜ç‡ã€‚å®ƒæ˜¯æŒ‡å®¢æˆ·åœ¨ä¸€æ®µæ—¶é—´å†…ç»§ç»­è´­ä¹°äº§å“æˆ–æœåŠ¡çš„æ¦‚ç‡ï¼Œé€šå¸¸ä½œä¸ºå®¢æˆ·æµå¤±çš„ç›¸åæ¦‚ç‡ã€‚\n1.5.1 Exploratory Data Analysis 1 2 3 4 5 6 7 8 \u0026gt; summary(CLV.df) t active p c i r Min. :1.0 Min. :135.0 Min. :375 Min. :20 Min. :0.01 Min. :0.6750 1st Qu.:2.5 1st Qu.:150.0 1st Qu.:375 1st Qu.:20 1st Qu.:0.01 1st Qu.:0.7500 Median :4.0 Median :165.0 Median :375 Median :20 Median :0.01 Median :0.8250 Mean :4.0 Mean :164.9 Mean :375 Mean :20 Mean :0.01 Mean :0.8114 3rd Qu.:5.5 3rd Qu.:177.0 3rd Qu.:375 3rd Qu.:20 3rd Qu.:0.01 3rd Qu.:0.8850 Max. :7.0 Max. :200.0 Max. :375 Max. :20 Max. :0.01 Max. :0.9100 æ‘˜è¦æ˜¾ç¤ºä»·æ ¼å’Œæˆæœ¬æ˜¯æ’å®šçš„ã€‚æ´»è·ƒå®¢æˆ·çš„èŒƒå›´æ˜¯[135,200]ã€‚ä¿ç•™ç‡çš„èŒƒå›´æ˜¯[0.83,1.11]ã€‚\nå®¢æˆ·æ¼”å˜ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€æ¡æŠ˜çº¿å›¾æ¥äº†è§£å®¢æˆ·æ•°é‡çš„å˜åŒ–æƒ…å†µã€‚ ggplot() ç”¨äºæ„å»ºåˆå§‹ç»˜å›¾å¯¹è±¡ï¼Œå¹¶å‡ ä¹æ€»æ˜¯ç´§è·Ÿç€ + æ·»åŠ ç»„ä»¶åˆ°å›¾ä¸­ã€‚\nActive Customer Evolution\n1 2 3 ggplot(CLV.df, aes(x = t, y = active)) + geom_line() + ylab(\u0026#34;Customer\u0026#34;) + xlab(\u0026#34;Period\u0026#34;) + ggtitle(\u0026#34;Active Customer Evolution\u0026#34;) {% asset_image week5_code_1.png %}\nRetention Ratio Evolution\n1 2 ggplot(CLV.df, aes(x = t, y = r)) + geom_line() + ylab(\u0026#34;Customer\u0026#34;) + xlab(\u0026#34;Period\u0026#34;) + ggtitle(\u0026#34;Retention Ratio Evolution\u0026#34;) {% asset_image week5_code_2.png %}\né—®é¢˜ï¼šæˆ‘ä»¬è§‚å¯Ÿåˆ°äº†ä»€ä¹ˆï¼Ÿç”±äºä¸€äº›å˜é‡æ˜¯æ’å®šçš„ï¼ŒCLVåªå–å†³äºå®¢æˆ·æ•°é‡ã€‚å›¾è¡¨ä¸ä¹‹å‰çš„ç±»ä¼¼ã€‚\n1.5.2 Calculate CLV ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ï¼ˆå†å²ï¼‰CLVã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªæ—¶æœŸçš„CLVï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; CLV.df$CLV \u0026lt;- (CLV.df$p-CLV.df$c)*CLV.df$r^CLV.df$t/(1+CLV.df$i)^CLV.df$t \u0026gt; CLV.df # A tibble: 7 Ã— 7 t active p c i r CLV \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; 1 1 200 375 20 0.01 0.91 320. 2 2 165 375 20 0.01 0.825 237. 3 3 150 375 20 0.01 0.75 145. 4 4 176 375 20 0.01 0.88 205. 5 5 178 375 20 0.01 0.89 189. 6 6 150 375 20 0.01 0.75 59.5 7 7 135 375 20 0.01 0.675 21.1 CLVæ¼”å˜ã€‚ç°åœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå›¾è¡¨æ¥çœ‹çœ‹CLVçš„å˜åŒ–ï¼š\n1 ggplot(CLV.df, aes(x = t, y = CLV)) + geom_line() + ggtitle(\u0026#34;CLV evolution\u0026#34;) + ylab(\u0026#34;CLV\u0026#34;) + xlab(\u0026#34;Period\u0026#34;) CLV evolution\n{% asset_image week5_code_3.png %}\né—®é¢˜ï¼šæˆ‘ä»¬è§‚å¯Ÿåˆ°äº†ä»€ä¹ˆï¼Ÿç”±äºä¸€äº›å˜é‡æ˜¯æ’å®šçš„ï¼ŒCLVåªå–å†³äºå®¢æˆ·æ•°é‡ã€‚å›¾è¡¨ä¸ä¹‹å‰çš„ç±»ä¼¼ã€‚\n1 2 3 4 5 \u0026gt; CLV \u0026lt;- apply(CLV.df, 2, sum) \u0026gt; CLV[7] CLV 1175.932 é—®é¢˜ï¼šè¿™ä¸ªå€¼ä»£è¡¨ä»€ä¹ˆæ„æ€ï¼ŸCLVå€¼ä»£è¡¨äº†å®¢æˆ·çš„ç”Ÿå‘½å‘¨æœŸä»·å€¼ï¼Œå³å®¢æˆ·åœ¨å…¶ä¸å…¬å¸çš„æ•´ä¸ªå…³ç³»ä¸­ä¸ºå…¬å¸å¸¦æ¥çš„é¢„æœŸæ”¶ç›Šæ€»å’Œã€‚è¿™ä¸ªå€¼å¯ä»¥å¸®åŠ©å…¬å¸è¯„ä¼°å®¢æˆ·çš„é‡è¦æ€§ï¼Œå¹¶ä¸ºè¥é”€ç­–ç•¥å’Œèµ„æºåˆ†é…æä¾›æŒ‡å¯¼ã€‚\n1.6 Exercise: å¦‚æœä¿ç•™ç‡æ’å®šä¸º0.80ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ\nè§£å†³æ–¹æ¡ˆ é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªæ–°çš„åˆ—ï¼š\n1 CLV.df$CLV2 \u0026lt;- (CLV.df$p - CLV.df$c) * 0.8 / (1 + CLV.df$i)^(CLV.df$t - 1) ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å›¾è¡¨ï¼š\n1 ggplot(CLV.df, aes(x = t, y = CLV2)) + geom_line() + ylab(\u0026#34;CLV2\u0026#34;) + xlab(\u0026#34;Period\u0026#34;) + labs(title = \u0026#34;CLV 2 Evolution\u0026#34;) {% asset_image week5_code_4.png %}\næœ€åï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—CLVå€¼ï¼š\n1 2 3 4 5 6 7 8 9 \u0026gt; CLV \u0026lt;- apply(CLV.df, 2, sum) \u0026gt; CLV[7] CLV 1175.932 \u0026gt; CLV[8] CLV2 1929.915 CLV[7] ä»£è¡¨äº†æˆ‘ä»¬åœ¨åˆ†æä¸­æ‰€è€ƒè™‘çš„æ—¶é—´æ®µå†…çš„ CLV å€¼ï¼Œé€šå¸¸è¡¨ç¤ºäº†ä¸€ä¸ªæ—¶é—´æ®µçš„ç»“æŸã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨åˆ†æä¸­è€ƒè™‘çš„æ˜¯è¿‡å»ä¸€å¹´çš„æ•°æ®ï¼Œåˆ™ CLV[7] å°±è¡¨ç¤ºäº†è¿‡å»ä¸€å¹´çš„å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ã€‚\nCLV[8] åˆ™ä»£è¡¨äº†åœ¨ CLV[7] æ—¶é—´æ®µä¹‹åçš„ CLV å€¼ï¼Œé€šå¸¸è¡¨ç¤ºäº†ä¸€ä¸ªæ–°çš„æ—¶é—´æ®µçš„å¼€å§‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦é¢„æµ‹æœªæ¥ä¸€å¹´çš„å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ï¼Œåˆ™ CLV[8] å°±è¡¨ç¤ºäº†æœªæ¥ä¸€å¹´çš„é¢„æœŸ CLV å€¼ã€‚\n2 Data Manipulation éœ€è¦å®‰è£…dplyråŒ…ã€‚è·å–dplyrçš„æœ€ç®€å•æ–¹æ³•æ˜¯å®‰è£…tidyverseï¼šinstall.packages(\u0026quot;tidyverse\u0026quot;)ã€‚ tidyverseæ˜¯ä¸€ç»„è®¾è®¡ç”¨äºæ•°æ®ç§‘å­¦çš„RåŒ…ã€‚æ‰€æœ‰çš„åŒ…éƒ½å…±äº«ä¸€ä¸ªåŸºç¡€è®¾è®¡ç†å¿µã€è¯­æ³•å’Œæ•°æ®ç»“æ„ã€‚æ ¸å¿ƒtidyverseåŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªï¼š\nggplot2æ˜¯ä¸€ä¸ªç”¨äºå£°æ˜æ€§åˆ›å»ºå›¾å½¢çš„ç³»ç»Ÿã€‚ dplyræä¾›æ•°æ®æ“ä½œçš„è¯­æ³•ï¼Œæä¾›ä¸€ç»„ä¸€è‡´çš„åŠ¨è¯ï¼Œè§£å†³æœ€å¸¸è§çš„æ•°æ®æ“ä½œæŒ‘æˆ˜ã€‚ tidyræä¾›äº†ä¸€ç»„å‡½æ•°ï¼Œå¸®åŠ©æ‚¨å°†æ•°æ®æ•´ç†æˆæ•´æ´çš„å½¢å¼ã€‚æ•´æ´çš„æ•°æ®æ˜¯å…·æœ‰ä¸€è‡´å½¢å¼çš„æ•°æ®ï¼šç®€è¨€ä¹‹ï¼Œæ¯ä¸ªå˜é‡éƒ½æ”¾åœ¨ä¸€åˆ—ä¸­ï¼Œæ¯åˆ—éƒ½æ˜¯ä¸€ä¸ªå˜é‡ã€‚ readræä¾›äº†ä¸€ç§å¿«é€Ÿå‹å¥½çš„æ–¹å¼æ¥è¯»å–çŸ©å½¢æ•°æ®ï¼ˆä¾‹å¦‚csvã€tsvå’Œfwfï¼‰ stringræä¾›äº†ä¸€ç»„è¿è´¯çš„å‡½æ•°ï¼Œæ—¨åœ¨ä½¿å¤„ç†å­—ç¬¦ä¸²å˜å¾—å°½å¯èƒ½ç®€å•ã€‚ forcatsæä¾›äº†ä¸€ç»„æœ‰ç”¨çš„å·¥å…·ï¼Œè§£å†³äº†å› å­ï¼ˆåˆ†ç±»å˜é‡ï¼‰çš„å¸¸è§é—®é¢˜ purr tibble æˆ–è€…ï¼Œåªå®‰è£…dplyrï¼šinstall.packages(\u0026quot;dplyr\u0026quot;, dependencies=TRUE)ã€‚Dependencies = TRUEå°†å®‰è£…æ­¤åŒ…æ‰€éœ€çš„ä¾èµ–é¡¹ã€‚\nè®©æˆ‘ä»¬åŠ è½½åŒ…å’Œæ•°æ®é›†ã€‚mtcarsæ•°æ®é›†éšdplyråŒ…ä¸€èµ·æä¾›ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›åŒ…æ¥æ¢ç´¢æ•°æ®ã€‚\nmtcars\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026gt; head(mtcars) mpg cyl disp hp drat wt qsec vs am gear Mazda RX4 21.0 6 160 110 3.90 2.620 16.46 0 1 4 Mazda RX4 Wag 21.0 6 160 110 3.90 2.875 17.02 0 1 4 Datsun 710 22.8 4 108 93 3.85 2.320 18.61 1 1 4 Hornet 4 Drive 21.4 6 258 110 3.08 3.215 19.44 1 0 3 Hornet Sportabout 18.7 8 360 175 3.15 3.440 17.02 0 0 3 Valiant 18.1 6 225 105 2.76 3.460 20.22 1 0 3 carb Mazda RX4 4 Mazda RX4 Wag 4 Datsun 710 1 Hornet 4 Drive 1 Hornet Sportabout 2 Valiant 1 \u0026gt; str(mtcars) \u0026#39;data.frame\u0026#39;:\t32 obs. of 11 variables: $ mpg : num 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ... $ cyl : num 6 6 4 6 8 6 8 4 4 6 ... $ disp: num 160 160 108 258 360 ... $ hp : num 110 110 93 110 175 105 245 62 95 123 ... $ drat: num 3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ... $ wt : num 2.62 2.88 2.32 3.21 3.44 ... $ qsec: num 16.5 17 18.6 19.4 17 ... $ vs : num 0 0 1 1 0 1 0 1 1 1 ... $ am : num 1 1 1 0 0 0 0 0 0 0 ... $ gear: num 4 4 4 3 3 3 3 4 4 4 ... $ carb: num 4 4 1 1 2 1 4 2 2 4 ... 2.1 Manipulate cases filter() å‡½æ•°æ ¹æ®å…¶å€¼é€‰æ‹©æ¡ˆä¾‹ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 \u0026gt; filter(mtcars, gear == 4) # è¿‡æ»¤å™¨å¯ä¸æ‰€æœ‰æ ‡å‡†é€»è¾‘è¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨ mpg cyl disp hp drat wt qsec vs am gear carb Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4 Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4 Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2 \u0026gt; filter(mtcars, gear == 3 | gear == 4) # å³ \u0026gt;ã€\u0026lt;ã€=\u0026gt;ã€\u0026lt;=ã€!=ã€== mpg cyl disp hp drat wt qsec vs am gear carb Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 Valiant 18.1 6 225.0 105 2.76 3.460 20.22 1 0 3 1 Duster 360 14.3 8 360.0 245 3.21 3.570 15.84 0 0 3 4 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4 Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4 Merc 450SE 16.4 8 275.8 180 3.07 4.070 17.40 0 0 3 3 Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3 Merc 450SLC 15.2 8 275.8 180 3.07 3.780 18.00 0 0 3 3 Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.250 17.98 0 0 3 4 Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4 Chrysler Imperial 14.7 8 440.0 230 3.23 5.345 17.42 0 0 3 4 Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1 Dodge Challenger 15.5 8 318.0 150 2.76 3.520 16.87 0 0 3 2 AMC Javelin 15.2 8 304.0 150 3.15 3.435 17.30 0 0 3 2 Camaro Z28 13.3 8 350.0 245 3.73 3.840 15.41 0 0 3 4 Pontiac Firebird 19.2 8 400.0 175 3.08 3.845 17.05 0 0 3 2 Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2 \u0026gt; filter(mtcars, mpg \u0026gt; 21) mpg cyl disp hp drat wt qsec vs am gear carb Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1 Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.70 0 1 5 2 Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.90 1 1 5 2 Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2 arrange() å‡½æ•°æŒ‰ç…§é€‰å®šåˆ—çš„å€¼å¯¹æ•°æ®æ¡†çš„è¡Œè¿›è¡Œæ’åºã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 \u0026gt; arrange(mtcars, gear) mpg cyl disp hp drat wt qsec vs am gear carb Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 Valiant 18.1 6 225.0 105 2.76 3.460 20.22 1 0 3 1 Duster 360 14.3 8 360.0 245 3.21 3.570 15.84 0 0 3 4 Merc 450SE 16.4 8 275.8 180 3.07 4.070 17.40 0 0 3 3 Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3 Merc 450SLC 15.2 8 275.8 180 3.07 3.780 18.00 0 0 3 3 Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.250 17.98 0 0 3 4 Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4 Chrysler Imperial 14.7 8 440.0 230 3.23 5.345 17.42 0 0 3 4 Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1 Dodge Challenger 15.5 8 318.0 150 2.76 3.520 16.87 0 0 3 2 AMC Javelin 15.2 8 304.0 150 3.15 3.435 17.30 0 0 3 2 Camaro Z28 13.3 8 350.0 245 3.73 3.840 15.41 0 0 3 4 Pontiac Firebird 19.2 8 400.0 175 3.08 3.845 17.05 0 0 3 2 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4 Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4 Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2 Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.70 0 1 5 2 Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.90 1 1 5 2 Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.50 0 1 5 4 Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.50 0 1 5 6 Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.60 0 1 5 8 \u0026gt; arrange(mtcars, gear, mpg) mpg cyl disp hp drat wt qsec vs am gear carb Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.250 17.98 0 0 3 4 Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4 Camaro Z28 13.3 8 350.0 245 3.73 3.840 15.41 0 0 3 4 Duster 360 14.3 8 360.0 245 3.21 3.570 15.84 0 0 3 4 Chrysler Imperial 14.7 8 440.0 230 3.23 5.345 17.42 0 0 3 4 Merc 450SLC 15.2 8 275.8 180 3.07 3.780 18.00 0 0 3 3 AMC Javelin 15.2 8 304.0 150 3.15 3.435 17.30 0 0 3 2 Dodge Challenger 15.5 8 318.0 150 2.76 3.520 16.87 0 0 3 2 Merc 450SE 16.4 8 275.8 180 3.07 4.070 17.40 0 0 3 3 Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3 Valiant 18.1 6 225.0 105 2.76 3.460 20.22 1 0 3 1 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 Pontiac Firebird 19.2 8 400.0 175 3.08 3.845 17.05 0 0 3 2 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1 Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4 Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.60 0 1 5 8 Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.50 0 1 5 4 Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.50 0 1 5 6 Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.70 0 1 5 2 Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.90 1 1 5 2 \u0026gt; arrange(mtcars, desc(mpg)) # desc ä»¥é™åºæ’åº mpg cyl disp hp drat wt qsec vs am gear carb Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.90 1 1 5 2 Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.70 0 1 5 2 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.50 0 1 5 6 Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4 Pontiac Firebird 19.2 8 400.0 175 3.08 3.845 17.05 0 0 3 2 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 Valiant 18.1 6 225.0 105 2.76 3.460 20.22 1 0 3 1 Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4 Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3 Merc 450SE 16.4 8 275.8 180 3.07 4.070 17.40 0 0 3 3 Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.50 0 1 5 4 Dodge Challenger 15.5 8 318.0 150 2.76 3.520 16.87 0 0 3 2 Merc 450SLC 15.2 8 275.8 180 3.07 3.780 18.00 0 0 3 3 AMC Javelin 15.2 8 304.0 150 3.15 3.435 17.30 0 0 3 2 Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.60 0 1 5 8 Chrysler Imperial 14.7 8 440.0 230 3.23 5.345 17.42 0 0 3 4 Duster 360 14.3 8 360.0 245 3.21 3.570 15.84 0 0 3 4 Camaro Z28 13.3 8 350.0 245 3.73 3.840 15.41 0 0 3 4 Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.250 17.98 0 0 3 4 Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4 2.2 Manipulate variables select() å‡½æ•°æ ¹æ®å˜é‡åé€‰æ‹©å˜é‡ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 \u0026gt; select(mtcars, gear, mpg, hp) gear mpg hp Mazda RX4 4 21.0 110 Mazda RX4 Wag 4 21.0 110 Datsun 710 4 22.8 93 Hornet 4 Drive 3 21.4 110 Hornet Sportabout 3 18.7 175 Valiant 3 18.1 105 Duster 360 3 14.3 245 Merc 240D 4 24.4 62 Merc 230 4 22.8 95 Merc 280 4 19.2 123 Merc 280C 4 17.8 123 Merc 450SE 3 16.4 180 Merc 450SL 3 17.3 180 Merc 450SLC 3 15.2 180 Cadillac Fleetwood 3 10.4 205 Lincoln Continental 3 10.4 215 Chrysler Imperial 3 14.7 230 Fiat 128 4 32.4 66 Honda Civic 4 30.4 52 Toyota Corolla 4 33.9 65 Toyota Corona 3 21.5 97 Dodge Challenger 3 15.5 150 AMC Javelin 3 15.2 150 Camaro Z28 3 13.3 245 Pontiac Firebird 3 19.2 175 Fiat X1-9 4 27.3 66 Porsche 914-2 5 26.0 91 Lotus Europa 5 30.4 113 Ford Pantera L 5 15.8 264 Ferrari Dino 5 19.7 175 Maserati Bora 5 15.0 335 Volvo 142E 4 21.4 109 \u0026gt; select(mtcars, -drat) # - ç¬¦å·è¡¨ç¤ºåˆ é™¤å˜é‡/åˆ— mpg cyl disp hp wt qsec vs am gear carb Mazda RX4 21.0 6 160.0 110 2.620 16.46 0 1 4 4 Mazda RX4 Wag 21.0 6 160.0 110 2.875 17.02 0 1 4 4 Datsun 710 22.8 4 108.0 93 2.320 18.61 1 1 4 1 Hornet 4 Drive 21.4 6 258.0 110 3.215 19.44 1 0 3 1 Hornet Sportabout 18.7 8 360.0 175 3.440 17.02 0 0 3 2 Valiant 18.1 6 225.0 105 3.460 20.22 1 0 3 1 Duster 360 14.3 8 360.0 245 3.570 15.84 0 0 3 4 Merc 240D 24.4 4 146.7 62 3.190 20.00 1 0 4 2 Merc 230 22.8 4 140.8 95 3.150 22.90 1 0 4 2 Merc 280 19.2 6 167.6 123 3.440 18.30 1 0 4 4 Merc 280C 17.8 6 167.6 123 3.440 18.90 1 0 4 4 Merc 450SE 16.4 8 275.8 180 4.070 17.40 0 0 3 3 Merc 450SL 17.3 8 275.8 180 3.730 17.60 0 0 3 3 Merc 450SLC 15.2 8 275.8 180 3.780 18.00 0 0 3 3 Cadillac Fleetwood 10.4 8 472.0 205 5.250 17.98 0 0 3 4 Lincoln Continental 10.4 8 460.0 215 5.424 17.82 0 0 3 4 Chrysler Imperial 14.7 8 440.0 230 5.345 17.42 0 0 3 4 Fiat 128 32.4 4 78.7 66 2.200 19.47 1 1 4 1 Honda Civic 30.4 4 75.7 52 1.615 18.52 1 1 4 2 Toyota Corolla 33.9 4 71.1 65 1.835 19.90 1 1 4 1 Toyota Corona 21.5 4 120.1 97 2.465 20.01 1 0 3 1 Dodge Challenger 15.5 8 318.0 150 3.520 16.87 0 0 3 2 AMC Javelin 15.2 8 304.0 150 3.435 17.30 0 0 3 2 Camaro Z28 13.3 8 350.0 245 3.840 15.41 0 0 3 4 Pontiac Firebird 19.2 8 400.0 175 3.845 17.05 0 0 3 2 Fiat X1-9 27.3 4 79.0 66 1.935 18.90 1 1 4 1 Porsche 914-2 26.0 4 120.3 91 2.140 16.70 0 1 5 2 Lotus Europa 30.4 4 95.1 113 1.513 16.90 1 1 5 2 Ford Pantera L 15.8 8 351.0 264 3.170 14.50 0 1 5 4 Ferrari Dino 19.7 6 145.0 175 2.770 15.50 0 1 5 6 Maserati Bora 15.0 8 301.0 335 3.570 14.60 0 1 5 8 Volvo 142E 21.4 4 121.0 109 2.780 18.60 1 1 4 2 slice() å‡½æ•°æ ¹æ®è¡Œå·é€‰æ‹©ç‰¹å®šçš„è¡Œã€‚ 1 2 3 4 5 \u0026gt; slice(mtcars, 1:3) mpg cyl disp hp drat wt qsec vs am gear carb Mazda RX4 21.0 6 160 110 3.90 2.620 16.46 0 1 4 4 Mazda RX4 Wag 21.0 6 160 110 3.90 2.875 17.02 0 1 4 4 Datsun 710 22.8 4 108 93 3.85 2.320 18.61 1 1 4 1 sample_n() å’Œ sample_frac() å‡½æ•°é€‰æ‹©éšæœºè¡Œï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; sample_n(mtcars, 5) # é€‰æ‹©çš„è¡Œæ•° mpg cyl disp hp drat wt qsec vs am gear carb Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4 Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.50 0 1 5 6 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 \u0026gt; sample_frac(mtcars, .1) # é€‰æ‹©çš„è¡Œæ•°å æ€»è¡Œæ•°çš„æ¯”ä¾‹ mpg cyl disp hp drat wt qsec vs am gear carb Merc 230 22.8 4 140.8 95 3.92 3.150 22.9 1 0 4 2 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.0 1 0 4 2 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.9 1 1 4 1 mutate() å‡½æ•°æ·»åŠ æ–°å˜é‡ï¼Œè¿™äº›å˜é‡æ˜¯ç°æœ‰å˜é‡çš„å‡½æ•°ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 \u0026gt; mutate(mtcars, wt_mpg = wt * mpg) mpg cyl disp hp drat wt qsec vs am gear carb wt_mpg Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 55.0200 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 60.3750 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 52.8960 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 68.8010 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 64.3280 Valiant 18.1 6 225.0 105 2.76 3.460 20.22 1 0 3 1 62.6260 Duster 360 14.3 8 360.0 245 3.21 3.570 15.84 0 0 3 4 51.0510 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 77.8360 Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 71.8200 Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4 66.0480 Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4 61.2320 Merc 450SE 16.4 8 275.8 180 3.07 4.070 17.40 0 0 3 3 66.7480 Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3 64.5290 Merc 450SLC 15.2 8 275.8 180 3.07 3.780 18.00 0 0 3 3 57.4560 Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.250 17.98 0 0 3 4 54.6000 Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4 56.4096 Chrysler Imperial 14.7 8 440.0 230 3.23 5.345 17.42 0 0 3 4 78.5715 Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 71.2800 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 49.0960 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 62.2065 Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1 52.9975 Dodge Challenger 15.5 8 318.0 150 2.76 3.520 16.87 0 0 3 2 54.5600 AMC Javelin 15.2 8 304.0 150 3.15 3.435 17.30 0 0 3 2 52.2120 Camaro Z28 13.3 8 350.0 245 3.73 3.840 15.41 0 0 3 4 51.0720 Pontiac Firebird 19.2 8 400.0 175 3.08 3.845 17.05 0 0 3 2 73.8240 Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 52.8255 Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.70 0 1 5 2 55.6400 Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.90 1 1 5 2 45.9952 Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.50 0 1 5 4 50.0860 Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.50 0 1 5 6 54.5690 Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.60 0 1 5 8 53.5500 Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2 59.4920 \u0026gt; mutate(mtcars, mpg_mean = mean(mpg), mpg_diff_mean = mpg - mpg_mean) mpg cyl disp hp drat wt qsec vs am gear carb mpg_mean mpg_diff_mean Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 20.09062 0.909375 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 20.09062 0.909375 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 20.09062 2.709375 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 20.09062 1.309375 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 20.09062 -1.390625 Valiant 18.1 6 225.0 105 2.76 3.460 20.22 1 0 3 1 20.09062 -1.990625 Duster 360 14.3 8 360.0 245 3.21 3.570 15.84 0 0 3 4 20.09062 -5.790625 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 20.09062 4.309375 Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 20.09062 2.709375 Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4 20.09062 -0.890625 Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4 20.09062 -2.290625 Merc 450SE 16.4 8 275.8 180 3.07 4.070 17.40 0 0 3 3 20.09062 -3.690625 Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3 20.09062 -2.790625 Merc 450SLC 15.2 8 275.8 180 3.07 3.780 18.00 0 0 3 3 20.09062 -4.890625 Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.250 17.98 0 0 3 4 20.09062 -9.690625 Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4 20.09062 -9.690625 Chrysler Imperial 14.7 8 440.0 230 3.23 5.345 17.42 0 0 3 4 20.09062 -5.390625 Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 20.09062 12.309375 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 20.09062 10.309375 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 20.09062 13.809375 Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1 20.09062 1.409375 Dodge Challenger 15.5 8 318.0 150 2.76 3.520 16.87 0 0 3 2 20.09062 -4.590625 AMC Javelin 15.2 8 304.0 150 3.15 3.435 17.30 0 0 3 2 20.09062 -4.890625 Camaro Z28 13.3 8 350.0 245 3.73 3.840 15.41 0 0 3 4 20.09062 -6.790625 Pontiac Firebird 19.2 8 400.0 175 3.08 3.845 17.05 0 0 3 2 20.09062 -0.890625 Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 20.09062 7.209375 Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.70 0 1 5 2 20.09062 5.909375 Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.90 1 1 5 2 20.09062 10.309375 Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.50 0 1 5 4 20.09062 -4.290625 Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.50 0 1 5 6 20.09062 -0.390625 Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.60 0 1 5 8 20.09062 -5.090625 Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2 20.09062 1.309375 \u0026gt; mutate(mtcars, mpg_mean_diff = mpg - mean(mpg)) mpg cyl disp hp drat wt qsec vs am gear carb mpg_mean_diff Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 0.909375 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 0.909375 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 2.709375 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 1.309375 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 -1.390625 Valiant 18.1 6 225.0 105 2.76 3.460 20.22 1 0 3 1 -1.990625 Duster 360 14.3 8 360.0 245 3.21 3.570 15.84 0 0 3 4 -5.790625 Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 4.309375 Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 2.709375 Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4 -0.890625 Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4 -2.290625 Merc 450SE 16.4 8 275.8 180 3.07 4.070 17.40 0 0 3 3 -3.690625 Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3 -2.790625 Merc 450SLC 15.2 8 275.8 180 3.07 3.780 18.00 0 0 3 3 -4.890625 Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.250 17.98 0 0 3 4 -9.690625 Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4 -9.690625 Chrysler Imperial 14.7 8 440.0 230 3.23 5.345 17.42 0 0 3 4 -5.390625 Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 12.309375 Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 10.309375 Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 13.809375 Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1 1.409375 Dodge Challenger 15.5 8 318.0 150 2.76 3.520 16.87 0 0 3 2 -4.590625 AMC Javelin 15.2 8 304.0 150 3.15 3.435 17.30 0 0 3 2 -4.890625 Camaro Z28 13.3 8 350.0 245 3.73 3.840 15.41 0 0 3 4 -6.790625 Pontiac Firebird 19.2 8 400.0 175 3.08 3.845 17.05 0 0 3 2 -0.890625 Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 7.209375 Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.70 0 1 5 2 5.909375 Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.90 1 1 5 2 10.309375 Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.50 0 1 5 4 -4.290625 Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.50 0 1 5 6 -0.390625 Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.60 0 1 5 8 -5.090625 Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2 1.309375 2.3 Summarise cases summarise() å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®æ¡†ã€‚å®ƒå°†æœ‰ä¸€è¡Œæ€»ç»“æ‰€æœ‰è§‚å¯Ÿç»“æœï¼Œå¹¶åŒ…å«æ¯ä¸ªæ‚¨æŒ‡å®šçš„æ‘˜è¦ç»Ÿè®¡é‡çš„ä¸€ä¸ªåˆ—ã€‚å¦‚æœæœ‰åˆ†ç»„å˜é‡ï¼Œå®ƒå°†ä¸ºæ¯ä¸ªåˆ†ç»„å˜é‡çš„ç»„åˆåˆ›å»ºä¸€è¡Œã€‚\n1 2 3 4 5 6 7 \u0026gt; summarise(mtcars, sd(disp)) sd(disp) 1 123.9387 \u0026gt; summarise(mtcars, median(mpg), mean(mpg), max(mpg), min(mpg)) median(mpg) mean(mpg) max(mpg) min(mpg) 1 19.2 20.09062 33.9 10.4 2.4 Group cases ä½¿ç”¨ group_by() å‡½æ•°åˆ›å»ºè¡¨çš„ä¸€ä¸ªâ€œåˆ†ç»„â€å‰¯æœ¬ã€‚dplyrå‡½æ•°å°†åˆ†åˆ«å¤„ç†æ¯ä¸ªâ€œç»„â€ï¼Œç„¶åå°†ç»“æœç»„åˆèµ·æ¥ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026gt; group_by(mtcars, cyl) # A tibble: 32 Ã— 11 # Groups: cyl [3] mpg cyl disp hp drat wt qsec vs am gear carb \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; 1 21 6 160 110 3.9 2.62 16.5 0 1 4 4 2 21 6 160 110 3.9 2.88 17.0 0 1 4 4 3 22.8 4 108 93 3.85 2.32 18.6 1 1 4 1 4 21.4 6 258 110 3.08 3.22 19.4 1 0 3 1 5 18.7 8 360 175 3.15 3.44 17.0 0 0 3 2 6 18.1 6 225 105 2.76 3.46 20.2 1 0 3 1 7 14.3 8 360 245 3.21 3.57 15.8 0 0 3 4 8 24.4 4 147. 62 3.69 3.19 20 1 0 4 2 9 22.8 4 141. 95 3.92 3.15 22.9 1 0 4 2 10 19.2 6 168. 123 3.92 3.44 18.3 1 0 4 4 # â„¹ 22 more rows # â„¹ Use `print(n = ...)` to see more rows 2.5 ç®¡é“æ“ä½œç¬¦ %\u0026gt;% å…è®¸æ‚¨å°†ä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºç›´æ¥å‘é€åˆ°ä¸‹ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥ã€‚ä½¿ç”¨ç®¡é“æ“ä½œç¬¦æ—¶ï¼Œè¯·è®°ä½ä»¥ä¸‹å‡ ç‚¹ï¼š\nç¬¬ä¸€ä¸ªå‚æ•°å§‹ç»ˆæ˜¯ä¸€ä¸ªæ•°æ®æ¡†ã€‚ åç»­å‚æ•°æŒ‡å®šå¯¹æ•°æ®æ¡†è¦æ‰§è¡Œçš„æ“ä½œã€‚ å‚æ•°çš„é¡ºåºå°†è¿”å›ä¸€ä¸ªæ–°çš„æ•°æ®æ¡†ï¼ˆé™¤éæ‚¨é€šè¿‡åˆ†é…æ“ä½œï¼ˆå¦‚ä½¿ç”¨â€œ\u0026lt;-â€ï¼‰å¯¹ç¬¬ä¸€ä¸ªå‚æ•°ä¸­çš„æ•°æ®æ¡†è¿›è¡Œäº†æ›´æ”¹ï¼‰ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026gt; mtcars %\u0026gt;% # take dataframe, then + group_by(gear) %\u0026gt;% # group it by gear, then + summarise(mean(mpg)) # summarise the mean mpg for each level o .... [TRUNCATED] # A tibble: 3 Ã— 2 gear `mean(mpg)` \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; 1 3 16.1 2 4 24.5 3 5 21.4 \u0026gt; mtcars %\u0026gt;% + filter(mpg \u0026gt; 21) %\u0026gt;% select(gear, mpg, hp) %\u0026gt;% arrange(gear) gear mpg hp Hornet 4 Drive 3 21.4 110 Toyota Corona 3 21.5 97 Datsun 710 4 22.8 93 Merc 240D 4 24.4 62 Merc 230 4 22.8 95 Fiat 128 4 32.4 66 Honda Civic 4 30.4 52 Toyota Corolla 4 33.9 65 Fiat X1-9 4 27.3 66 Volvo 142E 4 21.4 109 Porsche 914-2 5 26.0 91 Lotus Europa 5 30.4 113 å¦‚æœæ‚¨æƒ³è¦ä½¿ç”¨è¿™ä¸ªè¾ƒå°ç‰ˆæœ¬çš„æ•°æ®åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ä¸ºå®ƒæŒ‡å®šä¸€ä¸ªæ–°åç§°æ¥å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026gt; mtcars_mpg \u0026lt;- mtcars %\u0026gt;% filter(mpg \u0026gt; 21) %\u0026gt;% select(gear, mpg, hp) %\u0026gt;% arrange(gear) \u0026gt; mtcars_mpg gear mpg hp Hornet 4 Drive 3 21.4 110 Toyota Corona 3 21.5 97 Datsun 710 4 22.8 93 Merc 240D 4 24.4 62 Merc 230 4 22.8 95 Fiat 128 4 32.4 66 Honda Civic 4 30.4 52 Toyota Corolla 4 33.9 65 Fiat X1-9 4 27.3 66 Volvo 142E 4 21.4 109 Porsche 914-2 5 26.0 91 Lotus Europa 5 30.4 113 2.6 Excercise 1 2 3 4 5 6 7 8 9 10 \u0026gt; redwine \u0026lt;- read.csv(\u0026#34;Data_redwine.csv\u0026#34;, header=TRUE) \u0026gt; head(redwine) fixed.acidity volatile.acidity citric.acid residual.sugar chlorides free.sulfur.dioxide total.sulfur.dioxide density pH sulphates alcohol quality 1 7.4 0.70 0.00 1.9 0.076 11 34 0.9978 3.51 0.56 9.4 5 2 7.8 0.88 0.00 2.6 0.098 25 67 0.9968 3.20 0.68 9.8 5 3 7.8 0.76 0.04 2.3 0.092 15 54 0.9970 3.26 0.65 9.8 5 4 11.2 0.28 0.56 1.9 0.075 17 60 0.9980 3.16 0.58 9.8 6 5 7.4 0.70 0.00 1.9 0.076 11 34 0.9978 3.51 0.56 9.4 5 6 7.4 0.66 0.00 1.8 0.075 13 40 0.9978 3.51 0.56 9.4 5 åˆ›å»ºä¸€ä¸ªä»…åŒ…å«å›ºå®šé…¸åº¦å¤§äºæˆ–ç­‰äº8çš„è‘¡è„é…’çš„æ•°æ®æ¡†ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026gt; wines_fixed_acidity_8_or_greater \u0026lt;- redwine %\u0026gt;% + filter(fixed.acidity \u0026gt;= 8) \u0026gt; wines_fixed_acidity_8_or_greater fixed.acidity volatile.acidity citric.acid residual.sugar chlorides free.sulfur.dioxide total.sulfur.dioxide density pH sulphates alcohol quality 1 11.2 0.280 0.56 1.9 0.075 17 60 0.99800 3.16 0.58 9.8 6 2 8.9 0.620 0.18 3.8 0.176 52 145 0.99860 3.16 0.88 9.2 5 3 8.9 0.620 0.19 3.9 0.170 51 148 0.99860 3.17 0.93 9.2 5 4 8.5 0.280 0.56 1.8 0.092 35 103 0.99690 3.30 0.75 10.5 7 5 8.1 0.560 0.28 1.7 0.368 16 56 0.99680 3.11 1.28 9.3 5 6 8.9 0.220 0.48 1.8 0.077 29 60 0.99680 3.39 0.53 9.4 6 7 8.5 0.490 0.11 2.3 0.084 9 67 0.99680 3.17 0.53 9.4 5 8 8.3 0.655 0.12 2.3 0.083 15 113 0.99660 3.17 0.66 9.8 5 3 12.0 0.380 0.56 2.1 0.093 6 24 0.99925 3.14 0.71 10.9 6 åˆ›å»ºä¸€ä¸ªä»…åŒ…å«å“è´¨ä¸º7çš„è‘¡è„é…’çš„æ•°æ®æ¡†ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; # ä½¿ç”¨filterå‡½æ•°ç­›é€‰å“è´¨ä¸º7çš„è‘¡è„é…’ \u0026gt; redwine_quality_7 \u0026lt;- redwine %\u0026gt;% + filter(quality == 7) \u0026gt; # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ \u0026gt; head(redwine_quality_7) fixed.acidity volatile.acidity citric.acid residual.sugar chlorides free.sulfur.dioxide total.sulfur.dioxide density pH sulphates alcohol quality 1 7.3 0.65 0.00 1.2 0.065 15 21 0.9946 3.39 0.47 10.0 7 2 7.8 0.58 0.02 2.0 0.073 9 18 0.9968 3.36 0.57 9.5 7 3 8.5 0.28 0.56 1.8 0.092 35 103 0.9969 3.30 0.75 10.5 7 4 8.1 0.38 0.28 2.1 0.066 13 30 0.9968 3.23 0.73 9.7 7 5 7.5 0.52 0.16 1.9 0.085 12 35 0.9968 3.38 0.62 9.5 7 6 8.0 0.59 0.16 1.8 0.065 3 16 0.9962 3.42 0.92 10.5 7 åˆ›å»ºä¸€ä¸ªä»…åŒ…å«2åˆ—ï¼ˆpHå’Œå“è´¨ï¼‰çš„æ•°æ®æ¡†ã€‚ 1 2 3 4 5 6 # ä½¿ç”¨selectå‡½æ•°é€‰æ‹©æŒ‡å®šçš„ä¸¤åˆ— redwine_selected_columns \u0026lt;- redwine %\u0026gt;% select(pH, quality) # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ head(redwine_selected_columns) åˆ›å»ºä¸€ä¸ªä»…åŒ…å«2åˆ—ï¼ˆpHå’Œå“è´¨ï¼‰çš„æ•°æ®æ¡†ï¼Œå…¶ä¸­è‘¡è„é…’æŒ‰ç…§pHçš„å‡åºæ’åºã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026gt; # ä½¿ç”¨selectå‡½æ•°é€‰æ‹©æŒ‡å®šçš„ä¸¤åˆ—ï¼Œç„¶åä½¿ç”¨arrangeå‡½æ•°æŒ‰ç…§pHçš„å‡åºæ’åº \u0026gt; redwine_selected_and_sorted \u0026lt;- redwine %\u0026gt;% + select(pH, quality) %\u0026gt;% + arrange(pH) \u0026gt; # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ \u0026gt; head(redwine_selected_and_sorted) pH quality 1 2.74 4 2 2.86 6 3 2.87 6 4 2.88 8 5 2.89 5 6 2.89 5 åˆ›å»ºä¸€ä¸ªä»…åŒ…å«2åˆ—ï¼ˆpHå’Œå“è´¨ï¼‰çš„æ•°æ®æ¡†ï¼Œå…¶ä¸­è‘¡è„é…’æŒ‰ç…§å“è´¨çš„é™åºæ’åºã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026gt; # ä½¿ç”¨selectå‡½æ•°é€‰æ‹©æŒ‡å®šçš„ä¸¤åˆ—ï¼Œç„¶åä½¿ç”¨arrangeå‡½æ•°æŒ‰ç…§å“è´¨çš„é™åºæ’åº \u0026gt; redwine_selected_and_sorted \u0026lt;- redwine %\u0026gt;% + select(pH, quality) %\u0026gt;% + arrange(desc(quality)) \u0026gt; # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ \u0026gt; head(redwine_selected_and_sorted) pH quality 1 3.35 8 2 3.23 8 3 3.56 8 4 2.88 8 5 3.22 8 6 3.15 8 åˆ›å»ºä¸€ä¸ªä»…åŒ…å«æ²¡æœ‰æŸ æª¬é…¸çš„è‘¡è„é…’çš„æ•°æ®æ¡†ï¼Œå¹¶æŒ‰ç…§å“è´¨çš„é™åºæ’åºã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026gt; # ä½¿ç”¨filterå‡½æ•°ç­›é€‰æ²¡æœ‰æŸ æª¬é…¸çš„è‘¡è„é…’ï¼Œç„¶åä½¿ç”¨arrangeå‡½æ•°æŒ‰ç…§å“è´¨çš„é™åºæ’åº \u0026gt; redwine_no_citric_acid \u0026lt;- redwine %\u0026gt;% + filter(citric.acid == 0) %\u0026gt;% + arrange(desc(quality)) \u0026gt; # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ \u0026gt; head(redwine_no_citric_acid) fixed.acidity volatile.acidity citric.acid residual.sugar chlorides free.sulfur.dioxide total.sulfur.dioxide density pH sulphates alcohol quality 1 7.3 0.650 0 1.2 0.065 15 21 0.99460 3.39 0.47 10.0 7 2 5.1 0.585 0 1.7 0.044 14 86 0.99264 3.56 0.94 12.9 7 3 4.9 0.420 0 2.1 0.048 16 42 0.99154 3.71 0.74 14.0 7 4 5.6 0.660 0 2.2 0.087 3 11 0.99378 3.71 0.63 12.8 7 5 5.6 0.660 0 2.2 0.087 3 11 0.99378 3.71 0.63 12.8 7 6 7.8 0.645 0 2.0 0.082 8 16 0.99640 3.38 0.59 9.8 6 åˆ›å»ºä¸€ä¸ªçº¢è‘¡è„é…’æ•°æ®é›†çš„ç‰ˆæœ¬ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªé¢å¤–çš„åˆ—ï¼Œè¯¥åˆ—åŒ…å«é…’ç²¾å«é‡ä¹˜ä»¥å¯†åº¦ã€‚ 1 2 3 4 5 6 # ä½¿ç”¨mutateå‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°åˆ—ï¼Œè¯¥åˆ—ä¸ºé…’ç²¾å«é‡ä¹˜ä»¥å¯†åº¦ redwine_with_extra_column \u0026lt;- redwine %\u0026gt;% mutate(alcohol_density = alcohol * density) # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ head(redwine_with_extra_column) åˆ›å»ºä¸€ä¸ªæ€»ç»“çº¢è‘¡è„é…’æ•°æ®é›†ä¸­æ¯ä¸ªå˜é‡çš„æ•°æ®æ¡†ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; # ä½¿ç”¨summaryå‡½æ•°å¯¹çº¢è‘¡è„é…’æ•°æ®é›†è¿›è¡Œæ€»ç»“ \u0026gt; redwine_summary \u0026lt;- summary(redwine) \u0026gt; # æ˜¾ç¤ºæ€»ç»“ç»“æœ \u0026gt; redwine_summary fixed.acidity volatile.acidity citric.acid residual.sugar chlorides free.sulfur.dioxide total.sulfur.dioxide density pH sulphates alcohol quality Min. : 4.600 Min. :0.1200 Min. :0.0000 Min. : 1.200 Min. :0.01200 Min. : 1.00 Min. : 6.00 Min. :0.9906 Min. :2.740 Min. :0.3300 Min. : 8.40 Min. :3.000 1st Qu.: 7.400 1st Qu.:0.4000 1st Qu.:0.1200 1st Qu.: 2.000 1st Qu.:0.07200 1st Qu.: 7.00 1st Qu.: 23.00 1st Qu.:0.9964 1st Qu.:3.190 1st Qu.:0.5600 1st Qu.: 9.50 1st Qu.:5.000 Median : 8.300 Median :0.5200 Median :0.2800 Median : 2.300 Median :0.08100 Median :13.00 Median : 39.00 Median :0.9973 Median :3.300 Median :0.6200 Median : 9.90 Median :5.000 Mean : 8.729 Mean :0.5283 Mean :0.2946 Mean : 2.579 Mean :0.09037 Mean :15.17 Mean : 48.33 Mean :0.9973 Mean :3.299 Mean :0.6685 Mean :10.24 Mean :5.594 3rd Qu.: 9.800 3rd Qu.:0.6350 3rd Qu.:0.4700 3rd Qu.: 2.700 3rd Qu.:0.09300 3rd Qu.:20.25 3rd Qu.: 64.25 3rd Qu.:0.9984 3rd Qu.:3.400 3rd Qu.:0.7400 3rd Qu.:10.80 3rd Qu.:6.000 Max. :15.900 Max. :1.3300 Max. :1.0000 Max. :15.500 Max. :0.61100 Max. :68.00 Max. :165.00 Max. :1.0032 Max. :3.900 Max. :2.0000 Max. :14.90 Max. :8.000 3. Code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 library(\u0026#34;readxl\u0026#34;) # used for report compilation and table display library(\u0026#34;ggplot2\u0026#34;) # confusion matrix library(\u0026#34;dplyr\u0026#34;) # confusion matrix # è·å–å½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• file_dir \u0026lt;- dirname(parent.frame(2)$ofile) print(file_dir) # å°†å·¥ä½œç›®å½•è®¾ç½®ä¸ºå½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• setwd(file_dir) CLV.df \u0026lt;- read_excel(\u0026#34;Data_CLV.xlsx\u0026#34;, sheet = \u0026#34;Ex2\u0026#34;) CLV.df summary(CLV.df) ggplot(CLV.df, aes(x = t, y = active)) + geom_line() + ylab(\u0026#34;Customer\u0026#34;) + xlab(\u0026#34;Period\u0026#34;) + ggtitle(\u0026#34;Active Customer Evolution\u0026#34;) ggplot(CLV.df, aes(x = t, y = r)) + geom_line() + ylab(\u0026#34;Customer\u0026#34;) + xlab(\u0026#34;Period\u0026#34;) + ggtitle(\u0026#34;Retention Ratio Evolution\u0026#34;) CLV.df$CLV \u0026lt;- (CLV.df$p-CLV.df$c)*CLV.df$r^CLV.df$t/(1+CLV.df$i)^CLV.df$t CLV.df ggplot(CLV.df, aes(x = t, y = CLV)) + geom_line() + ggtitle(\u0026#34;CLV evolution\u0026#34;) + ylab(\u0026#34;CLV\u0026#34;) + xlab(\u0026#34;Period\u0026#34;) CLV \u0026lt;- apply(CLV.df, 2, sum) CLV[7] CLV.df$CLV2 \u0026lt;- (CLV.df$p - CLV.df$c) * 0.8 / (1 + CLV.df$i)^(CLV.df$t - 1) ggplot(CLV.df, aes(x = t, y = CLV2)) + geom_line() + ylab(\u0026#34;CLV2\u0026#34;) + xlab(\u0026#34;Period\u0026#34;) + labs(title = \u0026#34;CLV 2 Evolution\u0026#34;) CLV \u0026lt;- apply(CLV.df, 2, sum) CLV[7] CLV[8] head(mtcars) str(mtcars) filter(mtcars, gear == 4) # è¿‡æ»¤å™¨å¯ä¸æ‰€æœ‰æ ‡å‡†é€»è¾‘è¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨ filter(mtcars, gear == 3 | gear == 4) # å³ \u0026gt;ã€\u0026lt;ã€=\u0026gt;ã€\u0026lt;=ã€!=ã€== filter(mtcars, mpg \u0026gt; 21) arrange(mtcars, gear) arrange(mtcars, gear, mpg) arrange(mtcars, desc(mpg)) # desc ä»¥é™åºæ’åº select(mtcars, gear, mpg, hp) select(mtcars, -drat) # - ç¬¦å·è¡¨ç¤ºåˆ é™¤å˜é‡/åˆ— slice(mtcars, 1:3) sample_n(mtcars, 5) # é€‰æ‹©çš„è¡Œæ•° sample_frac(mtcars, .1) # é€‰æ‹©çš„è¡Œæ•°å æ€»è¡Œæ•°çš„æ¯”ä¾‹ mutate(mtcars, wt_mpg = wt * mpg) mutate(mtcars, mpg_mean = mean(mpg), mpg_diff_mean = mpg - mpg_mean) mutate(mtcars, mpg_mean_diff = mpg - mean(mpg)) summarise(mtcars, sd(disp)) summarise(mtcars, median(mpg), mean(mpg), max(mpg), min(mpg)) group_by(mtcars, cyl) mtcars %\u0026gt;% # take dataframe, then group_by(gear) %\u0026gt;% # group it by gear, then summarise(mean(mpg)) # summarise the mean mpg for each level of gear mtcars %\u0026gt;% filter(mpg \u0026gt; 21) %\u0026gt;% select(gear, mpg, hp) %\u0026gt;% arrange(gear) mtcars_mpg \u0026lt;- mtcars %\u0026gt;% filter(mpg \u0026gt; 21) %\u0026gt;% select(gear, mpg, hp) %\u0026gt;% arrange(gear) mtcars_mpg # Excercise redwine \u0026lt;- read.csv(\u0026#34;Data_redwine.csv\u0026#34;, header=TRUE) head(redwine) wines_fixed_acidity_8_or_greater \u0026lt;- redwine %\u0026gt;% filter(fixed.acidity \u0026gt;= 8) wines_fixed_acidity_8_or_greater # ä½¿ç”¨filterå‡½æ•°ç­›é€‰å“è´¨ä¸º7çš„è‘¡è„é…’ redwine_quality_7 \u0026lt;- redwine %\u0026gt;% filter(quality == 7) # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ head(redwine_quality_7) # ä½¿ç”¨selectå‡½æ•°é€‰æ‹©æŒ‡å®šçš„ä¸¤åˆ—ï¼Œç„¶åä½¿ç”¨arrangeå‡½æ•°æŒ‰ç…§pHçš„å‡åºæ’åº redwine_selected_and_sorted \u0026lt;- redwine %\u0026gt;% select(pH, quality) %\u0026gt;% arrange(pH) # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ head(redwine_selected_and_sorted) # ä½¿ç”¨selectå‡½æ•°é€‰æ‹©æŒ‡å®šçš„ä¸¤åˆ—ï¼Œç„¶åä½¿ç”¨arrangeå‡½æ•°æŒ‰ç…§å“è´¨çš„é™åºæ’åº redwine_selected_and_sorted \u0026lt;- redwine %\u0026gt;% select(pH, quality) %\u0026gt;% arrange(desc(quality)) # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ head(redwine_selected_and_sorted) # ä½¿ç”¨filterå‡½æ•°ç­›é€‰æ²¡æœ‰æŸ æª¬é…¸çš„è‘¡è„é…’ï¼Œç„¶åä½¿ç”¨arrangeå‡½æ•°æŒ‰ç…§å“è´¨çš„é™åºæ’åº redwine_no_citric_acid \u0026lt;- redwine %\u0026gt;% filter(citric.acid == 0) %\u0026gt;% arrange(desc(quality)) # æ˜¾ç¤ºæ–°æ•°æ®æ¡†çš„å‰å‡ è¡Œ head(redwine_no_citric_acid) # ä½¿ç”¨summaryå‡½æ•°å¯¹çº¢è‘¡è„é…’æ•°æ®é›†è¿›è¡Œæ€»ç»“ redwine_summary \u0026lt;- summary(redwine) # æ˜¾ç¤ºæ€»ç»“ç»“æœ redwine_summary ","date":"2024-03-27T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek5-customer-lifetime-value-code/","title":"R[week5] Customer Lifetime Value code"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\n1. CLV CLVï¼ˆCustomer Lifetime Valueï¼‰æŒ‡çš„æ˜¯å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ï¼Œæ˜¯æŒ‡å®¢æˆ·ä¸å…¬å¸å»ºç«‹å…³ç³»æœŸé—´æ‰€è·å¾—çš„æ‰€æœ‰æœªæ¥åˆ©æ¶¦çš„ç°å€¼ã€‚è¿™ä¸ªæŒ‡æ ‡å¯ä»¥å¸®åŠ©å…¬å¸è¯„ä¼°ä»–ä»¬å¯¹å®¢æˆ·çš„æŠ•èµ„ä»·å€¼ï¼Œä»è€Œç¡®å®šåœ¨å®¢æˆ·è·å–ã€ç•™å­˜å’Œå‘å±•æ–¹é¢åº”è¯¥æŠ•å…¥å¤šå°‘èµ„æºã€‚CLVçš„è®¡ç®—é€šå¸¸æ¶‰åŠé¢„æµ‹å®¢æˆ·æœªæ¥çš„è´­ä¹°è¡Œä¸ºã€åˆ©æ¶¦å’Œå…³ç³»æŒç»­æ—¶é—´ï¼Œå¹¶å°†è¿™äº›æ•°æ®æŠ˜ç°åˆ°å½“å‰å€¼ï¼Œä»¥ä¾¿è¿›è¡Œæ¯”è¾ƒå’Œå†³ç­–åˆ¶å®šã€‚\nå¯¹äºä¼ä¸šåˆ¶å®šæ”¶è´­ï¼ˆAcquisitionï¼‰ã€æ‰©å¼ ï¼ˆExpansionï¼‰ã€ä¿ç•™ï¼ˆRetentionï¼‰å†³ç­–è€Œè¨€çš„å…³é”®åˆ†æå·¥å…·ã€‚ä»¥ä¸‹æ˜¯CLVå¯¹æ¯ä¸ªAERå†³ç­–ç»„æˆéƒ¨åˆ†çš„è´¡çŒ®ï¼š\næ”¶è´­ï¼ˆAcquisitionï¼‰ï¼šCLVå¸®åŠ©ä¼ä¸šç¡®å®šä»–ä»¬å¯ä»¥æŠ•å…¥å¤šå°‘æˆæœ¬æ¥è·å¾—æ–°å®¢æˆ·å¹¶å®ç°ç›ˆåˆ©ã€‚é€šè¿‡äº†è§£å®¢æˆ·çš„æ½œåœ¨é•¿æœŸä»·å€¼ï¼Œä¼ä¸šå¯ä»¥æ›´æœ‰æ•ˆåœ°åˆ†é…æ”¶è´­é¢„ç®—ï¼Œé’ˆå¯¹é‚£äº›å¯èƒ½äº§ç”Ÿæœ€é«˜CLVçš„å®¢æˆ·ç¾¤ä½“ã€‚\næ‰©å¼ ï¼ˆExpansionï¼‰ï¼šCLVåˆ†æå¯ä»¥è¯†åˆ«å‡ºå¯¹ç°æœ‰å®¢æˆ·è¿›è¡Œå‡çº§æˆ–äº¤å‰é”€å”®çš„æœºä¼šã€‚é€šè¿‡æ ¹æ®å®¢æˆ·çš„CLVè¿›è¡Œåˆ†ç»„ï¼Œä¼ä¸šå¯ä»¥ä¼˜å…ˆå°†èµ„æºæŠ•å…¥åˆ°é‚£äº›å…·æœ‰æ›´é«˜æ½œåŠ›è¿›è¡Œé¢å¤–è´­ä¹°æˆ–å‡çº§çš„å®¢æˆ·ç¾¤ä½“ï¼Œä»è€Œæœ€å¤§åŒ–ç°æœ‰å®¢æˆ·ç¾¤ä½“çš„æ”¶å…¥ã€‚\nä¿ç•™ï¼ˆRetentionï¼‰ï¼šCLVå¯ä»¥å¸®åŠ©ä¼ä¸šè¯†åˆ«å‡ºå…·æœ‰é«˜ä»·å€¼çš„å®¢æˆ·ï¼Œå¹¶é‡‡å–æªæ–½æ¥å¢å¼ºä¸è¿™äº›å®¢æˆ·çš„å…³ç³»ï¼Œä»¥æé«˜å®¢æˆ·çš„å¿ è¯šåº¦å’Œä¿ç•™ç‡ã€‚é€šè¿‡æŠ•èµ„äºæå‡æœåŠ¡è´¨é‡ã€ä¸ªæ€§åŒ–è¥é”€ã€å®¢æˆ·æœåŠ¡ç­‰æ–¹é¢ï¼Œä¼ä¸šå¯ä»¥æ›´å¥½åœ°ä¿æŒå’Œå‘å±•é«˜ä»·å€¼å®¢æˆ·ï¼Œä»è€Œæé«˜æ•´ä½“CLVã€‚\n2. How CLV works CLVæ˜¯å®¢æˆ·å…³ç³»çš„ç¾å…ƒä»·å€¼ï¼Œæ ¹æ®å…¶ç°å€¼å’Œé¢„æµ‹æœªæ¥ç°é‡‘æµé‡æ¥ç¡®å®šã€‚\nè®¡ç®—è¿‡ç¨‹åŒ…æ‹¬ä¸‰ä¸ªæ­¥éª¤ï¼š ä¼°è®¡å‰©ä½™å®¢æˆ·å¯¿å‘½ï¼Œæˆ–å®¢æˆ·å¯èƒ½ä¸å…¬å¸ä¿æŒå…³ç³»çš„å¹´æ•°ï¼Œé€šå¸¸æ ¹æ®ä¿ç•™ç‡è¿›è¡Œä¼°è®¡ã€‚ é¢„æµ‹å®¢æˆ·åœ¨é¢„æœŸå¯¿å‘½å†…çš„å‡€åˆ©æ¶¦ã€‚ è®¡ç®—æœªæ¥é‡‘é¢çš„å‡€ç°å€¼ã€‚ æ ¹æ®é¢„æœŸçš„é•¿æœŸåˆ©æ¶¦æˆ–CLVï¼ˆCustomer Lifetime Valueï¼Œå®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ï¼‰æ¥å¯¹å½“å‰å’Œæ½œåœ¨å®¢æˆ·è¿›è¡Œåˆ†æ®µï¼Œåˆ©ç”¨CLVåˆ†å¸ƒå›¾æ¥è¯†åˆ«å’Œé’ˆå¯¹æœ€å…·åˆ©æ¶¦æ€§çš„å®¢æˆ·è¿›è¡Œè¥é”€ä¿ç•™æ´»åŠ¨ã€‚\nCLVåˆ†å¸ƒï¼š ä¸æ´»è·ƒå®¢æˆ·ï¼ˆCLVä½è‡³è´Ÿå€¼ï¼‰ æ´»è·ƒå®¢æˆ·ï¼ˆCLVä¸ºæ­£ï¼‰ é«˜åº¦æ´»è·ƒå®¢æˆ·ï¼ˆCLVéå¸¸é«˜ï¼‰ å…¬å¸å¯ä»¥åˆ©ç”¨è¿™æ ·çš„å›¾è¡¨æ¥è¯†åˆ«å¹¶é’ˆå¯¹æœ€å…·åˆ©æ¶¦æ€§çš„å®¢æˆ·è¿›è¡Œè¥é”€ä¿ç•™æ´»åŠ¨ã€‚ è€ƒè™‘ä¸åŒå®¢æˆ·ä¹‹é—´åˆ©æ¶¦å·®å¼‚ï¼Œæ•æ‰ç°æœ‰å®¢æˆ·ä¹‹é—´çš„å·®å¼‚ï¼Œä»¥ä¾¿è·å–ã€æ‰©å±•å’Œä¿ç•™â€œæœ€ä½³å®¢æˆ·â€ã€‚\nCLVè€ƒè™‘äº†å®¢æˆ·ä¹‹é—´åˆ©æ¶¦çš„å·®å¼‚ï¼Œè¶…è¶Šäº†80/20æ³•åˆ™ï¼šä¼ä¸šä»30%çš„å®¢æˆ·ä¸­èµšå–äº†150%çš„åˆ©æ¶¦ã€‚ CLVæ•æ‰äº†ç°æœ‰å®¢æˆ·ä¹‹é—´çš„è¿™äº›å·®å¼‚ï¼Œå› æ­¤æ‚¨å¯ä»¥è·å–ã€æ‰©å±•å’Œä¿ç•™â€œæœ€ä½³å®¢æˆ·â€ã€‚ CLVè€ƒè™‘äº†å®¢æˆ·åˆ©æ¶¦çš„æ—¶é—´å˜åŒ–ã€‚\nå¹³å‡è€Œè¨€ï¼Œå®¢æˆ·çš„å¹´åº¦æ”¶ç›Šé€šå¸¸ä¼šéšç€æ—¶é—´å¢é•¿ï¼Œè¿™æ˜¯ç”±äºäº¤å‰é”€å”®/å‡çº§ã€‚ ä½†æ˜¯ï¼Œä¸€äº›å®¢æˆ·çš„è·å–æˆ–ä¿ç•™æˆæœ¬è¾ƒé«˜ï¼ˆé™ä½ä»·æ ¼ï¼Œæä¾›é«˜æœåŠ¡æ°´å¹³ï¼‰ã€‚ 3. CLV å…¬å¼ $$ CLV = \\sum_{t=0}^{T} \\frac{(p_t - c_t) r_t}{(1 + i)^t} - AC $$å…¶ä¸­ï¼š\n$ p_t $ ä»£è¡¨ç¬¬ $ t $ å¹´çš„åˆ©æ¶¦ï¼ˆProfitï¼‰ $ c_t $ ä»£è¡¨ç¬¬ $ t $ å¹´çš„æˆæœ¬ï¼ˆCostï¼‰ $ p_t - c_t $ ï¼šä»£è¡¨æ—¶é—´ $ t $ æ—¶æ¶ˆè´¹è€…çš„åˆ©æ¶¦ç‡ï¼ˆProfit marginï¼‰ $ r $ï¼šä»£è¡¨å®¢æˆ·çš„ä¿ç•™ç‡ï¼Œå³æ¶ˆè´¹è€…å†æ¬¡è´­ä¹°çš„æ¦‚ç‡ï¼ˆRetention rateï¼‰ $ i $ ä»£è¡¨æŠ˜ç°ç‡ï¼ˆInterest rateï¼‰ $ (1+i)^t $ï¼šä»£è¡¨å°†æ—¶é—´ $ t $ çš„åˆ©æ¶¦æŠ˜ç°(Discounting the profit in period $ t $) $ AC $ ä»£è¡¨è·å®¢æˆæœ¬ï¼ˆAcquisition costï¼‰ 4. CLV Analysis å‡è®¾ï¼š\nå½“ $ T $ è¶‹è¿‘äºæ— ç©·æ—¶ï¼ˆ$ T \\rightarrow \\infty $ï¼‰ è´¡çŒ®è¾¹é™…ï¼ˆContribution marginï¼‰$ m = p - c $ åœ¨æ—¶é—´ä¸Šä¸å˜ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒCLVå…¬å¼å¯ä»¥ç®€åŒ–ä¸ºï¼š\n$$ CLV = \\sum_{t=0}^{\\infty} \\frac{m \\cdot r^t}{(1 + i)^t} - AC = m \\cdot \\left( \\frac{r}{1 + i - r} \\right) - AC $$ æ¯å¹´è´¡çŒ®è¾¹é™… $m$ ä¿æŒä¸å˜ æ¯å¹´ä¿ç•™ç‡ $r$ ä¿æŒä¸å˜ æŠ˜ç°ç‡ $i$ ä¿æŒä¸å˜ è·å®¢æˆæœ¬ $AC$ ä¿æŒä¸å˜ ","date":"2024-03-26T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek5-customer-lifetime-value-lecture/","title":"R[week5] Customer Lifetime Value Lecture"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\nChoice modeling æ˜¯ä¸€ç§å¸‚åœºç ”ç©¶æ–¹æ³•ï¼Œç”¨äºç†è§£æ¶ˆè´¹è€…åœ¨è´­ä¹°å†³ç­–ä¸­åšå‡ºé€‰æ‹©çš„è¿‡ç¨‹ã€‚è¿™ç§æ–¹æ³•ä½¿ç”¨æ•°å­¦æ¨¡å‹æ¥åˆ†ææ¶ˆè´¹è€…å¦‚ä½•æ ¹æ®ä¸åŒçš„äº§å“æˆ–æœåŠ¡ç‰¹å¾åšå‡ºé€‰æ‹©ï¼Œå¹¶é‡åŒ–è¿™äº›é€‰æ‹©çš„æ¦‚ç‡ã€‚é€šå¸¸ï¼Œç ”ç©¶è€…ä¼šè®¾è®¡å®éªŒæˆ–è°ƒæŸ¥æ¥æ”¶é›†å…³äºæ¶ˆè´¹è€…å¯¹ä¸åŒäº§å“æˆ–æœåŠ¡çš„åå¥½å’Œé€‰æ‹©çš„æ•°æ®ï¼Œç„¶åä½¿ç”¨é€‰æ‹©æ¨¡å‹æ¥è§£é‡Šè¿™äº›æ•°æ®ã€‚\né€‰æ‹©æ¨¡å‹å¯ä»¥æ˜¯åŸºäºå‚æ•°çš„ï¼Œæ¯”å¦‚æ¦‚ç‡æ¨¡å‹ï¼ˆå¦‚é€»è¾‘å›å½’ï¼‰ã€åå¥½æ¨¡å‹ï¼ˆå¦‚åå¥½å‡½æ•°ï¼‰æˆ–æ•ˆç”¨æ¨¡å‹ï¼ˆå¦‚ç¦åˆ©å‡½æ•°ï¼‰ç­‰ï¼›ä¹Ÿå¯ä»¥æ˜¯éå‚æ•°çš„ï¼Œæ¯”å¦‚å†³ç­–æ ‘ã€éšæœºæ£®æ—ç­‰æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚è¿™äº›æ¨¡å‹èƒ½å¤Ÿå¸®åŠ©ä¼ä¸šäº†è§£æ¶ˆè´¹è€…å¯¹äº§å“æˆ–æœåŠ¡çš„åå¥½ï¼Œä»è€ŒæŒ‡å¯¼äº§å“å®šä»·ã€å¸‚åœºå®šä½ã€å¹¿å‘Šç­–ç•¥ç­‰å†³ç­–ã€‚\nMarketers often observe yes/no outcomes:\nâ€¢ Did a customer purchase a product?\nâ€¢ Did a customer take a test drive?\nâ€¢ Did a customer sign up for a credit card, renew her subscription, or respond to a promotion?\nAll of these kinds of outcomes are binary because they have only two possible overserved states: yes or no. A logistic model is used to fit such outcomes.\nè¿™äº›ç±»å‹çš„ç»“æœéƒ½æ˜¯äºŒå…ƒçš„ï¼Œå®ƒä»¬åªæœ‰ä¸¤ç§å¯èƒ½çš„çŠ¶æ€ï¼šæ˜¯æˆ–å¦ã€‚ logisticæ¨¡å‹è¢«ç”¨æ¥æ‹Ÿåˆè¿™æ ·çš„ç»“æœã€‚\n1. Basics of logistic regression The core feature of a logistic model is that it relates the probability of an outcome to an exponential function of a predictor variable.\nBy modelling the probability of an outcome, a logistic model accomplishes two things:\nâ€¢ First, it more directly models what we are interested in, which is a probability or proportion, such as the likelihood of a given customer to purchase a product or the expected proportion of a segment who will respond to a promotion.\nâ€¢ Second, it limits the model to the appropriate range for a proportion, which is [0, 1]. A basic linear model, as generated with lm(), does not have such a limit. The equation for the logistic function is:\n$$ p(y) = \\frac{e^{v_x}}{e^{v_x} + 1} $$Logisticæ¨¡å‹çš„æ ¸å¿ƒç‰¹å¾æ˜¯å®ƒå°†ç»“æœçš„æ¦‚ç‡ä¸é¢„æµ‹å˜é‡çš„æŒ‡æ•°å‡½æ•°ç›¸å…³è”ã€‚\né€šè¿‡å¯¹ç»“æœçš„æ¦‚ç‡å»ºæ¨¡ï¼Œlogisticæ¨¡å‹å®ç°äº†ä¸¤ä¸ªç›®æ ‡ã€‚\nâ€¢ é¦–å…ˆï¼Œå®ƒæ›´ç›´æ¥åœ°å¯¹æˆ‘ä»¬æ„Ÿå…´è¶£çš„å†…å®¹è¿›è¡Œå»ºæ¨¡ï¼Œå³æ¦‚ç‡æˆ–æ¯”ä¾‹ï¼Œä¾‹å¦‚ç»™å®šå®¢æˆ·è´­ä¹°äº§å“çš„å¯èƒ½æ€§æˆ–å°†å¯¹ä¿ƒé”€æ´»åŠ¨åšå‡ºå›åº”çš„ç»†åˆ†é¢„æœŸæ¯”ä¾‹ã€‚\nâ€¢ å…¶æ¬¡ï¼Œå®ƒå°†æ¨¡å‹é™åˆ¶åœ¨æ¯”ä¾‹çš„é€‚å½“èŒƒå›´å†…ï¼Œå³[0,1]ã€‚åŸºæœ¬çš„çº¿æ€§æ¨¡å‹ï¼Œå¦‚lm()ç”Ÿæˆçš„æ¨¡å‹ï¼Œæ²¡æœ‰è¿™æ ·çš„é™åˆ¶ã€‚\nIn this equation, the outcome of interest is y, and we compute its likelihood p(y) as a function of vx. We typically estimate vx as a function of the features (x) of a product, such as price. vx can take any real value, so we are able to treat it as a continuous function in a linear model. In that case, vx is composed of one or more coefficients of the model and indicates the importance of the corresponding features of the product.\nåœ¨è¿™ä¸ªæ–¹ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„ç»“æœæ˜¯yï¼Œæˆ‘ä»¬è®¡ç®—å…¶æ¦‚ç‡p(y)ä½œä¸ºvxçš„å‡½æ•°ã€‚æˆ‘ä»¬é€šå¸¸å°†vxä¼°è®¡ä¸ºäº§å“ç‰¹å¾ï¼ˆxï¼‰çš„å‡½æ•°ï¼Œä¾‹å¦‚ä»·æ ¼ã€‚vxå¯ä»¥å–ä»»ä½•å®æ•°å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºçº¿æ€§æ¨¡å‹ä¸­çš„è¿ç»­å‡½æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œvxç”±æ¨¡å‹çš„ä¸€ä¸ªæˆ–å¤šä¸ªç³»æ•°ç»„æˆï¼Œå¹¶æŒ‡ç¤ºäº§å“ç›¸åº”ç‰¹å¾çš„é‡è¦æ€§ã€‚\nThe formula gives a value between [0, 1]. The likelihood of y is less than 50% when vx is negative, is 50% when vx = 0 and is above 50% when vx is positive. We compute this first by hand and then switch to the equivalent plogis() function:\nè¿™ä¸ªå…¬å¼ç»™å‡ºäº†ä¸€ä¸ªåœ¨[0, 1]ä¹‹é—´çš„å€¼ã€‚å½“vxä¸ºè´Ÿæ—¶ï¼Œyçš„æ¦‚ç‡å°äº50ï¼…ï¼Œå½“vx = 0æ—¶ï¼Œæ¦‚ç‡ä¸º50ï¼…ï¼Œå½“vxä¸ºæ­£æ—¶ï¼Œæ¦‚ç‡å¤§äº50ï¼…ã€‚æˆ‘ä»¬é¦–å…ˆæ‰‹å·¥è®¡ç®—è¿™ä¸ªå€¼ï¼Œç„¶ååˆ‡æ¢åˆ°ç­‰æ•ˆçš„plogis()å‡½æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; exp(0) / exp(0)+1 # computing logistic by hand, or using plogis() â€¢[1] 2 # plogiså‚æ•°å…¶å®å°±æ˜¯p(y) \u0026gt; plogis(-Inf) #infinitely low = likelihood 0 [1] 0 \u0026gt; plogis(2) #moderate probability = 88% chance of outcome [1] 0.8807971 \u0026gt; plogis(-0.2) # weak likelihood [1] 0.450166 plogis():\nplogis() å‡½æ•°æ˜¯ R è¯­è¨€ä¸­ç”¨äºè®¡ç®—é€»è¾‘å‡½æ•°ï¼ˆlogistic functionï¼‰çš„å‡½æ•°ã€‚\né€»è¾‘å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š\n$$ \\text{logistic}(x) = \\frac{1}{1 + e^{-x}} $$å…¶ä¸­ï¼Œ\\(x\\) æ˜¯é€»è¾‘å‡½æ•°çš„è¾“å…¥å€¼ã€‚plogis() å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° \\(x\\)ï¼Œè¡¨ç¤ºé€»è¾‘å‡½æ•°çš„è¾“å…¥å€¼ï¼Œç„¶åè¿”å›é€»è¾‘å‡½æ•°çš„å€¼ã€‚è¿™ä¸ªå‡½æ•°é€šå¸¸ç”¨äºé€»è¾‘å›å½’æ¨¡å‹ä¸­ï¼Œå°†çº¿æ€§é¢„æµ‹å€¼è½¬æ¢ä¸º0åˆ°1ä¹‹é—´çš„æ¦‚ç‡å€¼ã€‚\nåœ¨ R ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ plogis() å‡½æ•°æ¥è®¡ç®—é€»è¾‘å‡½æ•°çš„å€¼ã€‚ä¾‹å¦‚ï¼š\n1 2 3 4 # è®¡ç®—é€»è¾‘å‡½æ•°å€¼ x \u0026lt;- 2 probability \u0026lt;- plogis(x) print(probability) Such a model is known as a logit model, which determines the value of vx from the logarithm of the relative probability of occurence of y:\n$$ v_x = \\log \\left( \\frac{p(y)}{1 - p(y)} \\right) $$ 1 2 3 4 5 \u0026gt; log(0.88 / (1-0.88)) # moderate high likelihood [1] 1.99243 \u0026gt; qlogis(0.88) # equivalent to hand computation [1] 1.99243 qlogis()\nqlogis() å‡½æ•°æ˜¯ R è¯­è¨€ä¸­ç”¨äºè®¡ç®—é€»è¾‘å‡½æ•°çš„åå‡½æ•°çš„å‡½æ•°ã€‚\né€»è¾‘å‡½æ•°çš„åå‡½æ•°é€šå¸¸ç§°ä¸ºé€†é€»è¾‘å‡½æ•°ï¼Œå…¶å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š\n$$ \\text{logit}(p) = \\log\\left(\\frac{p}{1 - p}\\right) $$å…¶ä¸­ï¼Œ\\( p \\) æ˜¯é€»è¾‘å‡½æ•°çš„è¾“å‡ºå€¼ï¼Œå³æ¦‚ç‡å€¼ã€‚\nqlogis() å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° \\( p \\)ï¼Œè¡¨ç¤ºé€»è¾‘å‡½æ•°çš„è¾“å‡ºå€¼ï¼ˆå³æ¦‚ç‡å€¼ï¼‰ï¼Œç„¶åè¿”å›é€†é€»è¾‘å‡½æ•°çš„å€¼ã€‚è¿™ä¸ªå‡½æ•°é€šå¸¸ç”¨äºä»é€»è¾‘å‡½æ•°çš„æ¦‚ç‡å€¼ä¸­åæ¨å‡ºçº¿æ€§é¢„æµ‹å€¼ã€‚\nåœ¨ R ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ qlogis() å‡½æ•°æ¥è®¡ç®—é€†é€»è¾‘å‡½æ•°çš„å€¼ã€‚ä¾‹å¦‚ï¼š\n1 2 3 4 # è®¡ç®—é€†é€»è¾‘å‡½æ•°å€¼ p \u0026lt;- 0.7 linear_pred \u0026lt;- qlogis(p) print(linear_pred) 2. Generalised linear model (GLM) A logistic regression model in R is fitted as a generalised linear model (GLM) using a process similar to linear regression with lm(), but with the difference that a GLM can handle dependent variables that are not normally distributed. Thus, GLM can be used to model data counts (such as the number of purchases), time intervals (such as time spent on a website), or binary variables (e.g., did/didnâ€™t purchase). The common feature of all GLM models is that they relate normally distributed predictors to a non-normal outcome using a function known as a link. This means that they are able to fit models for many different distributions using a single, consistent framework.\nåœ¨Rä¸­ï¼Œé€»è¾‘å›å½’æ¨¡å‹æ˜¯ä½œä¸ºå¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGLMï¼‰è¿›è¡Œæ‹Ÿåˆçš„ï¼Œä½¿ç”¨çš„è¿‡ç¨‹ç±»ä¼¼äºä½¿ç”¨lm()è¿›è¡Œçº¿æ€§å›å½’ï¼Œä½†ä¸åŒä¹‹å¤„åœ¨äºGLMå¯ä»¥å¤„ç†ä¸ç¬¦åˆæ­£æ€åˆ†å¸ƒçš„å› å˜é‡ã€‚å› æ­¤ï¼ŒGLMå¯ç”¨äºå¯¹æ•°æ®è®¡æ•°ï¼ˆä¾‹å¦‚è´­ä¹°æ¬¡æ•°ï¼‰ã€æ—¶é—´é—´éš”ï¼ˆä¾‹å¦‚åœ¨ç½‘ç«™ä¸Šçš„åœç•™æ—¶é—´ï¼‰æˆ–äºŒå…ƒå˜é‡ï¼ˆä¾‹å¦‚æ˜¯å¦è´­ä¹°ï¼‰å»ºæ¨¡ã€‚æ‰€æœ‰GLMæ¨¡å‹çš„å…±åŒç‰¹ç‚¹æ˜¯å®ƒä»¬å°†æ­£æ€åˆ†å¸ƒçš„é¢„æµ‹å˜é‡ä¸ä¸€ä¸ªéæ­£æ€çš„ç»“æœç›¸å…³è”ï¼Œä½¿ç”¨çš„å‡½æ•°ç§°ä¸ºé“¾æ¥å‡½æ•°ã€‚è¿™æ„å‘³ç€å®ƒä»¬èƒ½å¤Ÿä½¿ç”¨å•ä¸€ã€ä¸€è‡´çš„æ¡†æ¶æ‹Ÿåˆè®¸å¤šä¸åŒåˆ†å¸ƒçš„æ¨¡å‹ã€‚\nå¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGeneralized Linear Modelï¼ŒGLMï¼‰æ˜¯ä¸€ç§å¹¿æ³›åº”ç”¨äºç»Ÿè®¡åˆ†æä¸­çš„æ¨¡å‹ï¼Œå®ƒå°†çº¿æ€§æ¨¡å‹æ‰©å±•åˆ°äº†æ›´å¹¿æ³›çš„æ•°æ®ç±»å‹å’Œåˆ†å¸ƒã€‚GLMå¯ä»¥å¤„ç†ä¸åŒç±»å‹çš„å“åº”å˜é‡ï¼ŒåŒ…æ‹¬äºŒé¡¹åˆ†å¸ƒã€æ³Šæ¾åˆ†å¸ƒã€æ­£æ€åˆ†å¸ƒç­‰ï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†ä¸åŒçš„é“¾æ¥å‡½æ•°ï¼Œå¦‚æ’ç­‰å‡½æ•°ã€å¯¹æ•°å‡½æ•°ã€é€»è¾‘æ–¯è’‚å‡½æ•°ç­‰ã€‚\nGLMçš„åŸºæœ¬å½¢å¼å¦‚ä¸‹ï¼š\nçº¿æ€§éƒ¨åˆ†ï¼š $$ \\eta = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\ldots + \\beta_p x_p $$è¿™éƒ¨åˆ†ä¸å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ç›¸ä¼¼ï¼Œå…¶ä¸­ $ \\eta $ æ˜¯çº¿æ€§é¢„æµ‹å€¼ï¼Œ$ \\beta_0 $ , $ \\beta_1 $ , $ \\ldots $, $ \\beta_p $ æ˜¯ç³»æ•°ï¼Œ$ x_1 $ , $ x_2 $ , $ \\ldots $, $ x_p $ æ˜¯é¢„æµ‹å˜é‡ã€‚\né“¾æ¥å‡½æ•°ï¼š $$ g(\\mu) = \\eta $$è¿™é‡Œçš„ $ g(\\cdot) $ æ˜¯é“¾æ¥å‡½æ•°ï¼Œå®ƒå®šä¹‰äº†é¢„æµ‹å˜é‡ $ \\eta $ ä¸å“åº”å˜é‡ $ \\mu $ ä¹‹é—´çš„å…³ç³»ã€‚é“¾æ¥å‡½æ•°é€šå¸¸æ ¹æ®å“åº”å˜é‡çš„ç±»å‹é€‰æ‹©ï¼Œå¦‚å¯¹æ•°é“¾æ¥å‡½æ•°ç”¨äºå¤„ç†æ³Šæ¾åˆ†å¸ƒçš„å“åº”å˜é‡ï¼Œé€»è¾‘æ–¯è’‚é“¾æ¥å‡½æ•°ç”¨äºå¤„ç†äºŒé¡¹åˆ†å¸ƒçš„å“åº”å˜é‡ç­‰ã€‚\nåˆ†å¸ƒæ—ï¼š $$ Y \\sim \\text{Dist}(\\mu) $$è¿™é‡Œçš„ $ \\text{Dist}(\\mu) $ è¡¨ç¤ºå“åº”å˜é‡ Y çš„åˆ†å¸ƒæ—ï¼Œ$ \\mu $ æ˜¯å“åº”å˜é‡çš„å‡å€¼ã€‚\nGLMçš„ä¼˜åŠ¿åœ¨äºå®ƒçš„çµæ´»æ€§å’Œé€‚ç”¨æ€§ï¼Œå¯ä»¥é€‚åº”ä¸åŒç±»å‹å’Œåˆ†å¸ƒçš„æ•°æ®ï¼ŒåŒæ—¶ä¿æŒäº†å¯¹å‚æ•°çš„è§£é‡Šæ€§ã€‚å®ƒåœ¨è®¸å¤šé¢†åŸŸéƒ½å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ï¼ŒåŒ…æ‹¬ç”Ÿç‰©ç»Ÿè®¡å­¦ã€åŒ»å­¦ã€ç¤¾ä¼šç§‘å­¦ç­‰ã€‚\n3. RFM (recency, frequency, monetary) RFM is a method used for analyzing customer value. RFM stands for the three dimensions: Recency: How recently did the customer purchase? Frequency: How often do they purchase? Monetary Value: How much do they spend?\nRFMæ˜¯ç”¨äºåˆ†æå®¢æˆ·ä»·å€¼çš„ä¸€ç§æ–¹æ³•ã€‚RFMä»£è¡¨ä¸‰ä¸ªç»´åº¦ï¼šRecencyï¼ˆæœ€è¿‘è´­ä¹°æ—¶é—´ï¼‰ï¼šå®¢æˆ·æœ€è¿‘ä¸€æ¬¡è´­ä¹°æ˜¯åœ¨å¤šä¹…ä¹‹å‰ï¼ŸFrequencyï¼ˆè´­ä¹°é¢‘ç‡ï¼‰ï¼šä»–ä»¬è´­ä¹°çš„é¢‘ç‡å¦‚ä½•ï¼ŸMonetary Valueï¼ˆè´­ä¹°é‡‘é¢ï¼‰ï¼šä»–ä»¬çš„æ¶ˆè´¹é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ\n3.1 The Logit Model The logit model restricts the output values to lie in [0, 1] intervals.\nSpecifically, it expresses the probability of purchase by customer i as a function of coefficients Î²0:3 and variables in the following manner:\né€»è¾‘æ–¯è’‚æ¨¡å‹å°†è¾“å‡ºå€¼é™åˆ¶åœ¨[0, 1]çš„åŒºé—´å†…ã€‚ å…·ä½“è€Œè¨€ï¼Œå®ƒå°†å®¢æˆ·içš„è´­ä¹°æ¦‚ç‡è¡¨è¾¾ä¸ºç³»æ•°Î²0:3å’Œä»¥ä¸‹å˜é‡çš„å‡½æ•°ï¼š\n$$ P(Purchase_i) = \\frac{exp(\\beta_0 + \\beta_1 \\text{Recency}_i + \\beta_2 \\text{Frequency}_i + \\beta_3 \\text{Monetary}_i)}{exp(\\beta_0 + \\beta_1 \\text{Recency}_i + \\beta_2 \\text{Frequency}_i + \\beta_3 \\text{Monetary}_i) + 1} $$ è¿™ä¸ªå…¬å¼æ˜¯ä¸€ä¸ªé€»è¾‘å›å½’æ¨¡å‹ä¸­ç”¨äºè®¡ç®—è´­ä¹°æ¦‚ç‡çš„æ–¹ç¨‹ã€‚åœ¨è¿™ä¸ªæ–¹ç¨‹ä¸­ï¼š\n$ P(Purchase_i) $ è¡¨ç¤ºç¬¬ i ä¸ªä¸ªä½“è´­ä¹°çš„æ¦‚ç‡ã€‚ $ \\beta_0 $, $ \\beta_1 $, $ \\beta_2 $, $ \\beta_3 $ æ˜¯æ¨¡å‹çš„å‚æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºæˆªè·å’Œä¸æ¯ä¸ªé¢„æµ‹å˜é‡ï¼ˆRecencyã€Frequencyã€Monetaryï¼‰ç›¸å…³çš„ç³»æ•°ã€‚ $ \\text{Recency}_i $, $ \\text{Frequency}_i $, $ \\text{Monetary}_i $ æ˜¯ç¬¬ i ä¸ªä¸ªä½“çš„é¢„æµ‹å˜é‡å€¼ï¼Œåˆ†åˆ«è¡¨ç¤ºæœ€è¿‘ä¸€æ¬¡è´­ä¹°è·ç¦»ã€è´­ä¹°é¢‘ç‡å’Œè´­ä¹°é‡‘é¢ã€‚ å…¬å¼çš„åˆ†å­éƒ¨åˆ†è¡¨ç¤ºäº†ä¸€ä¸ªçº¿æ€§ç»„åˆ$ (\\beta_0 + \\beta_1 \\text{Recency}_i + \\beta_2 \\text{Frequency}_i + \\beta_3 \\text{Monetary}_i) $ çš„æŒ‡æ•°å½¢å¼ï¼Œå³æŒ‡æ•°å‡½æ•° $ \\text{exp}(\\ldots) $ ï¼Œä»£è¡¨äº†è´­ä¹°çš„å¯èƒ½æ€§ã€‚\nåˆ†æ¯éƒ¨åˆ†æ˜¯åˆ†å­éƒ¨åˆ†åŠ ä¸Š1ï¼Œè¿™æ˜¯ç”±äºé€»è¾‘å›å½’æ¨¡å‹çš„å½¢å¼ï¼Œä¿è¯äº†æ¦‚ç‡å€¼åœ¨0å’Œ1ä¹‹é—´ã€‚æ•´ä¸ªæ–¹ç¨‹å®é™…ä¸Šæ˜¯é€»è¾‘å›å½’æ¨¡å‹çš„é€»è¾‘å‡½æ•°ï¼ˆlogistic functionï¼‰ï¼Œå®ƒå°†çº¿æ€§é¢„æµ‹å€¼è½¬æ¢ä¸º0åˆ°1ä¹‹é—´çš„æ¦‚ç‡å€¼ï¼Œè¿™è¡¨ç¤ºä¸ªä½“è´­ä¹°çš„æ¦‚ç‡ã€‚\nIntuitively, the utility of choosing to buy is:\n$$ V_{bi} = \\beta_0 + \\beta_1 \\text{Recency}_i + \\beta_2 \\text{Frequency}_i + \\beta_3 \\text{Monetary}_i $$ è¿™ä¸ªå…¬å¼è¡¨ç¤ºäº†ä¸€ä¸ªçº¿æ€§æ¨¡å‹ï¼Œç”¨äºé¢„æµ‹ä¸ªä½“ i çš„ $ V $ å€¼ã€‚åœ¨è¿™ä¸ªå…¬å¼ä¸­ï¼š\n$ V_{bi} $ è¡¨ç¤ºä¸ªä½“ $ i $ çš„ $ V $ å€¼ã€‚ $ \\beta_0, \\beta_1, \\beta_2, \\beta_3 $ æ˜¯æ¨¡å‹çš„å‚æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºæˆªè·å’Œä¸æ¯ä¸ªé¢„æµ‹å˜é‡ï¼ˆRecencyã€Frequencyã€Monetaryï¼‰ç›¸å…³çš„ç³»æ•°ã€‚ $ \\text{Recency}_i, \\text{Frequency}_i, \\text{Monetary}_i $ ç¬¬ $ i $ ä¸ªä¸ªä½“çš„é¢„æµ‹å˜é‡å€¼ï¼Œåˆ†åˆ«è¡¨ç¤ºæœ€è¿‘ä¸€æ¬¡è´­ä¹°è·ç¦»ã€è´­ä¹°é¢‘ç‡å’Œè´­ä¹°é‡‘é¢ã€‚ è¿™ä¸ªæ¨¡å‹çš„ç›®çš„æ˜¯é€šè¿‡ä¸ªä½“çš„è´­ä¹°è¡Œä¸ºçš„ç›¸å…³ç‰¹å¾ï¼ˆRecencyã€Frequencyã€Monetaryï¼‰æ¥é¢„æµ‹ä»–ä»¬çš„ $ V $ å€¼ã€‚è¿™ä¸ª $ V $ å€¼å¯èƒ½è¡¨ç¤ºä¸ªä½“çš„æ½œåœ¨ä»·å€¼æˆ–å…¶ä»–ç›¸å…³çš„æŒ‡æ ‡ã€‚\nwhereas utility of choosing not to buy is normalized to zero $ V_ni = 0 $, so $ exp(V_n) = exp(0) = 1 $ in the fraction above.\nWith the given formulation, we can estimate values $ \\beta_0:3 $ that fit the data best. We use glm() of family=â€œbinomialâ€.\né€‰æ‹©ä¸è´­ä¹°çš„æ•ˆç”¨è¢«å½’ä¸€åŒ–ä¸ºé›¶ï¼Œå³ Vni = 0ï¼Œå› æ­¤åœ¨ä¸Šè¿°åˆ†æ•°ä¸­ exp(Vn) = exp(0) = 1ã€‚\né€šè¿‡ç»™å®šçš„å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä¼°è®¡æœ€é€‚åˆæ•°æ®çš„ Î²0:3 å€¼ã€‚æˆ‘ä»¬ä½¿ç”¨ glm() ä¸­çš„ family=\u0026ldquo;binomial\u0026rdquo;ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026gt; RFMdata \u0026lt;- read.csv(file = \u0026#34;RFMData.csv\u0026#34;,row.names=1) \u0026gt; head(RFMdata,5) Recency Frequency Monetary Purchase 1 120 7 41.66 0 2 90 9 46.71 0 3 120 6 103.99 1 4 270 17 37.13 1 5 60 5 88.92 0 \u0026gt; model \u0026lt;- glm(Purchase~Recency+Frequency+Monetary, data=RFMdata, family = \u0026#34;binomial\u0026#34;) \u0026gt; output \u0026lt;- cbind(coef(summary(model))[, 1:4],exp(coef(model))) \u0026gt; colnames(output) \u0026lt;- c(\u0026#34;beta\u0026#34;,\u0026#34;SE\u0026#34;,\u0026#34;z val.\u0026#34;,\u0026#34;Pr(\u0026gt;|z|)\u0026#34;,\u0026#39;exp(beta)\u0026#39;) \u0026gt; kable(output,caption = \u0026#34;Logistic regression estimates\u0026#34;) Table: Logistic regression estimates | | beta| SE| z val.| Pr(\u0026gt;\u0026amp;#124;z\u0026amp;#124;)| exp(beta)| |:-----------|-----------:|---------:|---------:|------------------:|---------:| |(Intercept) | -30.2976692| 8.5522913| -3.542638| 0.0003961| 0.000000| |Recency | 0.1114175| 0.0309797| 3.596464| 0.0003226| 1.117862| |Frequency | 0.5941268| 0.2429393| 2.445577| 0.0144620| 1.811448| |Monetary | 0.1677054| 0.0465645| 3.601572| 0.0003163| 1.182588| glm()\nglm() å‡½æ•°æ˜¯ R è¯­è¨€ä¸­çš„ä¸€ä¸ªé‡è¦å‡½æ•°ï¼Œç”¨äºæ‹Ÿåˆå¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGeneralized Linear Modelsï¼‰ã€‚å¹¿ä¹‰çº¿æ€§æ¨¡å‹æ˜¯çº¿æ€§æ¨¡å‹çš„æ‰©å±•ï¼Œå…è®¸å› å˜é‡æœä»ä¸åŒçš„åˆ†å¸ƒï¼Œè€Œä¸ä»…ä»…æ˜¯æ­£æ€åˆ†å¸ƒã€‚è¿™ä½¿å¾—å¹¿ä¹‰çº¿æ€§æ¨¡å‹é€‚ç”¨äºæ›´å¹¿æ³›çš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬äºŒé¡¹åˆ†å¸ƒï¼ˆäºŒå…ƒé€»è¾‘å›å½’ï¼‰ã€æ³Šæ¾åˆ†å¸ƒï¼ˆè®¡æ•°æ•°æ®ï¼‰ã€å¤šé¡¹åˆ†å¸ƒï¼ˆå¤šç±»åˆ«åˆ†ç±»ï¼‰ç­‰ã€‚ cbind()\ncbind() å‡½æ•°æ˜¯ R è¯­è¨€ä¸­çš„ä¸€ä¸ªåŸºç¡€å‡½æ•°ï¼Œç”¨äºæŒ‰åˆ—åˆå¹¶å¤šä¸ªå¯¹è±¡ï¼ˆé€šå¸¸æ˜¯å‘é‡ã€çŸ©é˜µæˆ–æ•°æ®æ¡†ï¼‰ã€‚cbind æ˜¯ \"column bind\" çš„ç¼©å†™ï¼Œè¡¨ç¤ºæŒ‰åˆ—åˆå¹¶ã€‚ kable()\nkable() å‡½æ•°æ˜¯ R è¯­è¨€ä¸­ knitr å’Œ rmarkdown åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºç”Ÿæˆç¾è§‚çš„è¡¨æ ¼è¾“å‡ºã€‚å®ƒèƒ½å¤Ÿå°† R ä¸­çš„æ•°æ®æ¡†ã€çŸ©é˜µæˆ–è¡¨æ ¼è½¬æ¢ä¸º Markdown æˆ– LaTeX æ ¼å¼çš„è¡¨æ ¼ï¼Œä»è€Œæ–¹ä¾¿åœ°å°†å…¶æ’å…¥åˆ° R Markdown æ–‡æ¡£æˆ– HTML é¡µé¢ä¸­ã€‚ We also run the likelihood ratio test with H0 : Î²1 = Î²2 = Î²3 = 0 â€“ to make sure our full logit model offers a significantly better fit than the model with just an intercept. We find that Ï‡2 = 107.14 and P(\u0026gt; |Chi|) â‰ˆ 0, so we reject H0.\næˆ‘ä»¬è¿˜è¿›è¡Œäº†ä¼¼ç„¶æ¯”æ£€éªŒï¼Œå‡è®¾ H0ï¼šÎ²1 = Î²2 = Î²3 = 0ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬çš„å®Œæ•´ logit æ¨¡å‹æä¾›äº†æ˜¾ç€æ›´å¥½çš„æ‹Ÿåˆæ•ˆæœï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªæˆªè·æ¨¡å‹ã€‚æˆ‘ä»¬å‘ç° Ï‡2 = 107.14ï¼ŒP(\u0026gt; |Chi|) â‰ˆ 0ï¼Œå› æ­¤æˆ‘ä»¬æ‹’ç» H0ã€‚\nè¿™å¥è¯è¡¨æ˜äº†å¯¹å…¨æ¨¡å‹ï¼ˆå«æœ‰Recencyã€Frequencyã€Monetaryé¢„æµ‹å˜é‡ï¼‰å’Œåªæœ‰æˆªè·é¡¹çš„æ¨¡å‹ä¹‹é—´è¿›è¡Œäº†ä¼¼ç„¶æ¯”æ£€éªŒã€‚åœ¨ä¼¼ç„¶æ¯”æ£€éªŒä¸­ï¼ŒåŸå‡è®¾ $ H_0 $ æ˜¯æ¨¡å‹ä¸­æ‰€æœ‰é¢„æµ‹å˜é‡çš„ç³»æ•°éƒ½ä¸ºé›¶ï¼Œå³ $ \\beta_1 = \\beta_2 = \\beta_3 = 0 $ï¼Œå³åªæœ‰æˆªè·é¡¹ã€‚å¤‡æ‹©å‡è®¾ $ H_1 $ æ˜¯è‡³å°‘æœ‰ä¸€ä¸ªé¢„æµ‹å˜é‡çš„ç³»æ•°ä¸ä¸ºé›¶ï¼Œå³å…¨æ¨¡å‹ã€‚\né€šè¿‡ä¼¼ç„¶æ¯”æ£€éªŒï¼Œå¯ä»¥ç¡®å®šæ˜¯å¦å…¨æ¨¡å‹ç›¸å¯¹äºåªæœ‰æˆªè·é¡¹çš„æ¨¡å‹æä¾›äº†æ›´å¥½çš„æ‹Ÿåˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šè¿‡è®¡ç®—å¾—åˆ°çš„å¡æ–¹ç»Ÿè®¡é‡ $ \\chi^2 $ ä¸º107.14ï¼Œå¯¹åº”çš„På€¼éå¸¸æ¥è¿‘äº0ï¼Œé€šå¸¸å°äºæ˜¾è‘—æ€§æ°´å¹³ï¼ˆä¾‹å¦‚0.05ï¼‰ã€‚ç”±äºPå€¼å°äºæ˜¾è‘—æ€§æ°´å¹³ï¼Œæˆ‘ä»¬æ‹’ç»åŸå‡è®¾ $ H_0 $ï¼Œå³è®¤ä¸ºå…¨æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœæ˜¾è‘—åœ°ä¼˜äºåªæœ‰æˆªè·é¡¹çš„æ¨¡å‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; # likelihood ratio test \u0026gt; reduced.model \u0026lt;- glm(Purchase ~ 1, data=RFMdata, family = \u0026#34;binomial\u0026#34;) \u0026gt; kable(xtable(anova(reduced.model, model, test = \u0026#34;Chisq\u0026#34;)),caption = \u0026#34;Likelihood ratio test\u0026#34;) Table: Likelihood ratio test | Resid. Df| Resid. Dev| Df| Deviance| Pr(\u0026gt;Chi)| |---------:|----------:|--:|--------:|--------:| | 99| 137.62776| NA| NA| NA| | 96| 30.48715| 3| 107.1406| 0| 3.2 Predicting probabilities Now we calculate $ P(Purchase_i) $ for each individual in the data set.\nç°åœ¨æˆ‘ä»¬è®¡ç®—æ•°æ®é›†ä¸­æ¯ä¸ªä¸ªä½“çš„è´­ä¹°æ¦‚ç‡$ P(Purchase_i) $ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; # calculate logit probabilities \u0026gt; RFMdata$Base.Probability \u0026lt;- predict(model, RFMdata, type=\u0026#34;response\u0026#34;) \u0026gt; kable(head(RFMdata,5),row.names = TRUE) | | Recency| Frequency| Monetary| Purchase| Base.Probability| |:--|-------:|---------:|--------:|--------:|----------------:| |1 | 120| 7| 41.66| 0| 0.0030728| |2 | 90| 9| 46.71| 0| 0.0008332| |3 | 120| 6| 103.99| 1| 0.9833225| |4 | 270| 17| 37.13| 1| 0.9999999| |5 | 60| 5| 88.92| 0| 0.0032378| predict()\npredict() å‡½æ•°æ˜¯ R è¯­è¨€ä¸­çš„ä¸€ä¸ªå¸¸ç”¨å‡½æ•°ï¼Œç”¨äºå¯¹å·²æ‹Ÿåˆçš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚å®ƒå¯ä»¥å¯¹æ–°çš„è§‚æµ‹æ•°æ®åº”ç”¨å·²ç»æ‹Ÿåˆå¥½çš„æ¨¡å‹ï¼Œä»è€Œç”Ÿæˆé¢„æµ‹å€¼ã€‚ 3.3 Predicting behaviour We also calculate an indicator variable for whether individuals will purchase or not based on their predicted probabilities\næˆ‘ä»¬è¿˜æ ¹æ®ä»–ä»¬çš„é¢„æµ‹æ¦‚ç‡è®¡ç®—å‡ºä¸ªä½“æ˜¯å¦ä¼šè´­ä¹°çš„æŒ‡ç¤ºå˜é‡ã€‚\nç¬¦å· \u0026ldquo;âŠ®\u0026rdquo; ä»£è¡¨é€»è¾‘éï¼ˆnegationï¼‰æˆ–è€…â€œéâ€ã€‚æ‰€ä»¥æ•´ä¸ªå…¬å¼çš„å«ä¹‰æ˜¯ï¼šè´­ä¹°æ¦‚ç‡ä¸å¤§äºæˆ–ç­‰äº0.5ã€‚\n$$ \\neg [P(Purchase_i) \\geq 0.5] $$If individualâ€™s predicted probability is greater or equal to 0.5, we predict he will make a purchase.\nå¦‚æœä¸ªä½“çš„é¢„æµ‹æ¦‚ç‡å¤§äºæˆ–ç­‰äº0.5ï¼Œåˆ™æˆ‘ä»¬é¢„æµ‹ä»–ä¼šè´­ä¹°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; # purchase vs. no purchase \u0026lt;-\u0026gt; p\u0026gt;0.5 or p\u0026lt;0.5 \u0026gt; RFMdata$Predicted.Purchase \u0026lt;- 1*(RFMdata$Base.Probability\u0026gt;=0.5) \u0026gt; kable(head(RFMdata,5),row.names = TRUE) | | Recency| Frequency| Monetary| Purchase| Base.Probability| Predicted.Purchase| |:--|-------:|---------:|--------:|--------:|----------------:|------------------:| |1 | 120| 7| 41.66| 0| 0.0030728| 0| |2 | 90| 9| 46.71| 0| 0.0008332| 0| |3 | 120| 6| 103.99| 1| 0.9833225| 1| |4 | 270| 17| 37.13| 1| 0.9999999| 1| |5 | 60| 5| 88.92| 0| 0.0032378| 0| 3.4 Evaluating the model Now, we compute a confusion matrix between predicted purchases and actual purchase behaviour.\nç°åœ¨ï¼Œæˆ‘ä»¬è®¡ç®—é¢„æµ‹è´­ä¹°å’Œå®é™…è´­ä¹°è¡Œä¸ºä¹‹é—´çš„æ··æ·†çŸ©é˜µã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026gt; confusionMatrix(table(RFMdata$Predicted.Purchase,RFMdata$Purchase),positive = \u0026#34;1\u0026#34;) Confusion Matrix and Statistics 0 1 0 51 2 1 4 43 Accuracy : 0.94 95% CI : (0.874, 0.9777) No Information Rate : 0.55 P-Value [Acc \u0026gt; NIR] : \u0026lt;2e-16 Kappa : 0.8793 Now we calculate Mcnemar\u0026#39;s Test P-Value : 0.6831 Sensitivity : 0.9556 Specificity : 0.9273 Pos Pred Value : 0.9149 Neg Pred Value : 0.9623 Prevalence : 0.4500 Detection Rate : 0.4300 Detection Prevalence : 0.4700 Balanced Accuracy : 0.9414 \u0026#39;Positive\u0026#39; Class : 1 confusionMatrix()\nconfusionMatrix() å‡½æ•°æ˜¯ caret åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè®¡ç®—åˆ†ç±»æ¨¡å‹çš„æ··æ·†çŸ©é˜µä»¥åŠå„ç§åˆ†ç±»æŒ‡æ ‡ï¼Œå¦‚å‡†ç¡®ç‡ã€çµæ•åº¦ã€ç‰¹å¼‚æ€§ç­‰ã€‚æ··æ·†çŸ©é˜µæ˜¯ä¸€ç§ç”¨äºè¯„ä¼°åˆ†ç±»æ¨¡å‹æ€§èƒ½çš„è¡¨æ ¼ï¼Œå…¶ä¸­è¡Œè¡¨ç¤ºçœŸå®ç±»åˆ«ï¼Œåˆ—è¡¨ç¤ºé¢„æµ‹ç±»åˆ«ã€‚ åœ¨å¸‚åœºè¥é”€åœºæ™¯ä¸­ï¼ŒconfusionMatrix() å‡½æ•°å¯ä»¥ç”¨äºè¯„ä¼°åˆ†ç±»æ¨¡å‹åœ¨é¢„æµ‹å®¢æˆ·è¡Œä¸ºæ–¹é¢çš„æ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å®é™…åº”ç”¨åœºæ™¯ï¼š\nâ€¢ å®¢æˆ·æµå¤±é¢„æµ‹ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å±•å®¢æˆ·æµå¤±é¢„æµ‹é¡¹ç›®ã€‚ä½ å¯ä»¥ä½¿ç”¨å†å²æ•°æ®è®­ç»ƒä¸€ä¸ªæµå¤±é¢„æµ‹æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ confusionMatrix() å‡½æ•°æ¥è¯„ä¼°è¯¥æ¨¡å‹çš„æ€§èƒ½ã€‚é€šè¿‡æ··æ·†çŸ©é˜µï¼Œä½ å¯ä»¥äº†è§£æ¨¡å‹æ­£ç¡®é¢„æµ‹æµå¤±å®¢æˆ·å’Œæœªæµå¤±å®¢æˆ·çš„æƒ…å†µï¼Œå¹¶è®¡ç®—å‡ºå‡†ç¡®ç‡ã€çµæ•åº¦ç­‰æŒ‡æ ‡ã€‚\nâ€¢ è¥é”€æ´»åŠ¨åé¦ˆï¼šå¦‚æœä½ è¿›è¡Œäº†ä¸€é¡¹å¸‚åœºè¥é”€æ´»åŠ¨ï¼Œä¾‹å¦‚å‘é€ç”µå­é‚®ä»¶æˆ–çŸ­ä¿¡è¥é”€æ´»åŠ¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ confusionMatrix() å‡½æ•°æ¥è¯„ä¼°æ´»åŠ¨çš„æ•ˆæœã€‚ä½ å¯ä»¥å°†å®é™…æ´»åŠ¨çš„ç»“æœä¸é¢„æœŸç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œä»¥äº†è§£æ´»åŠ¨çš„æˆåŠŸç‡ä»¥åŠæ˜¯å¦æœ‰å¿…è¦è°ƒæ•´ä½ çš„è¥é”€ç­–ç•¥ã€‚\nâ€¢ å®¢æˆ·åˆ†ç¾¤ï¼šåœ¨å®¢æˆ·åˆ†ç¾¤é¡¹ç›®ä¸­ï¼Œä½ å¯èƒ½ä½¿ç”¨èšç±»ç®—æ³•å°†å®¢æˆ·åˆ†æˆä¸åŒçš„ç¾¤ä½“ã€‚ä½ å¯ä»¥ä½¿ç”¨ confusionMatrix() å‡½æ•°æ¥è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ï¼Œä¾‹å¦‚æ¯”è¾ƒèšç±»ç»“æœä¸çœŸå®çš„å®¢æˆ·ç‰¹å¾ä¹‹é—´çš„åŒ¹é…ç¨‹åº¦ã€‚è¿™å¯ä»¥å¸®åŠ©ä½ ç¡®å®šæ˜¯å¦éœ€è¦é‡æ–°è°ƒæ•´åˆ†ç¾¤æ–¹æ³•æˆ–è€…æ”¹è¿›æ•°æ®è´¨é‡ã€‚\nâ€¢ äº§å“æ¨èç³»ç»Ÿï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªäº§å“æ¨èç³»ç»Ÿï¼Œä½ å¯ä»¥ä½¿ç”¨ confusionMatrix() å‡½æ•°æ¥è¯„ä¼°ç³»ç»Ÿçš„å‡†ç¡®æ€§ã€‚ä½ å¯ä»¥æ¯”è¾ƒç³»ç»Ÿæ¨èçš„äº§å“ä¸ç”¨æˆ·å®é™…è´­ä¹°çš„äº§å“ä¹‹é—´çš„åŒ¹é…æƒ…å†µï¼Œå¹¶è®¡ç®—å‡ºå‡†ç¡®ç‡ã€å¬å›ç‡ç­‰æŒ‡æ ‡ï¼Œä»¥äº†è§£ç³»ç»Ÿçš„æ€§èƒ½å’Œç”¨æˆ·çš„æ»¡æ„åº¦ã€‚\nWe can also plot the receiver operating characteristic (ROC) curve, which illustrates the diagnostic ability of a binary logit model. It is created by plotting the true positive rate (TPR) against the false positive rate (FPR) â€“ at various decision threshold values for prediction.\nROC curve can be quickly evaluated using the area under the curve (AUC) metric, which captures the overall quality of the classifier. The greater the AUC, the better. AUC of 1.0 represents a perfect classifier, AUC of 0.5 (diagonal line) represents a worthless classifier. As we see, the binary logit classifier does a good job of predicting purchases on the training data.\næˆ‘ä»¬è¿˜å¯ä»¥ç»˜åˆ¶æ¥æ”¶è€…æ“ä½œç‰¹å¾æ›²çº¿ï¼ˆROCæ›²çº¿ï¼‰ï¼Œå®ƒå±•ç¤ºäº†äºŒå…ƒLogitæ¨¡å‹çš„è¯Šæ–­èƒ½åŠ›ã€‚ROCæ›²çº¿é€šè¿‡åœ¨ä¸åŒçš„é¢„æµ‹å†³ç­–é˜ˆå€¼ä¸‹ç»˜åˆ¶çœŸæ­£ç‡ï¼ˆTPRï¼‰ä¸å‡æ­£ç‡ï¼ˆFPRï¼‰ä¹‹é—´çš„å…³ç³»æ¥åˆ›å»ºã€‚\nROCæ›²çº¿å¯ä»¥é€šè¿‡æ›²çº¿ä¸‹é¢ç§¯ï¼ˆAUCï¼‰æŒ‡æ ‡è¿›è¡Œå¿«é€Ÿè¯„ä¼°ï¼Œè¯¥æŒ‡æ ‡æ•æ‰äº†åˆ†ç±»å™¨çš„æ•´ä½“è´¨é‡ã€‚AUCè¶Šå¤§ï¼Œåˆ†ç±»å™¨çš„æ€§èƒ½è¶Šå¥½ã€‚AUCä¸º1.0è¡¨ç¤ºå®Œç¾çš„åˆ†ç±»å™¨ï¼ŒAUCä¸º0.5ï¼ˆå¯¹è§’çº¿ï¼‰è¡¨ç¤ºä¸€ä¸ªæ¯«æ— ä»·å€¼çš„åˆ†ç±»å™¨ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼ŒäºŒå…ƒLogitåˆ†ç±»å™¨åœ¨è®­ç»ƒæ•°æ®ä¸Šé¢„æµ‹è´­ä¹°è¡Œä¸ºçš„æ•ˆæœè‰¯å¥½ã€‚\n1 2 3 4 5 6 \u0026gt; rocobj \u0026lt;- roc(RFMdata$Purchase, RFMdata$Base.Probability) Setting levels: control = 0, case = 1 Setting direction: controls \u0026lt; cases \u0026gt; {plot(rocobj,legacy.axes=TRUE) text(0.5, 0.8, labels = sprintf(\u0026#34;AUC = %.5f\u0026#34;,rocobj$auc))} roc()\nroc() å‡½æ•°æ˜¯ pROC åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè®¡ç®—æ¥æ”¶è€…æ“ä½œç‰¹å¾ï¼ˆReceiver Operating Characteristicï¼ŒROCï¼‰æ›²çº¿ä»¥åŠè®¡ç®—æ›²çº¿ä¸‹é¢ç§¯ï¼ˆArea Under the Curveï¼ŒAUCï¼‰ã€‚ROC æ›²çº¿æ˜¯ä¸€ç§ç”¨äºè¯„ä¼°äºŒå…ƒåˆ†ç±»å™¨æ€§èƒ½çš„å›¾å½¢å·¥å…·ï¼Œå®ƒæ˜¾ç¤ºäº†åœ¨ä¸åŒåˆ†ç±»é˜ˆå€¼ä¸‹çœŸæ­£ä¾‹ç‡ï¼ˆTrue Positive Rateï¼ŒTPRï¼Œåˆç§°ä¸ºçµæ•åº¦ï¼‰ä¸å‡æ­£ä¾‹ç‡ï¼ˆFalse Positive Rateï¼ŒFPRï¼‰ä¹‹é—´çš„å…³ç³»ã€‚ {% asset_image week4_plot.png %}\nFinally, we predict new probabilities under a hypothetical scenario that everyoneâ€™s Monetary variable went up by one unit.\n$$ V_{\\text{new}} = \\beta_0 + \\beta_1 \\text{Recency} + \\beta_2 \\text{Frequency} + \\beta_3 (\\text{Monetary} + 1) $$ 1 2 3 4 5 6 \u0026gt; # calculate new logit probabilities (Monetary+1) \u0026gt; RFMdata_new \u0026lt;- RFMdata \u0026gt; RFMdata_new$Monetary \u0026lt;- RFMdata_new$Monetary + 1 \u0026gt; RFMdata$New.Probability \u0026lt;- predict(model, RFMdata_new, type=\u0026#34;response\u0026#34;) We compare mean new probability across individuals to the mean of old probabilities, and also calculate the lift metric.\næˆ‘ä»¬æ¯”è¾ƒå„ä¸ªä¸ªä½“çš„æ–°æ¦‚ç‡å‡å€¼ä¸æ—§æ¦‚ç‡å‡å€¼ï¼Œå¹¶è®¡ç®—æå‡åº¦é‡ã€‚\n$$ P(Purchase_i) = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{\\exp(V_{bi})}{\\exp(V_{bi}) + 1} $$$$ P(Purchase_{\\text{new}}) = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{\\exp(V_{\\text{new}})}{\\exp(V_{\\text{new}}) + 1} $$$$ \\text{Lift} = \\frac{p_{\\text{new}} - p_{\\text{old}}}{p_{\\text{old}}} $$ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026gt; # mean predicted base probability \u0026gt; mean(RFMdata$Base.Probability) [1] 0.45 \u0026gt; # mean new predicted probability \u0026gt; mean(RFMdata$New.Probability) [1] 0.4578851 \u0026gt; # lift \u0026gt; (mean(RFMdata$New.Probability) - mean(RFMdata$Base.Probability))/mean(RFMdata$Base.Probability) [1] 0.01752255 \u0026gt; # remove predicted purchase variable \u0026gt; RFMdata$Predicted.Purchase \u0026lt;- NULL \u0026gt; # data \u0026gt; kable(head(RFMdata,5),row.names = TRUE) | | Recency| Frequency| Monetary| Purchase| Base.Probability| New.Probability| |:--|-------:|---------:|--------:|--------:|----------------:|---------------:| |1 | 120| 7| 41.66| 0| 0.0030728| 0.0036319| |2 | 90| 9| 46.71| 0| 0.0008332| 0.0009852| |3 | 120| 6| 103.99| 1| 0.9833225| 0.9858611| |4 | 270| 17| 37.13| 1| 0.9999999| 0.9999999| |5 | 60| 5| 88.92| 0| 0.0032378| 0.0038267| 4. Recap â€¢ Logistic regression is a powerful method and a particularly good fit for many marketing problems with binary outcomes. We will cover the choice model later for modelling product choice among sets of alternatives.\nâ€¢ Logistic regression relates a binary outcome such as purchase to predictors that may include continuous and factor variable by modelling the variableâ€™s association with the probability of the outcome.\nAlthough we performed logistic regression here with categorical predictors (factor variables) due to the structure of the amusement park sales data, we could also use continuous predictors in glm(). Just add those to the right-hand side of the model formula as we did with lm()\nâ€¢ A logistic regression model, also known as a logit model, is a member of the generalized linear model family and is fit using glm( , family = binomial).\nâ€¢ Coefficient in a logit model can be interpreted in terms of odds ratios, the degree to which they are associated with the increased or decreased likelihood of an outcome. This is done simply by exponentiating the coefficients with exp().\nâ€¢ A statistically significant result does not always mean that the model is appropriate. It is important to explore data thoroughly and construct models on the basis of careful consideration.\nWe saw that the estimated effect of promotion was positive when we estimated one model yet negative when we estimated another. This shows that it is crucial to explore data thoroughly before modelling or interpreting a model. For most marketing data, no model is ever definitive. However, through careful data exploration and consideration of multiple models, we may increase our confidence in our models and the inferences drawn from them.\nâ€¢ é€»è¾‘å›å½’æ˜¯ä¸€ç§å¼ºå¤§çš„æ–¹æ³•ï¼Œç‰¹åˆ«é€‚ç”¨äºè®¸å¤šå…·æœ‰äºŒå…ƒç»“æœçš„è¥é”€é—®é¢˜ã€‚æˆ‘ä»¬ç¨åå°†ä»‹ç»é€‰æ‹©æ¨¡å‹ï¼Œç”¨äºå¯¹ä¸€ç»„æ›¿ä»£å“ä¸­çš„äº§å“é€‰æ‹©è¿›è¡Œå»ºæ¨¡ã€‚\nâ€¢ é€»è¾‘å›å½’å°†äºŒå…ƒç»“æœï¼ˆå¦‚è´­ä¹°ï¼‰ä¸å¯èƒ½åŒ…æ‹¬è¿ç»­å’Œå› å­å˜é‡çš„é¢„æµ‹å˜é‡å…³è”èµ·æ¥ï¼Œæ–¹æ³•æ˜¯é€šè¿‡æ¨¡æ‹Ÿå˜é‡ä¸ç»“æœçš„æ¦‚ç‡ä¹‹é—´çš„å…³è”ã€‚\nå°½ç®¡æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨äº†å› å­å˜é‡ï¼ˆåˆ†ç±»å˜é‡ï¼‰æ‰§è¡Œé€»è¾‘å›å½’ï¼Œå› ä¸ºå¨±ä¹å›­é”€å”®æ•°æ®çš„ç»“æ„å¦‚æ­¤ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨glm()ä¸­ä½¿ç”¨è¿ç»­é¢„æµ‹å˜é‡ã€‚åªéœ€åƒæˆ‘ä»¬åœ¨lm()ä¸­é‚£æ ·å°†å®ƒä»¬æ·»åŠ åˆ°æ¨¡å‹å…¬å¼çš„å³ä¾§å³å¯ã€‚\nâ€¢ é€»è¾‘å›å½’æ¨¡å‹ï¼Œä¹Ÿç§°ä¸ºlogitæ¨¡å‹ï¼Œæ˜¯å¹¿ä¹‰çº¿æ€§æ¨¡å‹å®¶æ—çš„ä¸€å‘˜ï¼Œä½¿ç”¨glm()æ‹Ÿåˆï¼Œå®¶æ—è®¾ç½®ä¸ºbinomialã€‚\nâ€¢ åœ¨logitæ¨¡å‹ä¸­ï¼Œç³»æ•°å¯ä»¥é€šè¿‡å°†å…¶æŒ‡æ•°åŒ–ä¸ºexp()æ¥è§£é‡Šä¸ºå‡ ç‡æ¯”ï¼Œå³å®ƒä»¬ä¸ç»“æœçš„å¢åŠ æˆ–å‡å°‘å¯èƒ½æ€§çš„ç›¸å…³ç¨‹åº¦ã€‚\nâ€¢ ç»Ÿè®¡æ˜¾è‘—ç»“æœå¹¶ä¸æ€»æ„å‘³ç€æ¨¡å‹æ˜¯é€‚å½“çš„ã€‚åœ¨å»ºæ¨¡æˆ–è§£é‡Šæ¨¡å‹ä¹‹å‰ï¼Œå½»åº•æ¢ç´¢æ•°æ®å¹¶åŸºäºæ·±æ€ç†Ÿè™‘æ„å»ºæ¨¡å‹æ˜¯éå¸¸é‡è¦çš„ã€‚\næˆ‘ä»¬çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ä¼°è®¡ä¸€ä¸ªæ¨¡å‹æ—¶ï¼Œä¿ƒé”€çš„ä¼°è®¡æ•ˆæœæ˜¯æ­£å‘çš„ï¼Œä½†å½“æˆ‘ä»¬ä¼°è®¡å¦ä¸€ä¸ªæ¨¡å‹æ—¶ï¼Œæ•ˆæœæ˜¯è´Ÿå‘çš„ã€‚è¿™è¡¨æ˜ï¼Œåœ¨å»ºæ¨¡æˆ–è§£é‡Šæ¨¡å‹ä¹‹å‰ï¼Œå½»åº•æ¢ç´¢æ•°æ®æ˜¯è‡³å…³é‡è¦çš„ã€‚å¯¹äºå¤§å¤šæ•°è¥é”€æ•°æ®ï¼Œæ²¡æœ‰ä¸€ä¸ªæ¨¡å‹æ˜¯ç»å¯¹çš„ã€‚ç„¶è€Œï¼Œé€šè¿‡å¯¹æ•°æ®è¿›è¡Œæ·±å…¥æ¢ç´¢å¹¶è€ƒè™‘å¤šä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¢åŠ å¯¹æ¨¡å‹åŠå…¶æ¨æ–­çš„ä¿¡å¿ƒã€‚\n","date":"2024-03-25T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek4-choice-model-code/","title":"R[week4] Choice model code"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\näº†è§£ä¸ºä»€ä¹ˆæœ‰æ•ˆçš„è¥é”€ç­–ç•¥å¿…é¡»ç®¡ç†å®¢æˆ·åŠ¨æ€ï¼šè¿™éƒ¨åˆ†å¼ºè°ƒäº†ç®¡ç†å®¢æˆ·åŠ¨æ€å¯¹äºå®ç°æœ‰æ•ˆè¥é”€ç­–ç•¥çš„é‡è¦æ€§ã€‚ æ‰¹åˆ¤æ€§åœ°è§£é‡Šç®¡ç†å®¢æˆ·åŠ¨æ€çš„ä¸»è¦æ–¹æ³•ï¼šè¿™éƒ¨åˆ†è¯¦ç»†è§£é‡Šäº†ä¸¤ç§ä¸»è¦æ–¹æ³•ï¼Œå³åŠ¨æ€å®¢æˆ·ç»†åˆ†æ–¹æ³•å’Œå®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼æ–¹æ³•ã€‚åŠ¨æ€å®¢æˆ·ç»†åˆ†æ–¹æ³•æŒ‡çš„æ˜¯å°†å®¢æˆ·æŒ‰ç…§ä¸åŒçš„åŠ¨æ€ç‰¹å¾è¿›è¡Œåˆ†ç±»ï¼Œä»¥ä¾¿æ›´å¥½åœ°æ»¡è¶³å…¶éœ€æ±‚ã€‚å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼æ–¹æ³•åˆ™æ˜¯é€šè¿‡åˆ†æå®¢æˆ·åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…çš„ä»·å€¼æ¥æŒ‡å¯¼è¥é”€ç­–ç•¥ã€‚ ä½¿ç”¨åˆ†æå·¥å…·ï¼šè¿™éƒ¨åˆ†æåˆ°äº†ä½¿ç”¨é€‰æ‹©æ¨¡å‹å’Œå®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼åˆ†æç­‰åˆ†æå·¥å…·æ¥æ”¯æŒä¸Šè¿°æ–¹æ³•çš„å®æ–½ã€‚ 1. Customer Dynamics å®¢æˆ·å¯¹å¤§å¤šæ•°äº§å“å’ŒæœåŠ¡çš„éœ€æ±‚éšæ—¶é—´å˜åŒ–æˆ–ç”±äºç‰¹å®šäº‹ä»¶è€Œå˜åŒ–ã€‚\nå®¢æˆ·åå¥½éšæ—¶é—´å˜åŒ–ï¼šå› ä¸ºä¸ªä½“æ¶ˆè´¹è€…çš„éœ€æ±‚éšç€å¹´é¾„ã€ç»éªŒæˆ–ç‰¹å®šäº‹ä»¶è€Œæ”¹å˜ï¼Œä¹Ÿå¯èƒ½æ˜¯å› ä¸ºå®¢æˆ·æ‰€å¤„çš„è¡Œä¸šæˆ–å¸‚åœºéšç€æ—¶é—´çš„æ¨ç§»å‘ç”Ÿäº†å˜åŒ–ã€‚ å®¢æˆ·çš„éœ€æ±‚å˜åŒ–ä¸ä»…æ˜¯ç”±äºäººä»¬ä¹‹é—´çš„å›ºæœ‰å·®å¼‚ï¼šè¿˜ç”±äºäººä»¬å’Œå¸‚åœºçš„å˜åŒ–è€Œå¼•èµ·ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å®¢æˆ·çš„æ—¶é—´ä¾èµ–æ€§éœ€æ±‚ï¼Œè€Œä¸æ˜¯ä»…ä»…åŸºäºâ€œé€šç”¨â€éœ€æ±‚å¯¹æ‰€æœ‰å®¢æˆ·è¿›è¡Œâ€œé™æ€â€çš„ç»†åˆ†ã€‚ å› æ­¤ï¼Œå®¢æˆ·åŠ¨æ€æ˜¯æ‰€æœ‰ä¼ä¸šåœ¨åˆ¶å®šæœ‰æ•ˆè¥é”€ç­–ç•¥æ—¶å¿…é¡»è§£å†³çš„åŸºæœ¬â€œé—®é¢˜â€ã€‚å®¢æˆ·ä¼šå‘ç”Ÿå˜åŒ–ï¼›å¦‚æœä¸èƒ½ç†è§£å’Œè§£å†³è¿™äº›åŠ¨æ€ï¼Œå°±ä¼šå¯¼è‡´ä¸šåŠ¡ç»©æ•ˆä¸ä½³ã€‚\n1.1 ç”Ÿå‘½å‘¨æœŸæ–¹æ³• ä½¿ç”¨é€šç”¨çš„å®¢æˆ·æˆé•¿é˜¶æ®µåŠå…¶åœ¨ç”Ÿå‘½å‘¨æœŸä¸­çš„ä½ç½®æ¥ç¡®å®šå®¢æˆ·åå¥½å’Œç›¸å…³ç­–ç•¥ã€‚\nCustomer lifecycle Product lifecycle Industry lifecycle ä¼˜ç‚¹ï¼š\nç®€å•æ˜“æ‡‚ï¼šå°†æ‰€æœ‰å®¢æˆ·éƒ½è§†ä¸ºéµå¾ªåŒä¸€æ›²çº¿ã€‚ æ˜“äºä½¿ç”¨ï¼šå¯¹æ‰€æœ‰å®¢æˆ·è¿›è¡Œå¹³å‡å¤„ç†ã€‚ ä½¿ç”¨é€šç”¨çš„å®¢æˆ·ç”Ÿå‘½å‘¨æœŸé˜¶æ®µåŠå…¶åœ¨ç”Ÿå‘½å‘¨æœŸä¸­çš„ä½ç½®æ¥ç¡®å®šå®¢æˆ·åå¥½å’Œç›¸å…³ç­–ç•¥ã€‚ ç¼ºç‚¹ï¼š\nå¿½ç•¥å®¢æˆ·åŠ¨æ€çš„åŸå› ã€‚ ä»…é€‚ç”¨äºä»¥ç¦»æ•£é˜¶æ®µè¿›è¡Œåˆ’åˆ†çš„æƒ…å†µï¼Œä¸é€‚ç”¨äºè¿ç»­å˜åŒ–çš„æƒ…å†µã€‚ 1.2 åŠ¨æ€å®¢æˆ·ç»†åˆ† æ ¹æ®å®¢æˆ·ç±»ä¼¼çš„è·å–ã€æ‹“å±•å’Œä¿ç•™é˜¶æ®µå¯¹å…¬å¸ç°æœ‰å®¢æˆ·è¿›è¡Œåˆ†æ®µã€‚\né€‰æ‹©æ¨¡å‹å¯ä»¥åœ¨æ‰€æœ‰è·å–ã€æ‹“å±•å’Œä¿ç•™é˜¶æ®µè¿›è¡Œåˆ†æï¼Œå› ä¸ºå®ƒé¢„æµ‹äº†è§‚å¯Ÿåˆ°çš„å®¢æˆ·é€‰æ‹©çš„å¯èƒ½æ€§ã€‚ ä¼˜ç‚¹ï¼š\nç»“åˆäº†ç”Ÿå‘½å‘¨æœŸå’Œç»†åˆ†æ–¹æ³•ã€‚ ç¬¦åˆæˆ˜ç•¥è¥é”€æ€ç»´ã€‚ å°†æŒç»­å˜åŒ–è½¬åŒ–ä¸ºç¦»æ•£é˜¶æ®µã€‚ ç¼ºç‚¹ï¼š\nç»†åˆ†å¯èƒ½ä¸æ˜¯å®Œå…¨åŒè´¨çš„ã€‚ æ— æ³•ç²¾ç¡®åŒ¹é…æ‰€æœ‰å®¢æˆ·çš„ç‰¹ç‚¹ã€‚ 1.3 å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ æ•æ‰å®¢æˆ·æ ¹æ®å…¶é¢„æœŸè¿ç§»è·¯å¾„åœ¨æ•´ä¸ªä¸å…¬å¸çš„ç”Ÿå‘½å‘¨æœŸä¸­çš„è´¡çŒ®ã€‚\nå®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ï¼ˆCLVï¼‰åˆ†æä½¿ç”¨æŠ˜ç°ç°é‡‘æµï¼Œå¹¶æä¾›æ‰€æœ‰ä¿¡æ¯ä»¥åšå‡ºæœ€ä½³çš„è·å–ã€æ‹“å±•å’Œä¿ç•™å†³ç­–ã€‚ ä¼˜ç‚¹ï¼š\nä¸ºAERï¼ˆAcquisition-Expansion-Retentionï¼‰å†³ç­–æä¾›æ´å¯Ÿã€‚ æ”¯æŒå®¢æˆ·ä¸ºä¸­å¿ƒçš„æ–‡åŒ–ã€‚ æ•æ‰äº†å®¢æˆ·æ ¹æ®å…¶é¢„æœŸè¿ç§»è·¯å¾„åœ¨ä¸ä¼ä¸šçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­çš„è´¡çŒ®ã€‚ ç¼ºç‚¹ï¼š\néœ€è¦å¯¹æœªæ¥è¿ç§»æœ‰æ·±å…¥çš„äº†è§£ã€‚ éœ€è¦è¯¦ç»†çš„è´¢åŠ¡æ•°æ®ã€‚ å¿½ç•¥äº†åŠ¨æ€å’Œå¼‚è´¨æ€§ã€‚ 2. Choice Model Choice Model è¯•å›¾ç¡®å®šä¸åŒå› ç´ ï¼ˆä»·æ ¼ã€ä¿ƒé”€ï¼‰å¯¹æ¶ˆè´¹è€…ä¸ªä½“é€‰æ‹©ï¼ˆåŠ å…¥ã€äº¤å‰è´­ä¹°ã€ç¦»å¼€ï¼‰çš„å½±å“ã€‚å®ƒæ˜¯æœ€æµè¡Œçš„ä¸ªä½“çº§å“åº”æ¨¡å‹ã€‚\nè¾“å…¥ï¼š ä½¿ç”¨è¿‡å»è¥é”€è¡ŒåŠ¨å’Œä¸å®é™…å®¢æˆ·å“åº”ï¼ˆé€‰æ‹©ï¼‰ç›¸å…³è”çš„äººå£ç»Ÿè®¡æ•°æ®çš„æ•°æ®åº“ã€‚ ä½¿ç”¨è¿‡å»çš„è¡Œä¸ºæ•°æ®ï¼›æ— éœ€è°ƒæŸ¥æˆ–è·å–å®¢æˆ·è¾“å…¥ï¼ˆä»è¿‡å»å®¢æˆ·çš„è¡Œä¸ºæ¨æ–­æƒé‡ï¼‰ã€‚ è¾“å‡º æ¯ä¸ªè¾“å…¥å˜é‡å¯¹ç»“æœçš„ç³»æ•°ä¼°è®¡ï¼ˆä¾‹å¦‚ï¼Œå¹´é¾„ã€å­å¥³ã€ä¿¡ç”¨å’Œç›´é‚®å¯¹é€‰æ‹©çš„å½±å“ï¼‰ å®¢æˆ·é€‰æ‹©çš„æ¦‚ç‡ï¼ˆå‡çº§é”€å”®ã€ä¿ç•™çš„æ¦‚ç‡ï¼Œå¹¶å¯é’ˆå¯¹è·å–ç›®æ ‡è¿è¡Œåˆ—è¡¨ï¼‰\nâ€¢ å› å˜é‡ï¼š è´­ä¹°ï¼ˆæ˜¯/å¦ï¼‰ 2.1 Generalised linear models (GLM) å¹¿ä¹‰çº¿æ€§æ¨¡å‹ æ˜¯ä¸€ç§ç»Ÿè®¡æ¨¡å‹ï¼Œå¯ä»¥ç”¨äºåˆ†æå…·æœ‰éæ­£æ€è¯¯å·®ç»“æ„çš„æ•°æ®ï¼Œä¾‹å¦‚äºŒé¡¹åˆ†å¸ƒã€æ³Šæ¾åˆ†å¸ƒç­‰ã€‚GLM æ˜¯çº¿æ€§æ¨¡å‹çš„ä¸€ç§æ‰©å±•ï¼Œå®ƒå…è®¸å› å˜é‡å’Œè‡ªå˜é‡ä¹‹é—´çš„å…³ç³»ä¸æ˜¯çº¿æ€§çš„ï¼ŒåŒæ—¶ä¹Ÿä¸è¦æ±‚å› å˜é‡æœä»æ­£æ€åˆ†å¸ƒã€‚\nLinear regressionï¼šçº¿æ€§å›å½’ï¼Œæ˜¯ä¸€ç§ç”¨äºå»ºç«‹å› å˜é‡å’Œä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå˜é‡ä¹‹é—´çš„çº¿æ€§å…³ç³»çš„ç»Ÿè®¡æ–¹æ³•ã€‚å®ƒå‡è®¾å› å˜é‡å’Œè‡ªå˜é‡ä¹‹é—´çš„å…³ç³»æ˜¯çº¿æ€§çš„ï¼Œå¹¶å°è¯•æ‹Ÿåˆä¸€æ¡ç›´çº¿æ¥æè¿°è¿™ç§å…³ç³»ã€‚\nLogistic regressionï¼šé€»è¾‘å›å½’ï¼Œæ˜¯ä¸€ç§ç”¨äºå»ºç«‹å› å˜é‡ä¸ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå˜é‡ä¹‹é—´çš„éçº¿æ€§å…³ç³»çš„ç»Ÿè®¡æ–¹æ³•ã€‚é€»è¾‘å›å½’ç”¨äºåˆ†æå› å˜é‡æ˜¯äºŒå…ƒå˜é‡çš„æƒ…å†µï¼Œå®ƒé€šè¿‡å°†çº¿æ€§å›å½’æ¨¡å‹çš„ç»“æœè½¬æ¢æˆæ¦‚ç‡æ¥è¿›è¡Œåˆ†ç±»ã€‚\nMultinomial logistic regressionï¼šå¤šé¡¹å¼é€»è¾‘å›å½’ï¼Œæ˜¯é€»è¾‘å›å½’çš„ä¸€ç§æ‰©å±•ï¼Œé€‚ç”¨äºå› å˜é‡æœ‰å¤šä¸ªç±»åˆ«çš„æƒ…å†µã€‚ä¸äºŒå…ƒé€»è¾‘å›å½’ä¸åŒï¼Œå¤šé¡¹å¼é€»è¾‘å›å½’å¯ä»¥å¤„ç†å¤šç±»åˆ«çš„å› å˜é‡ï¼Œå¹¶æä¾›å„ç±»åˆ«çš„æ¦‚ç‡ã€‚\n2.2 Binary choice: logistic regression Response to marketing effortsï¼šè¥é”€æ´»åŠ¨çš„ååº”ã€‚æŒ‡å®¢æˆ·åœ¨æ¥æ”¶åˆ°è¥é”€æ´»åŠ¨åçš„ååº”ï¼Œæ¯”å¦‚ä½¿ç”¨ä¼˜æƒ åˆ¸æˆ–ç”µå­é‚®ä»¶å¹¿å‘Šåæ˜¯å¦è´­ä¹°äº†äº§å“ã€‚\nDid the customer buy after being sent a coupon or an email ad?ï¼šå®¢æˆ·åœ¨æ”¶åˆ°ä¼˜æƒ åˆ¸æˆ–ç”µå­é‚®ä»¶å¹¿å‘Šåæ˜¯å¦è´­ä¹°äº†äº§å“ã€‚ Online/Catalogue purchase (Buy/No-Buy)ï¼šåœ¨çº¿æˆ–ç›®å½•è´­ä¹°ã€‚æŒ‡å®¢æˆ·åœ¨ç½‘ä¸Šæˆ–é€šè¿‡ç›®å½•è´­ä¹°äº§å“çš„è¡Œä¸ºï¼Œä»¥åŠæ˜¯å¦è´­ä¹°äº†äº§å“ã€‚\nRecency, Frequency, Monetary value (RFM) measures as predictors of purchaseï¼šæœ€è¿‘è´­ä¹°æ—¶é—´ã€è´­ä¹°é¢‘ç‡å’Œè´­ä¹°é‡‘é¢ï¼ˆRFMï¼‰ä½œä¸ºè´­ä¹°é¢„æµ‹çš„æŒ‡æ ‡ã€‚è¿™äº›æ˜¯ç”¨æ¥é¢„æµ‹å®¢æˆ·æ˜¯å¦ä¼šè´­ä¹°äº§å“çš„æŒ‡æ ‡ã€‚ Spend = áµ1Frequency + Î²0ï¼šè¿™æ˜¯çº¿æ€§å›å½’æ¨¡å‹çš„è¡¨è¾¾å¼ï¼Œå…¶ä¸­Spendæ˜¯å› å˜é‡ï¼ˆè¦é¢„æµ‹çš„å˜é‡ï¼‰ï¼ŒFrequencyæ˜¯è‡ªå˜é‡ï¼ˆç”¨æ¥é¢„æµ‹çš„å˜é‡ï¼‰ï¼Œáµ1æ˜¯Frequencyçš„ç³»æ•°ï¼ˆä¹Ÿç§°ä¸ºæ–œç‡ï¼‰ï¼ŒÎ²0æ˜¯æˆªè·ã€‚\nThe line slope: the effect of frequency on money spendï¼šçº¿çš„æ–œç‡è¡¨ç¤ºFrequencyå¯¹èŠ±è´¹çš„å½±å“ï¼Œå³æ¯å•ä½Frequencyçš„å˜åŒ–å¯¼è‡´èŠ±è´¹çš„å˜åŒ–é‡ã€‚\nThe intercept: the money spend when frequency is 0ï¼šæˆªè·è¡¨ç¤ºå½“Frequencyä¸º0æ—¶çš„èŠ±è´¹ï¼Œå³åœ¨Frequencyä¸º0æ—¶çš„åŸºç¡€èŠ±è´¹ã€‚\nLinear regression uses the data to estimate áµ1 and áµ0ï¼šçº¿æ€§å›å½’ä½¿ç”¨æ•°æ®æ¥ä¼°è®¡áµ1å’Œáµ0ã€‚\nSpend = 0.5 Frequency + 0.6ï¼šè¿™æ˜¯ä¸€ä¸ªçº¿æ€§å›å½’æ¨¡å‹çš„å…·ä½“ç¤ºä¾‹ï¼Œå…¶ä¸­æ–œç‡ä¸º0.5ï¼Œæˆªè·ä¸º0.6ã€‚\nThen using this regression model, we can predict the money spend given a frequencyï¼šç„¶åï¼Œä½¿ç”¨è¿™ä¸ªå›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç»™å®šçš„é¢‘ç‡æ¥é¢„æµ‹èŠ±è´¹ã€‚\n2.2.1 å…¬å¼ oddï¼šè´­ä¹°æ¦‚ç‡ / ä¸è´­ä¹°çš„æ¦‚ç‡ $$ \\text{odds} = \\frac{Probability of purchase}{Probability of no-purchase} = \\frac{p}{1-p} $$ qlogis() $$ \\log (\\frac{p}{1-p}) = \\log(\\text{odds}) $$ p(plogis)ï¼šè´­ä¹°æ¦‚ç‡ $$ p = \\frac{e^{\\log(\\text{odds})}}{1 + e^{\\log(\\text{odds})}} $$ odd / p è½¬æ¢ $$ p = \\beta_1 \\text{frequency} + \\beta_0 $$ $$ \\log(\\text{odds}) = \\beta_1 \\text{frequency} + \\beta_0 $$2.2.2 Odds and Choice Probability Utility\n$$ V_b = \\log(\\frac{p}{1-p}) $$ Odds\n$$ \\text{odds} = \\exp(V_b) = \\frac{p}{1-p} $$ Probability\n$$ p = \\frac{\\exp(V_b)}{\\exp(V_b) + 1} $$$$ Utility from not buying: V_n = 0 $$$$ Odds of buying: \\exp(2) = e^2 = 7.39 $$$$ Odds of not buying: \\exp(0) = 1 $$$$ Probability of buying: p = \\frac{\\exp(2)}{\\exp(2) + 1} = \\frac{7.39}{7.39 + 1} = \\frac{7.39}{8.39} = 0.88 $$ æ¨¡å‹è¡¨æ˜ï¼Œæ¶ˆè´¹è€…å¯¹è´­ä¹°å’Œä¸è´­ä¹°ï¼ˆä¿ç•™é’±ï¼‰éƒ½æœ‰ä¸€å®šçš„æ•ˆç”¨ï¼š\nè´­ä¹°çš„æ•ˆç”¨ï¼š$V_b$ ä¸è´­ä¹°çš„æ•ˆç”¨ï¼š$V_n=0$ å¦‚æœ$V_b \u0026gt; V_n=0$ï¼Œæ¶ˆè´¹è€…å°±ä¼šè´­ä¹°ã€‚ å¯¹äºRFMæ•°æ®ï¼Œè´­ä¹°çš„æ•ˆç”¨å› RFMå˜é‡è€Œå¼‚ï¼š\n$V_b = \\beta_0 + \\beta_1 \\text{Recency} + \\beta_2 \\text{Frequency} + \\beta_3 \\text{Monetary}$ Logisticå›å½’ä½¿ç”¨æ•°æ®æ¥ä¼°è®¡æ¨¡å‹å‚æ•°ï¼ˆÎ²ç³»æ•°ï¼‰ã€‚\n3. Example 3.1 æ•°æ® å› å˜é‡ï¼š\nè´­ä¹°ï¼ˆæ˜¯/å¦ï¼‰ è§£é‡Šå˜é‡ï¼š\næœ€è¿‘è´­ä¹°è·ä»Šå¤šå°‘å¤© æ¶ˆè´¹è€…è´­ä¹°æ¬¡æ•° æ€»è´­ä¹°é‡‘é¢ {% asset_image week4_lec_1.png %}\n3.2 logistic output {% asset_image week4_lec_2.png %}\nRedis.Dfï¼šé‡æ–°å‚æ•°åŒ–çš„è‡ªç”±åº¦ï¼Œè¡¨ç¤ºæ¨¡å‹ä¸­å‚æ•°çš„æ•°é‡ã€‚ Redis.Devï¼šé‡æ–°å‚æ•°åŒ–çš„åå·®ï¼Œè¡¨ç¤ºæ¨¡å‹ä¸è§‚å¯Ÿæ•°æ®ä¹‹é—´çš„åå·®åº¦é‡ã€‚ Df Devianceï¼šåå·®çš„è‡ªç”±åº¦ï¼Œè¡¨ç¤ºæ¨¡å‹å¯¹è§‚å¯Ÿæ•°æ®çš„æ‹Ÿåˆç¨‹åº¦ã€‚ Pr(\u0026gt;Chi)ï¼šå¡æ–¹æ£€éªŒçš„på€¼ï¼Œç”¨äºæ£€éªŒæ¨¡å‹çš„æ‹Ÿåˆä¼˜åº¦ã€‚å®ƒè¡¨ç¤ºç»™å®šå‡è®¾æ¡ä»¶ä¸‹ï¼Œè§‚å¯Ÿåˆ°çš„åå·®å’ŒæœŸæœ›åå·®ä¹‹é—´çš„å·®å¼‚ç¨‹åº¦ï¼Œä»è€Œåˆ¤æ–­- æ¨¡å‹æ˜¯å¦å¯¹è§‚å¯Ÿæ•°æ®æ‹Ÿåˆè‰¯å¥½ã€‚é€šå¸¸ï¼Œpå€¼è¶Šå°ï¼Œè¡¨ç¤ºæ¨¡å‹æ‹Ÿåˆå¾—è¶Šå¥½ã€‚ {% asset_image week4_lec_3.png %}\ninterceptï¼šåœ¨å›å½’åˆ†æä¸­ï¼Œæ‹Ÿåˆçš„æ¨¡å‹é€šå¸¸åŒ…æ‹¬æˆªè·é¡¹(intercept)ï¼Œå®ƒä»£è¡¨äº†åœ¨æ‰€æœ‰è‡ªå˜é‡éƒ½ä¸ºé›¶æ—¶ï¼Œå› å˜é‡çš„é¢„æœŸå€¼ã€‚è¿™æ˜¯æ¨¡å‹ä¸­çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œå®ƒç¡®ä¿äº†æ¨¡å‹çš„çµæ´»æ€§ï¼Œå¹¶ä½¿æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°æ‹Ÿåˆæ•°æ®ã€‚åœ¨å›å½’ç»“æœçš„è¾“å‡ºä¸­ï¼Œ\u0026quot;(intercept)\u0026ldquo;è¡¨ç¤ºæˆªè·é¡¹çš„ä¼°è®¡å€¼å’Œç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ betaï¼šæ¨¡å‹å‚æ•°çš„ä¼°è®¡å€¼ï¼Œè¡¨ç¤ºè‡ªå˜é‡å¯¹å› å˜é‡çš„å½±å“ç¨‹åº¦ã€‚ SEï¼šæ ‡å‡†è¯¯å·®ï¼Œè¡¨ç¤ºä¼°è®¡çš„å‚æ•°å€¼ä¸çœŸå®å‚æ•°å€¼ä¹‹é—´çš„å·®å¼‚çš„æ ‡å‡†åå·®ã€‚å®ƒè¡¡é‡äº†ä¼°è®¡å‚æ•°çš„ä¸ç¡®å®šæ€§ã€‚ z val.ï¼šzå€¼ï¼Œè¡¨ç¤ºæ¨¡å‹å‚æ•°ä¼°è®¡å€¼ä¸é›¶å‡è®¾ä¹‹é—´çš„åå·®é‡ï¼ˆä»¥æ ‡å‡†è¯¯å·®ä¸ºå•ä½ï¼‰ã€‚zå€¼è¶Šå¤§ï¼Œè¡¨ç¤ºå‚æ•°ä¼°è®¡å€¼ä¸é›¶å‡è®¾ä¹‹é—´çš„åå·®è¶Šå¤§ã€‚ Pr(\u0026gt;|z|)ï¼šzæ£€éªŒçš„på€¼ï¼Œç”¨äºæ£€éªŒæ¨¡å‹å‚æ•°çš„æ˜¾è‘—æ€§ã€‚å®ƒè¡¨ç¤ºæ¨¡å‹å‚æ•°æ˜¯å¦æ˜¾è‘—ä¸åŒäºé›¶å‡è®¾ã€‚é€šå¸¸ï¼Œpå€¼å°äº0.05è¢«è®¤ä¸ºæ˜¯ç»Ÿè®¡ä¸Šæ˜¾è‘—çš„ã€‚ exp(beta)ï¼šå‚æ•°çš„æŒ‡æ•°ï¼Œè¡¨ç¤ºè‡ªå˜é‡å•ä½å˜åŒ–å¯¹å› å˜é‡çš„å½±å“çš„å€æ•°ã€‚é€šå¸¸ç”¨äºè§£é‡Šæ¨¡å‹ä¸­çš„è‡ªå˜é‡å¯¹å› å˜é‡çš„å½±å“ç¨‹åº¦ã€‚ æ›´ä¸€èˆ¬åœ°ï¼Œæ¯å¢åŠ 1ç¾å…ƒçš„è´­ä¹°é‡‘é¢ï¼Œè´­ä¹°çš„å‡ ç‡ä¼šå¢åŠ 1.183å€ã€‚\nè€ƒè™‘ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼ˆ1å’Œ2ï¼‰ï¼Œä»–ä»¬çš„æœ€è¿‘è´­ä¹°è·ä»Šå¤šå°‘å¤©å’Œè´­ä¹°æ¬¡æ•°ç›¸åŒï¼Œä½†æ¶ˆè´¹è€…1æ¯”æ¶ˆè´¹è€…2çš„è´­ä¹°é‡‘é¢å¤š1ç¾å…ƒã€‚\né‚£ä¹ˆï¼Œæ¶ˆè´¹è€…1è´­ä¹°çš„å‡ ç‡å°†æ¯”æ¶ˆè´¹è€…2è´­ä¹°çš„å‡ ç‡é«˜å‡º1.183å€ã€‚ åœ¨ RFM æ•°æ®ä¸­ä¼°è®¡çš„æ•ˆç”¨å‡½æ•°ä¸ºï¼š $$ V = -30.29 + 0.111 \\times \\text{Recency} + 0.594 \\times \\text{Frequency} + 0.168 \\times \\text{Monetary} $$ é¢„æµ‹è´­ä¹°æ¦‚ç‡ä¸ºï¼š $$ p = \\frac{\\exp(V)}{\\exp(V) + 1} $$ 3.3 Lift Calculation å¢åŠ 1ç¾å…ƒè´­ä¹°é‡‘é¢å¯¹è´­ä¹°æ¦‚ç‡çš„å½±å“ï¼š è®¡ç®—è´­ä¹°æ–°çš„æ•ˆç”¨å€¼ï¼š $$ V_{\\text{new}} = -30.29 + 0.111 \\times \\text{Recency} + 0.594 \\times \\text{Frequency} + 0.168 \\times (\\text{Monetary} + 1) $$ è®¡ç®—æ–°çš„è´­ä¹°æ¦‚ç‡ï¼š $$ p_{\\text{new}} = \\frac{\\exp(V_{\\text{new}})}{\\exp(V_{\\text{new}}) + 1} $$ æå‡ï¼š $$ \\text{Lift}_{\\text{new}} = \\frac{\\exp(V_{\\text{new}})}{\\exp(V_{\\text{base}}) + 1} - p_{\\text{base}} $$ å…¶ä¸­ï¼Œ$ p_{\\text{base}} $ æ˜¯åŸºå‡†è´­ä¹°æ¦‚ç‡ã€‚ {% asset_image week4_lec_4.png %}\n3.4 Classification {% asset_image week4_lec_5.png %}\n3.5 Classification (Hit Rate) {% asset_image week4_lec_6.png %}\nå‡†ç¡®ç‡ï¼šå‘½ä¸­ç‡=(51+43)/100=94% çµæ•åº¦ï¼šçœŸæ­£ç‡=43/(43+2)=96% ç‰¹å¼‚åº¦ï¼šçœŸè´Ÿç‡=51/(51+4)=93% å‡é˜³ç‡=1-93%=7% å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰ï¼šåˆ†ç±»æ­£ç¡®çš„æ ·æœ¬æ•°ä¸æ€»æ ·æœ¬æ•°ä¹‹æ¯”ã€‚å®ƒè¡¨ç¤ºæ¨¡å‹æ­£ç¡®é¢„æµ‹çš„æ ·æœ¬æ¯”ä¾‹ã€‚\nçµæ•åº¦ï¼ˆSensitivityï¼Œä¹Ÿç§°ä¸ºçœŸæ­£ç‡æˆ–å¬å›ç‡ï¼‰ï¼šçœŸæ­£ä¾‹ï¼ˆæ­£ç±»æ ·æœ¬ï¼‰ä¸­è¢«æ­£ç¡®é¢„æµ‹ä¸ºæ­£ç±»çš„æ¯”ä¾‹ã€‚å®ƒè¡¡é‡äº†æ¨¡å‹åœ¨æ­£ç±»æ ·æœ¬ä¸­çš„è¯†åˆ«èƒ½åŠ›ã€‚\nç‰¹å¼‚åº¦ï¼ˆSpecificityï¼Œä¹Ÿç§°ä¸ºçœŸè´Ÿç‡ï¼‰ï¼šçœŸè´Ÿä¾‹ï¼ˆè´Ÿç±»æ ·æœ¬ï¼‰ä¸­è¢«æ­£ç¡®é¢„æµ‹ä¸ºè´Ÿç±»çš„æ¯”ä¾‹ã€‚å®ƒè¡¡é‡äº†æ¨¡å‹åœ¨è´Ÿç±»æ ·æœ¬ä¸­çš„è¯†åˆ«èƒ½åŠ›ã€‚\nå‡é˜³ç‡ï¼ˆFalse Positive Rateï¼‰ï¼šè´Ÿç±»æ ·æœ¬ä¸­è¢«é”™è¯¯é¢„æµ‹ä¸ºæ­£ç±»çš„æ¯”ä¾‹ã€‚å®ƒæ˜¯ç‰¹å¼‚åº¦çš„è¡¥æ•°ï¼Œè¡¨ç¤ºæ¨¡å‹åœ¨è´Ÿç±»æ ·æœ¬ä¸­çš„é”™è¯¯è¯†åˆ«ç‡ã€‚\nè¿™äº›æŒ‡æ ‡é€šå¸¸ç”¨äºè¯„ä¼°äºŒåˆ†ç±»æ¨¡å‹ï¼ˆæ­£ç±»å’Œè´Ÿç±»ï¼‰ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€‰æ‹©å“ªä¸ªæŒ‡æ ‡å–å†³äºå…·ä½“çš„ä¸šåŠ¡éœ€æ±‚å’Œåˆ†ç±»ä»»åŠ¡çš„é‡è¦æ€§ã€‚\n4. ROC (Receiver Operating Characteristic) Curve è¿™äº›æ˜¯ç”¨äºè§£é‡ŠROCæ›²çº¿çš„AUCï¼ˆæ›²çº¿ä¸‹é¢ç§¯ï¼‰å€¼çš„å¸¸è§é˜ˆå€¼ï¼š\nå¤§äº0.9ï¼šä¼˜ç§€ 0.8-0.9ï¼šè‰¯å¥½ 0.7-0.8ï¼šå°šå¯ 0.6-0.7ï¼šè¾ƒå·® ROCæ›²çº¿æ˜¯è¡¡é‡äºŒåˆ†ç±»æ¨¡å‹æ€§èƒ½çš„é‡è¦å·¥å…·ï¼ŒAUCå€¼æ˜¯ROCæ›²çº¿ä¸‹çš„é¢ç§¯ï¼Œç”¨äºé‡åŒ–æ¨¡å‹å¯¹æ­£ä¾‹å’Œè´Ÿä¾‹çš„åŒºåˆ†èƒ½åŠ›ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒAUCå€¼è¶Šé«˜ï¼Œæ¨¡å‹æ€§èƒ½è¶Šå¥½ã€‚\n{% asset_image week4_lec_7.png %}\n5. Dynamic Segmentation æ ¹æ®æ¦‚ç‡å°ºåº¦ä»é«˜åˆ°ä½å¯¹å®¢æˆ·è¿›è¡Œæ’åã€‚é’ˆå¯¹ä»¥ä¸‹å®¢æˆ·ï¼š\nå±äºå‰ X% çš„é¡¶å°–å®¢æˆ·ï¼ˆå®¢æˆ·ç®¡ç†/èµ„æºåˆ†é…ï¼‰ æ¦‚ç‡é«˜äºæŸä¸ªé˜ˆå€¼çš„å®¢æˆ·ï¼ˆè‰¯å¥½å‰æ™¯ï¼‰ æ¦‚ç‡ä½äºæŸä¸ªé˜ˆå€¼çš„å®¢æˆ·ï¼ˆå³å°†â€œå¤±å»â€çš„å®¢æˆ·ï¼Œè¥é”€ä»ªè¡¨æ¿ï¼‰ è¿™äº›æ–¹æ³•å¯ä»¥å¸®åŠ©å…¬å¸æ ¹æ®å®¢æˆ·çš„æ¦‚ç‡åˆ†æ•°è¿›è¡Œä¼˜å…ˆçº§æ’åºï¼Œå¹¶æ ¹æ®ä¸šåŠ¡éœ€æ±‚é‡‡å–ç›¸åº”çš„è¡ŒåŠ¨ã€‚ 6. Takeaway é€‰æ‹©æ¨¡å‹æ˜¯ä¸€ç§æ•°å­¦æ¨¡å‹ï¼Œç”¨äºé¢„æµ‹è§‚å¯Ÿåˆ°çš„å®¢æˆ·é€‰æ‹©çš„å¯èƒ½æ€§ï¼Œå…¶å—åˆ°å…¬å¸è¥é”€çš„å½±å“ã€‚é€‰æ‹©å»ºæ¨¡åœ¨å¸‚åœºç ”ç©¶ä¸­éå¸¸æ™®éï¼Œç”¨äºç†è§£å„ç§æ¶ˆè´¹è€…å†³ç­–ã€‚\né€‰æ‹©åˆ†æçš„ä¸¤ç§å¸¸è§æ–¹æ³•æœ‰ï¼š\näºŒé¡¹å¼é€»è¾‘å›å½’ç”¨äºäºŒå…ƒé€‰æ‹© å¤šé¡¹å¼é€»è¾‘æ¨¡å‹ç”¨äºé€‰æ‹©é›†ä¸­è¶…è¿‡ä¸¤ä¸ªå¤‡é€‰é¡¹çš„æƒ…å†µã€‚ ","date":"2024-03-24T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek4-choice-model-lecture/","title":"R[week4] Choice model lecture"},{"content":" R: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\n1. Brand rating data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026gt; brand.ratings \u0026lt;- read.csv(\u0026#34;Data_Factor_Analysis.csv\u0026#34;, stringsAsFactors = TRUE) \u0026gt; head(brand.ratings) perform leader latest fun serious bargain value trendy rebuy brand 1 2 4 8 8 2 9 7 4 6 a 2 1 1 4 7 1 1 1 2 2 a 3 2 3 5 9 2 9 5 1 6 a 4 1 6 10 8 3 4 5 2 1 a 5 1 1 5 8 1 9 9 1 1 a 6 2 8 9 5 3 8 7 1 2 a \u0026gt; summary(brand.ratings) perform leader latest fun serious bargain value trendy rebuy brand Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.00 Min. : 1.000 a :100 1st Qu.: 1.000 1st Qu.: 2.000 1st Qu.: 4.000 1st Qu.: 4.000 1st Qu.: 2.000 1st Qu.: 2.000 1st Qu.: 2.000 1st Qu.: 3.00 1st Qu.: 1.000 b :100 Median : 4.000 Median : 4.000 Median : 7.000 Median : 6.000 Median : 4.000 Median : 4.000 Median : 4.000 Median : 5.00 Median : 3.000 c :100 Mean : 4.488 Mean : 4.417 Mean : 6.195 Mean : 6.068 Mean : 4.323 Mean : 4.259 Mean : 4.337 Mean : 5.22 Mean : 3.727 d :100 3rd Qu.: 7.000 3rd Qu.: 6.000 3rd Qu.: 9.000 3rd Qu.: 8.000 3rd Qu.: 6.000 3rd Qu.: 6.000 3rd Qu.: 6.000 3rd Qu.: 7.00 3rd Qu.: 5.000 e :100 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.00 Max. :10.000 f :100 (Other):400 \u0026gt; str(brand.ratings) \u0026#39;data.frame\u0026#39;:\t1000 obs. of 10 variables: $ perform: int 2 1 2 1 1 2 1 2 2 3 ... $ leader : int 4 1 3 6 1 8 1 1 1 1 ... $ latest : int 8 4 5 10 5 9 5 7 8 9 ... $ fun : int 8 7 9 8 8 5 7 5 10 8 ... $ serious: int 2 1 2 3 1 3 1 2 1 1 ... $ bargain: int 9 1 9 4 9 8 5 8 7 3 ... $ value : int 7 1 5 5 9 7 1 7 7 3 ... $ trendy : int 4 2 1 2 1 1 1 7 5 4 ... $ rebuy : int 6 2 6 1 1 2 1 1 1 1 ... $ brand : Factor w/ 10 levels \u0026#34;a\u0026#34;,\u0026#34;b\u0026#34;,\u0026#34;c\u0026#34;,\u0026#34;d\u0026#34;,..: 1 1 1 1 1 1 1 1 1 1 ... Perceptual adjective (column name) Example survey text perform Brand has a strong performance leader Brand is a leader in the field latest Brand has the latest products fun Brand is fun serious Brand is serious bargain Brand products are a bargain value Brand has a good value trendy Brand is trendy rebuy I would buy from Brand again 1.1 Rescaling the data æ ‡å‡†åŒ– 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026gt; brand.sc \u0026lt;- brand.ratings \u0026gt; brand.sc[,1:9] \u0026lt;- scale (brand.ratings[,1:9]) \u0026gt; #we select all rows and the first 9 columns as the 10th column is a factor variable. \u0026gt; summary(brand.sc) perform leader latest fun serious bargain value trendy rebuy brand Min. :-1.0888 Min. :-1.3100 Min. :-1.6878 Min. :-1.84677 Min. :-1.1961 Min. :-1.22196 Min. :-1.3912 Min. :-1.53897 Min. :-1.0717 a :100 1st Qu.:-1.0888 1st Qu.:-0.9266 1st Qu.:-0.7131 1st Qu.:-0.75358 1st Qu.:-0.8362 1st Qu.:-0.84701 1st Qu.:-0.9743 1st Qu.:-0.80960 1st Qu.:-1.0717 b :100 Median :-0.1523 Median :-0.1599 Median : 0.2615 Median :-0.02478 Median :-0.1163 Median :-0.09711 Median :-0.1405 Median :-0.08023 Median :-0.2857 c :100 Mean : 0.0000 Mean : 0.0000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 d :100 3rd Qu.: 0.7842 3rd Qu.: 0.6069 3rd Qu.: 0.9113 3rd Qu.: 0.70402 3rd Qu.: 0.6036 3rd Qu.: 0.65279 3rd Qu.: 0.6933 3rd Qu.: 0.64914 3rd Qu.: 0.5003 e :100 Max. : 1.7206 Max. : 2.1404 Max. : 1.2362 Max. : 1.43281 Max. : 2.0434 Max. : 2.15258 Max. : 2.3610 Max. : 1.74319 Max. : 2.4652 f :100 (Other):400 We can see the standardized variable has a mean of 0.00.\n1.2 Correlation Correlations among variables show some variables are highly related to each other and potentially could be combined.\n1 2 3 4 5 6 7 8 9 10 11 \u0026gt; cor(brand.sc[,1:9]) perform leader latest fun serious bargain value trendy rebuy perform 1.000000000 0.50020206 -0.122445813 -0.2563323 0.359172206 0.05712937 0.10194610 0.008733494 0.3066588 leader 0.500202058 1.00000000 0.026890447 -0.2903576 0.571215126 0.03309405 0.11831017 0.066512436 0.2087004 latest -0.122445813 0.02689045 1.000000000 0.2451545 0.009951527 -0.25441902 -0.34271372 0.627627667 -0.3971802 fun -0.256332316 -0.29035764 0.245154457 1.0000000 -0.281097443 -0.06655280 -0.14521849 0.127973639 -0.2371607 serious 0.359172206 0.57121513 0.009951527 -0.2810974 1.000000000 -0.00265559 0.02375656 0.121009377 0.1807027 bargain 0.057129372 0.03309405 -0.254419016 -0.0665528 -0.002655590 1.00000000 0.73962672 -0.350533746 0.4673811 value 0.101946104 0.11831017 -0.342713717 -0.1452185 0.023756556 0.73962672 1.00000000 -0.434534536 0.5059617 trendy 0.008733494 0.06651244 0.627627667 0.1279736 0.121009377 -0.35053375 -0.43453454 1.000000000 -0.2982462 rebuy 0.306658801 0.20870036 -0.397180225 -0.2371607 0.180702720 0.46738109 0.50596166 -0.298246195 1.0000000 1 corrplot(cor(brand.sc[,1:9])) {% asset_image R_week3_code_corrplot.png %}\ncorrplot()\ncorrplot æ˜¯ R è¯­è¨€ä¸­ç”¨äºå¯è§†åŒ–ç›¸å…³ç³»æ•°çŸ©é˜µçš„å‡½æ•°ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå¯ä»¥åˆ›å»ºå„ç§ç±»å‹çš„ç›¸å…³ç³»æ•°å›¾ï¼Œä»¥å¸®åŠ©ç†è§£å’Œåˆ†æå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 corrplot( M, # ç›¸å…³ç³»æ•°çŸ©é˜µ method = \u0026#34;circle\u0026#34;, # ç›¸å…³ç³»æ•°å›¾çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ \u0026#34;circle\u0026#34;, \u0026#34;square\u0026#34;, \u0026#34;ellipse\u0026#34;, \u0026#34;number\u0026#34;, \u0026#34;shade\u0026#34;, \u0026#34;color\u0026#34;, \u0026#34;pie\u0026#34; ç­‰ type = \u0026#34;full\u0026#34;, # ç›¸å…³ç³»æ•°ç±»å‹ï¼Œå¯ä»¥æ˜¯ \u0026#34;full\u0026#34;, \u0026#34;upper\u0026#34;, \u0026#34;lower\u0026#34;ï¼Œé»˜è®¤æ˜¯ \u0026#34;full\u0026#34; tl.col = \u0026#34;black\u0026#34;, # æ–‡æœ¬æ ‡ç­¾çš„é¢œè‰² tl.srt = 45, # æ–‡æœ¬æ ‡ç­¾çš„æ—‹è½¬è§’åº¦ diag = FALSE, # æ˜¯å¦æ˜¾ç¤ºå¯¹è§’çº¿å…ƒç´  addgrid.col = \u0026#34;gray\u0026#34;, # æ˜¯å¦æ·»åŠ ç½‘æ ¼çº¿ï¼Œç½‘æ ¼çº¿çš„é¢œè‰² order = \u0026#34;original\u0026#34;, # ç›¸å…³ç³»æ•°çš„æ’åºæ–¹å¼ï¼Œå¯ä»¥æ˜¯ \u0026#34;original\u0026#34;, \u0026#34;alphabet\u0026#34;, \u0026#34;hclust\u0026#34;, \u0026#34;FPC\u0026#34;, \u0026#34;color\u0026#34; ç­‰ addrect = 2, # æ·»åŠ çŸ©å½¢è¾¹æ¡†çš„ç±»å‹å’Œé¢œè‰²ï¼Œ0è¡¨ç¤ºä¸æ·»åŠ ï¼Œ1è¡¨ç¤ºé»˜è®¤é¢œè‰²ï¼Œ2è¡¨ç¤ºè‡ªå®šä¹‰é¢œè‰² rect.col = \u0026#34;black\u0026#34;, # çŸ©å½¢è¾¹æ¡†çš„é¢œè‰² bg = \u0026#34;white\u0026#34;, # ç›¸å…³ç³»æ•°å›¾çš„èƒŒæ™¯é¢œè‰² mar = c(0,0,2,0), # å›¾çš„è¾¹ç¼˜ç©ºç™½ cl.lim = c(-1, 1), # ç›¸å…³ç³»æ•°çš„é¢œè‰²èŒƒå›´ cl.pos = \u0026#34;n\u0026#34;, # ç›¸å…³ç³»æ•°çš„é¢œè‰²æ¡ä½ç½® addCoef.col = \u0026#34;black\u0026#34;, # ç³»æ•°çš„é¢œè‰² æ€»ç»“ä¸€ä¸‹ï¼Œå½“æ‚¨å¸Œæœ›è·¨å¤šä¸ªç»´åº¦æ¯”è¾ƒå‡ ä¸ªå“ç‰Œæ—¶ï¼Œå°†æ³¨æ„åŠ›é›†ä¸­åœ¨è§£é‡Šæ•°æ®å˜å¼‚çš„å‰ä¸¤ä¸ªæˆ–ä¸‰ä¸ªä¸»æˆåˆ†ä¸Šå¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å±å¹•å›¾é€‰æ‹©è¦å…³æ³¨çš„ä¸»æˆåˆ†æ•°é‡ï¼Œè¯¥å›¾æ˜¾ç¤ºäº†æ¯ä¸ªä¸»æˆåˆ†è§£é‡Šæ•°æ®ä¸­çš„å¤šå°‘å˜åŒ–ã€‚æ„ŸçŸ¥åœ°å›¾å°†å“ç‰Œç»˜åˆ¶åœ¨å‰ä¸¤ä¸ªä¸»æˆåˆ†ä¸Šï¼Œæ­ç¤ºäº†è§‚å¯Ÿç»“æœä¸æ½œåœ¨ç»´åº¦ï¼ˆå³æˆåˆ†ï¼‰çš„å…³ç³»ã€‚ PCAå¯ä»¥ä½¿ç”¨å“ç‰Œè°ƒæŸ¥è¯„åˆ†ï¼ˆå¦‚æˆ‘ä»¬åœ¨æ­¤å¤„æ‰€åšçš„ï¼‰è¿›è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä»·æ ¼å’Œç‰©ç†æµ‹é‡ç­‰å®¢è§‚æ•°æ®ï¼Œæˆ–è€…äºŒè€…çš„ç»„åˆè¿›è¡Œã€‚æ— è®ºåœ¨å“ªç§æƒ…å†µä¸‹ï¼Œå½“æ‚¨é¢å¯¹å“ç‰Œæˆ–äº§å“çš„å¤šç»´æ•°æ®æ—¶ï¼ŒPCAå¯è§†åŒ–éƒ½æ˜¯äº†è§£å¸‚åœºå·®å¼‚çš„æœ‰ç”¨å·¥å…·ã€‚ addCoefasPercent = TRUE, # æ˜¯å¦ä»¥ç™¾åˆ†æ¯”å½¢å¼æ˜¾ç¤ºç³»æ•° outline = TRUE, # æ˜¯å¦æ˜¾ç¤ºç›¸å…³ç³»æ•°çš„å¤–æ¡† number.cex = 0.8, # æ•°å­—æ ‡ç­¾çš„å¤§å° ...) corrplot å‡½æ•°çš„ä¸»è¦å‚æ•°åŒ…æ‹¬ï¼š\nMï¼šä¸€ä¸ªæ•°å€¼å‹çš„çŸ©é˜µï¼Œå…¶ä¸­å­˜å‚¨äº†ç›¸å…³ç³»æ•°ã€‚ methodï¼šæŒ‡å®šè¦ç»˜åˆ¶çš„ç›¸å…³ç³»æ•°å›¾çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ \u0026ldquo;circle\u0026rdquo;ã€\u0026ldquo;square\u0026rdquo;ã€\u0026ldquo;ellipse\u0026rdquo;ã€\u0026ldquo;number\u0026rdquo;ã€\u0026ldquo;shade\u0026rdquo;ã€\u0026ldquo;color\u0026rdquo;ã€\u0026ldquo;pie\u0026rdquo; ç­‰ã€‚ å…¶ä¸­ï¼Œxæ˜¯åŒ…å«åŸå§‹æ•°æ®çš„æ•°æ®æ¡†æˆ–çŸ©é˜µï¼Œ\u0026hellip;æ˜¯å…¶ä»–å‚æ•°ï¼Œç”¨äºæ§åˆ¶ä¸»æˆåˆ†åˆ†æçš„è¿‡ç¨‹ï¼Œä¾‹å¦‚æ˜¯å¦è¿›è¡Œå˜é‡æ ‡å‡†åŒ–ç­‰ã€‚ princomp() å‡½æ•°è¿”å›ä¸€ä¸ªä¸»æˆåˆ†åˆ†æç»“æœçš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†ä¸»æˆåˆ†åˆ†æçš„å„ç§ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¸»æˆåˆ†åˆ†æ•°ã€ä¸»æˆåˆ†è½½è·ã€æ–¹å·®è§£é‡Šæ¯”ä¾‹ç­‰ã€‚å¯ä»¥ä½¿ç”¨summary()å‡½æ•°å¯¹ä¸»æˆåˆ†åˆ†æç»“æœè¿›è¡Œæ‘˜è¦ç»Ÿè®¡ï¼Œæˆ–è€…ç›´æ¥è®¿é—®è¿”å›çš„å¯¹è±¡çš„æˆåˆ†æ¥è·å–ç›¸å…³ä¿¡æ¯ã€‚typeï¼šç›¸å…³ç³»æ•°ç±»å‹ï¼Œå¯ä»¥æ˜¯ \u0026ldquo;full\u0026rdquo;ã€\u0026ldquo;upper\u0026rdquo;ã€\u0026ldquo;lower\u0026rdquo;ï¼Œé»˜è®¤æ˜¯ \u0026ldquo;full\u0026rdquo;ï¼Œè¡¨ç¤ºç»˜åˆ¶å…¨éƒ¨ç›¸å…³ç³»æ•°ã€‚\ntl.colï¼šæ–‡æœ¬æ ‡ç­¾çš„é¢œè‰²ã€‚ tl.srtï¼šæ–‡æœ¬æ ‡ç­¾çš„æ—‹è½¬è§’åº¦ã€‚ diagï¼šæ˜¯å¦æ˜¾ç¤ºå¯¹è§’çº¿å…ƒç´ ã€‚ orderï¼šç›¸å…³ç³»æ•°çš„æ’åºæ–¹å¼ï¼Œå¯ä»¥æ˜¯ \u0026ldquo;original\u0026rdquo;ã€\u0026ldquo;alphabet\u0026rdquo;ã€\u0026ldquo;hclust\u0026rdquo;ã€\u0026ldquo;FPC\u0026rdquo;ã€\u0026ldquo;color\u0026rdquo; ç­‰ã€‚ cl.limï¼šç›¸å…³ç³»æ•°çš„é¢œè‰²èŒƒå›´ã€‚ addCoefasPercentï¼šæ˜¯å¦ä»¥ç™¾åˆ†æ¯”å½¢å¼æ˜¾ç¤ºç³»æ•°ã€‚ 1 2 # use the optional argument (order = â€œhclustâ€) to order variables for better visualization corrplot(cor(brand.sc[,1:9]), order = \u0026#34;hclust\u0026#34;) {% asset_image R_week3_code_corrplot_with_order.png %}\nThe result shows that some of the ratings are highly related to each other so that they could be represented by common factors.\n1.3 Mean rating by brand 1.3.1 aggregate() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026gt; brand.mean \u0026lt;- aggregate(. ~ brand, data=brand.sc, mean) \u0026gt; brand.mean brand perform leader latest fun serious bargain value trendy rebuy 1 a -0.88591874 -0.5279035 0.4109732 0.6566458 -0.91894067 0.21409609 0.18469264 -0.52514473 -0.59616642 2 b 0.93087022 1.0707584 0.7261069 -0.9722147 1.18314061 0.04161938 0.15133957 0.74030819 0.23697320 3 c 0.64992347 1.1627677 -0.1023372 -0.8446753 1.22273461 -0.60704302 -0.44067747 0.02552787 -0.13243776 4 d -0.67989112 -0.5930767 0.3524948 0.1865719 -0.69217505 -0.88075605 -0.93263529 0.73666135 -0.49398892 5 e -0.56439079 0.1928362 0.4564564 0.2958914 0.04211361 0.55155051 0.41816415 0.13857986 0.03654811 6 f -0.05868665 0.2695106 -1.2621589 -0.2179102 0.58923066 0.87400696 1.02268859 -0.81324496 1.35699580 7 g 0.91838369 -0.1675336 -1.2849005 -0.5167168 -0.53379906 0.89650392 1.25616009 -1.27639344 1.36092571 8 h -0.01498383 -0.2978802 0.5019396 0.7149495 -0.14145855 -0.73827529 -0.78254646 0.86430070 -0.60402622 9 i 0.33463879 -0.3208825 0.3557436 0.4124989 -0.14865746 -0.25459062 -0.80339213 0.59078782 -0.20317603 10 j -0.62994504 -0.7885965 -0.1543180 0.2849595 -0.60218870 -0.09711188 -0.07379367 -0.48138267 -0.96164748 \u0026gt; rownames(brand.mean) \u0026lt;- brand.mean[, 1] \u0026gt; # Use brand for the row name \u0026gt; brand.mean \u0026lt;- brand.mean [, -1] \u0026gt; # Remove the brand name column by not selecting the first column # Negative index is used to exclude the variable \u0026gt; brand.mean perform leader latest fun serious bargain value trendy rebuy a -0.88591874 -0.5279035 0.4109732 0.6566458 -0.91894067 0.21409609 0.18469264 -0.52514473 -0.59616642 b 0.93087022 1.0707584 0.7261069 -0.9722147 1.18314061 0.04161938 0.15133957 0.74030819 0.23697320 c 0.64992347 1.1627677 -0.1023372 -0.8446753 1.22273461 -0.60704302 -0.44067747 0.02552787 -0.13243776 d -0.67989112 -0.5930767 0.3524948 0.1865719 -0.69217505 -0.88075605 -0.93263529 0.73666135 -0.49398892 e -0.56439079 0.1928362 0.4564564 0.2958914 0.04211361 0.55155051 0.41816415 0.13857986 0.03654811 f -0.05868665 0.2695106 -1.2621589 -0.2179102 0.58923066 0.87400696 1.02268859 -0.81324496 1.35699580 g 0.91838369 -0.1675336 -1.2849005 -0.5167168 -0.53379906 0.89650392 1.25616009 -1.27639344 1.36092571 h -0.01498383 -0.2978802 0.5019396 0.7149495 -0.14145855 -0.73827529 -0.78254646 0.86430070 -0.60402622 i 0.33463879 -0.3208825 0.3557436 0.4124989 -0.14865746 -0.25459062 -0.80339213 0.59078782 -0.20317603 j -0.62994504 -0.7885965 -0.1543180 0.2849595 -0.60218870 -0.09711188 -0.07379367 -0.48138267 -0.96164748 Then we can visualize this matrix by using a heat map :\n1 heatmap.2(as.matrix(brand.mean),main = \u0026#34;Brand attributes\u0026#34;, trace = \u0026#34;none\u0026#34;, key = FALSE, dend = \u0026#34;none\u0026#34;) #turn off some options é¢œè‰²è¶Šæµ…è¡¨ç¤ºå€¼è¶Šé«˜ï¼Œé¢œè‰²è¶Šæ·±è¡¨ç¤ºå€¼è¶Šä½ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå“ç‰Œçš„æ„ŸçŸ¥æ˜æ˜¾ä¸åŒï¼Œä¸€äº›å“ç‰Œåœ¨performanceã€leaderæ–¹é¢å¾—åˆ†å¾ˆé«˜(å“ç‰Œbå’Œc)ï¼Œè€Œå¦ä¸€äº›å“ç‰Œåœ¨valueå’Œrebuyæ–¹é¢å¾—åˆ†å¾ˆé«˜(å“ç‰Œfå’Œg)ã€‚ ä»ç›¸å…³å›¾å’Œçƒ­å›¾å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹å½¢å®¹è¯å’Œå“ç‰Œçš„åˆ†ç»„å’Œå…³ç³»ã€‚ä¾‹å¦‚ï¼Œbargin/value/rebuyçš„å„æ çš„é¢œè‰²æ¨¡å¼æœ‰ç›¸ä¼¼ä¹‹å¤„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ­£å¼é˜è¿°è¿™ç§è§è§£ã€‚\n2 Principal component analysis (PCA) using princomp() princomp()å‡½æ•°äº§ç”Ÿæœªæ—‹è½¬çš„ä¸»æˆåˆ†åˆ†æã€‚\næ‚¨å¯ä»¥ä½¿ç”¨åŸå§‹çš„ä¸ªäººè¯„åˆ†æ•°æ®brand.scæˆ–èšåˆçš„å¹³å‡è¯„åˆ†æ•°æ®brand.meanã€‚ä¸ªä½“å—è®¿è€…è¯„åˆ†çš„å›¾è¡¨å¯èƒ½ä¼šè¿‡äºå¯†é›†ï¼Œå¯èƒ½æ— æ³•æ¸…æ¥šåœ°å‘Šè¯‰æˆ‘ä»¬æœ‰å…³å“ç‰Œä½ç½®çš„ä¿¡æ¯ï¼æ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æŒ‰å“ç‰Œèšåˆçš„è¯„åˆ†æ‰§è¡ŒPCAã€‚\n2.1 PCA 1 2 3 4 5 6 7 8 9 \u0026gt; brand.pc\u0026lt;- princomp(brand.mean, cor = TRUE) \u0026gt; #We added \u0026#34;cor =TRUE\u0026#34; to use correlation-based one. \u0026gt; summary(brand.pc) Importance of components: Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9 Standard deviation 2.134521 1.7349473 0.76898915 0.61498280 0.5098261 0.36661576 0.215062433 0.145882355 0.0486674686 Proportion of Variance 0.506242 0.3344491 0.06570492 0.04202265 0.0288803 0.01493412 0.005139094 0.002364629 0.0002631692 Cumulative Proportion 0.506242 0.8406911 0.90639603 0.94841868 0.9772990 0.99223311 0.997372202 0.999736831 1.0000000000 princomp()\nprincomp() å‡½æ•°æ˜¯Rè¯­è¨€ä¸­ç”¨äºè¿›è¡Œä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰çš„å‡½æ•°ä¹‹ä¸€ã€‚å®ƒå¯ä»¥ç”¨äºå¯¹æ•°æ®è¿›è¡Œé™ç»´ï¼Œæ‰¾å‡ºæ•°æ®ä¸­çš„ä¸»è¦æ–¹å‘æˆ–ä¸»æˆåˆ†ï¼Œä»è€Œç®€åŒ–æ•°æ®å¹¶æå–å…³é”®ç‰¹å¾ã€‚\nå…¶ä¸­ï¼Œxæ˜¯åŒ…å«åŸå§‹æ•°æ®çš„æ•°æ®æ¡†æˆ–çŸ©é˜µï¼Œ\u0026hellip;æ˜¯å…¶ä»–å‚æ•°ï¼Œç”¨äºæ§åˆ¶ä¸»æˆåˆ†åˆ†æçš„è¿‡ç¨‹ï¼Œä¾‹å¦‚æ˜¯å¦è¿›è¡Œå˜é‡æ ‡å‡†åŒ–ç­‰ã€‚\nprincomp() å‡½æ•°è¿”å›ä¸€ä¸ªä¸»æˆåˆ†åˆ†æç»“æœçš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†ä¸»æˆåˆ†åˆ†æçš„å„ç§ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¸»æˆåˆ†åˆ†æ•°ã€ä¸»æˆåˆ†è½½è·ã€æ–¹å·®è§£é‡Šæ¯”ä¾‹ç­‰ã€‚å¯ä»¥ä½¿ç”¨summary()å‡½æ•°å¯¹ä¸»æˆåˆ†åˆ†æç»“æœè¿›è¡Œæ‘˜è¦ç»Ÿè®¡ï¼Œæˆ–è€…ç›´æ¥è®¿é—®è¿”å›çš„å¯¹è±¡çš„æˆåˆ†æ¥è·å–ç›¸å…³ä¿¡æ¯ã€‚\n1 plot(brand.pc,type=\u0026#34;l\u0026#34;) # scree plot {% asset_image R_week3_PCA %}\nå‘ç”Ÿåœ¨å›¾çº¿å‡ºç°æ‹ç‚¹çš„åœ°æ–¹ï¼Œåœ¨ä¸Šå›¾ä¸­ï¼Œæ‹ç‚¹å‡ºç°åœ¨ç¬¬ä¸‰ä¸ªç»„ä»¶å¤„ã€‚è¿™è¡¨æ˜å‰ä¸¤ä¸ªç»„ä»¶è§£é‡Šäº†è§‚å¯Ÿåˆ°çš„å“ç‰Œè¯„åˆ†ä¸­å¤§éƒ¨åˆ†çš„å˜å¼‚ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026gt; loadings(brand.pc) # pc loadings Loadings: Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9 perform 0.285 0.337 0.481 0.470 0.396 0.435 leader 0.247 0.457 -0.317 -0.191 0.119 -0.610 0.451 latest -0.356 0.251 -0.496 0.275 0.461 -0.196 -0.119 -0.466 fun -0.336 -0.335 -0.152 0.324 -0.388 0.636 -0.246 0.179 serious 0.212 0.475 -0.244 -0.212 -0.394 0.334 0.439 -0.407 bargain 0.361 -0.278 -0.459 0.291 0.112 0.127 0.319 -0.513 0.321 value 0.401 -0.241 -0.336 0.206 0.778 trendy -0.311 0.375 0.484 -0.273 -0.339 0.322 0.243 0.410 rebuy 0.430 0.442 -0.438 -0.368 -0.352 -0.142 -0.372 Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9 SS loadings 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 Proportion Var 0.111 0.111 0.111 0.111 0.111 0.111 0.111 0.111 0.111 Cumulative Var 0.111 0.222 0.333 0.444 0.556 0.667 0.778 0.889 1.000 loadings()\né€šå¸¸ç”¨äºæå–ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ç»“æœä¸­çš„ä¸»æˆåˆ†è½½è·ã€‚ä¸»æˆåˆ†è½½è·æ˜¯æè¿°ä¸»æˆåˆ†ä¸åŸå§‹å˜é‡ä¹‹é—´ç›¸å…³æ€§çš„ç³»æ•°ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬æ¯ä¸ªä¸»æˆåˆ†ä¸æ¯ä¸ªåŸå§‹å˜é‡ä¹‹é—´çš„å…³ç³»å¼ºåº¦å’Œæ–¹å‘ã€‚\n1 loadings(object) å…¶ä¸­ï¼Œobjectæ˜¯è¿›è¡Œä¸»æˆåˆ†åˆ†æåè¿”å›çš„ç»“æœå¯¹è±¡ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨princomp()æˆ–prcomp()å‡½æ•°è¿›è¡Œä¸»æˆåˆ†åˆ†æåå¾—åˆ°çš„å¯¹è±¡ã€‚\nloadings()å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªçŸ©é˜µï¼Œå…¶ä¸­çš„è¡Œè¡¨ç¤ºåŸå§‹å˜é‡ï¼Œåˆ—è¡¨ç¤ºä¸»æˆåˆ†ã€‚çŸ©é˜µä¸­çš„å…ƒç´ æ˜¯ä¸»æˆåˆ†è½½è·ï¼Œè¡¨ç¤ºæ¯ä¸ªä¸»æˆåˆ†ä¸å¯¹åº”åŸå§‹å˜é‡ä¹‹é—´çš„ç›¸å…³ç³»æ•°ã€‚\n2.2 Visualising PCA (perceptual map) biplot()æ˜¯å…³äºå‰ä¸¤ä¸ªPCAæˆåˆ†çš„æ•°æ®ç‚¹çš„äºŒç»´å›¾ã€‚å®ƒå±•ç¤ºäº†è¯„åˆ†å½¢å®¹è¯ä¹‹é—´çš„å…³è”ã€‚å¯¹å¹³å‡è¯„åˆ†çš„PCAè§£çš„biplotæä¾›äº†å¯è§£é‡Šçš„æ„ŸçŸ¥å›¾ï¼Œæ˜¾ç¤ºäº†å“ç‰Œç›¸å¯¹äºå‰ä¸¤ä¸ªä¸»æˆåˆ†çš„ä½ç½®ã€‚\n1 biplot(brand.pc, main = \u0026#34;Brand positioning\u0026#34;) {% asset_image R_week3_biplot.png %}\nThe result shows the adjective map in four regions:\nâ€¢ category leadership: â€œseriousâ€, â€œleaderâ€, and â€œperformâ€\nâ€¢ category value: â€œrebuyâ€, â€œvalueâ€, and â€œbargainâ€\nâ€¢ category trendiness: â€œtrendyâ€ and â€œlatestâ€\nâ€¢ category fun: â€œfunâ€\nWhat does the map tell us? First, we interpret the adjective clusters and relationships and see four areas with well-differentiated sets of adjectives and brands that are positioned in proximity. Brands f and g are high on â€œvalueâ€, while brands a and j are relatively high on fun, which is opposite in direction from leadership adjectives (â€œleaderâ€ and â€œseriousâ€).\nå‡è®¾æ‚¨æ˜¯å“ç‰Œeçš„å“ç‰Œç»ç†ï¼Œåœ°å›¾å‘Šè¯‰æ‚¨ä»€ä¹ˆï¼Ÿ\næ‚¨çš„å“ç‰Œä½äºä¸­å¿ƒï¼Œå› æ­¤åœ¨ä»»ä½•ç»´åº¦ä¸Šä¼¼ä¹éƒ½æ²¡æœ‰å¾ˆå¥½çš„å·®å¼‚åŒ–ã€‚è¿™å¯èƒ½æ˜¯å¥½äº‹ï¼Œä¹Ÿå¯èƒ½æ˜¯åäº‹ï¼Œè¿™å–å†³äºæ‚¨çš„æˆ˜ç•¥ç›®æ ‡ã€‚\nå…³äºæ‚¨çš„å“ç‰Œeçš„ä½ç½®ï¼Œæ‚¨åº”è¯¥æ€ä¹ˆåšï¼Ÿ\nå†æ¬¡å¼ºè°ƒï¼Œè¿™å–å†³äºæˆ˜ç•¥ç›®æ ‡ã€‚å¦‚æœæ‚¨å¸Œæœ›å¢åŠ å·®å¼‚åŒ–ï¼Œä¸€ç§å¯èƒ½æ€§æ˜¯é‡‡å–è¡ŒåŠ¨å°†æ‚¨çš„å“ç‰Œæœåœ°å›¾ä¸Šçš„æŸä¸ªæ–¹å‘ç§»åŠ¨ã€‚\nå‡è®¾æ‚¨å¸Œæœ›æœå“ç‰Œcçš„æ–¹å‘ç§»åŠ¨ æ‚¨å¯ä»¥æŸ¥çœ‹æ•°æ®ä¸­ä¸cçš„å…·ä½“å·®å¼‚ï¼š\n1 2 3 \u0026gt; brand.mean[\u0026#34;c\u0026#34;,] - brand.mean[\u0026#34;e\u0026#34;,] perform leader latest fun serious bargain value trendy rebuy c 1.214314 0.9699315 -0.5587936 -1.140567 1.180621 -1.158594 -0.8588416 -0.113052 -0.1689859 è¿™è¡¨æ˜åœ¨â€œvalueâ€å’Œâ€œfunâ€æ–¹é¢ï¼Œeç›¸å¯¹äºcæ›´å¼ºï¼Œ è€Œåœ¨â€œperformâ€å’Œâ€œseriousâ€æ–¹é¢åˆ™æ¯”cå¼±ã€‚\nè¿™äº›å¯èƒ½æ˜¯eéœ€è¦åŠªåŠ›æ”¹è¿›çš„äº§å“æˆ–ä¿¡æ¯æ–¹é¢ã€‚\nå¦ä¸€ä¸ªé€‰æ‹©æ˜¯ç„å‡†ä¸€ä¸ªæ²¡æœ‰å“ç‰Œå®šä½çš„å·®å¼‚åŒ–ç©ºé—´ åœ¨å›¾ä¸­ï¼Œå³ä¸‹è§’å’Œå³ä¸Šè§’ä¹‹é—´æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—´éš™ã€‚è¿™ä¸ªåŒºåŸŸå¯ä»¥è¢«æè¿°ä¸ºâ€œvalue leaderâ€åŒºåŸŸæˆ–ç±»ä¼¼çš„åŒºåŸŸã€‚æˆ‘ä»¬å¦‚ä½•æ‰¾å‡ºå¦‚ä½•å®šä½åœ¨é‚£é‡Œå‘¢ï¼Ÿ\nè®©æˆ‘ä»¬å‡è®¾è¿™ä¸ªé—´éš™å¤§è‡´åæ˜ äº†é‚£å››ä¸ªå“ç‰Œï¼ˆgã€fã€cå’Œbï¼‰çš„å¹³å‡å€¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨colMeans()åœ¨å“ç‰Œçš„è¡Œä¸Šæ‰¾åˆ°å¹³å‡å€¼ï¼Œç„¶åå°†eä¸è¯¥å¹³å‡å€¼ç›¸æ¯”è¾ƒï¼š\n1 2 3 \u0026gt; colMeans(brand.mean[c(\u0026#34;b\u0026#34;,\u0026#34;c\u0026#34;,\u0026#34;f\u0026#34;,\u0026#34;g\u0026#34;),]) - brand.mean[\u0026#34;e\u0026#34;,] perform leader latest fun serious bargain value trendy rebuy e 1.174513 0.3910396 -0.9372789 -0.9337707 0.5732131 -0.2502787 0.07921355 -0.4695304 0.6690661 è¿™è¡¨æ˜å“ç‰Œeå¯ä»¥é€šè¿‡å¢åŠ å¯¹æ€§èƒ½çš„é‡è§†ï¼ŒåŒæ—¶å‡å°‘å¯¹â€œæœ€æ–°â€å’Œâ€œä¹è¶£â€çš„é‡è§†æ¥ç„å‡†è¿™ä¸ªé—´éš™ã€‚\n3 Factor analysis using factanal() * factanal()å‡½æ•°æ‰§è¡Œæœ€å¤§ä¼¼ç„¶å› å­åˆ†æã€‚\nfactanal()\nfactanal()å‡½æ•°æ˜¯Rè¯­è¨€ä¸­ç”¨äºæ‰§è¡Œå› å­åˆ†æï¼ˆFactor Analysisï¼‰çš„å‡½æ•°ä¹‹ä¸€ã€‚å› å­åˆ†ææ˜¯ä¸€ç§å¤šå˜é‡ç»Ÿè®¡æ–¹æ³•ï¼Œç”¨äºæ¢ç´¢å¤šä¸ªå˜é‡ä¹‹é—´çš„å†…åœ¨ç»“æ„å’Œå…³è”å…³ç³»ï¼Œå®ƒè¯•å›¾é€šè¿‡å‘ç°æ½œåœ¨çš„ä¸å¯è§‚æµ‹çš„å› å­æ¥è§£é‡Šå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚\nåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š\n1 factanal(x, factors, data, ...) å…¶ä¸­ï¼š\nx æ˜¯åŒ…å«åŸå§‹æ•°æ®çš„æ•°æ®æ¡†æˆ–çŸ©é˜µã€‚ factors æ˜¯è¦æå–çš„å› å­æ•°é‡ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•°æˆ–ä¸€ä¸ªå› å­æå–æ–¹æ³•ï¼Œå¦‚\u0026quot;ML\u0026quot;è¡¨ç¤ºæœ€å¤§ä¼¼ç„¶ä¼°è®¡æ³•ã€‚ data æ˜¯åŒ…å«åŸå§‹æ•°æ®çš„æ•°æ®æ¡†ï¼Œå¦‚æœåœ¨xä¸­æŒ‡å®šäº†å˜é‡åï¼Œå¯ä»¥ä¸ä½¿ç”¨è¯¥å‚æ•°ã€‚ \u0026hellip; æ˜¯å…¶ä»–å‚æ•°ï¼Œç”¨äºæŒ‡å®šå› å­åˆ†æçš„ä¸€äº›é€‰é¡¹ï¼Œä¾‹å¦‚æ—‹è½¬æ–¹æ³•ã€æå–æ–¹æ³•ç­‰ã€‚ factanal()å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«å› å­åˆ†æç»“æœçš„å¯¹è±¡ï¼Œå…¶ä¸­åŒ…æ‹¬æå–çš„å› å­ã€å› å­è½½è·ã€ç‰¹å¾å€¼ç­‰ä¿¡æ¯ã€‚å¯ä»¥ä½¿ç”¨print()æˆ–summary()å‡½æ•°æ¥æŸ¥çœ‹å› å­åˆ†æç»“æœçš„æ‘˜è¦ä¿¡æ¯ã€‚\næœ€å¤§ä¼¼ç„¶å› å­åˆ†æï¼ˆMaximum Likelihood Factor Analysisï¼‰\næ˜¯å› å­åˆ†æï¼ˆFactor Analysisï¼‰çš„ä¸€ç§å‚æ•°ä¼°è®¡æ–¹æ³•ã€‚åœ¨æœ€å¤§ä¼¼ç„¶å› å­åˆ†æä¸­ï¼Œé€šè¿‡æœ€å¤§åŒ–è§‚å¯Ÿæ•°æ®çš„ä¼¼ç„¶å‡½æ•°æ¥ä¼°è®¡å› å­è½½è·ã€å› å­æ–¹å·®å’Œè¯¯å·®æ–¹å·®ç­‰å‚æ•°ï¼Œä»¥è·å¾—å¯¹æ•°æ®ç»“æ„çš„æœ€ä½³è§£é‡Šã€‚\næœ€å¤§ä¼¼ç„¶å› å­åˆ†æå‡è®¾è§‚å¯Ÿæ•°æ®æœä»å¤šå˜é‡æ­£æ€åˆ†å¸ƒï¼Œå¹¶è¯•å›¾æ‰¾å‡ºèƒ½å¤Ÿæœ€å¤§ç¨‹åº¦åœ°è§£é‡Šæ•°æ®å˜å¼‚çš„æ½œåœ¨å› å­ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå‡è®¾æ¯ä¸ªè§‚å¯Ÿæ•°æ®æ˜¯ç”±ä¸€ä¸ªçº¿æ€§ç»„åˆçš„å› å­å’Œè¯¯å·®é¡¹ç»„æˆï¼Œå¹¶å°è¯•æ‰¾å‡ºæœ€åˆé€‚çš„å› å­è½½è·ï¼Œä½¿å¾—æ¨¡å‹å¯¹è§‚å¯Ÿæ•°æ®çš„æ‹Ÿåˆæœ€ä¼˜ã€‚\nåœ¨æœ€å¤§ä¼¼ç„¶å› å­åˆ†æä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨EMç®—æ³•ï¼ˆæœŸæœ›æœ€å¤§åŒ–ç®—æ³•ï¼‰æ¥ä¼°è®¡æ¨¡å‹å‚æ•°ï¼Œå…¶ä¸­EMç®—æ³•çš„ç›®æ ‡æ˜¯åœ¨æ¯æ¬¡è¿­ä»£ä¸­æœ€å¤§åŒ–è§‚å¯Ÿæ•°æ®çš„ä¼¼ç„¶å‡½æ•°ï¼Œé€šè¿‡äº¤æ›¿åœ°è¿›è¡ŒEæ­¥éª¤ï¼ˆExpectation Stepï¼‰å’ŒMæ­¥éª¤ï¼ˆMaximization Stepï¼‰æ¥è¾¾åˆ°è¿™ä¸ªç›®æ ‡ã€‚\næœ€å¤§ä¼¼ç„¶å› å­åˆ†ææ˜¯ä¸€ç§å¸¸ç”¨çš„å› å­åˆ†ææ–¹æ³•ï¼Œå®ƒé€šå¸¸ç”¨äºæ¢ç´¢å¤šä¸ªå˜é‡ä¹‹é—´çš„æ½œåœ¨ç»“æ„ï¼Œå¹¶è¯†åˆ«å‡ºèƒ½å¤Ÿè§£é‡Šè§‚å¯Ÿæ•°æ®å˜å¼‚çš„é‡è¦å› å­ã€‚\n3.1 Determine the factor number é¦–å…ˆè¦ç¡®å®šè¦ä¼°è®¡çš„å› å­æ•°é‡ã€‚æœ‰å„ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œå…¶ä¸­ä¸¤ç§ä¼ ç»Ÿæ–¹æ³•æ˜¯ä½¿ç”¨screen plotï¼Œä»¥åŠä¿ç•™ç‰¹å¾å€¼ï¼ˆç”¨äºè§£é‡Šæ–¹å·®æ¯”ä¾‹çš„æŒ‡æ ‡ï¼‰å¤§äº1.0çš„å› å­ã€‚ç‰¹å¾å€¼ä¸º1.0å¯¹åº”äºå¯èƒ½å½’å› äºå•ä¸ªè‡ªå˜é‡çš„æ–¹å·®é‡ï¼›æ•è·æ¯”æ­¤ç±»é¡¹æ›´å°‘æ–¹å·®çš„å› å­å¯èƒ½è¢«è®¤ä¸ºç›¸å¯¹ä¸é‡è¦ã€‚\nscreen plotå’Œeigenvalueså¯ä»¥é€šè¿‡ä½¿ç”¨nFactorsä¸­çš„nScree()å‡½æ•°ä»åˆ†æä¸­æ­£å¼è·å¾—ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026gt; nScree(brand.mean) noc naf nparallel nkaiser 1 2 2 2 2 \u0026gt; eigen(cor(brand.mean)) eigen() decomposition $values [1] 4.556177847 3.010042148 0.591344314 0.378203844 0.259922697 0.134407115 0.046251850 0.021281662 0.002368523 $vectors [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [1,] -0.2852486 -0.33729698 0.48121446 0.46995620 0.39623804 0.43471514 -0.02784431 0.074243080 0.012984626 [2,] -0.2473668 -0.45654557 -0.31711577 -0.19084693 -0.06130157 0.11868317 0.60997229 0.021119910 0.450594077 [3,] 0.3562989 -0.25056983 -0.49589600 0.27477470 0.46061874 -0.08173299 0.19587019 -0.119316063 -0.466262266 [4,] 0.3355152 0.33455495 -0.15167546 0.32394053 -0.38757837 0.63609709 0.24602385 0.179248006 -0.008094488 [5,] -0.2121240 -0.47463096 -0.24371327 -0.21229430 -0.39428137 0.33437227 -0.43881277 0.005157446 -0.406716076 [6,] -0.3613409 0.27776101 -0.45940272 0.29120398 0.11248446 0.12716342 -0.31905166 -0.512721569 0.320827507 [7,] -0.4010778 0.24062869 -0.33576144 0.05052374 0.20581208 -0.08329187 -0.08325891 0.778125659 -0.065102236 [8,] 0.3114405 -0.37521575 -0.08724910 0.48392969 -0.27261916 -0.33925412 -0.32150758 0.243224760 0.410460300 [9,] -0.4295359 0.04438337 0.09031492 0.44234693 -0.43824713 -0.36828116 0.35159046 -0.141872872 -0.371841553 nScree()åº”ç”¨äº†å‡ ç§æ–¹æ³•æ¥ä»å±å¹•æµ‹è¯•ä¸­ä¼°è®¡å› å­çš„æ•°é‡ã€‚ nScree()\nç”¨äºç»˜åˆ¶Scree Plotï¼ˆå±å¹•å›¾ï¼‰ï¼Œä»¥å¸®åŠ©ç¡®å®šå› å­åˆ†æä¸­çš„å› å­æ•°é‡ã€‚\nåŸºæœ¬è¯­æ³•æ˜¯ï¼š\n1 nScree(fit) å…¶ä¸­ï¼Œfitæ˜¯ä¸€ä¸ªåŒ…å«å› å­åˆ†æç»“æœçš„å¯¹è±¡ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨nFactorsåŒ…ä¸­çš„fa()å‡½æ•°è¿›è¡Œå› å­åˆ†æåå¾—åˆ°çš„ç»“æœã€‚\næ­¤å‡½æ•°å°†ä¼šç»˜åˆ¶ä¸€ä¸ªScree Plotï¼Œå›¾ä¸­æ¨ªè½´è¡¨ç¤ºå› å­æ•°é‡ï¼Œçºµè½´è¡¨ç¤ºç‰¹å¾å€¼ï¼ˆeigenvalueï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®ç‰¹å¾å€¼çš„å˜åŒ–è¶‹åŠ¿æ¥å¸®åŠ©ç¡®å®šåˆé€‚çš„å› å­æ•°é‡ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šè§‚å¯ŸScree Plotä¸­ç‰¹å¾å€¼å¼€å§‹æ€¥å‰§ä¸‹é™çš„ä½ç½®ï¼Œè¿™ä¸ªä½ç½®ä¹‹å‰çš„å› å­æ•°é‡é€šå¸¸è¢«è®¤ä¸ºæ˜¯é€‚å½“çš„å› å­æ•°é‡ã€‚\nåœ¨æ‚¨çš„æƒ…å†µä¸‹ï¼Œæ‚¨ä½¿ç”¨nScree(brand.mean)ï¼Œå…¶ä¸­brand.meanæ˜¯æ‚¨çš„æ•°æ®ï¼Œå°†ä¼šç»˜åˆ¶ä¸€ä¸ªScree Plotæ¥å¸®åŠ©æ‚¨ç¡®å®šé€‚å½“çš„å› å­æ•°é‡ã€‚æ‚¨å¯ä»¥æ ¹æ®Scree Plotçš„ç»“æœæ¥é€‰æ‹©åˆé€‚çš„å› å­æ•°é‡ï¼Œä»¥ä¾¿åœ¨å› å­åˆ†æä¸­è·å¾—æœ€ä½³çš„è§£é‡ŠåŠ›å’Œç®€åŒ–åº¦ã€‚\neigen()\neigen() å‡½æ•°æ˜¯Rè¯­è¨€ä¸­ç”¨äºè®¡ç®—çŸ©é˜µç‰¹å¾å€¼ï¼ˆeigenvaluesï¼‰å’Œç‰¹å¾å‘é‡ï¼ˆeigenvectorsï¼‰çš„å‡½æ•°ã€‚åœ¨å› å­åˆ†æä¸­ï¼Œå®ƒé€šå¸¸ç”¨äºè®¡ç®—ç›¸å…³çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼Œä»¥ä¾¿è¿›è¡Œä¸»æˆåˆ†åˆ†ææˆ–å› å­åˆ†æã€‚\n1 eigen(x) å…¶ä¸­ï¼Œxæ˜¯ä¸€ä¸ªæ–¹é˜µï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªç›¸å…³çŸ©é˜µæˆ–åæ–¹å·®çŸ©é˜µã€‚\neigen()å‡½æ•°è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«äº†ä¸¤ä¸ªå…ƒç´ ï¼š\n$valuesï¼šä¸€ä¸ªå‘é‡ï¼ŒåŒ…å«äº†çŸ©é˜µçš„ç‰¹å¾å€¼ã€‚ $vectorsï¼šä¸€ä¸ªçŸ©é˜µï¼Œæ¯ä¸€åˆ—æ˜¯çŸ©é˜µçš„ä¸€ä¸ªç‰¹å¾å‘é‡ã€‚ è¿™äº›ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡å¯ä»¥ç”¨äºè¿›è¡Œä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰æˆ–å› å­åˆ†æï¼ˆFAï¼‰ï¼Œä»¥åŠå…¶ä»–éœ€è¦è®¡ç®—çŸ©é˜µç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çš„åˆ†ææ–¹æ³•ã€‚\næœ€ç»ˆæ¨¡å‹çš„é€‰æ‹©å–å†³äºå®ƒæ˜¯å¦æœ‰ç”¨ã€‚æœ€ä½³å®è·µæ˜¯æ£€æŸ¥å‡ ä¸ªå› å­è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬screeå’Œeigenvaluesç»“æœå»ºè®®çš„è§£å†³æ–¹æ¡ˆã€‚\n1 2 3 \u0026gt; brand.fa \u0026lt;- factanal(brand.mean, factors = 2, rotation = \u0026#34;varimax\u0026#34;, scores = \u0026#34;regression\u0026#34;) å› å­åˆ†æå¯ä»¥è¿›è¡Œæ—‹è½¬ï¼Œä»¥å…·æœ‰è§£é‡Šç›¸åŒæ–¹å·®æ¯”ä¾‹çš„æ–°è½½è·ã€‚factanal()ä¸­çš„é»˜è®¤è®¾ç½®æ˜¯æ‰¾åˆ°å„å› å­ä¹‹é—´çš„é›¶ç›¸å…³æ€§ï¼ˆä½¿ç”¨varimaxæ—‹è½¬ï¼‰ã€‚ 3.2 Factor loadings å› å­è½½è·æ˜¯ä»è½½è·å€¼ä¸­è·å¾—çš„ã€‚\n1 \u0026gt; brand.fl\u0026lt;- brand.fa$loadings[, 1:2] å¯ä»¥ç®€å•åœ°ä½¿ç”¨å› å­è½½è·å°†å˜é‡ç»˜åˆ¶åœ¨ä¸¤ä¸ªå› å­ä¸Šã€‚ä¾‹å¦‚ï¼š\n1 2 3 \u0026gt; plot(brand.fl,type=\u0026#34;n\u0026#34;) # set up plot \u0026gt; text(brand.fl,labels=names(brand.mean),cex=.7) {% asset_image R_week3_factor_loading.png %}\n3.3 Factor scores ä»factanal()è¯·æ±‚å› å­å¾—åˆ†æ˜¯é€šè¿‡æ·»åŠ \u0026quot;scores = \u0026hellip;\u0026ldquo;å‚æ•°å®ç°çš„ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä»ç”Ÿæˆçš„å¯¹è±¡ä¸­æå–å®ƒä»¬ä»¥å½¢æˆä¸€ä¸ªæ–°çš„æ•°æ®æ¡†ã€‚\n1 brand.fs \u0026lt;- brand.fa$scores æˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨å› å­å¾—åˆ†å°†å“ç‰Œç»˜åˆ¶åœ¨ä¸¤ä¸ªå› å­ä¸Šã€‚ä¾‹å¦‚ï¼š\n1 2 3 \u0026gt; plot(brand.fl,type=\u0026#34;n\u0026#34;) # set up plot \u0026gt; text(brand.fl,labels=rownames(brand.mean),cex=.7) {% asset_image R_week3_factor_scores.png %}\nRecap æ€»ç»“ä¸€ä¸‹ï¼Œå½“å¸Œæœ›è·¨å¤šä¸ªç»´åº¦æ¯”è¾ƒå‡ ä¸ªå“ç‰Œæ—¶ï¼Œå°†æ³¨æ„åŠ›é›†ä¸­åœ¨è§£é‡Šæ•°æ®å˜å¼‚çš„å‰ä¸¤ä¸ªæˆ–ä¸‰ä¸ªä¸»æˆåˆ†ä¸Šå¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å±å¹•å›¾é€‰æ‹©è¦å…³æ³¨çš„ä¸»æˆåˆ†æ•°é‡ï¼Œè¯¥å›¾æ˜¾ç¤ºäº†æ¯ä¸ªä¸»æˆåˆ†è§£é‡Šæ•°æ®ä¸­çš„å¤šå°‘å˜åŒ–ã€‚æ„ŸçŸ¥åœ°å›¾å°†å“ç‰Œç»˜åˆ¶åœ¨å‰ä¸¤ä¸ªä¸»æˆåˆ†ä¸Šï¼Œæ­ç¤ºäº†è§‚å¯Ÿç»“æœä¸æ½œåœ¨ç»´åº¦ï¼ˆå³æˆåˆ†ï¼‰çš„å…³ç³»ã€‚\nPCAå¯ä»¥ä½¿ç”¨å“ç‰Œè°ƒæŸ¥è¯„åˆ†ï¼ˆå¦‚æˆ‘ä»¬åœ¨æ­¤å¤„æ‰€åšçš„ï¼‰è¿›è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä»·æ ¼å’Œç‰©ç†æµ‹é‡ç­‰å®¢è§‚æ•°æ®ï¼Œæˆ–è€…äºŒè€…çš„ç»„åˆè¿›è¡Œã€‚æ— è®ºåœ¨å“ªç§æƒ…å†µä¸‹ï¼Œå½“æ‚¨é¢å¯¹å“ç‰Œæˆ–äº§å“çš„å¤šç»´æ•°æ®æ—¶ï¼ŒPCAå¯è§†åŒ–éƒ½æ˜¯äº†è§£å¸‚åœºå·®å¼‚çš„æœ‰ç”¨å·¥å…·ã€‚\nCode 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 library(\u0026#34;corrplot\u0026#34;) library(\u0026#34;gplots\u0026#34;) library(\u0026#34;nFactors\u0026#34;) brand.ratings \u0026lt;- read.csv(\u0026#34;Data_Factor_Analysis.csv\u0026#34;, stringsAsFactors = TRUE) head(brand.ratings) summary(brand.ratings) str(brand.ratings) brand.sc \u0026lt;- brand.ratings brand.sc[,1:9] \u0026lt;- scale (brand.ratings[,1:9]) #we select all rows and the first 9 columns as the 10th column is a factor variable. summary(brand.sc) cor(brand.sc[,1:9]) corrplot(cor(brand.sc[,1:9])) corrplot(cor(brand.sc[,1:9]), order = \u0026#34;hclust\u0026#34;) brand.mean \u0026lt;- aggregate(. ~ brand, data=brand.sc, mean) brand.mean rownames(brand.mean) \u0026lt;- brand.mean[, 1] # Use brand for the row name brand.mean \u0026lt;- brand.mean [, -1] # Remove the brand name column by not selecting the first column # Negative index is used to exclude the variable brand.mean heatmap.2(as.matrix(brand.mean),main = \u0026#34;Brand attributes\u0026#34;, trace = \u0026#34;none\u0026#34;, key = FALSE, dend = \u0026#34;none\u0026#34;) #turn off some options brand.pc\u0026lt;- princomp(brand.mean, cor = TRUE) #We added \u0026#34;cor =TRUE\u0026#34; to use correlation-based one. summary(brand.pc) plot(brand.pc,type=\u0026#34;l\u0026#34;) # scree plot loadings(brand.pc) # pc loadings biplot(brand.pc, main = \u0026#34;Brand positioning\u0026#34;) brand.mean[\u0026#34;c\u0026#34;,] - brand.mean[\u0026#34;e\u0026#34;,] colMeans(brand.mean[c(\u0026#34;b\u0026#34;,\u0026#34;c\u0026#34;,\u0026#34;f\u0026#34;,\u0026#34;g\u0026#34;),]) - brand.mean[\u0026#34;e\u0026#34;,] nScree(brand.mean) eigen(cor(brand.mean)) brand.fa \u0026lt;- factanal(brand.mean, factors = 2, rotation = \u0026#34;varimax\u0026#34;, scores = \u0026#34;regression\u0026#34;) brand.fl\u0026lt;- brand.fa$loadings[, 1:2] plot(brand.fl,type=\u0026#34;n\u0026#34;) # set up plot text(brand.fl,labels=names(brand.mean),cex=.7) plot(brand.fl,type=\u0026#34;n\u0026#34;) # set up plot text(brand.fl,labels=rownames(brand.mean),cex=.7) ","date":"2024-03-23T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek3-factor-analysis-for-perceptual-maps-code/","title":"R[week3] Factor Analysis For Perceptual Maps Code"},{"content":"Prepare æ”¶é›†æ•°æ®ï¼šé€šè¿‡è°ƒæŸ¥é—®å·æ”¶é›†ç›®æ ‡æ¶ˆè´¹è€…ç¾¤ä½“å¯¹é€‰å®šå“ç‰Œåœ¨å…³é”®å±æ€§ä¸Šçš„è¯„ä»·ã€‚ é€‰æ‹©å±æ€§ï¼šç¡®å®šå“ªäº›å±æ€§å¯¹ç›®æ ‡æ¶ˆè´¹è€…ç¾¤ä½“æ¥è¯´æœ€é‡è¦ã€‚ Perceptual mapping æ„ŸçŸ¥æ˜ å°„ï¼Œå¯è§†åŒ–ç°å®æ¶ˆè´¹è€…è§‚ç‚¹\n{% asset_image R_week3_perceptual_mapping.png %}\nFactor Analysis æ•°æ®ç®€åŒ–ï¼Œé™ç»´åˆ°å°‘é‡factorï¼Œä½¿ç”¨å› å­åˆ†ææ¥å‡å°‘å±æ€§çš„æ•°é‡ï¼Œåªä¿ç•™æœ€èƒ½è§£é‡Šæ•°æ®å˜å¼‚çš„å› å­ã€‚ å‹ç¼©æˆç®€çŸ­çš„ç›¸ä¼¼ç‰¹å¾ï¼Œæ„å»ºæ„ŸçŸ¥å›¾ã€‚ è§£é‡Šå› å­ï¼šæ ¹æ®å±æ€§çš„å› å­è½½è·ï¼ˆå³å±æ€§ä¸å› å­ä¹‹é—´çš„ç›¸å…³æ€§ï¼‰ï¼Œè§£é‡Šæ¯ä¸ªå› å­ä»£è¡¨çš„æ½œåœ¨æ¦‚å¿µã€‚ Create perceptual map é€‰æ‹©å› å­ï¼šæ ¹æ®å› å­åˆ†æçš„ç»“æœï¼Œé€‰æ‹©ä¸¤ä¸ªæˆ–ä¸‰ä¸ªæœ€ä¸»è¦çš„å› å­æ¥åˆ›å»ºæ„ŸçŸ¥å›¾ã€‚ è®¡ç®—å› å­å¾—åˆ†ï¼šä¸ºæ¯ä¸ªå“ç‰Œè®¡ç®—æ¯ä¸ªå› å­çš„å¾—åˆ†ï¼Œè¿™äº›å¾—åˆ†å°†ç”¨äºåœ¨æ„ŸçŸ¥å›¾ä¸Šå®šä½å“ç‰Œã€‚ ç»˜åˆ¶æ„ŸçŸ¥å›¾ï¼šåœ¨ä¸€ä¸ªäºŒç»´å¹³é¢ä¸Šï¼Œä»¥é€‰å®šçš„å› å­ä¸ºåæ ‡è½´ï¼Œç»˜åˆ¶æ¯ä¸ªå“ç‰Œçš„ç‚¹ã€‚ Pearsonç›¸å…³ç³»æ•°ï¼ˆPearson Correlation Coefficientï¼‰\næ˜¯ç”¨æ¥è¡¡é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çº¿æ€§ç›¸å…³ç¨‹åº¦çš„ç»Ÿè®¡æŒ‡æ ‡ã€‚å…¶è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š\n$$ r = \\frac{\\sum((x_i - \\bar{x}) \\cdot (y_i - \\bar{y}))}{\\sqrt{\\sum(x_i - \\bar{x})^2} \\cdot \\sqrt{\\sum(y_i - \\bar{y})^2}} $$ç›¸å…³ç³»æ•°çš„å€¼èŒƒå›´ä» -1 åˆ° 1ï¼Œå…¶ä¸­ -1 è¡¨ç¤ºå®Œå…¨è´Ÿç›¸å…³ï¼Œ1 è¡¨ç¤ºå®Œå…¨æ­£ç›¸å…³ï¼Œ0 è¡¨ç¤ºæ²¡æœ‰çº¿æ€§ç›¸å…³æ€§ã€‚\nExplain åˆ†æå“ç‰Œä½ç½®ï¼šè§‚å¯Ÿå“ç‰Œåœ¨æ„ŸçŸ¥å›¾ä¸Šçš„ç›¸å¯¹ä½ç½®ï¼Œäº†è§£å®ƒä»¬åœ¨æ¶ˆè´¹è€…å¿ƒç›®ä¸­çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿ã€‚ åˆ¶å®šç­–ç•¥ï¼šåŸºäºæ„ŸçŸ¥å›¾çš„ç»“æœï¼Œåˆ¶å®šå“ç‰Œå®šä½ç­–ç•¥ï¼Œä»¥æ”¹å–„å“ç‰Œå½¢è±¡æˆ–åŒºåˆ†ç«äº‰å¯¹æ‰‹ã€‚ {% asset_image R_week3_jobs.png %}\n","date":"2024-03-22T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek3-factor-analysis-for-perceptual-maps-lecture/","title":"R[week3] Factor Analysis For Perceptual Maps Lecture"},{"content":" R: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\n1. Segmentation data â€¢ å¹´é¾„ï¼ˆageï¼‰\nâ€¢ æ€§åˆ«ï¼ˆgenderï¼‰\nâ€¢ æ”¶å…¥ï¼ˆincomeï¼‰\nâ€¢ å­©å­æ•°é‡ï¼ˆkidsï¼‰\nâ€¢ æ˜¯å¦æ‹¥æœ‰æˆ–ç§Ÿèµä½æˆ¿ï¼ˆownHomeï¼‰\nâ€¢ å½“å‰æ˜¯å¦è®¢é˜…æ‰€æä¾›çš„ä¼šå‘˜æœåŠ¡ï¼ˆsubscribeï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026gt; seg.df \u0026lt;- read.csv(\u0026#34;Data_Segmentation.csv\u0026#34;, stringsAsFactors = TRUE) \u0026gt; head(seg.df, n=8) \u0026gt; head(seg.df, n=8) age gender income kids ownHome subscribe 1 47.31613 Male 49482.81 2 ownNo subNo 2 31.38684 Male 35546.29 1 ownYes subNo 3 43.20034 Male 44169.19 0 ownYes subNo 4 37.31700 Female 81041.99 1 ownNo subNo 5 40.95439 Female 79353.01 3 ownYes subNo 6 43.03387 Male 58143.36 4 ownYes subNo 7 37.55696 Male 19282.23 3 ownNo subNo 8 28.45129 Male 47245.24 0 ownNo subNo 1.1 Recode factor into numeric data 1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; seg.df$gender \u0026lt;- ifelse(seg.df$gender==\u0026#34;Male\u0026#34;,0,1) \u0026gt; seg.df$ownHome \u0026lt;- ifelse(seg.df$ownHome == \u0026#34;ownNo\u0026#34;, 0,1) \u0026gt; seg.df$subscribe \u0026lt;- ifelse(seg.df$subscribe == \u0026#34;subNo\u0026#34;, 0,1) \u0026gt; head(seg.df) age gender income kids ownHome subscribe 1 47.31613 0 49482.81 2 0 0 2 31.38684 0 35546.29 1 1 0 3 43.20034 0 44169.19 0 1 0 4 37.31700 1 81041.99 1 0 0 5 40.95439 1 79353.01 3 1 0 6 43.03387 0 58143.36 4 1 0 1.2 Rescaling the data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026gt; seg.df.sc \u0026lt;- seg.df \u0026gt; seg.df.sc[, c(1,3,4)] \u0026lt;- scale(seg.df[, c(1,3,4)]) # We only need to standardize continuous variables. \u0026gt; head(seg.df.sc) age gender income kids ownHome subscribe 1 0.48133138 0 -0.0721898 0.5183027 0 0 2 -0.77221071 0 -0.7642562 -0.1917010 1 0 3 0.15744276 0 -0.3360563 -0.9017048 1 0 4 -0.30554218 1 1.4949908 -0.1917010 0 0 5 -0.01930052 1 1.4111190 1.2283065 1 0 6 0.14434200 0 0.3578800 1.9383103 1 0 \u0026gt; summary(seg.df.sc, digits = 2) age gender income kids ownHome subscribe Min. :-1.73 Min. :0.00 Min. :-2.787 Min. :-0.90 Min. :0.00 Min. :0.00 1st Qu.:-0.64 1st Qu.:0.00 1st Qu.:-0.560 1st Qu.:-0.90 1st Qu.:0.00 1st Qu.:0.00 Median :-0.13 Median :1.00 Median : 0.054 Median :-0.19 Median :0.00 Median :0.00 Mean : 0.00 Mean :0.52 Mean : 0.000 Mean : 0.00 Mean :0.47 Mean :0.13 3rd Qu.: 0.53 3rd Qu.:1.00 3rd Qu.: 0.520 3rd Qu.: 0.52 3rd Qu.:1.00 3rd Qu.:0.00 Max. : 3.09 Max. :1.00 Max. : 3.145 Max. : 4.07 Max. :1.00 Max. :1.00 2. Hierarchical clustering: hclust() 2.1 Distance 1 2 3 4 5 6 7 8 9 \u0026gt; seg.dist \u0026lt;- dist(seg.df.sc) \u0026gt; as.matrix(seg.dist)[1:5, 1:5] 1 2 3 4 5 1 0.000000 1.885319 1.786323 2.139937 2.225970 2 1.885319 0.000000 1.245679 2.705915 2.883670 3 1.786323 1.245679 0.000000 2.463979 2.936121 4 2.139937 2.705915 2.463979 0.000000 1.762212 5 2.225970 2.883670 2.936121 1.762212 0.000000 2.2 Clustering 1 2 \u0026gt; seg.hc \u0026lt;- hclust(seg.dist, method=\u0026#34;complete\u0026#34;) \u0026gt; plot(seg.hc) {% asset_image R_week2_cluster_plot.png %}\nhclust(d, method = \u0026ldquo;complete\u0026rdquo;)\ndï¼šæ•°æ®çš„è·ç¦»çŸ©é˜µæˆ–ç›¸ä¼¼åº¦çŸ©é˜µã€‚è·ç¦»çŸ©é˜µæ˜¯ä¸€ä¸ªå¯¹ç§°çŸ©é˜µï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸¤ä¸ªè§‚æµ‹ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚ç›¸ä¼¼åº¦çŸ©é˜µä¹Ÿæ˜¯ä¸€ä¸ªå¯¹ç§°çŸ©é˜µï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸¤ä¸ªè§‚æµ‹ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚é€šå¸¸å¯ä»¥ä½¿ç”¨ dist() å‡½æ•°è®¡ç®—è·ç¦»çŸ©é˜µæˆ–ç›¸ä¼¼åº¦çŸ©é˜µã€‚\nmethodï¼šæŒ‡å®šç”¨äºè®¡ç®—ç°‡é—´è·ç¦»çš„æ–¹æ³•ã€‚å¸¸ç”¨çš„æ–¹æ³•åŒ…æ‹¬ï¼š\n\u0026ldquo;single\u0026rdquo;ï¼šæœ€çŸ­è·ç¦»æ³•ï¼ˆsingle linkageï¼‰ã€‚ \u0026ldquo;complete\u0026rdquo;ï¼šæœ€è¿œè·ç¦»æ³•ï¼ˆcomplete linkageï¼‰ã€‚ \u0026ldquo;average\u0026rdquo;ï¼šå¹³å‡è·ç¦»æ³•ï¼ˆaverage linkageï¼‰ã€‚ \u0026ldquo;ward.D\u0026rdquo;ï¼šWard\u0026rsquo;s æ–¹æ³•ï¼Œé€šè¿‡æœ€å°åŒ–ç°‡å†…æ–¹å·®æ¥åˆå¹¶ç°‡ã€‚ hclust() å‡½æ•°è¿”å›ä¸€ä¸ªæ ‘å½¢ç»“æ„å¯¹è±¡ï¼ˆdendrogramï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ plot() å‡½æ•°å¯¹å…¶è¿›è¡Œå¯è§†åŒ–ã€‚é€šè¿‡è°ƒæ•´ method å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶èšç±»çš„æ–¹å¼ä»¥åŠç°‡é—´çš„ç›¸ä¼¼æ€§åº¦é‡ã€‚\n1 \u0026gt; plot(cut(as.dendrogram(seg.hc), h = 4)$lower[[1]]) {% asset_image R_week2_cluster_plot_2.png %}\n1 2 3 4 5 6 7 8 9 \u0026gt; seg.df[c(156, 152),] #similar age gender income kids ownHome subscribe 156 66.89691 0 54060.59 0 1 0 152 64.45890 0 61052.08 0 1 0 \u0026gt; seg.df[c(156, 183),] #less similar age gender income kids ownHome subscribe 156 66.89691 0 54060.59 0 1 0 183 57.79006 1 105537.82 0 1 0 as.dendrogram()\nå°†ä¸åŒçš„å¯¹è±¡è½¬æ¢ä¸ºæ ‘å½¢ç»“æ„å¯¹è±¡ã€‚å®ƒå¯ä»¥æ¥å—å¤šç§ä¸åŒçš„è¾“å…¥å¯¹è±¡ï¼ŒåŒ…æ‹¬ï¼š\nhclust å¯¹è±¡ï¼šä» hclust() å‡½æ•°è¿”å›çš„èšç±»ç»“æœå¯¹è±¡ã€‚ agnes å¯¹è±¡ï¼šä» agnes() å‡½æ•°è¿”å›çš„èšç±»ç»“æœå¯¹è±¡ã€‚ phylo å¯¹è±¡ï¼šä» ape åŒ…ä¸­çš„å‡½æ•°è¿”å›çš„ç³»ç»Ÿå‘è‚²æ ‘å¯¹è±¡ã€‚ dist å¯¹è±¡ï¼šè·ç¦»çŸ©é˜µå¯¹è±¡ï¼Œè¡¨ç¤ºè§‚æµ‹ç‚¹ä¹‹é—´çš„è·ç¦»æˆ–ç›¸ä¼¼åº¦ã€‚ ä½¿ç”¨ as.dendrogram() å‡½æ•°å¯ä»¥å°†ä»¥ä¸Šè¿™äº›å¯¹è±¡è½¬æ¢ä¸º dendrogram å¯¹è±¡ï¼Œç„¶åå¯ä»¥ä½¿ç”¨ dendrogram å¯¹è±¡è¿›è¡Œå¯è§†åŒ–ã€åˆ†ææˆ–å…¶ä»–æ“ä½œã€‚\n2.3 Getting groups 1 2 3 \u0026gt; plot(seg.hc) \u0026gt; rect.hclust(seg.hc, k=4, border = \u0026#34;red\u0026#34;) {% asset_image R_week2_getting_group_plot.png %}\n1 2 3 4 5 6 \u0026gt; seg.hc.segment \u0026lt;- cutree(seg.hc, k=4) #membership vector for 4 groups \u0026gt; table(seg.hc.segment) #counts seg.hc.segment 1 2 3 4 164 73 30 33 2.4 Describing clusters 1 2 3 4 5 6 7 8 library(cluster) clusplot(seg.df, seg.hc.segment, color = TRUE, #color the lines = 0, #omit distance lines between groups main = \u0026#34;Hierarchical cluster plot\u0026#34;, # figure title groupsshade = TRUE, #shade the ellipses for group membership labels = 4, #label only the groups, not the individual points ) {% asset_image R_week2_describing_clusters_plot.png %}\n1 2 3 4 5 6 \u0026gt; aggregate(seg.df, list(seg.hc.segment), mean) Group.1 age gender income kids ownHome subscribe 1 1 35.70250 0.5121951 45474.72 0.847561 0.3292683 0.15243902 2 2 37.34969 0.5479452 54571.75 3.273973 0.4520548 0.08219178 3 3 57.61221 0.6333333 40589.64 0.100000 0.9333333 0.16666667 4 4 62.11487 0.4242424 79444.84 0.000000 0.7878788 0.12121212 1 boxplot(seg.df$income ~ seg.hc.segment, ylab = \u0026#34;Income\u0026#34;, xlab = \u0026#34;Cluster\u0026#34;) {% asset_image R_week2_describing_clusters_plot_2.png %}\nboxplot()\nç»˜åˆ¶ç®±çº¿å›¾ï¼Œæ˜¯ä¸€ç§å¸¸ç”¨çš„ç»Ÿè®¡å›¾å½¢ï¼Œç”¨äºæ˜¾ç¤ºä¸€ç»„æ•°æ®çš„åˆ†å¸ƒæƒ…å†µï¼ŒåŒ…æ‹¬ä¸­ä½æ•°ã€å››åˆ†ä½æ•°ã€æå€¼ç­‰ã€‚\nç®±çº¿å›¾\nç®±çº¿å›¾ï¼ˆBoxplotï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„ç»Ÿè®¡å›¾å½¢ï¼Œç”¨äºæ˜¾ç¤ºä¸€ç»„æ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€‚å®ƒæä¾›äº†å…³äºæ•°æ®åˆ†å¸ƒã€ä¸­å¿ƒä½ç½®ã€ç¦»æ•£ç¨‹åº¦å’Œå¼‚å¸¸å€¼ç­‰æ–¹é¢çš„ç›´è§‚ä¿¡æ¯ã€‚ç®±çº¿å›¾é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š\nç®±å­ï¼ˆBoxï¼‰ï¼šç®±å­ç”±ä¸¤æ¡æ°´å¹³çº¿æ®µç»„æˆï¼Œåˆ†åˆ«è¡¨ç¤ºæ•°æ®çš„ä¸Šå››åˆ†ä½æ•°ï¼ˆQ3ï¼‰å’Œä¸‹å››åˆ†ä½æ•°ï¼ˆQ1ï¼‰ã€‚ç®±å­çš„ä¸­é—´çº¿è¡¨ç¤ºæ•°æ®çš„ä¸­ä½æ•°ï¼ˆQ2ï¼‰ã€‚\né¡»ï¼ˆWhiskersï¼‰ï¼šé¡»å»¶ä¼¸å‡ºç®±å­çš„ä¸¤ç«¯ï¼Œé€šå¸¸ç”±ç›´çº¿æˆ–çº¿æ®µè¡¨ç¤ºã€‚é¡»çš„é•¿åº¦é€šå¸¸æ˜¯ç®±å­é«˜åº¦çš„1.5å€çš„å››åˆ†ä½è·ï¼ˆIQR = Q3 - Q1ï¼‰ã€‚é¡»çš„ç«¯ç‚¹é€šå¸¸æ˜¯æœ€å¤§éå¼‚å¸¸å€¼å’Œæœ€å°éå¼‚å¸¸å€¼ï¼Œä½†å…·ä½“çš„å®šä¹‰å¯èƒ½å› æ•°æ®åˆ†å¸ƒè€Œå¼‚ã€‚\nå¼‚å¸¸å€¼ï¼ˆOutliersï¼‰ï¼šåœ¨ç®±å­çš„é¡»ä¹‹å¤–çš„æ•°æ®ç‚¹è¢«è§†ä¸ºå¼‚å¸¸å€¼ï¼Œå¹¶å•ç‹¬ç»˜åˆ¶å‡ºæ¥ï¼Œé€šå¸¸ä»¥åœ†åœˆæˆ–æ˜Ÿå·è¡¨ç¤ºã€‚\nç®±çº¿å›¾çš„ç»˜åˆ¶è¿‡ç¨‹é€šå¸¸æ¶‰åŠä»¥ä¸‹æ­¥éª¤ï¼š\nè®¡ç®—æ•°æ®çš„æè¿°æ€§ç»Ÿè®¡é‡ï¼ŒåŒ…æ‹¬æœ€å°å€¼ã€æœ€å¤§å€¼ã€ä¸­ä½æ•°ã€å››åˆ†ä½æ•°ç­‰ã€‚ æ ¹æ®è®¡ç®—çš„æè¿°æ€§ç»Ÿè®¡é‡ç»˜åˆ¶ç®±å­å’Œé¡»ã€‚ æ ¹æ®æ•°æ®ä¸­çš„å¼‚å¸¸å€¼ç»˜åˆ¶å¼‚å¸¸å€¼ã€‚ æ·»åŠ é¢å¤–çš„æ³¨é‡Šå’Œæ ‡ç­¾ï¼Œä½¿å¾—å›¾å½¢æ›´åŠ æ¸…æ™°æ˜“æ‡‚ã€‚ ç®±çº¿å›¾å¯ä»¥ç”¨äºæ¯”è¾ƒä¸åŒç»„ä¹‹é—´çš„æ•°æ®åˆ†å¸ƒæƒ…å†µï¼Œæ£€æµ‹å¼‚å¸¸å€¼ï¼Œä»¥åŠè§‚å¯Ÿæ•°æ®çš„ç¦»æ•£ç¨‹åº¦ã€‚å®ƒæ˜¯ä¸€ç§ç®€æ´è€Œæœ‰æ•ˆçš„å¯è§†åŒ–å·¥å…·ï¼Œé€‚ç”¨äºå„ç§ç±»å‹çš„æ•°æ®åˆ†æå’Œæ¢ç´¢ã€‚\n3. Mean-based clustering: kmeans() 3.1 Clustering 1 2 \u0026gt; set.seed(96743) \u0026gt; seg.k \u0026lt;- kmeans(seg.df.sc, centers = 4) #use standardized variables 3.2 Describing clusters 1 2 3 4 5 6 \u0026gt; aggregate(seg.df, list(seg.k$cluster), mean) Group.1 age gender income kids ownHome subscribe 1 1 26.12680 0.3728814 21850.99 1.16949153 0.2542373 0.16949153 2 2 59.86977 0.5522388 66319.07 0.02985075 0.7611940 0.08955224 3 3 38.10768 0.6136364 56864.13 2.96590909 0.4772727 0.11363636 4 4 40.15887 0.5116279 52841.06 0.56976744 0.3837209 0.16279070 1 boxplot(seg.df$income ~ seg.k$cluster, ylab = \u0026#34;Income\u0026#34;, xlab = \u0026#34;Cluster\u0026#34;) {% asset_image R_week2_means_describing_clusters_plot.png %}\n1 2 3 4 5 6 7 clusplot(seg.df, seg.k$cluster, color = TRUE, shade = TRUE, labels = 4, lines = 0, main = \u0026#34;K_means cluster plot\u0026#34;, ) {% asset_image R_week2_means_describing_clusters_plot_2.png %}\nè¿™å¯èƒ½æš—ç¤ºäº†ä¸€ç§å•†ä¸šç­–ç•¥ã€‚åœ¨å½“å‰æƒ…å†µä¸‹ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬çœ‹åˆ°ç¬¬äºŒç»„åœ¨ä¸€å®šç¨‹åº¦ä¸Šæœ‰æ‰€åŒºåˆ«ï¼Œå¹¶ä¸”æ‹¥æœ‰æœ€é«˜çš„å¹³å‡æ”¶å…¥ã€‚è¿™å¯èƒ½ä½¿å…¶æˆä¸ºæ½œåœ¨å®£ä¼ æ´»åŠ¨çš„è‰¯å¥½ç›®æ ‡ã€‚è¿˜æœ‰è®¸å¤šå…¶ä»–ç­–ç•¥å¯ä¾›é€‰æ‹©ï¼›å…³é”®ç‚¹åœ¨äºåˆ†ææä¾›äº†å€¼å¾—è€ƒè™‘çš„æœ‰è¶£é€‰é¡¹ã€‚\nk-meansåˆ†æçš„ä¸€ä¸ªå±€é™æ€§æ˜¯éœ€è¦æŒ‡å®šèšç±»çš„æ•°é‡ï¼Œå¹¶ä¸”å¾ˆéš¾ç¡®å®šä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯å¦æ¯”å¦ä¸€ä¸ªæ›´å¥½ã€‚å¦‚æœæˆ‘ä»¬è¦å¯¹å½“å‰çš„é—®é¢˜ä½¿ç”¨k-meansï¼Œæˆ‘ä»¬å°†é‡å¤åˆ†æk=3ã€4ã€5ç­‰ï¼Œå¹¶ç¡®å®šå“ªä¸ªè§£å†³æ–¹æ¡ˆå¯¹æˆ‘ä»¬çš„ä¸šåŠ¡ç›®æ ‡æœ€æœ‰ç”¨ã€‚\n4. Model-based clustering: Mclust() å…³é”®æ€æƒ³æ˜¯è§‚å¯Ÿç»“æœæ¥è‡ªå…·æœ‰ä¸åŒç»Ÿè®¡åˆ†å¸ƒï¼ˆä¾‹å¦‚ä¸åŒçš„å‡å€¼å’Œæ–¹å·®ï¼‰çš„ç¾¤ä½“ã€‚ç®—æ³•è¯•å›¾æ‰¾åˆ°æœ€ä½³çš„ä¸€ç»„è¿™æ ·çš„æ½œåœ¨åˆ†å¸ƒï¼Œä»¥è§£é‡Šè§‚å¯Ÿåˆ°çš„æ•°æ®ã€‚\n4.1 Clustering 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026gt; library(mclust) #install if needed \u0026gt; seg.mc \u0026lt;- Mclust(seg.df.sc) \u0026gt; summary(seg.mc) ---------------------------------------------------- Gaussian finite mixture model fitted by EM algorithm ---------------------------------------------------- Mclust VEV (ellipsoidal, equal shape) model with 3 components: log-likelihood n df BIC ICL -1291.139 300 73 -2998.655 -2998.655 Clustering table: 1 2 3 163 71 66 ç»“æœæ˜¾ç¤ºï¼Œæ•°æ®è¢«ä¼°è®¡ä¸ºå…·æœ‰ä¸‰ä¸ªå¤§å°ä¸åŒçš„èšç±»ï¼Œå¦‚è¡¨æ‰€ç¤ºã€‚\næˆ‘ä»¬è¿˜çœ‹åˆ°å¯¹æ•°ä¼¼ç„¶ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æ¯”è¾ƒæ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°è¯•ä¸€ä¸ªå››ä¸ªèšç±»çš„è§£å†³æ–¹æ¡ˆã€‚\nå¯¹æ•°ä¼¼ç„¶ï¼ˆlog-likelihoodï¼‰æ˜¯ç»Ÿè®¡å­¦ä¸­ç”¨äºè¯„ä¼°æ¨¡å‹æ‹Ÿåˆä¼˜è‰¯åº¦çš„ä¸€ç§å¸¸ç”¨æŒ‡æ ‡ã€‚å®ƒé€šå¸¸ç”¨äºæè¿°ä¸€ä¸ªæ¨¡å‹å¯¹è§‚æµ‹æ•°æ®çš„æ‹Ÿåˆç¨‹åº¦æœ‰å¤šå¥½ã€‚å¯¹æ•°ä¼¼ç„¶å€¼è¶Šé«˜ï¼Œè¡¨ç¤ºæ¨¡å‹å¯¹è§‚æµ‹æ•°æ®çš„æ‹Ÿåˆè¶Šå¥½ã€‚\nå…·ä½“æ¥è¯´ï¼Œå¯¹æ•°ä¼¼ç„¶å€¼æ˜¯åœ¨ç»™å®šæ¨¡å‹å‚æ•°çš„æ¡ä»¶ä¸‹ï¼Œè§‚æµ‹æ•°æ®å‡ºç°çš„æ¦‚ç‡çš„å¯¹æ•°ã€‚å¯¹äºç»™å®šçš„è§‚æµ‹æ•°æ®é›†ï¼Œæˆ‘ä»¬å¯ä»¥å°†è§‚æµ‹æ•°æ®è§†ä¸ºä»ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒä¸­ç‹¬ç«‹åœ°æŠ½å–å¾—åˆ°çš„æ ·æœ¬ã€‚ç„¶åï¼Œå¯¹æ•°ä¼¼ç„¶å€¼è¡¨ç¤ºäº†åœ¨ç»™å®šæ¨¡å‹å‚æ•°çš„æ¡ä»¶ä¸‹ï¼Œè§‚æµ‹æ•°æ®å‡ºç°çš„å¯èƒ½æ€§å¤§å°ã€‚å¯¹æ•°ä¼¼ç„¶å€¼è¶Šé«˜ï¼Œè¡¨ç¤ºè§‚æµ‹æ•°æ®å‡ºç°çš„å¯èƒ½æ€§è¶Šå¤§ï¼Œå³æ¨¡å‹æ‹Ÿåˆæ•ˆæœè¶Šå¥½ã€‚\nåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯¹æ•°ä¼¼ç„¶å€¼é€šå¸¸ç”¨äºæ¯”è¾ƒä¸åŒæ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœã€‚æˆ‘ä»¬å¯ä»¥å¯¹åŒä¸€ç»„è§‚æµ‹æ•°æ®ä½¿ç”¨ä¸åŒçš„æ¨¡å‹è¿›è¡Œæ‹Ÿåˆï¼Œå¹¶è®¡ç®—æ¯ä¸ªæ¨¡å‹çš„å¯¹æ•°ä¼¼ç„¶å€¼ã€‚ç„¶åï¼Œé€šè¿‡æ¯”è¾ƒå¯¹æ•°ä¼¼ç„¶å€¼çš„å¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šå“ªä¸ªæ¨¡å‹å¯¹è§‚æµ‹æ•°æ®çš„æ‹Ÿåˆæ•ˆæœæ›´å¥½ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹æ•°ä¼¼ç„¶å€¼é€šå¸¸æ˜¯è´Ÿæ•°ã€‚è¿™æ˜¯å› ä¸ºå¯¹æ•°ä¼¼ç„¶å€¼æ˜¯ä¸€ä¸ªæ¦‚ç‡çš„å¯¹æ•°ï¼Œè€Œæ¦‚ç‡çš„å–å€¼èŒƒå›´æ˜¯0åˆ°1ä¹‹é—´ã€‚å› æ­¤ï¼Œå¯¹æ•°ä¼¼ç„¶å€¼è¶Šå¤§ï¼Œè¡¨ç¤ºæ¦‚ç‡è¶Šæ¥è¿‘äº1ï¼Œè€Œå¯¹æ•°ä¼¼ç„¶å€¼è¶Šå°ï¼ˆå³ç»å¯¹å€¼è¶Šå¤§ï¼‰ï¼Œè¡¨ç¤ºæ¦‚ç‡è¶Šæ¥è¿‘äº0ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026gt; seg.mc4 \u0026lt;- Mclust(seg.df.sc, G =4) #specifying the number of clusters \u0026gt; summary(seg.mc4) ---------------------------------------------------- Gaussian finite mixture model fitted by EM algorithm ---------------------------------------------------- Mclust VII (spherical, varying volume) model with 4 components: log-likelihood n df BIC ICL -1690.304 300 31 -3557.425 -3597.143 Clustering table: 1 2 3 4 51 74 119 56 çœ‹èµ·æ¥åˆ†ä¸º3ç»„æ—¶ï¼Œå¯¹æ•°ä¼¼ç„¶ä¼°è®¡æ›´é«˜ã€‚\n4.2 Comparing models 1 2 3 4 \u0026gt; BIC(seg.mc, seg.mc4) df BIC seg.mc 73 2998.655 seg.mc4 31 3557.425 3-cluster better.\n4.3 Describing clusters 1 2 3 4 5 6 7 8 9 10 \u0026gt; aggregate(seg.df, list(seg.mc$classification), mean) Group.1 age gender income kids ownHome subscribe 1 1 44.68018 0.5276074 52980.52 1.171779 0.8650307 0.2453988 2 2 38.02229 1.0000000 51550.98 1.422535 0.0000000 0.0000000 3 3 36.02187 0.0000000 45227.51 1.348485 0.0000000 0.0000000 \u0026gt; library(cluster) \u0026gt; clusplot(seg.df, seg.mc$classification, color = TRUE, shade = TRUE, + labels = 4, lines = 0, main = \u0026#34;Model-based cluster plot\u0026#34;) {% asset_image R_week2_model_based_describing_clusters_plot.png %}\nWeek2 Code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 # install.packages (\u0026#34;readxl\u0026#34;) # install.packages (\u0026#34;psych\u0026#34;) # install.packages (\u0026#34;car\u0026#34;) # install.packages (\u0026#34;gpairs\u0026#34;) # install.packages (\u0026#34;grid\u0026#34;) # install.packages (\u0026#34;lattice\u0026#34;) # install.packages (\u0026#34;corrplot\u0026#34;) # install.packages (\u0026#34;gplots\u0026#34;) # install.packages (\u0026#34;mclust\u0026#34;) # install.packages (\u0026#34;cluster\u0026#34;) library(\u0026#34;readxl\u0026#34;) library(\u0026#34;psych\u0026#34;) library(\u0026#34;car\u0026#34;) library(\u0026#34;gpairs\u0026#34;) library(\u0026#34;grid\u0026#34;) library(\u0026#34;lattice\u0026#34;) library(\u0026#34;corrplot\u0026#34;) library(\u0026#34;gplots\u0026#34;) library(\u0026#34;mclust\u0026#34;) library(\u0026#34;cluster\u0026#34;) # è·å–å½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• file_dir \u0026lt;- dirname(parent.frame(2)$ofile) print(file_dir) # å°†å·¥ä½œç›®å½•è®¾ç½®ä¸ºå½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• setwd(file_dir) seg.df \u0026lt;- read.csv(\u0026#34;Data_Segmentation.csv\u0026#34;, stringsAsFactors = TRUE) head(seg.df, n=8) seg.df$gender \u0026lt;- ifelse(seg.df$gender==\u0026#34;Male\u0026#34;,0,1) seg.df$ownHome \u0026lt;- ifelse(seg.df$ownHome == \u0026#34;ownNo\u0026#34;, 0,1) seg.df$subscribe \u0026lt;- ifelse(seg.df$subscribe == \u0026#34;subNo\u0026#34;, 0,1) head(seg.df) seg.df.sc \u0026lt;- seg.df seg.df.sc[, c(1,3,4)] \u0026lt;- scale(seg.df[, c(1,3,4)]) # We only need to standardize continuous variables. head(seg.df.sc) summary(seg.df.sc, digits = 2) seg.dist \u0026lt;- dist(seg.df.sc) as.matrix(seg.dist)[1:5, 1:5] seg.hc \u0026lt;- hclust(seg.dist, method=\u0026#34;complete\u0026#34;) seg.hc plot(seg.hc) plot(cut(as.dendrogram(seg.hc), h = 4)$lower[[1]]) seg.df[c(156, 152),] #similar seg.df[c(156, 183),] #less similar plot(seg.hc) rect.hclust(seg.hc, k=4, border = \u0026#34;red\u0026#34;) seg.hc.segment \u0026lt;- cutree(seg.hc, k=4) #membership vector for 4 groups table(seg.hc.segment) #counts library(cluster) clusplot(seg.df, seg.hc.segment, color = TRUE, #color the groups shade = TRUE, #shade the ellipses for group membership labels = 4, #label only the groups, not the individual points lines = 0, #omit distance lines between groups main = \u0026#34;Hierarchical cluster plot\u0026#34; # figure title ) aggregate(seg.df, list(seg.hc.segment), mean) boxplot(seg.df$income ~ seg.hc.segment, ylab = \u0026#34;Income\u0026#34;, xlab = \u0026#34;Cluster\u0026#34;) set.seed(96743) seg.k \u0026lt;- kmeans(seg.df.sc, centers = 4) #use standardized variables aggregate(seg.df, list(seg.k$cluster), mean) boxplot(seg.df$income ~ seg.k$cluster, ylab = \u0026#34;Income\u0026#34;, xlab = \u0026#34;Cluster\u0026#34;) clusplot(seg.df, seg.k$cluster, color = TRUE, shade = TRUE, labels = 4, lines = 0, main = \u0026#34;K_means cluster plot\u0026#34;, ) library(mclust) #install if needed seg.mc \u0026lt;- Mclust(seg.df.sc) summary(seg.mc) seg.mc4 \u0026lt;- Mclust(seg.df.sc, G =4) #specifying the number of clusters summary(seg.mc4) BIC(seg.mc, seg.mc4) aggregate(seg.df, list(seg.mc$classification), mean) library(cluster) clusplot(seg.df, seg.mc$classification, color = TRUE, shade = TRUE, labels = 4, lines = 0, main = \u0026#34;Model-based cluster plot\u0026#34;) ","date":"2024-03-15T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek2-segmentation-code/","title":"R[week2] Segmentation Code"},{"content":" R: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\nè¯†åˆ«ã€ç®¡ç†å®¢æˆ·çš„å·®å¼‚æ€§\nAgenda\nFramework Segmentation, Targeting, and Positioning (STP) Approach Analysis tools Cluster analysis for segmentation Factor analysis for developing perceptual maps Perceptual Maps\n1 2 3 åœ¨å¸‚åœºè¥é”€ä¸­ï¼Œå› å­åˆ†æç”¨äºå¼€å‘æ„ŸçŸ¥åœ°å›¾ï¼ˆPerceptual Mapsï¼‰ã€‚æ„ŸçŸ¥åœ°å›¾æ˜¯ä¸€ç§å¯è§†åŒ–å·¥å…·ï¼Œç”¨äºæ˜¾ç¤ºäº§å“æˆ–å“ç‰Œåœ¨æ¶ˆè´¹è€…å¿ƒä¸­çš„ä½ç½®ï¼Œå¹¶æ˜¾ç¤ºä¸ä¹‹ç›¸å…³çš„ç«äº‰å¯¹æ‰‹ã€‚æ„ŸçŸ¥åœ°å›¾é€šå¸¸æ˜¯äºŒç»´å›¾è¡¨ï¼Œå…¶ä¸­è½´è¡¨ç¤ºä¸äº§å“ç›¸å…³çš„å…³é”®å±æ€§æˆ–ç‰¹å¾ï¼Œè€Œå„ä¸ªäº§å“æˆ–å“ç‰Œåˆ™åœ¨å›¾è¡¨ä¸Šç›¸åº”ä½ç½®ä¸Šæ˜¾ç¤ºã€‚ å› å­åˆ†æåœ¨å¼€å‘æ„ŸçŸ¥åœ°å›¾ä¸­çš„ä½œç”¨æ˜¯å¸®åŠ©ç¡®å®šåº”è¯¥è€ƒè™‘å“ªäº›å› ç´ æ¥åŒºåˆ†äº§å“æˆ–å“ç‰Œä¹‹é—´çš„ä¸åŒã€‚å®ƒé€šè¿‡åˆ†ææ•°æ®é›†ä¸­çš„å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œç¡®å®šæ½œåœ¨çš„å› ç´ æˆ–ç»´åº¦ã€‚è¿™äº›å› ç´ æˆ–ç»´åº¦å¯ä»¥ä»£è¡¨æ¶ˆè´¹è€…åœ¨è¯„ä¼°äº§å“æˆ–å“ç‰Œæ—¶æ‰€å…³æ³¨çš„é‡è¦ç‰¹å¾ã€‚å› å­åˆ†æå¯ä»¥å¸®åŠ©è¯†åˆ«æ½œåœ¨çš„å…±åŒå› ç´ ï¼Œä»è€Œä¸ºæ„ŸçŸ¥åœ°å›¾çš„æ„å»ºæä¾›æŒ‡å¯¼ã€‚ SWOT\nSWOTåˆ†æï¼ˆSWOT analysisï¼‰æ˜¯ä¸€ç§ç”¨äºè¯„ä¼°ç»„ç»‡ã€é¡¹ç›®æˆ–ä¸ªäººçš„å†…éƒ¨ä¼˜åŠ¿ï¼ˆStrengthsï¼‰ã€å†…éƒ¨åŠ£åŠ¿ï¼ˆWeaknessesï¼‰ã€å¤–éƒ¨æœºä¼šï¼ˆOpportunitiesï¼‰å’Œå¤–éƒ¨å¨èƒï¼ˆThreatsï¼‰çš„æ–¹æ³•ã€‚è¿™ç§åˆ†æé€šå¸¸ç”¨äºåˆ¶å®šæˆ˜ç•¥è®¡åˆ’ã€å†³ç­–åˆ¶å®šå’Œé—®é¢˜è§£å†³è¿‡ç¨‹ä¸­ã€‚\nä¼˜åŠ¿ï¼ˆStrengthsï¼‰ï¼šç»„ç»‡æˆ–é¡¹ç›®å†…éƒ¨çš„ç§¯æå› ç´ å’Œä¼˜åŠ¿ã€‚è¿™äº›å¯ä»¥åŒ…æ‹¬èµ„æºã€æŠ€èƒ½ã€å£°èª‰ã€å¸‚åœºåœ°ä½ç­‰æ–¹é¢çš„ä¼˜åŠ¿ã€‚ åŠ£åŠ¿ï¼ˆWeaknessesï¼‰ï¼šç»„ç»‡æˆ–é¡¹ç›®å†…éƒ¨çš„è´Ÿé¢å› ç´ å’ŒåŠ£åŠ¿ã€‚è¿™äº›å¯èƒ½æ˜¯ç¼ºä¹æŸäº›èµ„æºã€æŠ€èƒ½ä¸è¶³ã€ç®¡ç†é—®é¢˜ç­‰å†…éƒ¨æŒ‘æˆ˜ã€‚ æœºä¼šï¼ˆOpportunitiesï¼‰ï¼šå¤–éƒ¨ç¯å¢ƒä¸­æœ‰åˆ©äºç»„ç»‡æˆ–é¡¹ç›®å‘å±•çš„å› ç´ ã€‚è¿™äº›å¯èƒ½æ˜¯å¸‚åœºè¶‹åŠ¿ã€æŠ€æœ¯è¿›æ­¥ã€ç«äº‰å¯¹æ‰‹çš„å¼±ç‚¹ç­‰ã€‚ å¨èƒï¼ˆThreatsï¼‰ï¼šå¤–éƒ¨ç¯å¢ƒä¸­å¯èƒ½å¯¹ç»„ç»‡æˆ–é¡¹ç›®æ„æˆé£é™©å’Œå¨èƒçš„å› ç´ ã€‚è¿™äº›å¯èƒ½æ˜¯ç«äº‰åŠ å‰§ã€æ³•è§„å˜åŒ–ã€å¸‚åœºéœ€æ±‚ä¸‹é™ç­‰ã€‚ SWOTåˆ†æçš„ç›®çš„æ˜¯å¸®åŠ©ç»„ç»‡æˆ–ä¸ªäººè¯†åˆ«å…¶æ‰€é¢ä¸´çš„å†…éƒ¨å’Œå¤–éƒ¨å› ç´ ï¼Œå¹¶åŸºäºè¿™äº›å› ç´ åˆ¶å®šæˆ˜ç•¥ï¼Œåˆ©ç”¨ä¼˜åŠ¿åº”å¯¹æœºä¼šï¼Œå…‹æœåŠ£åŠ¿é¿å…å¨èƒã€‚è¿™ç§åˆ†æé€šå¸¸ä»¥å››ä¸ªè±¡é™çš„å½¢å¼å‘ˆç°ï¼Œå°†ä¼˜åŠ¿å’ŒåŠ£åŠ¿æ”¾ç½®åœ¨æ°´å¹³è½´ä¸Šï¼Œå°†æœºä¼šå’Œå¨èƒæ”¾ç½®åœ¨å‚ç›´è½´ä¸Šï¼Œä»¥ä¾¿æ›´ç›´è§‚åœ°äº†è§£å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚\nå› å­åˆ†æï¼ˆFactor analysisï¼‰ï¼š\nå› å­åˆ†ææ˜¯ä¸€ç§ç»Ÿè®¡æŠ€æœ¯ï¼Œç”¨äºç†è§£è§‚å¯Ÿåˆ°çš„å˜é‡ä¹‹é—´çš„æ½œåœ¨ç»“æ„æˆ–æ¨¡å¼ã€‚å®ƒè¯•å›¾æ‰¾åˆ°ä¸€ç»„æ½œåœ¨çš„å› ç´ ï¼ˆæˆ–ç»´åº¦ï¼‰ï¼Œè¿™äº›å› ç´ å¯ä»¥è§£é‡Šå˜é‡ä¹‹é—´çš„å…±åŒå˜å¼‚æ€§ã€‚åœ¨å› å­åˆ†æä¸­ï¼Œå˜é‡è¢«å‡è®¾æ˜¯ç”±ä¸€ç»„æ½œåœ¨å› ç´ æ‰€å½±å“ï¼Œè€Œè¿™äº›æ½œåœ¨å› ç´ æ— æ³•ç›´æ¥è§‚å¯Ÿåˆ°ã€‚å› å­åˆ†æå¯ç”¨äºç®€åŒ–æ•°æ®é›†ã€è¯†åˆ«å˜é‡ä¹‹é—´çš„æ¨¡å¼ä»¥åŠæ¢ç´¢å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚\nèšç±»åˆ†æï¼ˆCluster analysisï¼‰ï¼š\nèšç±»åˆ†ææ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œç”¨äºå°†æ•°æ®é›†ä¸­çš„å¯¹è±¡åˆ†æˆç›¸ä¼¼çš„ç»„æˆ–ç°‡ã€‚åœ¨èšç±»åˆ†æä¸­ï¼Œç›®æ ‡æ˜¯é€šè¿‡æµ‹é‡å¯¹è±¡ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œå°†å®ƒä»¬åˆ’åˆ†ä¸ºå…·æœ‰é«˜å†…éƒ¨ä¸€è‡´æ€§å’Œä½ç»„é—´ä¸€è‡´æ€§çš„ç»„ã€‚èšç±»åˆ†æçš„ç»“æœæ˜¯ä¸€ç»„ç°‡ï¼Œæ¯ä¸ªç°‡å†…çš„å¯¹è±¡å½¼æ­¤ç›¸ä¼¼ï¼Œè€Œä¸åŒç°‡ä¹‹é—´çš„å¯¹è±¡åˆ™å…·æœ‰è¾ƒå¤§çš„å·®å¼‚ã€‚èšç±»åˆ†æå¯ç”¨äºå‘ç°æ•°æ®é›†ä¸­çš„éšè—æ¨¡å¼ã€è¯†åˆ«æ½œåœ¨çš„ç¾¤ç»„æˆ–è€…ç®€åŒ–å¤æ‚çš„æ•°æ®é›†ã€‚\nGEçŸ©é˜µï¼ˆGE Matrixï¼‰ï¼š\nGEçŸ©é˜µï¼Œä¹Ÿç§°ä¸ºGeneral ElectricçŸ©é˜µæˆ–GEå¤šé‡ä¸šåŠ¡çŸ©é˜µï¼Œæ˜¯ä¸€ç§æˆ˜ç•¥è§„åˆ’å·¥å…·ï¼Œç”¨äºè¯„ä¼°å…¬å¸çš„ä¸šåŠ¡ç»„åˆå¹¶å†³å®šèµ„æºåˆ†é…ã€‚è¯¥çŸ©é˜µé€šå¸¸ç”±ä¸¤ä¸ªç»´åº¦ç»„æˆï¼šå¸‚åœºå¸å¼•åŠ›å’Œç«äº‰åŠ›ã€‚å¸‚åœºå¸å¼•åŠ›é€šå¸¸ç”¨äºè¯„ä¼°è¡Œä¸šçš„å¸å¼•åŠ›ç¨‹åº¦ï¼Œè€Œç«äº‰åŠ›åˆ™ç”¨äºè¯„ä¼°å…¬å¸åœ¨ç‰¹å®šå¸‚åœºä¸Šçš„ç«äº‰åŠ›ã€‚é€šè¿‡å°†ä¸åŒçš„ä¸šåŠ¡å•å…ƒæˆ–äº§å“å®šä½åœ¨GEçŸ©é˜µçš„ä¸åŒè±¡é™ä¸­ï¼Œç®¡ç†è€…å¯ä»¥æ›´å¥½åœ°äº†è§£å“ªäº›ä¸šåŠ¡å•å…ƒéœ€è¦è¿›ä¸€æ­¥å‘å±•ã€ä¿æŒã€æ’¤é€€æˆ–æ”¶ç¼©ï¼Œå¹¶åˆ¶å®šç›¸åº”çš„æˆ˜ç•¥è®¡åˆ’ã€‚\n{% asset_image week2_ge_matrix.png %}\næ¬§å‡ é‡Œå¾—è·ç¦» Euclidean Distance\næ¬§å‡ é‡Œå¾—è·ç¦»ï¼ˆEuclidean distanceï¼‰æ˜¯ç©ºé—´ä¸­ä¸¤ç‚¹ä¹‹é—´çš„ç›´çº¿è·ç¦»ï¼Œé€šå¸¸ç”¨äºè¡¡é‡å¤šç»´ç©ºé—´ä¸­çš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼æ€§æˆ–å·®å¼‚æ€§ã€‚å…¶å«ä¹‰æ˜¯åŸºäºæ¬§å‡ é‡Œå¾—å‡ ä½•å­¦ä¸­çš„è·ç¦»å®šä¹‰è€Œæ¥ï¼Œå³ä¸¤ç‚¹ä¹‹é—´çš„ç›´çº¿æœ€çŸ­è·¯å¾„çš„é•¿åº¦ã€‚\n$$ d_e = \\sqrt{\\sum_{i=1}^{n}(x_i - y_i)^2} $${% asset_image week2_euclidean_distance.png %}\næ ‡å‡†åŒ– standardization\næ ‡å‡†åŒ–çš„è¿‡ç¨‹æ˜¯å°†åŸå§‹æ•°æ®è¿›è¡Œå¹³ç§»å’Œç¼©æ”¾ï¼Œä½¿å¾—æ•°æ®çš„å‡å€¼å˜ä¸º0ï¼Œæ ‡å‡†å·®å˜ä¸º1ã€‚è¿™æœ‰åŠ©äºæ¶ˆé™¤ä¸åŒå˜é‡ä¹‹é—´çš„å°ºåº¦å·®å¼‚ï¼Œä½¿å¾—å®ƒä»¬å¯ä»¥æ›´å¥½åœ°è¿›è¡Œæ¯”è¾ƒå’Œåˆ†æã€‚\n$$ z = \\frac{x - \\mu}{\\sigma} $$å…¶ä¸­ï¼š\nzï¼šæ ‡å‡†åŒ–åçš„å€¼ã€‚ xï¼šåŸå§‹æ•°æ®ç‚¹çš„å€¼ã€‚ Î¼ï¼šæ•°æ®çš„å‡å€¼ï¼Œè¡¨ç¤ºæ•´ä¸ªæ•°æ®é›†çš„ä¸­å¿ƒä½ç½®ã€‚ Ïƒï¼šæ•°æ®çš„æ ‡å‡†å·®ï¼Œè¡¨ç¤ºæ•°æ®åˆ†å¸ƒçš„ç¦»æ•£ç¨‹åº¦æˆ–æ³¢åŠ¨ç¨‹åº¦ã€‚ $$ \\sigma = \\sqrt{\\frac{\\sum_{i=1}^{n}(x_i - \\mu)^2}{n}} $${% asset_image week2_standardization.png %}\nå±‚æ¬¡èšç±» Hierarchical clustering\nå•é“¾æ¥èšç±»ï¼ˆSingle Linkage Clusteringï¼‰ï¼šä¹Ÿç§°ä¸ºæœ€å°è·ç¦»æ³•ï¼Œå®ƒå°†ä¸¤ä¸ªç°‡ä¹‹é—´çš„æœ€è¿‘ç‚¹ä¹‹é—´çš„è·ç¦»ä½œä¸ºç°‡é—´è·ç¦»çš„åº¦é‡ã€‚\nå®Œå…¨é“¾æ¥èšç±»ï¼ˆComplete Linkage Clusteringï¼‰ï¼šä¹Ÿç§°ä¸ºæœ€å¤§è·ç¦»æ³•ï¼Œå®ƒå°†ä¸¤ä¸ªç°‡ä¸­æœ€è¿œç‚¹ä¹‹é—´çš„è·ç¦»ä½œä¸ºç°‡é—´è·ç¦»çš„åº¦é‡ã€‚\nå¹³å‡é“¾æ¥èšç±»ï¼ˆAverage Linkage Clusteringï¼‰ï¼ˆCentroid Methodï¼‰ï¼šå®ƒå°†ä¸¤ä¸ªç°‡ä¸­æ‰€æœ‰ç‚¹å¯¹ä¹‹é—´çš„å¹³å‡è·ç¦»ä½œä¸ºç°‡é—´è·ç¦»çš„åº¦é‡ã€‚\nå¹³å‡-å¹³å‡é“¾æ¥èšç±»ï¼ˆAverage-Average Linkage Clusteringï¼‰ï¼šå®ƒç»“åˆäº†å¹³å‡é“¾æ¥å’Œå¹³å‡-å¹³å‡èšç±»çš„æ€æƒ³ï¼Œåˆ©ç”¨ä¸¤ä¸ªç°‡ä¸­æ‰€æœ‰ç‚¹å¯¹ä¹‹é—´çš„å¹³å‡è·ç¦»ä½œä¸ºç°‡é—´è·ç¦»çš„åº¦é‡ã€‚\næœ€å¤§-æœ€å°å¹³å‡é“¾æ¥èšç±»ï¼ˆMaximum-Minimum Average Linkage Clusteringï¼‰ï¼šå®ƒç»“åˆäº†æœ€å¤§è·ç¦»æ³•å’Œæœ€å°è·ç¦»æ³•çš„æ€æƒ³ï¼Œå°†ä¸¤ä¸ªç°‡ä¸­æœ€è¿œç‚¹ä¹‹é—´çš„è·ç¦»å’Œæœ€è¿‘ç‚¹ä¹‹é—´çš„è·ç¦»çš„å¹³å‡å€¼ä½œä¸ºç°‡é—´è·ç¦»çš„åº¦é‡ã€‚\nWard Methodï¼šæœ€å°åŒ–ç°‡å†…å˜å¼‚æ€§æˆ–ç°‡å†…ç‚¹åˆ°è´¨å¿ƒçš„å¹³æ–¹åå·®å’Œï¼Œå®ƒè¯•å›¾é€šè¿‡è€ƒè™‘æ¯ä¸ªç‚¹ä¸å…¶æ‰€å±ç°‡çš„è´¨å¿ƒä¹‹é—´çš„å·®å¼‚çš„å¹³æ–¹å’Œæ¥æœ€å°åŒ–åˆå¹¶ç°‡æ—¶çš„æ–¹å·®ã€‚\nK-means clustering\nK-means clustering æ˜¯ä¸€ç§åŸºäºè·ç¦»çš„èšç±»æ–¹æ³•ï¼Œå…¶ç›®æ ‡æ˜¯å°†æ•°æ®ç‚¹åˆ†æˆé¢„å…ˆæŒ‡å®šæ•°é‡çš„ç°‡ï¼Œä½¿å¾—ç°‡å†…çš„æ•°æ®ç‚¹ç›¸äº’ä¹‹é—´çš„è·ç¦»å°½å¯èƒ½å°ï¼Œè€Œä¸åŒç°‡ä¹‹é—´çš„è·ç¦»å°½å¯èƒ½å¤§ã€‚K-means ç®—æ³•é¦–å…ˆéšæœºé€‰æ‹© k ä¸ªåˆå§‹è´¨å¿ƒï¼Œç„¶åè¿­ä»£åœ°å°†æ•°æ®ç‚¹åˆ†é…åˆ°æœ€è¿‘çš„è´¨å¿ƒï¼Œå¹¶æ›´æ–°è´¨å¿ƒçš„ä½ç½®ï¼Œç›´åˆ°è¾¾åˆ°æ”¶æ•›æ¡ä»¶ã€‚K-means çš„ä¸»è¦ç¼ºç‚¹æ˜¯å¯¹äºä¸åŒå¤§å°ã€å¯†åº¦å’Œå½¢çŠ¶çš„ç°‡è¡¨ç°ä¸ä½³ï¼Œå¹¶ä¸”å¯¹äºåˆå§‹è´¨å¿ƒçš„é€‰æ‹©æ•æ„Ÿã€‚ç„¶è€Œï¼ŒK-means æ˜¯ä¸€ç§é«˜æ•ˆçš„ç®—æ³•ï¼Œé€šå¸¸åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šè¡¨ç°è‰¯å¥½ã€‚\nModel-based clustering\nModel-based clustering æ˜¯ä¸€ç§åŸºäºæ¦‚ç‡æ¨¡å‹çš„èšç±»æ–¹æ³•ï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯å‡è®¾æ•°æ®æ˜¯ç”±å¤šä¸ªæ½œåœ¨çš„æ¦‚ç‡åˆ†å¸ƒç”Ÿæˆçš„æ··åˆç‰©ã€‚è¿™äº›åˆ†å¸ƒé€šå¸¸æ˜¯é«˜æ–¯åˆ†å¸ƒæˆ–å…¶å˜ä½“ï¼Œæ¯ä¸ªåˆ†å¸ƒä»£è¡¨ä¸€ä¸ªç°‡ã€‚æ¨¡å‹åŸºäºè¿™äº›æ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°è¿›è¡Œå‚æ•°åŒ–ï¼Œç„¶åä½¿ç”¨EMç®—æ³•æˆ–å…¶ä»–ä¼˜åŒ–æ–¹æ³•å¯¹è¿™äº›å‚æ•°è¿›è¡Œä¼°è®¡ã€‚åœ¨èšç±»æ—¶ï¼Œé€šè¿‡æœ€å¤§åŒ–æ•°æ®çš„ä¼¼ç„¶æ€§æˆ–æœ€å°åŒ–ä¸€ä¸ªé€‚å½“çš„æŸå¤±å‡½æ•°æ¥ç¡®å®šæ•°æ®ç‚¹çš„åˆ†é…å’Œæ¨¡å‹å‚æ•°ã€‚Model-based clustering çš„ä¼˜ç‚¹åŒ…æ‹¬èƒ½å¤Ÿå¤„ç†ä¸è§„åˆ™å½¢çŠ¶çš„ç°‡ä»¥åŠèƒ½å¤Ÿä¼°è®¡æ¯ä¸ªæ•°æ®ç‚¹å±äºæ¯ä¸ªç°‡çš„æ¦‚ç‡ã€‚\n","date":"2024-03-15T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek2-segmentation-lecture/","title":"R[week2] Segmentation Lecture"},{"content":"æœ¬ç¯‡ä¸»è¦è®²äº†åˆ©ç”¨Rè¯­è¨€è¿›è¡Œæ•°æ®ç®€å•å¤„ç†åˆ†æï¼Œå’Œå›¾è¡¨çš„ç»˜åˆ¶ã€‚\nR: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\ninstall and import libraries\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # install.packages (\u0026#34;readxl\u0026#34;) # install.packages (\u0026#34;psych\u0026#34;) # install.packages (\u0026#34;car\u0026#34;) # install.packages (\u0026#34;gpairs\u0026#34;) # install.packages (\u0026#34;grid\u0026#34;) # install.packages (\u0026#34;lattice\u0026#34;) # install.packages (\u0026#34;corrplot\u0026#34;) # install.packages (\u0026#34;gplots\u0026#34;) library(\u0026#34;readxl\u0026#34;) library(\u0026#34;psych\u0026#34;) library(\u0026#34;car\u0026#34;) library(\u0026#34;gpairs\u0026#34;) library(\u0026#34;grid\u0026#34;) library(\u0026#34;lattice\u0026#34;) library(\u0026#34;corrplot\u0026#34;) library(\u0026#34;gplots\u0026#34;) ä¸€ã€Data 1. vectors 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # å¯¼å…¥æ•°æ® \u0026gt; store.df \u0026lt;- read.csv(\u0026#34;Data_Descriptive.csv\u0026#34;, stringsAsFactors=TRUE) \u0026gt; str(store.df) \u0026#39;data.frame\u0026#39;:\t2080 obs. of 10 variables: $ storeNum: int 101 101 101 101 101 101 101 101 101 101 ... $ Year : int 1 1 1 1 1 1 1 1 1 1 ... $ Week : int 1 2 3 4 5 6 7 8 9 10 ... $ p1sales : int 127 137 156 117 138 115 116 106 116 145 ... $ p2sales : int 106 105 97 106 100 127 90 126 94 91 ... $ p1price : num 2.29 2.49 2.99 2.99 2.49 2.79 2.99 2.99 2.29 2.49 ... $ p2price : num 2.29 2.49 2.99 3.19 2.59 2.49 3.19 2.29 2.29 2.99 ... $ p1prom : int 0 0 1 0 0 0 0 0 0 0 ... $ p2prom : int 0 0 0 0 1 0 0 0 0 0 ... $ country : Factor w/ 7 levels \u0026#34;AU\u0026#34;,\u0026#34;BR\u0026#34;,\u0026#34;CN\u0026#34;,..: 7 7 7 7 7 7 7 7 7 7 ... # ä»ä¸Šé¢ç»“æœå¯ä»¥çœ‹å‡ºï¼Œcsvä¸­ä¸€å…±æœ‰2080ä¸ªè§‚å¯Ÿå€¼ï¼ˆè¡Œï¼‰ï¼Œ10ä¸ªå˜é‡ï¼ˆåˆ—ï¼‰ã€‚ # å…¶ä¸­countryæ˜¯factorç±»å‹çš„ï¼Œä¸€å…±æœ‰7ä¸ªlevelã€‚ 2. Summarize a single variable 2.1 Discrete variables 1 2 3 \u0026gt; table(store.df$p1price) 2.19 2.29 2.49 2.79 2.99 395 444 423 443 375 æ³¨âš ï¸ï¼štable() å‡½æ•° ç”¨æ¥åˆ›å»ºé¢‘æ•°è¡¨ï¼ˆFrequency Tableï¼‰çš„å‡½æ•°ã€‚å®ƒå¯ä»¥ç”¨äºç»Ÿè®¡ä¸€ç»„æ•°æ®ä¸­å„ä¸ªå€¼å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶å°†ç»“æœä»¥è¡¨æ ¼çš„å½¢å¼å‘ˆç°ã€‚ å®ƒä¹Ÿå¯ä»¥æä¾›å¤šç»´çš„ç»“æœï¼Œæ¯”å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 \u0026gt; df \u0026lt;- data.frame( + gender = c(\u0026#34;Male\u0026#34;, \u0026#34;Female\u0026#34;, \u0026#34;Female\u0026#34;, \u0026#34;Male\u0026#34;, \u0026#34;Male\u0026#34;, \u0026#34;Female\u0026#34;, \u0026#34;Male\u0026#34;, \u0026#34;Female\u0026#34;, \u0026#34;Female\u0026#34;, \u0026#34;Male\u0026#34;), + age_group = c(\u0026#34;Young\u0026#34;, \u0026#34;Young\u0026#34;, \u0026#34;Old\u0026#34;, \u0026#34;Young\u0026#34;, \u0026#34;Old\u0026#34;, \u0026#34;Young\u0026#34;, \u0026#34;Old\u0026#34;, \u0026#34;Old\u0026#34;, \u0026#34;Young\u0026#34;, \u0026#34;Young\u0026#34;) + ) # åˆ›å»ºå¤šç»´é¢‘æ•°è¡¨ \u0026gt; table(df$gender, df$age_group) Young Old Female 3 2 Male 4 1 é™¤table()å¤–ï¼Œè¿˜æœ‰å…¶ä»–ç±»ä¼¼çš„å‡½æ•°ä»¥åŠåŠŸèƒ½ï¼š\nå‡½æ•° æè¿° prop.table() è®¡ç®—è¡¨æ ¼ä¸­æ¯ä¸ªå•å…ƒæ ¼çš„æ¯”ä¾‹ã€‚ xtabs() åˆ›å»ºé¢‘æ•°è¡¨ï¼Œæ”¯æŒå¤šç»´æ•°æ®å’Œå…¬å¼è¯­æ³•ã€‚ addmargins() å‘è¡¨æ ¼ä¸­æ·»åŠ è¾¹é™…æ€»è®¡ã€‚ ftable() åˆ›å»ºæ‰å¹³çš„è¡¨æ ¼ï¼Œæ›´å®¹æ˜“æŸ¥çœ‹å’Œç†è§£ã€‚ summary() é€šå¸¸ç”¨äºæ‘˜è¦ç»Ÿè®¡ï¼Œæ˜¾ç¤ºæ¯ä¸ªå› å­å˜é‡çš„æ•°é‡ï¼Œä»¥åŠæ•°å€¼å‹å˜é‡çš„æ‘˜è¦ç»Ÿè®¡é‡ã€‚ dplyr::count() è®¡ç®—æ•°æ®æ¡†ä¸­æ¯ä¸ªç±»åˆ«çš„é¢‘æ•°ï¼Œå¹¶è¿”å›åŒ…å«é¢‘æ•°çš„æ•°æ®æ¡†ã€‚ psych::describe() ç”ŸæˆåŒ…å«å¤šä¸ªç»Ÿè®¡æŒ‡æ ‡çš„æ‘˜è¦ç»Ÿè®¡ä¿¡æ¯ï¼Œå¦‚å‡å€¼ã€æ ‡å‡†å·®ã€æœ€å°å€¼ã€æœ€å¤§å€¼ç­‰ã€‚ é¢˜å¤–è¯ç»“æŸï¼Œç»§ç»­å‰é¢çš„æ•°æ®åˆ†æ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026gt; p1.table \u0026lt;- table(store.df$p1price) \u0026gt; p1.table 2.19 2.29 2.49 2.79 2.99 395 444 423 443 375 # talbe()è¿”å›çš„æ˜¯ä¸€ä¸ªtableç±»å‹çš„ç»“æœ \u0026gt; str(p1.table) \u0026#39;table\u0026#39; int [1:5(1d)] 395 444 423 443 375 - attr(*, \u0026#34;dimnames\u0026#34;)=List of 1 ..$ : chr [1:5] \u0026#34;2.19\u0026#34; \u0026#34;2.29\u0026#34; \u0026#34;2.49\u0026#34; \u0026#34;2.79\u0026#34; ... # è½¬ä¸ºå›¾ \u0026gt; plot(p1.table) {% asset_image plot1.png %}\næ³¨âš ï¸ï¼šplot()å‡½æ•°\nç”¨äºåˆ›å»ºå„ç§ç±»å‹çš„å›¾å½¢çš„åŸºæœ¬å‡½æ•°ä¹‹ä¸€ã€‚å®ƒå¯ä»¥ç”¨äºç»˜åˆ¶æ•£ç‚¹å›¾ã€çº¿å›¾ã€æŸ±çŠ¶å›¾ã€ç®±çº¿å›¾ç­‰ç­‰ã€‚åé¢ä¼šæœ‰æ›´å¤šçš„ç”¨æ³•ï¼Œå°±ä¸åœ¨æ­¤å¤„åˆ—ä¸¾äº†ã€‚ plot()ä¼šè‡ªé€‚åº”åœ°é‡‡ç”¨ä¸€ç§å›¾è¡¨æ¥å±•ç¤ºæ•°æ®ï¼Œä½†æˆ‘ä»¬åŒæ ·å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # äºŒç»´tableï¼Œè·å–æ¯ä¸ªä»·ä½ä¸Šçš„ä¿ƒé”€é¢‘æ•° \u0026gt; table(store.df$p1price, store.df$p1prom) 0 1 2.19 354 41 2.29 398 46 2.49 381 42 2.79 396 47 2.99 343 32 # è®¡ç®—product 1åœ¨æ¯ä¸ªpriceä¸Šçš„ä¿ƒé”€æ¯”ä¾‹[prod1/(prod1+prod2)] \u0026gt; p1.table2 \u0026lt;- table(store.df$p1price, store.df$p1prom) \u0026gt; p1.table2[ ,2] / (p1.table2[ ,1] + p1.table2[ ,2]) 2.19 2.29 2.49 2.79 2.99 0.10379747 0.10360360 0.09929078 0.10609481 0.08533333 2.2 Continuous variables æ³¨âš ï¸ï¼šContinuous variables VS Discrete variable\nè¿ç»­å˜é‡ï¼ŒæŒ‡çš„æ˜¯å¯ä»¥åœ¨ä¸€ä¸ªèŒƒå›´å†…å–ä»»æ„å€¼çš„å˜é‡ï¼Œè€Œä¸æ˜¯ä¸€ç»„ç¦»æ•£çš„å€¼ã€‚è¿™ç§å˜é‡å¯ä»¥åœ¨æŸä¸ªèŒƒå›´å†…è¿ç»­åœ°å–å€¼ï¼Œå¯ä»¥æ˜¯ä»»ä½•æ•°å€¼ã€‚\næ¯”å¦‚ä¸€ä¸ªäººçš„èº«é«˜ã€ä½“é‡ã€å¹´é¾„ç­‰å°±æ˜¯è¿ç»­å˜é‡ã€‚å› ä¸ºèº«é«˜ã€ä½“é‡ã€å¹´é¾„éƒ½å¯ä»¥åœ¨ä¸€ä¸ªèŒƒå›´å†…å–ä»»ä½•å®æ•°å€¼ï¼Œè€Œä¸ä»…ä»…æ˜¯æŸäº›ç‰¹å®šçš„ç¦»æ•£æ•°å€¼ã€‚å¦å¤–ï¼Œæ¸©åº¦ã€æ—¶é—´ç­‰ä¹Ÿæ˜¯è¿ç»­å˜é‡ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥åœ¨ä¸€ä¸ªè¿ç»­çš„èŒƒå›´å†…å–ä»»ä½•å€¼ã€‚\nç¦»æ•£å˜é‡ï¼Œæ˜¯æŒ‡åªèƒ½å–æœ‰é™ä¸ªæ•°å€¼çš„å˜é‡ã€‚ æ¯”å¦‚ä¸€ä¸ªç­çº§ä¸­å­¦ç”Ÿçš„äººæ•°ã€ä¸€ä¸ªç®±å­ä¸­çš„çƒçš„ä¸ªæ•°ç­‰éƒ½æ˜¯ç¦»æ•£å˜é‡ï¼Œå› ä¸ºå®ƒä»¬åªèƒ½å–æ•´æ•°å€¼ï¼Œè€Œä¸èƒ½å–è¿ç»­çš„ä»»æ„æ•°å€¼ã€‚\nå¯¹äºè¿ç»­å˜é‡ï¼Œæ ¹æ®å…¶åˆ†å¸ƒæ¥æ€»ç»“æ•°æ®æ›´æœ‰å¸®åŠ©ã€‚æœ€å¸¸è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ•°å­¦å‡½æ•°æ¥æè¿°æ•°æ®çš„èŒƒå›´ã€ä¸­å¿ƒã€é›†ä¸­æˆ–åˆ†æ•£çš„ç¨‹åº¦ï¼Œä»¥åŠå¯èƒ½æ„Ÿå…´è¶£çš„å…·ä½“ç‚¹(å¦‚ç¬¬90ç™¾åˆ†ä½):\nDescribe Function Value Extremes[æå€¼] min(x) Min max(x) Max Central trendency[ä¸­å¿ƒè¶‹åŠ¿] mean(x) Arithmetic mean median(x) Mid Dispersion[ç¦»æ•£åº¦] var(x) Variance around the mean sd(x) Standard deviaion(sqrt(var(x))) IQR(x) Interquartile range, 75th-25th percentile mad(x) Median absolute deviation Points[è§‚å¯Ÿå€¼/æ•°æ®ç‚¹] quantile(x, probs=c(\u0026hellip;)) Percentiles æ–¹å·® var(x) æè¿°æ•°æ®åˆ†å¸ƒç¦»æ•£ç¨‹åº¦çš„ä¸€ç§ç»Ÿè®¡é‡ã€‚å®ƒè¡¡é‡äº†æ•°æ®é›†ä¸­æ¯ä¸ªæ•°æ®ç‚¹ä¸æ•°æ®é›†å¹³å‡å€¼ä¹‹é—´çš„å·®å¼‚ç¨‹åº¦\næ ‡å‡†å·® sd(x) æ–¹å·®çš„å¹³æ–¹æ ¹\nIQR(x)\næ˜¯ç»Ÿè®¡å­¦ä¸­ç”¨äºåº¦é‡æ•°æ®åˆ†å¸ƒçš„å·®å¼‚æ€§çš„ä¸€ç§æ–¹æ³•ã€‚å®ƒæ˜¯ç¬¬ä¸‰å››åˆ†ä½æ•°ï¼ˆQ3ï¼‰ä¸ç¬¬ä¸€å››åˆ†ä½æ•°ï¼ˆQ1ï¼‰ä¹‹é—´çš„è·ç¦»ï¼Œé€šå¸¸ç”¨æ¥æè¿°æ•°æ®çš„ç¦»æ•£ç¨‹åº¦ã€‚ä¸æ–¹å·®å’Œæ ‡å‡†å·®ä¸åŒï¼ŒIQRä¸å—æç«¯å€¼ï¼ˆç¦»ç¾¤å€¼ï¼‰çš„å½±å“ï¼Œå› æ­¤åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒIQRæ›´é€‚åˆç”¨æ¥åº¦é‡æ•°æ®çš„ç¦»æ•£ç¨‹åº¦ã€‚ IQRçš„ä¼˜åŠ¿åœ¨äºå®ƒæä¾›äº†ä¸€ä¸ªå¯¹æ•°æ®é›†çš„ä¸­é—´50%æ•°æ®çš„åº¦é‡ï¼Œè€Œä¸å—æç«¯å€¼çš„å½±å“ã€‚è¿™ä½¿å¾—å®ƒåœ¨å¤„ç†åæ–œæˆ–åŒ…å«æç«¯å€¼çš„æ•°æ®é›†æ—¶æ›´ä¸ºç¨³å¥ã€‚åœ¨æè¿°åæ€åˆ†å¸ƒæˆ–å­˜åœ¨ç¦»ç¾¤å€¼çš„æ•°æ®æ—¶ï¼ŒIQRé€šå¸¸æ¯”æ ‡å‡†å·®æ›´å…·æœ‰ä»£è¡¨æ€§ã€‚ åœ¨ç»Ÿè®¡å­¦å’Œæ•°æ®åˆ†æä¸­ï¼Œé€šå¸¸ä¼šå°†IQRä¸ç®±çº¿å›¾ç»“åˆä½¿ç”¨ã€‚ç®±çº¿å›¾æ˜¾ç¤ºäº†æ•°æ®çš„å››åˆ†ä½æ•°èŒƒå›´ä»¥åŠä»»ä½•ç¦»ç¾¤å€¼çš„å­˜åœ¨ï¼Œè¿™ä½¿å¾—å¯ä»¥ç›´è§‚åœ°äº†è§£æ•°æ®çš„åˆ†å¸ƒæƒ…å†µï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡æ¯”è¾ƒä¸åŒç»„çš„ç®±çº¿å›¾æ¥è¯†åˆ«ä»»ä½•å·®å¼‚ã€‚\nmad(x) åŒIQRï¼Œç®€å•æ¯”è¾ƒä¸€ä¸‹è¿™ä¸¤è€…ï¼š\nIQRï¼ˆInterquartile Rangeï¼‰ï¼š å®šä¹‰ï¼šIQRæ˜¯æ•°æ®é›†ä¸­ç¬¬ä¸‰å››åˆ†ä½æ•°ï¼ˆQ3ï¼‰å’Œç¬¬ä¸€å››åˆ†ä½æ•°ï¼ˆQ1ï¼‰ä¹‹é—´çš„è·ç¦»ã€‚ è®¡ç®—æ–¹æ³•ï¼šIQR = Q3 - Q1ï¼Œå…¶ä¸­Q3æ˜¯æ•°æ®é›†ä¸­75thç™¾åˆ†ä½æ•°ï¼ŒQ1æ˜¯æ•°æ®é›†ä¸­25thç™¾åˆ†ä½æ•°ã€‚\nç”¨é€”ï¼šIQRé€šå¸¸ç”¨äºè¯†åˆ«æ•°æ®ä¸­çš„ç¦»ç¾¤å€¼ï¼Œå› ä¸ºå®ƒæä¾›äº†æ•°æ®ä¸­é—´50%çš„èŒƒå›´ï¼Œå¹¶ä¸”å¯¹äºåæ–œåˆ†å¸ƒçš„æ•°æ®æ¯”æ ‡å‡†å·®æ›´é²æ£’ã€‚\nMADï¼ˆMedian Absolute Deviationï¼‰ï¼š å®šä¹‰ï¼šMADæ˜¯æ•°æ®ç‚¹ä¸æ•°æ®é›†ä¸­ä½æ•°çš„ç»å¯¹åå·®çš„ä¸­ä½æ•°ã€‚ è®¡ç®—æ–¹æ³•ï¼šé¦–å…ˆè®¡ç®—æ¯ä¸ªæ•°æ®ç‚¹ä¸æ•°æ®é›†ä¸­ä½æ•°çš„ç»å¯¹åå·®ï¼Œç„¶åå–è¿™äº›ç»å¯¹åå·®çš„ä¸­ä½æ•°ã€‚\nç”¨é€”ï¼šMADä¹Ÿç”¨äºåº¦é‡æ•°æ®çš„ç¦»æ•£ç¨‹åº¦ï¼Œå¹¶ä¸”åœ¨å¤„ç†ç¦»ç¾¤å€¼æ—¶æ›´å…·æœ‰é²æ£’æ€§ï¼Œå› ä¸ºå®ƒä¸å—æç«¯å€¼çš„å½±å“ï¼Œç±»ä¼¼äºIQRã€‚\nIQR å’Œ MAD ç›¸æ¯”ï¼š è®¡ç®—æ–¹æ³•ï¼šIQRæ˜¯åŸºäºå››åˆ†ä½æ•°è®¡ç®—çš„ï¼Œè€ŒMADæ˜¯åŸºäºä¸­ä½æ•°è®¡ç®—çš„ã€‚ é²æ£’æ€§ï¼šIQRå’ŒMADéƒ½æ˜¯é²æ£’çš„ç»Ÿè®¡é‡ï¼Œå¯¹å¼‚å¸¸å€¼çš„å½±å“è¾ƒå°ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒMADå¯èƒ½æ›´ä¸ºé²æ£’ï¼Œç‰¹åˆ«æ˜¯å½“æ•°æ®é›†åŒ…å«å¤§é‡ç¦»ç¾¤å€¼æ—¶ã€‚ è§£é‡Šï¼šIQRæ›´å®¹æ˜“è§£é‡Šï¼Œå› ä¸ºå®ƒä»£è¡¨äº†æ•°æ®é›†ä¸­é—´50%çš„èŒƒå›´ï¼Œè€ŒMADåˆ™è¡¨ç¤ºæ•°æ®ç‚¹ä¸ä¸­ä½æ•°çš„å…¸å‹åå·®ã€‚ å¸¸è§ç”¨é€”ï¼šIQRå’ŒMADåœ¨å¼‚å¸¸å€¼æ£€æµ‹å’Œæ•°æ®åˆ†æä¸­éƒ½å¾ˆå¸¸è§ï¼Œä½†åœ¨ä¸åŒçš„èƒŒæ™¯ä¸‹å¯èƒ½æœ‰ä¸åŒçš„åº”ç”¨åœºæ™¯ã€‚\nquantile(x, probs=c(\u0026hellip;)) é€šå¸¸ç”¨äºè®¡ç®—æ•°æ®é›† x çš„åˆ†ä½æ•°ã€‚å…¶ä¸­ probs å‚æ•°æ˜¯ä¸€ä¸ªåŒ…å«æ‰€éœ€åˆ†ä½æ•°çš„ç™¾åˆ†æ¯”çš„å‘é‡ã€‚\nxï¼šåŒ…å«æ•°æ®çš„å‘é‡æˆ–æ•°æ®æ¡†ã€‚\nprobsï¼šä¸€ä¸ªåŒ…å«æ‰€éœ€åˆ†ä½æ•°çš„ç™¾åˆ†æ¯”çš„å‘é‡ï¼Œä¾‹å¦‚ï¼Œprobs = c(0.25, 0.5, 0.75) è¡¨ç¤ºè®¡ç®—ç¬¬ä¸€å››åˆ†ä½æ•°ï¼ˆ25thç™¾åˆ†ä½æ•°ï¼‰ã€ä¸­ä½æ•°ï¼ˆ50thç™¾åˆ†ä½æ•°ï¼‰ã€ç¬¬ä¸‰å››åˆ†ä½æ•°ï¼ˆ75thç™¾åˆ†ä½æ•°ï¼‰ã€‚\nè¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªåŒ…å«è®¡ç®—å¾—åˆ°çš„åˆ†ä½æ•°çš„å‘é‡ï¼Œå…¶é¡ºåºä¸ probs ä¸­æŒ‡å®šçš„é¡ºåºç›¸å¯¹åº”ã€‚\n1 2 3 4 5 6 7 8 9 10 # åˆ›å»ºä¸€ä¸ªç¤ºä¾‹æ•°æ®é›† \u0026gt; data \u0026lt;- c(10, 15, 20, 25, 30, 35, 40, 45, 50) # è®¡ç®—ç¬¬ä¸€å››åˆ†ä½æ•°ã€ä¸­ä½æ•°ã€ç¬¬ä¸‰å››åˆ†ä½æ•° \u0026gt; quantiles \u0026lt;- quantile(data, probs = c(0.25, 0.5, 0.75)) # æ‰“å°ç»“æœ \u0026gt; print(quantiles) 25% 50% 75% 20 30 40 é¢˜å¤–è¯ç»“æŸã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026gt; min(store.df$p1sales) [1] 73 \u0026gt; max(store.df$p1sales) [1] 263 \u0026gt; mean(store.df$p1prom) [1] 0.1 \u0026gt; median(store.df$p2sales) [1] 96 \u0026gt; var(store.df$p1sales) [1] 805.0044 \u0026gt; sd(store.df$p1sales) [1] 28.3726 \u0026gt; IQR(store.df$p1sales) [1] 37 \u0026gt; mad(store.df$p1sales) [1] 26.6868 \u0026gt; quantile(store.df$p1sales, probs = c(0.25, 0.5, 0.75)) 25% 50% 75% 113 129 150 For skewed and asymmetric distributions that are common in marketing, such as unit sales or household income, the arithmetic mean() and standard deviation sd() may be misleading; in those cases, the median() and the interquartile range IQR() (the range of the middle 50% of data) are often used to summarize a distribution.\nå¯¹äºå¸‚åœºè¥é”€ä¸­å¸¸è§çš„å€¾æ–œå’Œä¸å¯¹ç§°åˆ†å¸ƒï¼Œä¾‹å¦‚å•ä½é”€å”®æˆ–å®¶åº­æ”¶å…¥ï¼Œç®—æœ¯å¹³å‡å€¼()å’Œæ ‡å‡†å·®sd()å¯èƒ½ä¼šäº§ç”Ÿè¯¯å¯¼;åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä¸­ä½æ•°()å’Œå››åˆ†ä½æ•°é—´è·IQR()(ä¸­é—´50%æ•°æ®çš„èŒƒå›´)é€šå¸¸ç”¨äºæ€»ç»“åˆ†å¸ƒã€‚\nå› ä¸ºåœ¨åæ–œå’Œä¸å¯¹ç§°åˆ†å¸ƒçš„æƒ…å†µä¸‹ï¼Œæ•°æ®ä¸­å¯èƒ½å­˜åœ¨æç«¯å€¼ï¼ˆç¦»ç¾¤å€¼ï¼‰ï¼Œè¿™äº›å€¼å¯¹äºç®—æœ¯å¹³å‡å€¼å’Œæ ‡å‡†å·®çš„å½±å“è¾ƒå¤§ï¼Œå¯¼è‡´è¿™ä¸¤ä¸ªç»Ÿè®¡é‡å¯èƒ½ä¸å¤ªå‡†ç¡®åœ°åæ˜ æ•´ä½“æ•°æ®çš„ç‰¹å¾ã€‚\nç®—æœ¯å¹³å‡å€¼çš„é—®é¢˜ï¼š åæ–œåˆ†å¸ƒä¸­çš„æç«¯å€¼ä¼šå¯¹å¹³å‡å€¼äº§ç”Ÿè¾ƒå¤§çš„å½±å“ï¼Œä½¿å…¶åç¦»æ•°æ®é›†çš„ä¸­å¿ƒè¶‹åŠ¿ã€‚è¿™å¯¼è‡´å¹³å‡å€¼å¯èƒ½ä¸å†æ˜¯æ•°æ®çš„å…¸å‹ä¸­å¿ƒåº¦é‡ã€‚ æ ‡å‡†å·®çš„é—®é¢˜ï¼š æ ‡å‡†å·®å¯¹æç«¯å€¼éå¸¸æ•æ„Ÿï¼Œå› ä¸ºå®ƒæ˜¯åŸºäºå¹³æ–¹å·®çš„ï¼Œè¿™ä¼šæ”¾å¤§ç¦»ç¾¤å€¼çš„å½±å“ã€‚è¿™æ ·ï¼Œæ ‡å‡†å·®å¯èƒ½é«˜ä¼°äº†æ•°æ®çš„çœŸå®åˆ†æ•£ç¨‹åº¦ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¸­ä½æ•°æ˜¯æ•°æ®é›†ä¸­çš„ä¸­é—´å€¼ï¼Œä¸å—æç«¯å€¼çš„å½±å“ï¼Œå› æ­¤æ›´èƒ½åæ˜ æ•°æ®çš„ä¸­å¿ƒè¶‹åŠ¿ã€‚å››åˆ†ä½æ•°é—´è·ï¼ˆIQRï¼‰æ˜¯æ•°æ®ä¸­é—´50%çš„èŒƒå›´ï¼Œå®ƒä¹Ÿå¯¹ç¦»ç¾¤å€¼å…·æœ‰ä¸€å®šçš„é²æ£’æ€§ï¼Œå› æ­¤æ›´é€‚åˆåœ¨åæ–œåˆ†å¸ƒä¸­åº¦é‡æ•°æ®çš„åˆ†æ•£ç¨‹åº¦ã€‚\nç»¼åˆèµ·æ¥ï¼Œä¸ºäº†æ›´å‡†ç¡®åœ°æ‘˜è¦å’Œç†è§£åæ–œåˆ†å¸ƒçš„æ•°æ®ç‰¹å¾ï¼Œä½¿ç”¨ä¸­ä½æ•°å’Œå››åˆ†ä½æ•°é—´è·é€šå¸¸æ˜¯æ›´åˆé€‚çš„é€‰æ‹©ã€‚è¿™æ ·çš„åº¦é‡æ–¹æ³•æ›´å…·æœ‰é²æ£’æ€§ï¼Œèƒ½å¤Ÿæä¾›æ›´ç¨³å¥ã€ä¸å—æç«¯å€¼å¹²æ‰°çš„æ•°æ®æ‘˜è¦ã€‚\n1 2 3 4 5 6 7 8 9 10 11 \u0026gt; quantile(store.df$p1sales, probs = c(0.05, 0.95)) # central 90% data 5% 95% 93 184 \u0026gt; quantile(store.df$p1sales, probs = 0:10/10) 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 73.0 100.0 109.0 117.0 122.6 129.0 136.0 145.0 156.0 171.0 263.0o \u0026gt; quantile(store.df$p1sales, probs = seq(from=0, to=1, by=0.1)) 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 73.0 100.0 109.0 117.0 122.6 129.0 136.0 145.0 156.0 171.0 263.0 Suppose we wanted a summary of the sales for product 1 and product 2 based on their median and interquartile range. We might assemble these summary statistics into a data frame that is easier to read than the one-line- at-a-time output above. We create a data frame to hold our summary statistics. We name the columns and rows and fill in the cells with function values:\nå‡è®¾æˆ‘ä»¬æƒ³æ ¹æ®äº§å“1å’Œäº§å“2çš„ä¸­ä½æ•°å’Œå››åˆ†ä½æ•°èŒƒå›´æ±‡æ€»å®ƒä»¬çš„é”€å”®é¢ã€‚æˆ‘ä»¬å¯ä»¥å°†è¿™äº›æ±‡æ€»ç»Ÿè®¡ä¿¡æ¯ç»„åˆæˆä¸€ä¸ªæ•°æ®å¸§ï¼Œè¿™æ ·æ¯”ä¸Šé¢çš„ä¸€è¡Œä¸€è¡Œçš„è¾“å‡ºæ›´å®¹æ˜“é˜…è¯»ã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ•°æ®æ¡†æ¶æ¥ä¿å­˜æ±‡æ€»ç»Ÿè®¡æ•°æ®ã€‚æˆ‘ä»¬ä¸ºåˆ—å’Œè¡Œå‘½åï¼Œå¹¶ç”¨å‡½æ•°å€¼å¡«å……å•å…ƒæ ¼:\n1 2 3 4 5 6 7 8 mysummary.df \u0026lt;- data.frame(matrix(NA, nrow=2, ncol=2)) # 2 by 2 empty matrix names(mysummary.df) \u0026lt;- c(\u0026#34;Median Sales\u0026#34;, \u0026#34;IQR\u0026#34;) # name columns rownames(mysummary.df) \u0026lt;- c(\u0026#34;Product 1\u0026#34;, \u0026#34;Product 2\u0026#34;) # name rows mysummary.df[\u0026#34;Product 1\u0026#34;, \u0026#34;Median Sales\u0026#34;] \u0026lt;- median(store.df$p1sales) mysummary.df[\u0026#34;Product 2\u0026#34;, \u0026#34;Median Sales\u0026#34;] \u0026lt;- median(store.df$p2sales) mysummary.df[\u0026#34;Product 1\u0026#34;, \u0026#34;IQR\u0026#34;] \u0026lt;- IQR(store.df$p1sales) mysummary.df[\u0026#34;Product 2\u0026#34;, \u0026#34;IQR\u0026#34;] \u0026lt;- IQR(store.df$p2sales) mysummary.df 3 Summarize data frames 3.1 summary() æœ‰äº‹æ²¡äº‹ï¼Œsummaryä¸€ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026gt; summary(store.df) storeNum Year Week p1sales p2sales p1price p2price p1prom p2prom country Min. :101.0 Min. :1.0 Min. : 1.00 Min. : 73 Min. : 51.0 Min. :2.190 Min. :2.29 Min. :0.0 Min. :0.0000 AU:104 1st Qu.:105.8 1st Qu.:1.0 1st Qu.:13.75 1st Qu.:113 1st Qu.: 84.0 1st Qu.:2.290 1st Qu.:2.49 1st Qu.:0.0 1st Qu.:0.0000 BR:208 Median :110.5 Median :1.5 Median :26.50 Median :129 Median : 96.0 Median :2.490 Median :2.59 Median :0.0 Median :0.0000 CN:208 Mean :110.5 Mean :1.5 Mean :26.50 Mean :133 Mean :100.2 Mean :2.544 Mean :2.70 Mean :0.1 Mean :0.1385 DE:520 3rd Qu.:115.2 3rd Qu.:2.0 3rd Qu.:39.25 3rd Qu.:150 3rd Qu.:113.0 3rd Qu.:2.790 3rd Qu.:2.99 3rd Qu.:0.0 3rd Qu.:0.0000 GB:312 Max. :120.0 Max. :2.0 Max. :52.00 Max. :263 Max. :225.0 Max. :2.990 Max. :3.19 Max. :1.0 Max. :1.0000 JP:416 US:312 \u0026gt; summary(store.df$Year) Min. 1st Qu. Median Mean 3rd Qu. Max. 1.0 1.0 1.5 1.5 2.0 2.0 \u0026gt; summary(store.df, digits = 2) # ä¿ç•™å°æ•°ç‚¹åä¸¤ä½ storeNum Year Week p1sales p2sales p1price p2price p1prom p2prom country Min. :101 Min. :1.0 Min. : 1 Min. : 73 Min. : 51 Min. :2.2 Min. :2.3 Min. :0.0 Min. :0.00 AU:104 1st Qu.:106 1st Qu.:1.0 1st Qu.:14 1st Qu.:113 1st Qu.: 84 1st Qu.:2.3 1st Qu.:2.5 1st Qu.:0.0 1st Qu.:0.00 BR:208 Median :110 Median :1.5 Median :26 Median :129 Median : 96 Median :2.5 Median :2.6 Median :0.0 Median :0.00 CN:208 Mean :110 Mean :1.5 Mean :26 Mean :133 Mean :100 Mean :2.5 Mean :2.7 Mean :0.1 Mean :0.14 DE:520 3rd Qu.:115 3rd Qu.:2.0 3rd Qu.:39 3rd Qu.:150 3rd Qu.:113 3rd Qu.:2.8 3rd Qu.:3.0 3rd Qu.:0.0 3rd Qu.:0.00 GB:312 Max. :120 Max. :2.0 Max. :52 Max. :263 Max. :225 Max. :3.0 Max. :3.2 Max. :1.0 Max. :1.00 JP:416 US:312 åœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œ\u0026ldquo;1st Qu\u0026rdquo; å’Œ \u0026ldquo;3rd Qu\u0026rdquo; åˆ†åˆ«ä»£è¡¨ç¬¬ä¸€å››åˆ†ä½æ•°å’Œç¬¬ä¸‰å››åˆ†ä½æ•°ã€‚å››åˆ†ä½æ•°æ˜¯å°†æ•°æ®é›†åˆ†ä¸ºå››ç­‰ä»½çš„å€¼ï¼Œå®ƒä»¬ç”¨äºæè¿°æ•°æ®åˆ†å¸ƒçš„ä½ç½®å’Œåˆ†æ•£ç¨‹åº¦ã€‚\nç¬¬ä¸€å››åˆ†ä½æ•°ï¼ˆ1st Quï¼‰ æ˜¯æ•°æ®é›†ä¸­æ‰€æœ‰æ•°å€¼æ’åºåç¬¬25%ä½ç½®çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æ•°æ®ä¸­çš„è¾ƒå°çš„å››åˆ†ä¹‹ä¸€ã€‚\nç¬¬ä¸‰å››åˆ†ä½æ•°ï¼ˆ3rd Quï¼‰ æ˜¯æ•°æ®é›†ä¸­æ‰€æœ‰æ•°å€¼æ’åºåç¬¬75%ä½ç½®çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æ•°æ®ä¸­çš„è¾ƒå¤§çš„å››åˆ†ä¹‹ä¸‰ã€‚\n3.2 describe() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 \u0026gt; library(psych) # install if needed \u0026gt; describe(store.df) vars n mean sd median trimmed mad min max range skew kurtosis se storeNum 1 2080 110.50 5.77 110.50 110.50 7.41 101.00 120.00 19.0 0.00 -1.21 0.13 Year 2 2080 1.50 0.50 1.50 1.50 0.74 1.00 2.00 1.0 0.00 -2.00 0.01 Week 3 2080 26.50 15.01 26.50 26.50 19.27 1.00 52.00 51.0 0.00 -1.20 0.33 p1sales 4 2080 133.05 28.37 129.00 131.08 26.69 73.00 263.00 190.0 0.74 0.66 0.62 p2sales 5 2080 100.16 24.42 96.00 98.05 22.24 51.00 225.00 174.0 0.99 1.51 0.54 p1price 6 2080 2.54 0.29 2.49 2.53 0.44 2.19 2.99 0.8 0.28 -1.44 0.01 p2price 7 2080 2.70 0.33 2.59 2.69 0.44 2.29 3.19 0.9 0.32 -1.40 0.01 p1prom 8 2080 0.10 0.30 0.00 0.00 0.00 0.00 1.00 1.0 2.66 5.10 0.01 p2prom 9 2080 0.14 0.35 0.00 0.05 0.00 0.00 1.00 1.0 2.09 2.38 0.01 country* 10 2080 4.55 1.72 4.50 4.62 2.22 1.00 7.00 6.0 -0.29 -0.81 0.04 # vars: æ–¹å·® # n: è§‚æµ‹æ•°é‡ï¼ˆæ ·æœ¬æ•°é‡ï¼‰ # mean: å‡å€¼ # sd: æ ‡å‡†å·® # median: ä¸­ä½æ•° # trimmed: ä¿®å‰ªå‡å€¼ï¼ˆå»é™¤å¼‚å¸¸å€¼åçš„å‡å€¼ï¼‰ # mad: ä¸­ä½æ•°ç»å¯¹åå·®ï¼ˆMedian Absolute Deviationï¼‰ # min: æœ€å°å€¼ # max: æœ€å¤§å€¼ # range: èŒƒå›´ï¼ˆæœ€å¤§å€¼ä¸æœ€å°å€¼çš„å·®ï¼‰ # skew: ååº¦ï¼ˆSkewnessï¼Œè¡¡é‡åˆ†å¸ƒåæ–œç¨‹åº¦ï¼‰ # kurtosis: å³°åº¦ï¼ˆKurtosisï¼Œè¡¡é‡åˆ†å¸ƒçš„å°–å³°ç¨‹åº¦ï¼‰ # se: æ ‡å‡†è¯¯å·®ï¼ˆStandard Errorï¼Œå‡å€¼çš„ä¼°è®¡æ ‡å‡†å·®ï¼‰ \u0026gt; describe(store.df[,c(2, 4:9)]) vars n mean sd median trimmed mad min max range skew kurtosis se Year 1 2080 1.50 0.50 1.50 1.50 0.74 1.00 2.00 1.0 0.00 -2.00 0.01 p1sales 2 2080 133.05 28.37 129.00 131.08 26.69 73.00 263.00 190.0 0.74 0.66 0.62 p2sales 3 2080 100.16 24.42 96.00 98.05 22.24 51.00 225.00 174.0 0.99 1.51 0.54 p1price 4 2080 2.54 0.29 2.49 2.53 0.44 2.19 2.99 0.8 0.28 -1.44 0.01 p2price 5 2080 2.70 0.33 2.59 2.69 0.44 2.29 3.19 0.9 0.32 -1.40 0.01 p1prom 6 2080 0.10 0.30 0.00 0.00 0.00 0.00 1.00 1.0 2.66 5.10 0.01 p2prom 7 2080 0.14 0.35 0.00 0.05 0.00 0.00 1.00 1.0 2.09 2.38 0.01 trimmed trimmed æ˜¯æŒ‡å»é™¤äº†æ•°æ®ä¸­ä¸€å®šæ¯”ä¾‹çš„æç«¯å€¼ï¼ˆé€šå¸¸æ˜¯å°¾éƒ¨çš„æç«¯å€¼ï¼‰åè®¡ç®—å¾—åˆ°çš„å‡å€¼ã€‚ä¿®å‰ªå‡å€¼ï¼ˆtrimmed meanï¼‰æ˜¯ä¸€ç§å¯¹å‡å€¼çš„ä¿®æ­£ï¼Œæ—¨åœ¨å‡å°‘æç«¯å€¼å¯¹å‡å€¼çš„å½±å“ï¼Œä»è€Œæ›´å¥½åœ°åæ˜ æ•°æ®çš„ä¸­å¿ƒè¶‹åŠ¿ã€‚\né€šå¸¸æƒ…å†µä¸‹ï¼Œä¿®å‰ªå‡å€¼çš„è®¡ç®—æ–¹å¼æ˜¯å°†æ•°æ®é›†ä¸­çš„ä¸€å®šæ¯”ä¾‹çš„æœ€å°å€¼å’Œæœ€å¤§å€¼å»æ‰ï¼Œç„¶åè®¡ç®—å‰©ä½™æ•°æ®çš„ç®—æœ¯å¹³å‡å€¼ã€‚è¿™ä¸ªæ¯”ä¾‹å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè€Œå®šï¼Œå¸¸è§çš„ä¿®å‰ªæ¯”ä¾‹åŒ…æ‹¬å»æ‰5%ã€10%ç”šè‡³æ›´å¤šçš„æç«¯å€¼ã€‚\nä¿®å‰ªå‡å€¼é€‚ç”¨äºæ•°æ®é›†ä¸­å­˜åœ¨æ˜æ˜¾çš„æç«¯å€¼æˆ–å¼‚å¸¸å€¼çš„æƒ…å†µã€‚ä¸ç®€å•çš„ç®—æœ¯å¹³å‡å€¼ç›¸æ¯”ï¼Œä¿®å‰ªå‡å€¼æ›´åŠ ç¨³å¥ï¼Œå› ä¸ºå®ƒå¯¹å¼‚å¸¸å€¼çš„å½±å“æ›´å°ï¼Œæ›´èƒ½å¤Ÿåæ˜ æ•°æ®çš„å…¸å‹ä¸­å¿ƒä½ç½®ã€‚ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¿®å‰ªå‡å€¼å¯èƒ½ä¼šå¯¼è‡´ä¸€å®šç¨‹åº¦ä¸Šçš„ä¿¡æ¯æŸå¤±ï¼Œå°¤å…¶æ˜¯å½“æ•°æ®ä¸­çš„æç«¯å€¼å…·æœ‰ç‰¹æ®Šæ„ä¹‰æˆ–é‡è¦æ€§æ—¶ã€‚\nmad MADï¼ˆMedian Absolute Deviationï¼Œä¸­ä½æ•°ç»å¯¹åå·®ï¼‰æ˜¯ä¸€ç§ç”¨äºè¡¡é‡æ•°æ®é›†æ•£å¸ƒåº¦çš„ç»Ÿè®¡é‡ï¼Œå®ƒè¡¡é‡äº†æ•°æ®ç‚¹ä¸æ•°æ®é›†ä¸­ä½æ•°ä¹‹é—´çš„å…¸å‹åå·®ã€‚\nå…·ä½“è€Œè¨€ï¼ŒMADæ˜¯æ•°æ®é›†ä¸­æ‰€æœ‰æ•°æ®ç‚¹ä¸æ•°æ®é›†ä¸­ä½æ•°çš„ç»å¯¹åå·®çš„ä¸­ä½æ•°ã€‚\nMADç›¸å¯¹äºæ ‡å‡†å·®çš„ä¼˜åŠ¿åœ¨äºå®ƒå¯¹æç«¯å€¼ï¼ˆç¦»ç¾¤å€¼ï¼‰å…·æœ‰è¾ƒå¼ºçš„é²æ£’æ€§ã€‚å› ä¸ºMADæ˜¯åŸºäºç»å¯¹åå·®çš„ä¸­ä½æ•°è®¡ç®—çš„ï¼Œå®ƒä¸å—æç«¯å€¼çš„å½±å“ï¼Œæ›´èƒ½å¤Ÿå‡†ç¡®åœ°æè¿°æ•°æ®çš„ç¦»æ•£ç¨‹åº¦ï¼Œå°¤å…¶æ˜¯åœ¨å­˜åœ¨ç¦»ç¾¤å€¼çš„æƒ…å†µä¸‹ã€‚\nMADå¸¸ç”¨äºé‡‘èé¢†åŸŸå’Œå…¶ä»–é¢†åŸŸçš„æ•°æ®åˆ†æä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦è€ƒè™‘æ•°æ®çš„å¼‚å¸¸å€¼å¯¹ç»“æœçš„å½±å“æ—¶ã€‚\nSkewnessï¼ˆååº¦ï¼‰ æ˜¯æè¿°æ•°æ®åˆ†å¸ƒå½¢æ€åæ–œç¨‹åº¦çš„ç»Ÿè®¡é‡ã€‚å®ƒè¡¡é‡äº†æ•°æ®åˆ†å¸ƒç›¸å¯¹äºå…¶å¹³å‡å€¼çš„ä¸å¯¹ç§°æ€§ï¼Œå³æ•°æ®é›†åœ¨å¹³å‡å€¼ä¸¤ä¾§çš„åˆ†å¸ƒæ˜¯å¦å¯¹ç§°ã€‚\næ­£åï¼ˆPositive Skewnessï¼‰ï¼šæ•°æ®åˆ†å¸ƒå‘å³åç§»ï¼Œå°¾éƒ¨å‘å³å»¶ä¼¸ï¼Œå³æ•°æ®é›†å³ä¾§çš„å°¾éƒ¨è¾ƒé•¿ï¼Œå¹³å‡å€¼å³ä¾§çš„æ•°æ®ç‚¹è¾ƒå¤šï¼Œå½¢æˆä¸€ä¸ªé•¿å°¾ã€‚æ­£ååˆ†å¸ƒæ„å‘³ç€æ•°æ®é›†ä¸­å­˜åœ¨è¾ƒå¤šè¾ƒå¤§çš„å€¼ã€‚\nè´Ÿåï¼ˆNegative Skewnessï¼‰ï¼šæ•°æ®åˆ†å¸ƒå‘å·¦åç§»ï¼Œå°¾éƒ¨å‘å·¦å»¶ä¼¸ï¼Œå³æ•°æ®é›†å·¦ä¾§çš„å°¾éƒ¨è¾ƒé•¿ï¼Œå¹³å‡å€¼å·¦ä¾§çš„æ•°æ®ç‚¹è¾ƒå¤šï¼Œå½¢æˆä¸€ä¸ªé•¿å°¾ã€‚è´Ÿååˆ†å¸ƒæ„å‘³ç€æ•°æ®é›†ä¸­å­˜åœ¨è¾ƒå¤šè¾ƒå°çš„å€¼ã€‚\nååº¦ä¸º0è¡¨ç¤ºæ•°æ®åˆ†å¸ƒç›¸å¯¹å¯¹ç§°ï¼Œå¤§äº0è¡¨ç¤ºæ­£åï¼Œå°äº0è¡¨ç¤ºè´Ÿåã€‚ååº¦çš„ç»å¯¹å€¼è¶Šå¤§ï¼Œåæ–œç¨‹åº¦è¶Šæ˜æ˜¾ã€‚\nååº¦æ˜¯äº†è§£æ•°æ®åˆ†å¸ƒå½¢æ€çš„é‡è¦æŒ‡æ ‡ï¼Œç‰¹åˆ«æ˜¯åœ¨åšæ•°æ®åˆ†æå’Œæ¨¡å‹å»ºç«‹æ—¶ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ¤æ–­æ•°æ®é›†æ˜¯å¦éœ€è¦è¿›è¡Œå¯¹ç§°åŒ–å¤„ç†ï¼Œä»¥æ»¡è¶³å»ºæ¨¡çš„å‡è®¾æ¡ä»¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 å¯¹ç§°åŒ–å¤„ç†æ˜¯æŒ‡é€šè¿‡æŸç§æ–¹æ³•æˆ–æŠ€æœ¯ä½¿æ•°æ®åˆ†å¸ƒæ›´åŠ å¯¹ç§°çš„è¿‡ç¨‹ã€‚åœ¨ç»Ÿè®¡å­¦å’Œæ•°æ®åˆ†æä¸­ï¼Œå¯¹ç§°åŒ–å¤„ç†é€šå¸¸ç”¨äºè°ƒæ•´æ•°æ®çš„åˆ†å¸ƒå½¢æ€ï¼Œä½¿å…¶æ›´æ¥è¿‘å¯¹ç§°åˆ†å¸ƒï¼Œä»¥æ»¡è¶³ç»Ÿè®¡æ–¹æ³•æˆ–æ¨¡å‹çš„å‡è®¾æ¡ä»¶ã€‚ å¸¸è§çš„å¯¹ç§°åŒ–å¤„ç†æ–¹æ³•åŒ…æ‹¬ï¼š 1. å¯¹æ•°è½¬æ¢ï¼ˆLog Transformationï¼‰ï¼šå¯¹æ•°è½¬æ¢æ˜¯é€šè¿‡å–æ•°æ®çš„å¯¹æ•°æ¥å‡å°æ•°æ®çš„ååº¦ã€‚è¿™ç§è½¬æ¢é€šå¸¸ç”¨äºå¤„ç†å³ååˆ†å¸ƒçš„æ•°æ®ï¼Œå°†å…¶è½¬æ¢ä¸ºæ›´æ¥è¿‘å¯¹ç§°åˆ†å¸ƒçš„å½¢å¼ã€‚ 2. æ–¹æ ¹è½¬æ¢ï¼ˆSquare Root Transformationï¼‰ï¼šæ–¹æ ¹è½¬æ¢æ˜¯é€šè¿‡å–æ•°æ®çš„å¹³æ–¹æ ¹æ¥å‡å°æ•°æ®çš„ååº¦ã€‚ç±»ä¼¼äºå¯¹æ•°è½¬æ¢ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨äºè°ƒæ•´å³ååˆ†å¸ƒçš„æ•°æ®ã€‚ 3. å¹‚è½¬æ¢ï¼ˆPower Transformationï¼‰ï¼šå¹‚è½¬æ¢æ˜¯é€šè¿‡å–æ•°æ®çš„æŸä¸ªå¹‚æ¬¡æ–¹æ¥è°ƒæ•´æ•°æ®çš„åˆ†å¸ƒå½¢æ€ã€‚å¸¸è§çš„å¹‚æ¬¡æ–¹åŒ…æ‹¬0.5ï¼ˆå¹³æ–¹æ ¹è½¬æ¢ï¼‰ã€0.33ã€0.25ç­‰ï¼Œå…·ä½“é€‰æ‹©å–å†³äºæ•°æ®çš„åˆ†å¸ƒç‰¹å¾ã€‚ 4. æ ‡å‡†åŒ–ï¼ˆStandardizationï¼‰ï¼šæ ‡å‡†åŒ–æ˜¯å°†æ•°æ®è½¬æ¢ä¸ºå‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚è™½ç„¶æ ‡å‡†åŒ–ä¸ä¼šæ”¹å˜æ•°æ®çš„åˆ†å¸ƒå½¢æ€ï¼Œä½†å®ƒå¯ä»¥å°†æ•°æ®è½¬æ¢ä¸ºå…·æœ‰å›ºå®šå‡å€¼å’Œæ–¹å·®çš„å½¢å¼ï¼Œæœ‰åŠ©äºåœ¨ä¸€äº›æƒ…å†µä¸‹æ¯”è¾ƒä¸åŒå°ºåº¦çš„å˜é‡ã€‚ å¯¹ç§°åŒ–å¤„ç†çš„ç›®çš„æ˜¯ä½¿æ•°æ®æ›´ç¬¦åˆç»Ÿè®¡æ¨¡å‹çš„å‡è®¾ï¼Œä¾‹å¦‚çº¿æ€§æ¨¡å‹å¯¹æ•°æ®çš„æ­£æ€æ€§å‡è®¾ã€‚é€šè¿‡å¯¹æ•°æ®è¿›è¡Œå¯¹ç§°åŒ–å¤„ç†ï¼Œå¯ä»¥æé«˜ç»Ÿè®¡åˆ†æçš„å‡†ç¡®æ€§å’Œç¨³å¥æ€§ï¼Œå¹¶æé«˜æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœã€‚ Kurtosisï¼ˆå³°åº¦ï¼‰ æ˜¯æè¿°æ•°æ®åˆ†å¸ƒå³°æ€ï¼ˆå°–å³°ç¨‹åº¦ï¼‰çš„ç»Ÿè®¡é‡ã€‚å®ƒè¡¡é‡äº†æ•°æ®åˆ†å¸ƒä¸­æ•°æ®ç‚¹åœ¨å‡å€¼é™„è¿‘èšé›†çš„ç¨‹åº¦ï¼Œå³æ•°æ®é›†çš„å°–å³°åº¦ã€‚\næ­£å³°ï¼ˆPositive Kurtosisï¼‰ï¼šæ•°æ®åˆ†å¸ƒçš„å³°æ€è¾ƒé«˜ä¸”å°–é”ï¼Œå°¾éƒ¨è¾ƒé•¿ã€‚æ­£å³°åˆ†å¸ƒè¡¨æ˜æ•°æ®é›†ä¸­çš„æ•°æ®ç‚¹åœ¨å‡å€¼é™„è¿‘èšé›†å¾—æ›´ä¸ºå¯†é›†ï¼ŒåŒæ—¶å­˜åœ¨æ›´å¤šçš„æç«¯å€¼ï¼Œå°¾éƒ¨æ›´é•¿ã€‚\nè´Ÿå³°ï¼ˆNegative Kurtosisï¼‰ï¼šæ•°æ®åˆ†å¸ƒçš„å³°æ€è¾ƒä½ä¸”å¹³ç¼“ï¼Œå°¾éƒ¨è¾ƒçŸ­ã€‚è´Ÿå³°åˆ†å¸ƒè¡¨æ˜æ•°æ®é›†ä¸­çš„æ•°æ®ç‚¹åˆ†å¸ƒæ›´ä¸ºæ‰å¹³ï¼Œç›¸å¯¹æ›´åŠ åˆ†æ•£ã€‚\næ­£å¸¸çš„å³°åº¦ä¸º3ã€‚å¤§äº3çš„å³°åº¦è¡¨ç¤ºåˆ†å¸ƒå°–å³­ï¼ˆå°–å³°ï¼‰ï¼Œè€Œå°äº3çš„å³°åº¦è¡¨ç¤ºåˆ†å¸ƒå¹³ç¼“ï¼ˆæ‰å¹³ï¼‰ã€‚ä¸ååº¦ä¸€æ ·ï¼Œå³°åº¦ä¹Ÿæ˜¯äº†è§£æ•°æ®åˆ†å¸ƒå½¢æ€çš„é‡è¦æŒ‡æ ‡ï¼Œç‰¹åˆ«æ˜¯åœ¨å»ºæ¨¡æ—¶éœ€è¦è€ƒè™‘æ•°æ®é›†çš„å³°æ€ç‰¹å¾ã€‚\nse se ä»£è¡¨çš„æ˜¯æ ‡å‡†è¯¯å·®ï¼ˆStandard Errorï¼‰ã€‚æ ‡å‡†è¯¯å·®æ˜¯å¯¹æ ·æœ¬ç»Ÿè®¡é‡çš„æŠ½æ ·åˆ†å¸ƒçš„ç¦»æ•£ç¨‹åº¦è¿›è¡Œä¼°è®¡çš„ä¸€ç§åº¦é‡ï¼Œç”¨äºè¡¡é‡æ ·æœ¬ç»Ÿè®¡é‡ä¸æ€»ä½“å‚æ•°ä¹‹é—´çš„å·®å¼‚ã€‚\nåœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œæ ‡å‡†è¯¯å·®é€šå¸¸ç”¨äºä¼°è®¡æ ·æœ¬ç»Ÿè®¡é‡çš„æŠ½æ ·åˆ†å¸ƒçš„ç¦»æ•£ç¨‹åº¦ï¼Œä¾‹å¦‚æ ·æœ¬å‡å€¼çš„æ ‡å‡†è¯¯å·®ç”¨äºä¼°è®¡æ ·æœ¬å‡å€¼çš„æŠ½æ ·åˆ†å¸ƒçš„ç¦»æ•£ç¨‹åº¦ã€‚æ ‡å‡†è¯¯å·®è¶Šå°ï¼Œè¡¨ç¤ºæ ·æœ¬ç»Ÿè®¡é‡æ›´æ¥è¿‘äºæ€»ä½“å‚æ•°çš„çœŸå€¼ï¼›æ ‡å‡†è¯¯å·®è¶Šå¤§ï¼Œè¡¨ç¤ºæ ·æœ¬ç»Ÿè®¡é‡ä¸æ€»ä½“å‚æ•°ä¹‹é—´çš„å·®å¼‚è¶Šå¤§ã€‚\næ ‡å‡†è¯¯å·®çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œç‰¹åˆ«æ˜¯åœ¨ç»Ÿè®¡æ¨æ–­å’Œå‡è®¾æ£€éªŒä¸­ï¼Œå®ƒå¸¸ç”¨äºè®¡ç®—ç½®ä¿¡åŒºé—´ã€å‡è®¾æ£€éªŒçš„ç»Ÿè®¡é‡ï¼ˆå¦‚ t ç»Ÿè®¡é‡ã€z ç»Ÿè®¡é‡ï¼‰\næ£€æŸ¥æ•°æ®é›†çš„é€šç”¨æ–¹æ³• read.csv è¯»å–æ•°æ® è½¬æ¢ä¸ºdata frameï¼Œç»™å®šåˆé€‚çš„åç§° é€šè¿‡dim()æ£€æŸ¥æ˜¯å¦æ˜¯é¢„æœŸçš„è¡Œæ•°å’Œåˆ—æ•° 1 2 \u0026gt; dim(store.df) [1] 2080 10 ä½¿ç”¨head()ã€tail()æ£€æŸ¥å‰å‡ è¡Œå’Œæœ«å°¾å‡ è¡Œï¼Œç¡®ä¿å¼€å¤´æ ‡é¢˜è¡Œå’Œæœ«å°¾ç©ºç™½è¡Œæ²¡æœ‰åŒ…å«åœ¨å†… 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026gt; head(store.df) storeNum Year Week p1sales p2sales p1price p2price p1prom p2prom country 1 101 1 1 127 106 2.29 2.29 0 0 US 2 101 1 2 137 105 2.49 2.49 0 0 US 3 101 1 3 156 97 2.99 2.99 1 0 US 4 101 1 4 117 106 2.99 3.19 0 0 US 5 101 1 5 138 100 2.49 2.59 0 1 US 6 101 1 6 115 127 2.79 2.49 0 0 US \u0026gt; tail(store.df) storeNum Year Week p1sales p2sales p1price p2price p1prom p2prom country 2075 120 2 47 140 104 2.49 2.59 0 0 CN 2076 120 2 48 150 88 2.49 2.99 0 0 CN 2077 120 2 49 121 97 2.49 2.59 0 0 CN 2078 120 2 50 91 124 2.99 2.29 0 0 CN 2079 120 2 51 83 115 2.99 2.29 0 0 CN 2080 120 2 52 136 99 2.49 2.49 0 0 CN ä½¿ç”¨Some()éšæœºæ£€æŸ¥å‡ è¡Œ 1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; some(store.df) storeNum Year Week p1sales p2sales p1price p2price p1prom p2prom country 324 104 1 12 112 99 2.29 2.29 0 0 DE 644 107 1 20 131 92 2.49 2.59 0 0 DE 1032 110 2 44 211 70 2.19 3.19 0 1 GB 1183 112 1 39 155 80 2.29 2.59 1 0 BR 1274 113 1 26 121 117 2.29 2.29 0 0 BR 1518 115 2 10 157 82 2.49 3.19 0 0 JP 1525 115 2 17 167 72 2.49 3.19 0 0 JP 1565 116 1 5 186 63 2.19 3.19 0 0 JP 1974 119 2 50 144 111 2.99 3.19 0 0 CN 2036 120 2 8 125 103 2.79 2.99 0 0 CN str()æ£€æŸ¥data frameæ¶æ„ï¼Œç¡®ä¿å˜é‡çš„ç±»å‹å’Œå€¼æ˜¯åˆé€‚çš„ï¼Œå°¤å…¶æ˜¯factor 1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; str(store.df) \u0026#39;data.frame\u0026#39;:\t2080 obs. of 10 variables: $ storeNum: int 101 101 101 101 101 101 101 101 101 101 ... $ Year : int 1 1 1 1 1 1 1 1 1 1 ... $ Week : int 1 2 3 4 5 6 7 8 9 10 ... $ p1sales : int 127 137 156 117 138 115 116 106 116 145 ... $ p2sales : int 106 105 97 106 100 127 90 126 94 91 ... $ p1price : num 2.29 2.49 2.99 2.99 2.49 2.79 2.99 2.99 2.29 2.49 ... $ p2price : num 2.29 2.49 2.99 3.19 2.59 2.49 3.19 2.29 2.29 2.99 ... $ p1prom : int 0 0 1 0 0 0 0 0 0 0 ... $ p2prom : int 0 0 0 0 1 0 0 0 0 0 ... $ country : Factor w/ 7 levels \u0026#34;AU\u0026#34;,\u0026#34;BR\u0026#34;,\u0026#34;CN\u0026#34;,..: 7 7 7 7 7 7 7 7 7 7 ... 7.summary()æŸ¥çœ‹é¢„æœŸå¤–çš„å€¼ï¼Œå°¤å…¶æ˜¯Min/Max\n1 2 3 4 5 6 7 8 9 \u0026gt; summary(store.df) storeNum Year Week p1sales p2sales p1price p2price p1prom p2prom country Min. :101.0 Min. :1.0 Min. : 1.00 Min. : 73 Min. : 51.0 Min. :2.190 Min. :2.29 Min. :0.0 Min. :0.0000 AU:104 1st Qu.:105.8 1st Qu.:1.0 1st Qu.:13.75 1st Qu.:113 1st Qu.: 84.0 1st Qu.:2.290 1st Qu.:2.49 1st Qu.:0.0 1st Qu.:0.0000 BR:208 Median :110.5 Median :1.5 Median :26.50 Median :129 Median : 96.0 Median :2.490 Median :2.59 Median :0.0 Median :0.0000 CN:208 Mean :110.5 Mean :1.5 Mean :26.50 Mean :133 Mean :100.2 Mean :2.544 Mean :2.70 Mean :0.1 Mean :0.1385 DE:520 3rd Qu.:115.2 3rd Qu.:2.0 3rd Qu.:39.25 3rd Qu.:150 3rd Qu.:113.0 3rd Qu.:2.790 3rd Qu.:2.99 3rd Qu.:0.0 3rd Qu.:0.0000 GB:312 Max. :120.0 Max. :2.0 Max. :52.00 Max. :263 Max. :225.0 Max. :2.990 Max. :3.19 Max. :1.0 Max. :1.0000 JP:416 US:312 describe()æŸ¥çœ‹å„ä¸ªitemçš„næ˜¯å¦ç›¸åŒï¼Œå¹¶ä¸”æ£€æŸ¥trimmedå’Œskew 1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; describe(store.df) vars n mean sd median trimmed mad min max range skew kurtosis se storeNum 1 2080 110.50 5.77 110.50 110.50 7.41 101.00 120.00 19.0 0.00 -1.21 0.13 Year 2 2080 1.50 0.50 1.50 1.50 0.74 1.00 2.00 1.0 0.00 -2.00 0.01 Week 3 2080 26.50 15.01 26.50 26.50 19.27 1.00 52.00 51.0 0.00 -1.20 0.33 p1sales 4 2080 133.05 28.37 129.00 131.08 26.69 73.00 263.00 190.0 0.74 0.66 0.62 p2sales 5 2080 100.16 24.42 96.00 98.05 22.24 51.00 225.00 174.0 0.99 1.51 0.54 p1price 6 2080 2.54 0.29 2.49 2.53 0.44 2.19 2.99 0.8 0.28 -1.44 0.01 p2price 7 2080 2.70 0.33 2.59 2.69 0.44 2.29 3.19 0.9 0.32 -1.40 0.01 p1prom 8 2080 0.10 0.30 0.00 0.00 0.00 0.00 1.00 1.0 2.66 5.10 0.01 p2prom 9 2080 0.14 0.35 0.00 0.05 0.00 0.00 1.00 1.0 2.09 2.38 0.01 country* 10 2080 4.55 1.72 4.50 4.62 2.22 1.00 7.00 6.0 -0.29 -0.81 0.04 ç•ªå¤– Trimmmed And Skewed Trimmed\nå½“æ•°æ®é›†ä¸­å­˜åœ¨æç«¯å€¼æ—¶ï¼Œä¿®å‰ªå‡å€¼å¯ä»¥æ›´å‡†ç¡®åœ°åæ˜ æ•°æ®çš„ä¸­å¿ƒè¶‹åŠ¿ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚\nå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«10ä¸ªè§‚æµ‹å€¼çš„æ•°æ®é›†ï¼š\n\\[ \\{2, 3, 4, 5, 6, 7, 8, 9, 10, 100\\} \\]è¿™ä¸ªæ•°æ®é›†ä¸­æœ‰ä¸€ä¸ªæ˜æ˜¾çš„æç«¯å€¼100ã€‚è®©æˆ‘ä»¬è®¡ç®—ä¸€ä¸‹è¿™ä¸ªæ•°æ®é›†çš„ç®€å•ç®—æœ¯å¹³å‡å€¼å’Œä¿®å‰ªå‡å€¼ï¼Œå¹¶æ¯”è¾ƒå®ƒä»¬å¯¹æ•°æ®ä¸­å¿ƒè¶‹åŠ¿çš„åæ˜ ã€‚\né¦–å…ˆï¼Œè®¡ç®—ç®€å•ç®—æœ¯å¹³å‡å€¼ï¼š\n$$ \\text{Mean} = \\frac{2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 100}{10} = 15.4 $$æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¡ç®—ä¿®å‰ªå‡å€¼ï¼Œå‰”é™¤æœ€å¤§å’Œæœ€å°çš„10%çš„è§‚æµ‹å€¼ï¼ˆå³å‰”é™¤ä¸€ä¸ªæç«¯å€¼100ï¼‰ï¼š\n$$ \\text{Trimmed Mean} = \\frac{3 + 4 + 5 + 6 + 7 + 8 + 9 + 10}{8} = 6.875 $$ä»è®¡ç®—ç»“æœå¯ä»¥çœ‹å‡ºï¼Œç®€å•ç®—æœ¯å¹³å‡å€¼å—åˆ°æç«¯å€¼100çš„å½±å“ï¼Œå¯¼è‡´å¹³å‡å€¼è¾¾åˆ°äº†15.4ï¼Œä¸å¤Ÿå‡†ç¡®åœ°åæ˜ äº†æ•°æ®çš„ä¸­å¿ƒè¶‹åŠ¿ã€‚è€Œä¿®å‰ªå‡å€¼å‰”é™¤äº†æç«¯å€¼100åï¼Œå¾—åˆ°çš„ä¿®å‰ªå‡å€¼ä¸º6.875ï¼Œæ›´æ¥è¿‘æ•°æ®çš„ä¸­å¿ƒä½ç½®ã€‚\nå› æ­¤ï¼Œé€šè¿‡æ¯”è¾ƒç®€å•ç®—æœ¯å¹³å‡å€¼å’Œä¿®å‰ªå‡å€¼ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å‡†ç¡®åœ°äº†è§£æ•°æ®çš„ä¸­å¿ƒè¶‹åŠ¿ï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®é›†ä¸­å­˜åœ¨æç«¯å€¼çš„æƒ…å†µä¸‹ã€‚\nSkewed\nå½“æ•°æ®é›†ä¸­å­˜åœ¨æç«¯å€¼æ—¶ï¼Œæ•°æ®çš„åˆ†å¸ƒå¯èƒ½ä¼šåæ–œï¼ˆskewedï¼‰ï¼Œä¿®å‰ªå‡å€¼å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘æç«¯å€¼å¯¹æ•°æ®çš„å½±å“ï¼Œä»è€Œæ”¹å–„æ•°æ®åˆ†å¸ƒçš„åæ–œæƒ…å†µã€‚\nè®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨ä¸Šé¢çš„ä¾‹å­æ¥è¯´æ˜ä¿®å‰ªå‡å€¼å¦‚ä½•å½±å“æ•°æ®åˆ†å¸ƒçš„åæ–œæƒ…å†µã€‚æˆ‘ä»¬å·²ç»è®¡ç®—äº†ç®€å•ç®—æœ¯å¹³å‡å€¼å’Œä¿®å‰ªå‡å€¼ï¼Œç°åœ¨æˆ‘ä»¬å°†è®¡ç®—æ•°æ®é›†çš„ååº¦ï¼ˆskewnessï¼‰ï¼Œä»¥äº†è§£ä¿®å‰ªå‡å€¼å¦‚ä½•å½±å“æ•°æ®åˆ†å¸ƒçš„åæ–œæ€§ã€‚\nåœ¨Rè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ psych åŒ…ä¸­çš„ describe() å‡½æ•°æ¥è®¡ç®—æ•°æ®é›†çš„ååº¦ã€‚è®©æˆ‘ä»¬æ¥è¿›è¡Œè®¡ç®—ï¼š\n1 2 3 4 5 6 7 8 9 # å®‰è£…å¹¶åŠ è½½ psych åŒ… install.packages(\u0026#34;psych\u0026#34;) library(psych) # åˆ›å»ºæ•°æ®é›† data \u0026lt;- c(2, 3, 4, 5, 6, 7, 8, 9, 10, 100) # è®¡ç®—æ•°æ®é›†çš„ååº¦ describe(data)$skew åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•°æ®é›†çš„ååº¦ä¸º4.07ï¼Œè¿™è¡¨æ˜æ•°æ®é›†æ˜¯å³åï¼ˆå³åçš„ååº¦å€¼å¤§äº0ï¼‰ã€‚å³ååˆ†å¸ƒæ„å‘³ç€æ•°æ®é›†çš„å°¾éƒ¨å‘å³å»¶ä¼¸ï¼Œå³æ•°æ®é›†ä¸­å­˜åœ¨æç«¯å€¼æˆ–è¾ƒå¤§çš„å€¼ã€‚\nç°åœ¨ï¼Œæˆ‘ä»¬å‰”é™¤æç«¯å€¼100ï¼Œå¹¶é‡æ–°è®¡ç®—æ•°æ®é›†çš„ååº¦ï¼š\n1 2 3 # å‰”é™¤æç«¯å€¼å¹¶é‡æ–°è®¡ç®—ååº¦ trimmed_data \u0026lt;- data[data \u0026lt; 100] describe(trimmed_data)$skew å‰”é™¤æç«¯å€¼åï¼Œä¿®å‰ªåçš„æ•°æ®é›†çš„ååº¦ä¸º0.32ã€‚ä¸åŸå§‹æ•°æ®é›†ç›¸æ¯”ï¼Œä¿®å‰ªåçš„æ•°æ®é›†çš„ååº¦æ›´æ¥è¿‘äº0ï¼Œè¡¨æ˜ä¿®å‰ªå‡å€¼æœ‰åŠ©äºå‡å°‘æ•°æ®åˆ†å¸ƒçš„åæ–œæ€§ï¼Œä½¿æ•°æ®æ›´æ¥è¿‘äºå¯¹ç§°åˆ†å¸ƒã€‚\nå› æ­¤ï¼Œé€šè¿‡è®¡ç®—ä¿®å‰ªå‡å€¼å’Œè§‚å¯Ÿæ•°æ®é›†çš„ååº¦ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°ç†è§£æç«¯å€¼å¯¹æ•°æ®åˆ†å¸ƒçš„å½±å“ï¼Œä»¥åŠä¿®å‰ªå‡å€¼å¯¹äºæ”¹å–„æ•°æ®åˆ†å¸ƒçš„åæ–œæ€§çš„ä½œç”¨ã€‚\n3.3 apply() 1 2 3 4 5 apply(x = DATA, MARGIN = MARGIN, FUN = FUNCTION) apply(store.df[2:9], MARGIN = 1, FUN = mean) apply(store.df[2:9], MARGIN = 2, FUN = mean) apply(store.df[2:9], MARGIN = c(1,2), FUN = mean) åœ¨ apply() å‡½æ•°ä¸­ï¼ŒMARGIN å‚æ•°æŒ‡å®šäº†å‡½æ•°åº”è¯¥æ²¿ç€å“ªä¸ªç»´åº¦ï¼ˆè¡Œæˆ–åˆ—ï¼‰åº”ç”¨ã€‚MARGIN å‚æ•°å¯ä»¥å–ä»¥ä¸‹å€¼ï¼š\nMARGIN = 1ï¼šå¯¹æ¯ä¸€è¡Œåº”ç”¨å‡½æ•°ã€‚ MARGIN = 2ï¼šå¯¹æ¯ä¸€åˆ—åº”ç”¨å‡½æ•°ã€‚ MARGIN = c(1, 2)ï¼šåŒæ—¶å¯¹æ¯ä¸€è¡Œå’Œæ¯ä¸€åˆ—åº”ç”¨å‡½æ•°ã€‚ åœ¨ç»™å®šçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† apply() å‡½æ•°æ¥å¯¹æ•°æ®é›† store.df ä¸­çš„å­é›†è¿›è¡Œå‡½æ•°çš„åº”ç”¨ï¼Œå­é›†åŒ…å«åˆ—ç´¢å¼•ä¸º2åˆ°9çš„æ•°æ®ã€‚å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š\napply(store.df[2:9], MARGIN = 1, FUN = mean)ï¼š è¿™å¥ä»£ç æ„å‘³ç€å¯¹æ•°æ®é›† store.df ä¸­çš„æ¯ä¸€è¡Œï¼ˆæ²¿ç€è¡Œçš„æ–¹å‘ï¼‰çš„åˆ—ç´¢å¼•ä¸º2åˆ°9çš„æ•°æ®åº”ç”¨ mean() å‡½æ•°ï¼Œè®¡ç®—æ¯ä¸€è¡Œçš„å¹³å‡å€¼ã€‚\napply(store.df[2:9], MARGIN = 2, FUN = mean)ï¼š è¿™å¥ä»£ç æ„å‘³ç€å¯¹æ•°æ®é›† store.df ä¸­çš„æ¯ä¸€åˆ—ï¼ˆæ²¿ç€åˆ—çš„æ–¹å‘ï¼‰çš„è¡Œç´¢å¼•ä¸º2åˆ°9çš„æ•°æ®åº”ç”¨ mean() å‡½æ•°ï¼Œè®¡ç®—æ¯ä¸€åˆ—çš„å¹³å‡å€¼ã€‚\napply(store.df[2:9], MARGIN = c(1,2), FUN = mean)ï¼š è¿™å¥ä»£ç æ„å‘³ç€åŒæ—¶å¯¹æ•°æ®é›† store.df ä¸­çš„æ¯ä¸€è¡Œå’Œæ¯ä¸€åˆ—çš„è¡Œåˆ—äº¤å‰ç‚¹ï¼ˆå³æ‰€æœ‰çš„å•å…ƒæ ¼ï¼‰çš„æ•°æ®åº”ç”¨ mean() å‡½æ•°ï¼Œè®¡ç®—æ‰€æœ‰è¡Œå’Œåˆ—çš„å¹³å‡å€¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 \u0026gt; apply(store.df[ 2:9], MARGIN = 2, FUN = mean) Year Week p1sales p2sales p1price p2price p1prom p2prom 1.5000000 26.5000000 133.0485577 100.1567308 2.5443750 2.6995192 0.1000000 0.1384615 \u0026gt; apply(store.df[ , 2:9], 2, sum) Year Week p1sales p2sales p1price p2price p1prom p2prom 3120.0 55120.0 276741.0 208326.0 5292.3 5615.0 208.0 288.0 \u0026gt; apply(store.df[ , 2:9], 2, sd) Year Week p1sales p2sales p1price p2price p1prom p2prom 0.5001202 15.0119401 28.3725990 24.4241905 0.2948819 0.3292181 0.3000721 0.3454668 4. Single variable visualisation 4.1 Histograms æŸ±çŠ¶å›¾ hist()\n1 hist(store.df$p1sales) {% asset_image hist1.png %}\n1 2 3 4 5 # æ·»åŠ æ ‡é¢˜ã€xè½´yè½´è¯´æ˜ hist(store.df$p1sales, main = \u0026#34;Product 1 Weekly Sales Frequencies, All Stores\u0026#34;, xlab = \u0026#34;Product 1 Sales (Units)\u0026#34;, ylab = \u0026#34;Count\u0026#34;) {% asset_image hist2.png %}\n1 2 3 4 5 6 hist(store.df$p1sales, main = \u0026#34;Product 1 Weekly Sales Frequencies, All Stores\u0026#34;, xlab = \u0026#34;Product 1 Sales (Units)\u0026#34;, ylab = \u0026#34;Count\u0026#34;, breaks = 30, # more columns col = \u0026#34;lightblue\u0026#34; # colore the bars ) {% asset_image hist3.png %}\n1 2 3 4 5 6 7 8 hist(store.df$p1sales, main = \u0026#34;Product 1 Weekly Sales Frequencies, All Stores\u0026#34;, xlab = \u0026#34;Product 1 Sales (Units)\u0026#34;, ylab = \u0026#34;Count\u0026#34;, breaks = 30, col = \u0026#34;lightblue\u0026#34;, freq = FALSE, # means plot density, not counts xaxt=\u0026#34;n\u0026#34; # means x-axis tick mark is set to \u0026#34;none\u0026#34; ) {% asset_image hist4.png %}\nfreq\nfreq å‚æ•°ç”¨äºæ§åˆ¶ç›´æ–¹å›¾çš„çºµè½´æ˜¾ç¤ºçš„æ˜¯é¢‘æ•°ï¼ˆcountsï¼‰è¿˜æ˜¯å¯†åº¦ï¼ˆdensityï¼‰ã€‚å½“ freq è®¾ç½®ä¸º TRUE æ—¶ï¼Œé»˜è®¤å€¼ï¼Œçºµè½´æ˜¾ç¤ºçš„æ˜¯é¢‘æ•°ï¼Œå³æ¯ä¸ªåˆ†ç®±å†…æ•°æ®çš„æ•°é‡ï¼›å½“ freq è®¾ç½®ä¸º FALSE æ—¶ï¼Œçºµè½´æ˜¾ç¤ºçš„æ˜¯å¯†åº¦ï¼Œå³æ¯ä¸ªåˆ†ç®±å†…æ•°æ®çš„æ¦‚ç‡å¯†åº¦ã€‚\næ¦‚ç‡å¯†åº¦æ˜¯æ¦‚ç‡è®ºä¸­ç”¨äºæè¿°è¿ç»­éšæœºå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒçš„æ¦‚å¿µã€‚å®ƒåœ¨æ•°å­¦ä¸Šæ˜¯ä¸€ä¸ªéè´Ÿå®å€¼å‡½æ•°ï¼Œé€šå¸¸ç”¨äºæè¿°æŸä¸ªéšæœºå˜é‡è½åœ¨æŸä¸ªåŒºé—´å†…çš„æ¦‚ç‡ã€‚\nå¯¹äºä¸€ä¸ªè¿ç»­éšæœºå˜é‡ï¼Œå®ƒå¯èƒ½å–æ— ç©·å¤šä¸ªå¯èƒ½çš„å–å€¼ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½åƒç¦»æ•£éšæœºå˜é‡é‚£æ ·ç›´æ¥è®¡ç®—æŸä¸ªç‰¹å®šå€¼çš„æ¦‚ç‡ã€‚ç›¸åï¼Œæˆ‘ä»¬é€šå¸¸å…³æ³¨æŸä¸ªåŒºé—´å†…çš„æ¦‚ç‡ï¼Œè¿™ä¸ªåŒºé—´è¶Šå°ï¼Œè®¡ç®—çš„æ¦‚ç‡è¶Šå‡†ç¡®ã€‚æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆProbability Density Functionï¼ŒPDFï¼‰å°±æ˜¯ç”¨æ¥æè¿°éšæœºå˜é‡åœ¨æŸä¸ªåŒºé—´å†…çš„æ¦‚ç‡å¯†åº¦çš„å‡½æ•°ã€‚\nåœ¨æ•°å­¦ä¸Šï¼Œå¯¹äºä¸€ä¸ªè¿ç»­éšæœºå˜é‡ Xï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•° f(x) æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ€§è´¨ï¼š\néè´Ÿæ€§ï¼šå¯¹äºæ‰€æœ‰çš„ xï¼Œæœ‰ f(x) â‰¥ 0ã€‚ æ€»é¢ç§¯ä¸º1ï¼šæ•´ä¸ªå®šä¹‰åŸŸå†…çš„æ¦‚ç‡å¯†åº¦å‡½æ•°çš„ç§¯åˆ†ç­‰äº1ï¼Œå³ âˆ«f(x)dx = 1ã€‚ å› æ­¤ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°æè¿°äº†éšæœºå˜é‡è½åœ¨æŸä¸ªåŒºé—´å†…çš„æ¦‚ç‡å¯†åº¦ï¼Œè€Œä¸æ˜¯å…·ä½“çš„æ¦‚ç‡å€¼ã€‚è¦è®¡ç®—æŸä¸ªåŒºé—´å†…çš„æ¦‚ç‡ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¦‚ç‡å¯†åº¦å‡½æ•°åœ¨è¯¥åŒºé—´ä¸Šè¿›è¡Œç§¯åˆ†ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 æ¦‚ç‡å¯†åº¦å’Œé¢‘æ•°ä¹‹é—´çš„å…³ç³»æ¶‰åŠåˆ°è¿ç»­éšæœºå˜é‡å’Œç¦»æ•£éšæœºå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒã€‚ä¸‹é¢åˆ†åˆ«è®¨è®ºå®ƒä»¬çš„å…³ç³»ï¼š 1. è¿ç»­éšæœºå˜é‡çš„æ¦‚ç‡å¯†åº¦å’Œé¢‘æ•°çš„å…³ç³»ï¼š å¯¹äºè¿ç»­éšæœºå˜é‡ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆPDFï¼‰æè¿°äº†éšæœºå˜é‡è½åœ¨æŸä¸ªåŒºé—´å†…çš„æ¦‚ç‡å¯†åº¦ï¼Œè€Œä¸æ˜¯å…·ä½“çš„æ¦‚ç‡å€¼ã€‚æ¦‚ç‡å¯†åº¦å‡½æ•°åœ¨æŸä¸ªåŒºé—´ä¸Šçš„å€¼è¶Šå¤§ï¼Œè¡¨ç¤ºè¯¥åŒºé—´å†…çš„æ•°æ®æ›´åŠ å¯†é›†ï¼Œæ¦‚ç‡å¯†åº¦æ›´é«˜ã€‚ ç›´æ–¹å›¾æ˜¯ç”¨äºè¡¨ç¤ºè¿ç»­éšæœºå˜é‡çš„åˆ†å¸ƒçš„ä¸€ç§å¸¸ç”¨æ–¹æ³•ã€‚åœ¨ç›´æ–¹å›¾ä¸­ï¼Œå°†æ•°æ®åˆ†æˆå¤šä¸ªç­‰å®½çš„åˆ†ç®±ï¼Œå¹¶ç»Ÿè®¡æ¯ä¸ªåˆ†ç®±å†…æ•°æ®çš„é¢‘æ•°ï¼Œç„¶åé€šè¿‡å½’ä¸€åŒ–å¤„ç†ï¼Œå¾—åˆ°æ¯ä¸ªåˆ†ç®±å†…çš„é¢‘ç‡ï¼ˆå³é¢‘æ•°é™¤ä»¥æ ·æœ¬æ€»æ•°ï¼‰ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªè¿‘ä¼¼çš„æ¦‚ç‡å¯†åº¦åˆ†å¸ƒã€‚ 2. ç¦»æ•£éšæœºå˜é‡çš„æ¦‚ç‡å¯†åº¦å’Œé¢‘æ•°çš„å…³ç³»ï¼š å¯¹äºç¦»æ•£éšæœºå˜é‡ï¼Œæ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆPMFï¼‰æè¿°äº†éšæœºå˜é‡å–æŸä¸ªç‰¹å®šå€¼çš„æ¦‚ç‡ã€‚æ¯ä¸ªå¯èƒ½çš„å–å€¼éƒ½æœ‰ä¸€ä¸ªæ¦‚ç‡ã€‚ ç›´æ–¹å›¾åŒæ ·å¯ä»¥ç”¨äºè¡¨ç¤ºç¦»æ•£éšæœºå˜é‡çš„åˆ†å¸ƒã€‚åœ¨ç›´æ–¹å›¾ä¸­ï¼Œæ¯ä¸ªæŸ±å­ä»£è¡¨äº†éšæœºå˜é‡å–æŸä¸ªç‰¹å®šå€¼çš„é¢‘æ•°ï¼Œé¢‘æ•°è¡¨ç¤ºäº†è¯¥å€¼åœ¨æ ·æœ¬ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚ç”±äºç¦»æ•£éšæœºå˜é‡çš„å–å€¼æ˜¯æœ‰é™çš„ï¼Œå› æ­¤ç›´æ–¹å›¾ä¸­çš„æŸ±å­é€šå¸¸å¯¹åº”äºæ¯ä¸ªå¯èƒ½çš„å–å€¼ï¼Œæ¯ä¸ªæŸ±å­çš„é«˜åº¦è¡¨ç¤ºäº†è¯¥å€¼çš„é¢‘ç‡ã€‚ æ€»çš„æ¥è¯´ï¼Œæ¦‚ç‡å¯†åº¦å’Œé¢‘æ•°éƒ½æ˜¯ç”¨äºæè¿°éšæœºå˜é‡çš„åˆ†å¸ƒæƒ…å†µçš„æ¦‚å¿µï¼Œä½†åœ¨è¿ç»­éšæœºå˜é‡å’Œç¦»æ•£éšæœºå˜é‡çš„æƒ…å¢ƒä¸‹æœ‰æ‰€ä¸åŒã€‚åœ¨è¿ç»­æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¦‚ç‡å¯†åº¦å‡½æ•°æè¿°æ¦‚ç‡åˆ†å¸ƒï¼Œè€Œåœ¨ç¦»æ•£æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¦‚ç‡è´¨é‡å‡½æ•°æˆ–é¢‘æ•°æ¥æè¿°åˆ†å¸ƒã€‚ å½’ä¸€åŒ–\nå½’ä¸€åŒ–æ˜¯ä¸€ç§æ•°å­¦æˆ–ç»Ÿè®¡æ–¹æ³•ï¼Œç”¨äºå°†æ•°æ®è½¬æ¢ä¸ºç»Ÿä¸€çš„å°ºåº¦æˆ–èŒƒå›´ï¼Œä»¥ä¾¿è¿›è¡Œæ¯”è¾ƒã€åˆ†ææˆ–å¤„ç†ã€‚åœ¨ä¸åŒçš„é¢†åŸŸä¸­ï¼Œå½’ä¸€åŒ–å¯èƒ½å…·æœ‰ä¸åŒçš„å«ä¹‰å’Œæ–¹æ³•ï¼Œä½†å…¶åŸºæœ¬ç›®æ ‡æ˜¯å°†æ•°æ®è½¬æ¢ä¸ºæ ‡å‡†å½¢å¼ï¼Œæ¶ˆé™¤å°ºåº¦å·®å¼‚æˆ–ä½¿æ•°æ®å…·æœ‰ç‰¹å®šçš„æ€§è´¨ã€‚\nåœ¨ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ä¸­ï¼Œå½’ä¸€åŒ–é€šå¸¸æŒ‡çš„æ˜¯å°†æ•°æ®æŒ‰ç…§ä¸€å®šè§„åˆ™è¿›è¡Œç¼©æ”¾ï¼Œä½¿å…¶è½å…¥ç‰¹å®šçš„èŒƒå›´æˆ–åˆ†å¸ƒã€‚è¿™æœ‰åŠ©äºæé«˜æ¨¡å‹çš„ç¨³å®šæ€§å’Œæ”¶æ•›é€Ÿåº¦ï¼Œä»¥åŠé™ä½ä¸åŒç‰¹å¾ä¹‹é—´çš„å½±å“ã€‚\nå¸¸è§çš„å½’ä¸€åŒ–æ–¹æ³•åŒ…æ‹¬ï¼š\næœ€å°-æœ€å¤§ç¼©æ”¾ï¼ˆMin-Max Scalingï¼‰ï¼šå°†æ•°æ®çº¿æ€§ç¼©æ”¾åˆ°æŒ‡å®šçš„èŒƒå›´ï¼ˆé€šå¸¸æ˜¯ [0, 1]ï¼‰ï¼Œå…¬å¼ä¸ºï¼š\n$$ x_{\\text{norm}} = \\frac{x - \\text{min}(x)}{\\text{max}(x) - \\text{min}(x)} $$ Z-Score æ ‡å‡†åŒ–ï¼ˆZ-Score Normalizationï¼‰ï¼šä¹Ÿç§°ä¸ºæ ‡å‡†åŒ–ï¼Œå°†æ•°æ®è½¬æ¢ä¸ºå‡å€¼ä¸º 0ã€æ ‡å‡†å·®ä¸º 1 çš„æ­£æ€åˆ†å¸ƒï¼Œå…¬å¼ä¸ºï¼š $$ x_{\\text{norm}} = \\frac{x - \\mu}{\\sigma} $$ å°æ•°å®šæ ‡æ ‡å‡†åŒ–ï¼ˆDecimal Scalingï¼‰ï¼šå°†æ•°æ®é™¤ä»¥ä¸€ä¸ªé€‚å½“çš„åŸºæ•°ï¼ˆä¾‹å¦‚ 10 çš„å¹‚ï¼‰ï¼Œä½¿å¾—æ•°æ®çš„ç»å¯¹å€¼æœ€å¤§ä¸è¶…è¿‡ 1ã€‚\nå½’ä¸€åŒ–å¯ä»¥ç¡®ä¿æ•°æ®åœ¨ä¸åŒç‰¹å¾ä¹‹é—´å…·æœ‰å¯æ¯”æ€§ï¼Œå¹¶ä¸”æœ‰åŠ©äºæé«˜æ¨¡å‹çš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚\naxis()\n1 2 # side=1 xè½´; side=2 yè½´; at=sqp() ä¿®æ”¹é—´éš” axis(side = 1, at=seq(60, 300, by=20)) # add \u0026#34;60\u0026#34;, \u0026#34;80\u0026#34;, ... {% asset_image hist5.png %}\nlines()\n1 2 lines(density(store.df$p1sales, bw=10), # \u0026#34;bw=...\u0026#34; adjusts the smoothing type=\u0026#34;l\u0026#34;, col = \u0026#34;darkred\u0026#34;, lwd=2) # lwd=line width è¿™æ˜¯å¯¹ density å‡½æ•°çš„è°ƒç”¨ï¼Œç”¨äºåˆ›å»ºæ¦‚ç‡å¯†åº¦ä¼°è®¡å›¾ï¼ˆKernel Density Estimationï¼ŒKDEï¼‰ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­çš„å„ä¸ªå‚æ•°çš„è§£é‡Šï¼š\ndensity(store.df$p1sales, bw=10)ï¼šè¿™éƒ¨åˆ†è°ƒç”¨äº† density å‡½æ•°ï¼Œå¯¹ store.df$p1sales åˆ—è¿›è¡Œæ¦‚ç‡å¯†åº¦ä¼°è®¡ã€‚bw=10 æŒ‡å®šäº†å¸¦å®½å‚æ•°ï¼Œæ§åˆ¶äº†ä¼°è®¡çš„å¹³æ»‘ç¨‹åº¦ã€‚å¸¦å®½è¶Šå¤§ï¼Œä¼°è®¡çš„æ›²çº¿è¶Šå¹³æ»‘ï¼Œå¸¦å®½è¶Šå°ï¼Œæ›²çº¿è¶Šç²¾ç»†ã€‚è¿™é‡Œçš„ bw=10 è¡¨ç¤ºå¸¦å®½ä¸º 10ã€‚\ntype=\u0026quot;l\u0026quot;ï¼šè¿™ä¸ªå‚æ•°æŒ‡å®šäº†è¦ç»˜åˆ¶çš„å›¾å½¢ç±»å‹ã€‚\u0026quot;l\u0026quot; è¡¨ç¤ºç»˜åˆ¶ä¸€æ¡æŠ˜çº¿å›¾ã€‚æŠ˜çº¿å›¾å°†ä¼°è®¡çš„å¯†åº¦æ›²çº¿ä½œä¸ºæŠ˜çº¿ç»˜åˆ¶ã€‚\ncol=\u0026quot;darkred\u0026quot;ï¼šè¿™ä¸ªå‚æ•°æŒ‡å®šäº†ç»˜åˆ¶çš„æŠ˜çº¿çš„é¢œè‰²ã€‚\u0026quot;darkred\u0026quot; è¡¨ç¤ºæ·±çº¢è‰²ã€‚\nlwd=2ï¼šè¿™ä¸ªå‚æ•°æŒ‡å®šäº†ç»˜åˆ¶çš„æŠ˜çº¿çš„çº¿å®½ã€‚lwd=2 è¡¨ç¤ºçº¿å®½ä¸º 2 åƒç´ ã€‚\n{% asset_image hist6.png %}\ntype\ntype å‚æ•°ç”¨äºæŒ‡å®šç»˜å›¾çš„ç±»å‹ï¼Œé™¤äº† \u0026ldquo;l\u0026rdquo;ï¼ˆæŠ˜çº¿å›¾ï¼‰ä¹‹å¤–ï¼Œå¸¸ç”¨çš„å–å€¼è¿˜æœ‰ï¼š\n\u0026ldquo;p\u0026rdquo;ï¼šç»˜åˆ¶æ•£ç‚¹å›¾ï¼Œå³ä»…ç»˜åˆ¶æ•°æ®ç‚¹è€Œä¸è¿æ¥å®ƒä»¬ã€‚ \u0026ldquo;b\u0026rdquo;ï¼šç»˜åˆ¶æ•°æ®ç‚¹å¹¶å°†å®ƒä»¬è¿æ¥æˆçº¿æ®µï¼Œä»è€Œå½¢æˆæŠ˜çº¿å›¾ã€‚ä¸ \u0026ldquo;l\u0026rdquo; ç±»ä¼¼ï¼Œä½†æ˜¯åœ¨æ¯ä¸ªæ•°æ®ç‚¹å¤„ç»˜åˆ¶ä¸€ä¸ªå¤§ç‚¹ã€‚ \u0026ldquo;o\u0026rdquo;ï¼šä¸ \u0026ldquo;b\u0026rdquo; ç±»ä¼¼ï¼Œä½†åœ¨æ¯ä¸ªæ•°æ®ç‚¹å¤„ç»˜åˆ¶ä¸€ä¸ªå°åœ†åœˆï¼Œè€Œä¸æ˜¯å¤§ç‚¹ã€‚ \u0026ldquo;h\u0026rdquo;ï¼šç»˜åˆ¶ç›´æ–¹å›¾ï¼Œå³å‚ç›´çš„çº¿æ¡ç”¨äºè¡¨ç¤ºé¢‘ç‡ã€‚ \u0026ldquo;s\u0026rdquo;ï¼šç»˜åˆ¶é˜¶æ¢¯å›¾ï¼Œå³é€šè¿‡å‚ç›´å’Œæ°´å¹³çº¿æ®µè¿æ¥æ¯ä¸ªæ•°æ®ç‚¹ï¼Œä»è€Œå½¢æˆé˜¶æ¢¯çŠ¶çš„å›¾å½¢ã€‚ 1 2 lines(density(store.df$p1sales, bw=10), # \u0026#34;bw=...\u0026#34; adjusts the smoothing type=\u0026#34;o\u0026#34;, col = \u0026#34;darkred\u0026#34;, lwd=2) # lwd=line width {% asset_image hist7.png %}\näºŒã€week1 code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 # install.packages (\u0026#34;readxl\u0026#34;) # install.packages (\u0026#34;psych\u0026#34;) # install.packages (\u0026#34;car\u0026#34;) # install.packages (\u0026#34;gpairs\u0026#34;) # install.packages (\u0026#34;grid\u0026#34;) # install.packages (\u0026#34;lattice\u0026#34;) # install.packages (\u0026#34;corrplot\u0026#34;) # install.packages (\u0026#34;gplots\u0026#34;) library(\u0026#34;readxl\u0026#34;) library(\u0026#34;psych\u0026#34;) library(\u0026#34;car\u0026#34;) library(\u0026#34;gpairs\u0026#34;) library(\u0026#34;grid\u0026#34;) library(\u0026#34;lattice\u0026#34;) library(\u0026#34;corrplot\u0026#34;) library(\u0026#34;gplots\u0026#34;) # è·å–å½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• file_dir \u0026lt;- dirname(parent.frame(2)$ofile) print(file_dir) # å°†å·¥ä½œç›®å½•è®¾ç½®ä¸ºå½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• setwd(file_dir) store.df \u0026lt;- read.csv(\u0026#34;Data_Descriptive.csv\u0026#34;, stringsAsFactors=TRUE) str(store.df) table(store.df$p1price) p1.table \u0026lt;- table(store.df$p1price) p1.table str(p1.table) plot(p1.table) table(store.df$p1price, store.df$p1prom) p1.table2 \u0026lt;- table(store.df$p1price, store.df$p1prom) p1.table2[ ,2] / (p1.table2[ ,1] + p1.table2[ ,2]) plot(p1.table2) min(store.df$p1sales) max(store.df$p1sales) mean(store.df$p1prom) median(store.df$p2sales) var(store.df$p1sales) sd(store.df$p1sales) IQR(store.df$p1sales) mad(store.df$p1sales) quantile(store.df$p1sales, probs = c(0.25, 0.5, 0.75)) quantile(store.df$p1sales, probs = c(0.05, 0.95)) # central 90% data quantile(store.df$p1sales, probs = 0:10/10) quantile(store.df$p1sales, probs = seq(from=0, to=1, by=0.1)) mysummary.df \u0026lt;- data.frame(matrix(NA, nrow=2, ncol=2)) # 2 by 2 empty matrix names(mysummary.df) \u0026lt;- c(\u0026#34;Median Sales\u0026#34;, \u0026#34;IQR\u0026#34;) # name columns rownames(mysummary.df) \u0026lt;- c(\u0026#34;Product 1\u0026#34;, \u0026#34;Product 2\u0026#34;) # name rows mysummary.df[\u0026#34;Product 1\u0026#34;, \u0026#34;Median Sales\u0026#34;] \u0026lt;- median(store.df$p1sales) mysummary.df[\u0026#34;Product 2\u0026#34;, \u0026#34;Median Sales\u0026#34;] \u0026lt;- median(store.df$p2sales) mysummary.df[\u0026#34;Product 1\u0026#34;, \u0026#34;IQR\u0026#34;] \u0026lt;- IQR(store.df$p1sales) mysummary.df[\u0026#34;Product 2\u0026#34;, \u0026#34;IQR\u0026#34;] \u0026lt;- IQR(store.df$p2sales) mysummary.df summary(store.df) summary(store.df$Year) summary(store.df, digits = 2) # ä¿ç•™å°æ•°ç‚¹åä¸¤ä½ library(psych) # install if needed describe(store.df) describe(store.df[,c(2, 4:9)]) dim(store.df) head(store.df) tail(store.df) some(store.df) str(store.df) summary(store.df) describe(store.df) apply(store.df[ 2:9], MARGIN = 2, FUN = mean) apply(store.df[ , 2:9], 2, sum) apply(store.df[ , 2:9], 2, sd) hist(store.df$p1sales) # æ·»åŠ æ ‡é¢˜ã€xè½´yè½´è¯´æ˜ hist(store.df$p1sales, main = \u0026#34;Product 1 Weekly Sales Frequencies, All Stores\u0026#34;, xlab = \u0026#34;Product 1 Sales (Units)\u0026#34;, ylab = \u0026#34;Count\u0026#34;) colors() hist(store.df$p1sales, main = \u0026#34;Product 1 Weekly Sales Frequencies, All Stores\u0026#34;, xlab = \u0026#34;Product 1 Sales (Units)\u0026#34;, ylab = \u0026#34;Count\u0026#34;, breaks = 30, # more columns col = \u0026#34;lightblue\u0026#34; # colore the bars ) hist(store.df$p1sales, main = \u0026#34;Product 1 Weekly Sales Frequencies, All Stores\u0026#34;, xlab = \u0026#34;Product 1 Sales (Units)\u0026#34;, ylab = \u0026#34;Count\u0026#34;, breaks = 30, col = \u0026#34;lightblue\u0026#34;, freq = FALSE, # means plot density, not counts xaxt=\u0026#34;n\u0026#34; # means x-axis tick mark is set to \u0026#34;none\u0026#34; ) hist(store.df$p1sales, main = \u0026#34;Product 1 Weekly Sales Frequencies, All Stores\u0026#34;, xlab = \u0026#34;Product 1 Sales (Units)\u0026#34;, ylab = \u0026#34;Count\u0026#34;, breaks = 30, col = \u0026#34;lightblue\u0026#34;, freq = FALSE, # means plot density, not counts xaxt=\u0026#34;n\u0026#34; # means x-axis tick mark is set to \u0026#34;none\u0026#34; ) # side=1 xè½´; side=2 yè½´; at=sqp() ä¿®æ”¹é—´éš” axis(side = 1, at=seq(60, 300, by=20)) # add \u0026#34;60\u0026#34;, \u0026#34;80\u0026#34;, ... lines(density(store.df$p1sales, bw=10), # \u0026#34;bw=...\u0026#34; adjusts the smoothing type=\u0026#34;l\u0026#34;, col = \u0026#34;darkred\u0026#34;, lwd=2) # lwd=line width lines(density(store.df$p1sales, bw=10), # \u0026#34;bw=...\u0026#34; adjusts the smoothing type=\u0026#34;o\u0026#34;, col = \u0026#34;darkred\u0026#34;, lwd=2) # lwd=line width ","date":"2024-03-13T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek1-desciptive-analysis/","title":"R[week1] Desciptive Analysis"},{"content":"æœ¬ç¯‡ä¸»è¦è®²äº†Rè¯­è¨€çš„å‡ ç§ç±»å‹ï¼Œä»¥åŠä¸æ•°æ®ä¹‹é—´çš„å…³ç³»ã€‚\nR: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\nä¸€ã€Basic objects 1. vectors ä¸€ç»´æ•°æ®é›†ï¼Œå¸¸ç”¨äºnumber, boolean, string, etc.\n1 2 3 4 5 6 7 8 9 10 11 12 # define some variables \u0026gt; x \u0026lt;- c(2, 4, 6, 8) \u0026gt; xNum \u0026lt;- c(1, 3.14159, 5, 7) \u0026gt; xLog \u0026lt;- c(TRUE, FALSE, TRUE, TRUE) \u0026gt; xChar \u0026lt;- c(\u0026#34;foo\u0026#34;, \u0026#34;bar\u0026#34;, \u0026#34;boo\u0026#34;, \u0026#34;far\u0026#34;) \u0026gt; xMix \u0026lt;- c(1, TRUE, 3, \u0026#34;Hello, world!\u0026#34;) # print variable \u0026gt; xNum # result [1] 1.00000 3.14159 5.00000 7.00000 1 2 3 4 5 6 7 8 9 # å¯ä»¥ä½¿ç”¨vectorä½œä¸ºæ–°verctoråˆ›å»ºçš„åˆå§‹å€¼ \u0026gt; x2 \u0026lt;- c(xNum, xMix) # print \u0026gt; x2 # result [1] \u0026#34;1\u0026#34; \u0026#34;3.14159\u0026#34; \u0026#34;5\u0026#34; \u0026#34;7\u0026#34; \u0026#34;1\u0026#34; \u0026#34;TRUE\u0026#34; [7] \u0026#34;3\u0026#34; \u0026#34;Hello, world!\u0026#34; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # ä¸‹æ ‡ä¸è®¡ç®—ï¼Œéœ€è¦æ³¨æ„Rè¯­è¨€ä¸­ä¸‹æ ‡ä»1å¼€å§‹ \u0026gt; xNum[2] [1] 3.14159 # è®¡ç®—æ—¶ï¼Œä¸æŒ‡æ˜å…ƒç´ çš„è¯ï¼Œä¼šå°†vecä¸­æ‰€æœ‰å…ƒç´ å„æ‰§è¡Œä¸€éè®¡ç®— \u0026gt; x2 \u0026lt;- c(x, x) \u0026gt; x2 + 1 [1] 3 5 7 9 3 5 7 9 \u0026gt; x2 * pi [1] 6.283185 12.566371 18.849556 25.132741 6.283185 12.566371 18.849556 25.132741 \u0026gt; (x+cos(0.5)) * x2 [1] 5.755165 19.510330 41.265495 71.020660 5.755165 19.510330 41.265495 71.020660 æ³¨âš ï¸ï¼šç”±æ­¤å¯ä»¥çœ‹å‡ºä¸€ä¸ªç‰¹ç‚¹ï¼Œè‹¥ä¸¤ä¸ªvecè®¡ç®—ï¼Œå…ƒç´ æ•°é‡ä¸ç›¸åŒæ—¶ï¼Œä¼šåå¤ä½¿ç”¨å…ƒç´ å°‘çš„vecã€‚ï¼ˆå¾ˆåƒæ˜¯çŸ©é˜µçš„è®¡ç®—ï¼Ÿï¼ˆè°è¯´vecä¸æ˜¯ä¸€ç»´çŸ©é˜µå‘¢ï¼Ÿ æ¯”å¦‚ä¸Šé¢çš„xåªæœ‰4ä¸ªå…ƒç´ ï¼Œè€Œx2æœ‰8ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥xçš„å…ƒç´ ä½¿ç”¨äº†ä¸¤æ¬¡ã€‚\næ³¨âš ï¸ï¼šé™¤äº†coså¤–ï¼Œå¸¸ç”¨çš„æ•°å­¦å‡½æ•°è¿˜æœ‰ï¼š\nå‡½æ•° æè¿° exp(x) è®¡ç®—eçš„xæ¬¡å¹‚ã€‚ log(x) è®¡ç®—xçš„è‡ªç„¶å¯¹æ•°ã€‚ log10(x) è®¡ç®—xçš„ä»¥10ä¸ºåº•çš„å¯¹æ•°ã€‚ log2(x) è®¡ç®—xçš„ä»¥2ä¸ºåº•çš„å¯¹æ•°ã€‚ sqrt(x) è®¡ç®—xçš„å¹³æ–¹æ ¹ã€‚ ^ æˆ– ** è¿›è¡Œå¹‚è¿ç®—ï¼Œä¾‹å¦‚x^2 æˆ– x**2è¡¨ç¤ºxçš„å¹³æ–¹ã€‚ sin(x) è®¡ç®—xçš„æ­£å¼¦å€¼ã€‚ cos(x) è®¡ç®—xçš„ä½™å¼¦å€¼ã€‚ tan(x) è®¡ç®—xçš„æ­£åˆ‡å€¼ã€‚ asin(x) è®¡ç®—xçš„åæ­£å¼¦å€¼ã€‚ acos(x) è®¡ç®—xçš„åä½™å¼¦å€¼ã€‚ atan(x) è®¡ç®—xçš„åæ­£åˆ‡å€¼ã€‚ sinh(x) è®¡ç®—xçš„åŒæ›²æ­£å¼¦å€¼ã€‚ cosh(x) è®¡ç®—xçš„åŒæ›²ä½™å¼¦å€¼ã€‚ tanh(x) è®¡ç®—xçš„åŒæ›²æ­£åˆ‡å€¼ã€‚ ceiling(x) å¯¹xè¿›è¡Œå‘ä¸Šå–æ•´ã€‚ floor(x) å¯¹xè¿›è¡Œå‘ä¸‹å–æ•´ã€‚ abs(x) è®¡ç®—xçš„ç»å¯¹å€¼ã€‚ factorial(x) è®¡ç®—xçš„é˜¶ä¹˜ã€‚ %% è®¡ç®—xé™¤ä»¥yçš„ä½™æ•°ï¼Œä¾‹å¦‚5 %% 2ç­‰äº1ã€‚ 2. More on Vectors and Indexing 2.1 å­é›† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 # å®šä¹‰ä¸€ä¸ªæ•°å­—åºåˆ— \u0026gt; xSeq \u0026lt;- 1:10 # use 1:10 instead of typing 1,2,3,4 ...10. # è·å–å­é›† \u0026gt; xNum [1] 1.00000 3.14159 5.00000 7.00000 # ç¬¬2åˆ°ç¬¬4ä¸ªå…ƒç´  \u0026gt; xNum[2:4] [1] 3.14159 5.00000 7.00000 # ç¬¬2-3ä¸ªå…ƒç´  \u0026gt; myStart \u0026lt;- 2 \u0026gt; xNum[myStart:sqrt(myStart+7)] [1] 3.14159 5.00000 \u0026gt; xSeq [1] 1 2 3 4 5 6 7 8 9 10 # è´Ÿæ•°ä»£è¡¨æ’é™¤æ‰ç¬¬nä¸ªå…ƒç´  \u0026gt; xSeq[-5:-7] [1] 1 2 3 4 8 9 10 # ç”¨vecè®¡ç®—å¾—å‡ºå¦ä¸€ä¸ªvec \u0026gt; xSub \u0026lt;- xNum[2:4] [1] 3.14159 5.00000 7.00000 # å¯ä»¥ç”¨booleanæ¥ç­›é€‰å…ƒç´  \u0026gt; xNum[c(FALSE, TRUE, TRUE, TRUE)] [1] 3.14159 5.00000 7.00000 # å› æ­¤å¯ä»¥ç”¨è¡¨è¾¾å¼æ¥è·å–logic value \u0026gt; xNum[xNum \u0026gt; 3] [1] 3.14159 5.00000 7.00000 3. Missing and interesting values - NA 3.1 é‡è¦çš„NA 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026gt; my.test.scores \u0026lt;- c(91, NA, NA) NA \u0026gt; mean(my.test.scores) NA \u0026gt; max(my.test.scores) NA # ç­›é€‰æ‰NA ## æ–¹æ³•1: na.rm=TRUE \u0026gt; mean(my.test.scores, na.rm=TRUE) 91 \u0026gt; max(my.test.scores, na.rm=TRUE) 91 ## æ–¹æ³•2ï¼šna.omit \u0026gt; mean(na.omit(my.test.scores)) 91 ## æ–¹æ³•3: !is.na(x) \u0026gt; is.na(my.test.scores) [1] FALSE TRUE TRUE \u0026gt; my.test.scores[!is.na(my.test.scores)] 91 4. Lists å¤šç»´çš„æ•°æ®é›†åˆ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 \u0026gt; str(xChar) chr [1:4] \u0026#34;foo\u0026#34; \u0026#34;bar\u0026#34; \u0026#34;boo\u0026#34; \u0026#34;far\u0026#34; # ä»vecåˆå¹¶ä¸ºlist \u0026gt; xList \u0026lt;- list(xNum, xChar) \u0026gt; xList [[1]] [1] 1.00000 3.14159 5.00000 7.00000 [[2]] [1] \u0026#34;foo\u0026#34; \u0026#34;bar\u0026#34; \u0026#34;boo\u0026#34; \u0026#34;far\u0026#34; \u0026gt; str(xList) List of 2 $ : num [1:4] 1 3.14 5 7 $ : chr [1:4] \u0026#34;foo\u0026#34; \u0026#34;bar\u0026#34; \u0026#34;boo\u0026#34; \u0026#34;far\u0026#34; \u0026gt; summary(xList[[1]]) Min. 1st Qu. Median Mean 3rd Qu. Max. 1.000 2.606 4.071 4.035 5.500 7.000 # åˆ†é…åå­— ## æ–¹å¼1 \u0026gt; names(xList) \u0026lt;- c(\u0026#34;itemnum\u0026#34;, \u0026#34;itemchar\u0026#34;) ## æ–¹å¼2 xList \u0026lt;- list(itemnum=xNum, itemchar=xChar) \u0026gt; xList $itemnum [1] 1.00000 3.14159 5.00000 7.00000 $itemchar [1] \u0026#34;foo\u0026#34; \u0026#34;bar\u0026#34; \u0026#34;boo\u0026#34; \u0026#34;far\u0026#34; # åˆ†é…åå­—åï¼Œå¯ä»¥ç”¨åå­—æ¥æ›¿ä»£ç´¢å¼•ï¼Œè·å¾—å…ƒç´  \u0026gt; xList$itemnum # method 2: $name reference [1] 1.00000 3.14159 5.00000 7.00000 \u0026gt; xList[[\u0026#34;itemnum\u0026#34;]] # method 3: quoted name [1] 1.00000 3.14159 5.00000 7.00000 5. Data frame å³ä¸ºçŸ©é˜µ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # åˆ›å»ºä¸€ä¸ªdate frame, ä½¿ç”¨å¤šä¸ªvecä½œä¸ºæ•°æ®æº \u0026gt; x.df \u0026lt;- data.frame(xNum, xLog, xChar) \u0026gt; x.df xNum xLog xChar 1 1.00000 TRUE foo 2 3.14159 FALSE bar 3 5.00000 TRUE boo 4 7.00000 TRUE far # ä½¿ç”¨indexè·å–ç‰¹å®šå…ƒç´  \u0026gt; x.df[2,1] [1] 3.14159 \u0026gt; x.df1 \u0026lt;- data.frame(xNum, xLog, xChar, stringsAsFactors=TRUE) \u0026gt; x.df1 xNum xLog xChar 1 1.00000 TRUE foo 2 3.14159 FALSE bar 3 5.00000 TRUE boo 4 7.00000 TRUE far \u0026gt; str(x.df1) \u0026#39;data.frame\u0026#39;:\t4 obs. of 3 variables: $ xNum : num 1 3.14 5 7 $ xLog : logi TRUE FALSE TRUE TRUE $ xChar: Factor w/ 4 levels \u0026#34;bar\u0026#34;,\u0026#34;boo\u0026#34;,\u0026#34;far\u0026#34;,..: 4 1 2 3 æ³¨âš ï¸ï¼šä½•ä¸ºfactorï¼Ÿ\nä¸ªäººç†è§£ç±»ä¼¼äºâ€œæšä¸¾â€ï¼Œæœ‰é™é›†åˆã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 # ä¸€äº› \u0026#39;sub\u0026#39; data frame æ–¹æ³• \u0026gt; x.df[2, ] # ç¬¬2è¡Œ all of row 2 xNum xLog xChar 2 3.14159 FALSE bar \u0026gt; x.df[ ,3] # ç¬¬3åˆ— all of column 3 [1] \u0026#34;foo\u0026#34; \u0026#34;bar\u0026#34; \u0026#34;boo\u0026#34; \u0026#34;far\u0026#34; \u0026gt; x.df[2:3, ] # ç¬¬2-3è¡Œ xNum xLog xChar 2 3.14159 FALSE bar 3 5.00000 TRUE boo \u0026gt; x.df[ ,1:2] # two columns # ç¬¬1-2åˆ— xNum xLog 1 1.00000 TRUE 2 3.14159 FALSE 3 5.00000 TRUE 4 7.00000 TRUE \u0026gt; x.df[-3, ] # omit the third observation # æ’é™¤æ‰ç¬¬3è¡Œ xNum xLog xChar 1 1.00000 TRUE foo 2 3.14159 FALSE bar 4 7.00000 TRUE far \u0026gt; x.df[, -2] # omit the second column # æ’é™¤æ‰ç¬¬2åˆ— xNum xChar 1 1.00000 foo 2 3.14159 bar 3 5.00000 boo 4 7.00000 far æ³¨âš ï¸ï¼šä»data frameä¸­ç­›é€‰æ•°æ®ï¼Œå¦‚æœæ˜¯å•ä¸ªå…ƒç´ ï¼Œè¿”å›å€¼ç±»å‹ä¸ºå…ƒç´ æ•°é‡ä¸º1çš„vecï¼›å¦‚æœæ˜¯ä¸€è¡Œæˆ–è€…ä¸€åˆ—ï¼Œåˆ™ä¸ºvecï¼›å¦‚æœæ˜¯å¤šè¡Œæˆ–è€…å¤šåˆ—ï¼Œåˆ™ä¸ºä¸€ä¸ªæ–°çš„data frameã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 # æ¸…ç†æ‰ä¸Šè¿°å†…å®¹ \u0026gt; rm(list=ls()) # caution, deletes all objects! # æ–°å»ºä¸€ä¸ªdata frameï¼Œå¡«å……å…ƒç´  \u0026gt; store.num \u0026lt;- factor(c(3, 14, 21, 32, 54)) # store id \u0026gt; store.rev \u0026lt;- c(543, 654, 345, 678, 234) # store revenue, $1000 \u0026gt; store.visits \u0026lt;- c(45, 78, 32, 56, 34) # visits, 1000s \u0026gt; store.manager \u0026lt;- c(\u0026#34;Annie\u0026#34;, \u0026#34;Bert\u0026#34;, \u0026#34;Carla\u0026#34;, \u0026#34;Dave\u0026#34;, \u0026#34;Ella\u0026#34;) \u0026gt; (store.df \u0026lt;- data.frame(store.num, store.rev, store.visits,store.manager)) # åŠ æ‹¬å·ï¼Œç›´æ¥æ‰“å°å†…å®¹ store.num store.rev store.visits store.manager 1 3 543 45 Annie 2 14 654 78 Bert 3 21 345 32 Carla 4 32 678 56 Dave 5 54 234 34 Ella \u0026gt; store.df$store.manager # æŸ¥è¯¢manager [1] \u0026#34;Annie\u0026#34; \u0026#34;Bert\u0026#34; \u0026#34;Carla\u0026#34; \u0026#34;Dave\u0026#34; \u0026#34;Ella\u0026#34; \u0026gt; mean(store.df$store.rev) # æŸ¥è¯¢revenue å¹³å‡å€¼ [1] 490.8 \u0026gt; cor(store.df$store.rev, store.df$store.visits) # caculate correlation [1] 0.8291032 \u0026gt; summary(store.df) # summary store.num store.rev store.visits store.manager 3 :1 Min. :234.0 Min. :32 Length:5 14:1 1st Qu.:345.0 1st Qu.:34 Class :character 21:1 Median :543.0 Median :45 Mode :character 32:1 Mean :490.8 Mean :49 54:1 3rd Qu.:654.0 3rd Qu.:56 Max. :678.0 Max. :78 cor()å‡½æ•° ç”¨äºè®¡ç®—ç›¸å…³ç³»æ•°çš„å‡½æ•°ä¹‹ä¸€ã€‚ç›¸å…³ç³»æ•°æ˜¯è¡¡é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çº¿æ€§å…³ç³»å¼ºåº¦å’Œæ–¹å‘çš„ç»Ÿè®¡é‡ï¼Œé€šå¸¸ç”¨äºæ¢ç´¢å˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚\n1 cor(x, y, method = c(\u0026#34;pearson\u0026#34;, \u0026#34;kendall\u0026#34;, \u0026#34;spearman\u0026#34;), use = c(\u0026#34;everything\u0026#34;, \u0026#34;all.obs\u0026#34;, \u0026#34;complete.obs\u0026#34;, \u0026#34;na.or.complete\u0026#34;)) å‚æ•° x: ä¸€ä¸ªæ•°å€¼å‘é‡ã€çŸ©é˜µæˆ–æ•°æ®æ¡†ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå› å­ã€‚ y: ï¼ˆå¯é€‰ï¼‰ä¸€ä¸ªæ•°å€¼å‘é‡ã€çŸ©é˜µæˆ–æ•°æ®æ¡†ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå› å­ã€‚å¦‚æœæŒ‡å®šäº† yï¼Œåˆ™ä¼šè®¡ç®— x å’Œ y ä¹‹é—´çš„ç›¸å…³ç³»æ•°ï¼›å¦‚æœæœªæŒ‡å®š yï¼Œåˆ™ä¼šè®¡ç®— x ä¸­å„ä¸ªå˜é‡ä¹‹é—´çš„ç›¸å…³ç³»æ•°ã€‚ method: ï¼ˆå¯é€‰ï¼‰æŒ‡å®šè®¡ç®—ç›¸å…³ç³»æ•°çš„æ–¹æ³•ï¼Œå¯é€‰å€¼ä¸º \u0026ldquo;pearson\u0026rdquo;ï¼ˆçš®å°”é€Šç›¸å…³ç³»æ•°ï¼Œé»˜è®¤ï¼‰ã€\u0026ldquo;kendall\u0026rdquo;ï¼ˆè‚¯å¾·å°”ç›¸å…³ç³»æ•°ï¼‰å’Œ \u0026ldquo;spearman\u0026rdquo;ï¼ˆæ–¯çš®å°”æ›¼ç›¸å…³ç³»æ•°ï¼‰ã€‚ use: ï¼ˆå¯é€‰ï¼‰æŒ‡å®šå¦‚ä½•å¤„ç†ç¼ºå¤±å€¼çš„å‚æ•°ï¼Œå¯é€‰å€¼åŒ…æ‹¬ \u0026ldquo;everything\u0026rdquo;ï¼ˆé»˜è®¤ï¼Œå¯¹æ‰€æœ‰æ•°æ®ç‚¹è¿›è¡Œè®¡ç®—ï¼‰ã€\u0026ldquo;all.obs\u0026rdquo;ï¼ˆå¯¹æ‰€æœ‰éç¼ºå¤±æ•°æ®ç‚¹è¿›è¡Œè®¡ç®—ï¼‰ã€\u0026ldquo;complete.obs\u0026rdquo;ï¼ˆå¯¹å®Œå…¨æ²¡æœ‰ç¼ºå¤±å€¼çš„æ•°æ®ç‚¹è¿›è¡Œè®¡ç®—ï¼‰ã€\u0026ldquo;na.or.complete\u0026rdquo;ï¼ˆå¯¹æœ‰ç¼ºå¤±å€¼ä½†è‡³å°‘æœ‰ä¸€å¯¹å®Œæ•´è§‚æµ‹å€¼çš„æ•°æ®ç‚¹è¿›è¡Œè®¡ç®—ï¼‰ã€‚\nè¿”å›å€¼ è¿”å›ä¸€ä¸ªç›¸å…³ç³»æ•°çŸ©é˜µï¼Œå…¶ä¸­åŒ…å«äº†å„ä¸ªå˜é‡ä¹‹é—´çš„ç›¸å…³ç³»æ•°ã€‚\nç¤ºä¾‹ å‡è®¾æœ‰ä¸€ä¸ªæ•°æ®æ¡† df åŒ…å«äº†ä¸¤ä¸ªæ•°å€¼å˜é‡ x å’Œ y\n1 2 3 4 5 6 7 8 # åˆ›å»ºæ•°æ®æ¡† df \u0026lt;- data.frame( x = c(1, 2, 3, 4, 5), y = c(2, 3, 5, 7, 11) ) # è®¡ç®—ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„çš®å°”é€Šç›¸å…³ç³»æ•° cor(df$x, df$y) å°†è¾“å‡ºä¸¤ä¸ªå˜é‡ x å’Œ y ä¹‹é—´çš„çš®å°”é€Šç›¸å…³ç³»æ•°ã€‚\nçš®å°”é€Šç›¸å…³ç³»æ•°ï¼ˆPearson correlation coefficientï¼‰ æ˜¯ä¸€ç§ç”¨æ¥è¡¡é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çº¿æ€§å…³ç³»å¼ºåº¦å’Œæ–¹å‘çš„ç»Ÿè®¡é‡ã€‚å®ƒè¡¡é‡çš„æ˜¯ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„çº¿æ€§ç›¸å…³ç¨‹åº¦ï¼Œå–å€¼èŒƒå›´åœ¨-1åˆ°1ä¹‹é—´ã€‚\nç‰¹ç‚¹ï¼š å½“ r=1 æ—¶ï¼Œè¡¨ç¤ºä¸¤ä¸ªå˜é‡å®Œå…¨æ­£ç›¸å…³ï¼Œå³ä¸€ä¸ªå˜é‡å¢å¤§æ—¶ï¼Œå¦ä¸€ä¸ªå˜é‡ä¹Ÿå¢å¤§ï¼Œå‘ˆçº¿æ€§å…³ç³»ï¼› å½“ r=-1 æ—¶ï¼Œè¡¨ç¤ºä¸¤ä¸ªå˜é‡å®Œå…¨è´Ÿç›¸å…³ï¼Œå³ä¸€ä¸ªå˜é‡å¢å¤§æ—¶ï¼Œå¦ä¸€ä¸ªå˜é‡å‡å°ï¼Œä¹Ÿå‘ˆçº¿æ€§å…³ç³»ï¼› å½“ r=0 æ—¶ï¼Œè¡¨ç¤ºä¸¤ä¸ªå˜é‡ä¹‹é—´æ²¡æœ‰çº¿æ€§å…³ç³»ï¼Œä½†å¹¶ä¸ä»£è¡¨ä¸¤ä¸ªå˜é‡ä¹‹é—´æ²¡æœ‰å…¶ä»–ç±»å‹çš„å…³ç³»ã€‚\nè§£é‡Šï¼š å¦‚æœ r çš„å€¼æ¥è¿‘äº1æˆ–-1ï¼Œè¡¨ç¤ºä¸¤ä¸ªå˜é‡ä¹‹é—´æœ‰å¾ˆå¼ºçš„çº¿æ€§å…³ç³»ï¼Œç›¸å…³æ€§è¾ƒé«˜ï¼›\nå¦‚æœ r çš„å€¼æ¥è¿‘äº0ï¼Œè¡¨ç¤ºä¸¤ä¸ªå˜é‡ä¹‹é—´çš„çº¿æ€§å…³ç³»å¾ˆå¼±ï¼Œç›¸å…³æ€§è¾ƒä½ã€‚\né€‚ç”¨èŒƒå›´ï¼š çš®å°”é€Šç›¸å…³ç³»æ•°è¦æ±‚ä¸¤ä¸ªå˜é‡çš„æ•°æ®æ˜¯è¿ç»­å˜é‡ï¼› å®ƒè¦æ±‚å˜é‡ä¹‹é—´çš„å…³ç³»æ˜¯çº¿æ€§çš„ã€‚\næ³¨æ„äº‹é¡¹ï¼š çš®å°”é€Šç›¸å…³ç³»æ•°åªèƒ½è¡¡é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„çº¿æ€§å…³ç³»ï¼Œå¯¹äºéçº¿æ€§å…³ç³»ä¸æ•æ„Ÿï¼› ç›¸å…³ç³»æ•°ä¸èƒ½è¯´æ˜å› æœå…³ç³»ï¼Œåªèƒ½è¯´æ˜ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚\nåœ¨å®é™…æ•°æ®åˆ†æä¸­ï¼Œçš®å°”é€Šç›¸å…³ç³»æ•°ç»å¸¸ç”¨äºæ¢ç´¢å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¢ç´¢ä¸¤ä¸ªè¿ç»­å˜é‡ä¹‹é—´çš„å…³ç³»æ—¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚\n6. Saving, loading, and importing data 6.1 save and reload 1 2 3 4 5 6 7 8 # ä¿å­˜data frameåˆ°æ–‡ä»¶ \u0026gt; save(store.df, file=\u0026#34;store-df-backup.RData\u0026#34;) # åˆ æ‰å†…å­˜ä¸­çš„data frame \u0026gt; rm(store.df) # caution, only if save() gave no error # é‡æ–°ä»æ–‡ä»¶ä¸­åŠ è½½ \u0026gt; load(\u0026#34;store-df-backup.RData\u0026#34;) 1 2 3 4 5 \u0026gt; save.image() # saves file \u0026#34;.RData\u0026#34; \u0026gt; save.image(\u0026#34;mywork.RData\u0026#34;) \u0026gt; load(\u0026#34;mywork.RData\u0026#34;) æ³¨âš ï¸ï¼š save()å’Œsave.image()éƒ½æ˜¯ä¿å­˜åˆ°æ–‡ä»¶ï¼›save()åªä¿å­˜æŒ‡å®šçš„å…ƒç´ ï¼›save.image()ä¿å­˜æ‰€æœ‰çš„å¯¹è±¡å’Œæ•°æ®ã€‚ load()åŠ è½½.RDataæ—¶ï¼Œä¼šæŠŠæ–‡ä»¶ä¸­ä¿å­˜çš„å†…å­˜å¯¹è±¡ï¼Œè¦†ç›–æ‰å½“å‰å†…å­˜ä¸­çš„\n6.2 import 6.2.1 excel 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 # å®‰è£…å¹¶å¼•ç”¨excelå¤„ç†çš„ä¾èµ–åŒ… \u0026gt; install.packages (\u0026#34;readxl\u0026#34;) \u0026gt; library(readxl) \u0026gt; deospray.data \u0026lt;- read_excel(path = \u0026#34;deospray sales.xls\u0026#34;, sheet = \u0026#34;deospray\u0026#34;) # filename, sheet name \u0026gt; str(deospray.data) tibble [620 Ã— 22] (S3: tbl_df/tbl/data.frame) $ chain : num [1:620] 1 1 1 1 1 1 1 1 1 1 ... $ week : chr [1:620] \u0026#34;W16046\u0026#34; \u0026#34;W16047\u0026#34; \u0026#34;W16048\u0026#34; \u0026#34;W16049\u0026#34; ... $ sales_brand1 : num [1:620] 24 28.1 25.8 24.6 23 ... $ sales_brand2 : num [1:620] 31.3 39.6 102.2 68.4 37.8 ... $ sales_brand3 : num [1:620] 21.1 24 26.8 22.7 20.6 ... $ sales_brand4 : num [1:620] 48.4 52.1 53 43 53.9 ... $ sales_brand5 : num [1:620] 65 64.6 64.7 64.2 52.7 ... $ price_brand1 : num [1:620] 1.09 1.08 1.08 1.08 1.08 ... $ price_brand2 : num [1:620] 0.688 0.642 0.478 0.569 0.576 ... $ price_brand3 : num [1:620] 1.05 1.05 1.05 1.04 1.06 ... $ price_brand4 : num [1:620] 1.12 1.12 1.12 1.12 1.12 ... $ price_brand5 : num [1:620] 1.32 1.32 1.32 1.32 1.32 ... $ display_brand1: num [1:620] 0.02 0.02 0.19 0.18 0.05 0.05 0.08 0.03 0.05 0.04 ... $ display_brand2: num [1:620] 0 0 0 0 0 0 0 0 0 0 ... $ display_brand3: num [1:620] 0 0 0 0 0 0 0 0 0 0 ... $ display_brand4: num [1:620] 0.01 0 0 0 0 0 0 0 0 0 ... $ display_brand5: num [1:620] 0 0 0 0 0 0 0 0 0 0 ... $ feature_brand1: num [1:620] 0 0 0 0 0 0 0 0 0 0 ... $ feature_brand2: num [1:620] 0 0 0 0 0 0 0 0 0 0 ... $ feature_brand3: num [1:620] 0 0 0 0 0 0 0 0 0 0 ... $ feature_brand4: num [1:620] 0 0 0 0 0 0 0 0 0 0 ... $ feature_brand5: num [1:620] 0 0 0 0 0 0 0 0 0 0 ... # æŸ¥çœ‹æ•°æ® \u0026gt; View(deospray.data) 6.2.2 csv 1 2 \u0026gt; store.df \u0026lt;- read.csv(\u0026#34;Data_descriptive.csv\u0026#34;) \u0026gt; store.df$storeNum \u0026lt;- factor(store.df$storeNum) 7. function 1 2 3 4 5 6 7 8 9 10 11 12 # ä¸€ä¸ªç®€å•çš„function se \u0026gt; se \u0026lt;- function(x){sd(x) / sqrt(length(x))} \u0026gt; se(store.df$store.visits) [1] 8.42615 # ä¸ºä»€ä¹ˆPDFé‡Œé¢ç»“æœæ˜¯NA???? \u0026gt; se \u0026lt;- function(x){ \u0026gt; # computes standard error of the mean \u0026gt; tmp.sd \u0026lt;- sd(x) # standard deviation \u0026gt; tmp.N \u0026lt;- length(x) # sample size \u0026gt; tmp.se \u0026lt;- tmp.sd / sqrt(tmp.N) #std error of the mean return(tmp.se) \u0026gt; } æ³¨âš ï¸ï¼šå…¶ä»–çš„ä¸€äº›æ•°å­¦å‡½æ•°\nå‡½æ•° æè¿° mean() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„å‡å€¼ã€‚ median() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„ä¸­ä½æ•°ã€‚ min() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„æœ€å°å€¼ã€‚ max() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„æœ€å¤§å€¼ã€‚ quantile() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„å››åˆ†ä½æ•°ã€‚ cv() æˆ– coefficient_of_variation() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„å˜å¼‚ç³»æ•°ã€‚ sd() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„æ ‡å‡†å·®ã€‚ var() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„æ–¹å·®ã€‚ stderr() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„æ ‡å‡†è¯¯å·®ã€‚ cumsum() è®¡ç®—å‘é‡ä¸­å…ƒç´ çš„ç´¯è®¡å’Œã€‚ cumprod() è®¡ç®—å‘é‡ä¸­å…ƒç´ çš„ç´¯è®¡ç§¯ã€‚ sort() å¯¹å‘é‡æˆ–æ•°æ®æ¡†åˆ—è¿›è¡Œæ’åºã€‚ rank() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—ä¸­å…ƒç´ çš„æ’åã€‚ sum() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„æ€»å’Œã€‚ prod() è®¡ç®—å‘é‡æˆ–æ•°æ®æ¡†åˆ—çš„ä¹˜ç§¯ã€‚ cor()ã€cov() åˆ†åˆ«è®¡ç®—ç›¸å…³ç³»æ•°å’Œåæ–¹å·®çŸ©é˜µã€‚ scale() å¯¹å‘é‡æˆ–æ•°æ®æ¡†åˆ—è¿›è¡Œæ ‡å‡†åŒ–ã€‚ 8. clean up 1 rm(list=ls()) # delete all visible objects in memory. äºŒã€week1 code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 # è·å–å½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• file_dir \u0026lt;- dirname(parent.frame(2)$ofile) print(file_dir) # å°†å·¥ä½œç›®å½•è®¾ç½®ä¸ºå½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• setwd(file_dir) # define some variables x \u0026lt;- c(2, 4, 6, 8) xNum \u0026lt;- c(1, 3.14159, 5, 7) xLog \u0026lt;- c(TRUE, FALSE, TRUE, TRUE) xChar \u0026lt;- c(\u0026#34;foo\u0026#34;, \u0026#34;bar\u0026#34;, \u0026#34;boo\u0026#34;, \u0026#34;far\u0026#34;) xMix \u0026lt;- c(1, TRUE, 3, \u0026#34;Hello, world!\u0026#34;) xNum x2 \u0026lt;- c(xNum, xMix) x2 xNum[2] x2 \u0026lt;- c(x, x) x2+1 x2 * pi (x+cos(0.5)) * x2 xSeq \u0026lt;- 1:10 # use 1:10 instead of typing 1,2,3,4 ...10. xNum xNum[2:4] myStart \u0026lt;- 2 xNum[myStart:sqrt(myStart+7)] xSeq xSeq[-5:-7] xSub \u0026lt;- xNum[2:4] xSub xNum[c(FALSE, TRUE, TRUE, TRUE)] xNum[xNum \u0026gt; 3] my.test.scores \u0026lt;- c(91, NA, NA) mean(my.test.scores) max(my.test.scores) mean(my.test.scores, na.rm=TRUE) max(my.test.scores, na.rm=TRUE) mean(na.omit(my.test.scores)) is.na(my.test.scores) my.test.scores[!is.na(my.test.scores)] str(xChar) xList \u0026lt;- list(xNum, xChar) xList str(xList) summary(xList[[1]]) xList \u0026lt;- list(xNum, xChar) # method 1: create, then name names(xList) \u0026lt;- c(\u0026#34;itemnum\u0026#34;, \u0026#34;itemchar\u0026#34;) xList xList \u0026lt;- list(itemnum=xNum, itemchar=xChar) names(xList) xList xList$itemnum # method 2: $name reference x.df \u0026lt;- data.frame(xNum, xLog, xChar) x.df x.df[2,1] x.df1 \u0026lt;- data.frame(xNum, xLog, xChar, stringsAsFactors=TRUE) x.df1 str(x.df1) x.df[2, ] # all of row 2 x.df[ ,3] # all of column 3 x.df[2:3, ] x.df[ ,1:2] # two columns x.df[-3, ] # omit the third observation x.df[, -2] # omit the second column rm(list=ls()) # caution, deletes all objects! store.num \u0026lt;- factor(c(3, 14, 21, 32, 54)) # store id store.rev \u0026lt;- c(543, 654, 345, 678, 234) # store revenue, $1000 store.visits \u0026lt;- c(45, 78, 32, 56, 34) # visits, 1000s store.manager \u0026lt;- c(\u0026#34;Annie\u0026#34;, \u0026#34;Bert\u0026#34;, \u0026#34;Carla\u0026#34;, \u0026#34;Dave\u0026#34;, \u0026#34;Ella\u0026#34;) (store.df \u0026lt;- data.frame(store.num, store.rev, store.visits,store.manager)) store.df$store.manager mean(store.df$store.rev) cor(store.df$store.rev, store.df$store.visits) summary(store.df) save(store.df, file=\u0026#34;store-df-backup.RData\u0026#34;) rm(store.df) # caution, only if save() gave no error load(\u0026#34;store-df-backup.RData\u0026#34;) save.image() # saves file \u0026#34;.RData\u0026#34; save.image(\u0026#34;mywork_week1.RData\u0026#34;) load(\u0026#34;mywork_week1.RData\u0026#34;) # install.packages (\u0026#34;readxl\u0026#34;) # library(readxl) deospray.data \u0026lt;- read_excel(path = \u0026#34;deospray sales.xls\u0026#34;, sheet = \u0026#34;deospray\u0026#34;) # filename, sheet name str(deospray.data) # View(deospray.data) se \u0026lt;- function(x){sd(x) / sqrt(length(x))} se(store.df$store.visits) ","date":"2024-03-12T00:00:00Z","permalink":"https://MyLoveES.github.io/p/rweek1-getting-start/","title":"R[week1] Getting start"},{"content":"ä¸€ã€ä¸»è¦æ¦‚å¿µ 1. å˜é‡ï¼ˆvariablesï¼‰ 1.1 åˆ›é€ ä¸€ä¸ªå˜é‡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # ä½¿ç”¨ç­‰å· = å·èµ‹å€¼ \u0026gt; var1 = c(0,1,2,3) \u0026gt; print(var1) [1] 0 1 2 3 # ä½¿ç”¨å·¦ç®­å¤´ \u0026lt;- èµ‹å€¼ \u0026gt; var2 \u0026lt;- c(\u0026#34;learn\u0026#34;,\u0026#34;R\u0026#34;) \u0026gt; print(var2) [1] \u0026#34;learn\u0026#34; \u0026#34;R\u0026#34; # ä½¿ç”¨å³ç®­å¤´ -\u0026gt; èµ‹å€¼ \u0026gt; c(TRUE,1) -\u0026gt; var3 \u0026gt; print(var3) [1] 1 1 1.2 æ‰“å°ä¸€ä¸‹å®šä¹‰è¿‡çš„æ‰€æœ‰å˜é‡ 1 2 # æ‰“å°ç°åœ¨å·²ç»å®šä¹‰äº†çš„å˜é‡ # ä½¿ç”¨ ls() å‘½ä»¤, ls å…¶å®å°±æ˜¯ list çš„ç¼©å†™ 1.3 æ‰“å°å˜é‡é‡Œçš„å€¼ 1 2 # å¯ä»¥ç›´æ¥è¾“å…¥å˜é‡ xNum 1 2 # ä¹Ÿå¯ä»¥ç”¨print() print(xNum) 1 2 3 # æˆ–è€…ç”¨str() [å±•ç¤ºæ—¶å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–å“¦ï¼Œæ¯”å¦‚å°æ•°ç‚¹ä½æ•°é»˜è®¤ä¿ç•™ä¸¤ä½] str(xNum) 2. å‘é‡ï¼ˆvectorï¼‰ 2.1 å•¥æ˜¯å‘é‡ ä¸€ç»„ç›¸åŒç±»å‹çš„å…ƒç´ çš„åˆ—è¡¨ï¼Œæ¯”å¦‚éƒ½æ˜¯æ•°å­—ï¼Œæˆ–è€…éƒ½æ˜¯å­—ç¬¦ä¸²\næ˜¯ä¸€ç»´çš„\n2.2 åˆ›é€ ä¸€ä¸ªå‘é‡ 1 2 # ä½¿ç”¨c()å‘½ä»¤ x \u0026lt;- c(2, 4, 6, 8) # create a vector x using combine function c() 2.3 ä¸‹æ ‡ï¼ˆindexï¼‰ æ—¢ç„¶æ˜¯åˆ—è¡¨ï¼Œé‚£ä¹ˆå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ è‡ªç„¶æ˜¯è¦æœ‰åºå·çš„ï¼Œä½†æ˜¯å’Œå¸¸è§çš„å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸åŒï¼Œå…ƒç´ åºå·æ˜¯ä»1å¼€å§‹çš„ï¼\n1 2 3 4 5 6 7 \u0026gt; x \u0026lt;- c(2, 4, 6, 8) # create a vector x using combine function c() \u0026gt; x [1] 2 4 6 8 \u0026gt; x[1] [1] 2 \u0026gt; x[4] [1] 8 2.4 NAï¼ˆæš‚æ—¶ä¸çŸ¥é“å…·ä½“æœ‰å•¥ç”¨ï¼‰ 1 2 # ä½¿ç”¨c()å‘½ä»¤ï¼Œå¯ä»¥ç”¨NAä½œä¸ºä¸€ä¸ªå ä½ç¬¦ï¼Œå…¶å®é™…å€¼ä¸ºç©º x \u0026lt;- c(2, 4, NA, NA) 3. åˆ—è¡¨ï¼ˆlistï¼‰ 3.1 å’Œå‘é‡æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ å‘é‡ï¼šä¸€ç»„ä¸€ç»´çš„ç›¸åŒç±»å‹çš„å…ƒç´ çš„åˆ—è¡¨ï¼Œæ¯”å¦‚éƒ½æ˜¯æ•°å­—ï¼Œæˆ–è€…éƒ½æ˜¯å­—ç¬¦ä¸²\næ•°ç»„ï¼šä¸€ç»„å…ƒç´ ï¼Œå¯ä»¥åŒ…å«ä¸åŒç±»å‹çš„å…ƒç´ ï¼Œæ¯”å¦‚æ•°å­—ã€å­—ç¬¦ä¸²ä»¥åŠçŸ©é˜µçš„æ··åˆã€‚é™¤äº†ä¸€ç»´å¤–ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šç»´çš„æ•°ç»„ [æ„Ÿè§‰ä¸å¦‚å‘é‡ç”¨å¾—å¹¿æ³›] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # åˆ—è¡¨å˜é‡èµ‹å€¼ \u0026gt; my_list \u0026lt;- list(matrix(c(1, 2, 3, 4), nrow = 2), c(5, 6, 7)) # æ‰“å°åˆ—è¡¨ \u0026gt; my_list # æ•°ç»„é‡Œçš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯çŸ©é˜µ [[1]] [,1] [,2] [1,] 1 3 [2,] 2 4 [[2]] # æ•°ç»„é‡Œçš„ç¬¬äºŒä¸ªå…ƒç´ æ˜¯å‘é‡ [1] 5 6 7 # æ‰“å°åˆ—è¡¨str() \u0026gt; str(my_list) List of 2 $ : num [1:2, 1:2] 1 2 3 4 $ : num [1:3] 5 6 7 3.2 æ•°ç»„çš„å‘½å 1 2 3 4 5 6 7 # 1.1 ç›´æ¥åˆ›å»ºä¸€ä¸ªåˆ—è¡¨ xList \u0026lt;- list(xNum, xChar) # method 1: create, then name # 1.2 ç»™åˆ—è¡¨å…ƒç´ å‘½å names(xList) \u0026lt;- c(\u0026#34;itemnum\u0026#34;, \u0026#34;itemchar\u0026#34;) # 2. åˆ›å»ºåˆ—è¡¨çš„åŒæ—¶ï¼Œç›´æ¥ç»™å…ƒç´ å‘½å xList \u0026lt;- list(itemnum=xNum, itemchar=xChar) éšåå¯ä»¥ä½¿ç”¨å…ƒç´ ä¸‹æ ‡ï¼Œæˆ–è€…å‘½ååçš„nameè·å–å¯¹åº”çš„å…ƒç´ \n1 2 3 # æ•°ç»„[ä¸‹æ ‡] \u0026gt; xList[[1]] [1] 1.00000 3.14159 5.00000 7.00000 1 2 3 # æ•°ç»„$åç§° \u0026gt; xList$itemnum # method 2: $name reference [1] 1.00000 3.14159 5.00000 7.00000 1 2 3 # æ•°ç»„[[åç§°]] \u0026gt; xList[[\u0026#34;itemnum\u0026#34;]] # method 3: quoted name [1] 1.00000 3.14159 5.00000 7.00000 4. æ•°æ®æ¡† ï¼ˆData frameï¼‰ ä¹Ÿæœ‰å«æ•°æ®å¸§ã€æ•°æ®è¡¨æ ¼çš„ï¼Œæ„Ÿè§‰æ¡†è¡¨è¾¾çš„æ›´å½¢è±¡ å®é™…ä¸Šå¯ä»¥ç†è§£ä¸ºexcelé‡Œå­˜å‚¨çš„è¡¨æ ¼ç»“æ„ 1 2 3 4 5 6 7 8 9 10 11 12 13 # åˆ›å»ºä¸€ä¸ªdata frame df = data.frame( å§“å = c(\u0026#34;å¼ ä¸‰\u0026#34;, \u0026#34;æå››\u0026#34;, \u0026#34;ç‹äº”\u0026#34;), å·¥å· = c(\u0026#34;001\u0026#34;,\u0026#34;002\u0026#34;,\u0026#34;003\u0026#34;), æœˆè–ª = c(1000, 2000, 3000) ) print(df) # æŸ¥çœ‹ table æ•°æ® å§“å å·¥å· æœˆè–ª 1 å¼ ä¸‰ 001 1000 2 æå›› 002 2000 3 ç‹äº” 003 3000 è€Œåå¯ä»¥é€šè¿‡å¤šç§æ“ä½œï¼Œè¯»å–frameä¸­çš„æ‰€éœ€æ•°æ® 1 2 3 4 5 6 7 8 # å¹³å‡å·¥èµ„(Rè¯­è¨€æ”¯æŒä¸­æ–‡) \u0026gt; mean(df$æœˆè–ª) [1] 2000 # ä¹Ÿå¯ä»¥ç›´æ¥summaryçœ‹æ•´ä½“æ•°æ® \u0026gt; summary(df$æœˆè–ª) Min. 1st Qu. Median Mean 3rd Qu. Max. 1000 1500 2000 2000 2500 3000 5. ä¾èµ–åº“ï¼ˆpackageï¼‰ ä¸€äº›å‡½æ•°æ“ä½œï¼Œæ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦å¼•å…¥å¤–éƒ¨ä¾èµ–åº“çš„ï¼Œæ¯”å¦‚mean/min/maxç­‰åŸºæœ¬è®¡ç®—ã€‚è€Œå¦ä¸€äº›æ¯”è¾ƒå¤æ‚çš„æ“ä½œï¼Œéœ€è¦å¼•å…¥å¤–éƒ¨packageï¼Œä½¿ç”¨packageä¸­å¯¹åº”çš„æ–¹æ³•å®ç°ï¼š\n1 2 3 4 5 6 7 8 # å®‰è£…readxlåº“ install.packages(â€œreadxlâ€) # å¼•ç”¨readxlåº“ library(\u0026#34;readxl\u0026#34;) # å€ŸåŠ©readxlåº“è¯»å–excelæ•°æ®ï¼Œæ–‡ä»¶åä¸ºdeospray sales.xlsï¼Œsheetåä¸ºdeospray deospray.data \u0026lt;- read_excel(path = \u0026#34;deospray sales.xls\u0026#34;, sheet = \u0026#34;deospray\u0026#34;) 6. å‡½æ•°ï¼ˆfunctionï¼‰ å¯ä»¥è‡ªå®šä¹‰ä¸€äº›funcä¾¿äºé‡å¤ä½¿ç”¨\n1 2 3 4 5 6 7 8 se \u0026lt;- function(x){ # computes standard error of the mean tmp.sd \u0026lt;- sd(x) # standard deviation tmp.N \u0026lt;- length(x) # sample size tmp.se \u0026lt;- tmp.sd / sqrt(tmp.N) #std error of the mean return(tmp.se) } se(store.df$store.visits) äºŒã€æ•°æ®è¯»å– From excel/csv excel 1 2 library(readxl) deospray.data \u0026lt;- read_excel(path = \u0026#34;deospray sales.xls\u0026#34;, sheet = \u0026#34;deospray\u0026#34;) csv 1 2 3 4 read.csv(\u0026#34;Data_Descriptive.csv\u0026#34;) store.df \u0026lt;- read.csv(\u0026#34;Data_descriptive.csv\u0026#34;) # å°†storeNumæ„å»ºä¸ºRå› å­ store.df$storeNum \u0026lt;- factor(store.df$storeNum) ä¸‰ã€æ•°æ®å¤„ç†çš„æ±ªæ´‹å¤§æµ·ï½ ","date":"2024-03-11T00:00:00Z","permalink":"https://MyLoveES.github.io/p/r-language-introduce/","title":"R language introduce"},{"content":" ä½¿ç”¨çš„ç‰ˆæœ¬ï¼š\nR: 4.3.2 (2023-10-31) R studio: 2023.12.1+402 (2023.12.1+402)\nä¸€ã€å»ºä¸€ä¸ªR script 1. åˆ‡æ¢å³ä¸‹è§’çš„files tab 2. æ–°å»ºR script äºŒã€ç¼–å†™\u0026amp;è¿è¡Œä»£ç  1. ç¼–å†™ä¸è¿è¡Œ 2. å¯¼å…¥ä¸å†™å‡ºåˆ°æ–‡ä»¶ å¦‚æœä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œåº”è¯¥éœ€è¦æŠŠæ–‡ä»¶æ”¾åˆ°work dir ä¸‰ã€æŠ€å·§ 1. åœ¨è„šæœ¬ä¸­ï¼Œå°†work dirè®¾ç½®ä¸ºæ–‡ä»¶æ‰€åœ¨ç›®å½• 1 2 3 4 5 # è·å–å½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• file_dir \u0026lt;- dirname(parent.frame(2)$ofile) print(file_dir) # å°†å·¥ä½œç›®å½•è®¾ç½®ä¸ºå½“å‰å·²åŠ è½½æ–‡ä»¶çš„ç›®å½• setwd(file_dir) ","date":"2024-03-10T00:00:00Z","permalink":"https://MyLoveES.github.io/p/r-studio-basic-usage/","title":"R studio - Basic usage"},{"content":"æˆ‘æƒ³äº†ä¸¤å¤© æˆ‘ä»¬çš„å…³ç³»ï¼Œå’Œå›°å¢ƒ\nçœŸçš„ä¸€ç›´åœ¨æ€è€ƒï¼Œä¸ºä»€ä¹ˆä»¿ä½›æ€»å¾ˆéš¾ç†è§£ä½ æ‰€æ‰§ç€åšçš„äº‹ã€‚ç°åœ¨å¥½åƒæœ‰ä¸€äº›ç­”æ¡ˆï¼Œä½ çœ‹è¯´çš„å¯¹ä¸å¯¹å§å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ\næˆ‘å‘ç°ï¼Œæˆ‘å§‹ç»ˆå¿½ç•¥äº†ä½ åšå¾ˆå¤šäº‹æƒ…çš„åŠ¨æœºï¼ŒèƒŒåä¸åªæ˜¯çƒ­çˆ±ï¼Œè€Œéƒ½éœ€è¦â€œæ”¶ç›Šâ€ã€‚\næˆ–è®¸æˆ‘ï¼Œä¸€ç›´éƒ½ç”¨å¤ªä¼ ç»Ÿçš„è§’åº¦çœ‹å¾…ä½ ã€‚å¾ˆä¹…å¾ˆä¹…ï¼Œæˆ‘ä¸€ç›´æƒ³æ¢ç´¢å‡ºä½ çš„ç›®æ ‡ï¼Œæˆ–è€…â€œçˆ±å¥½â€æ˜¯ä»€ä¹ˆï¼Œèƒ½è®©ä½ åçš„ä½ï¼Œé•¿ä¹…çš„æ³¨å…¥æ—¶é—´ï¼Œæœ€ç»ˆå®ç°æˆå°±ï¼Œå½“ç„¶ä¹Ÿèƒ½å¥½å¥½åœ°ç‹¬å¤„çš„ã€‚é—®ä½ ï¼Œä½ ä¹Ÿæ€»è¯´ä½ ä¸çŸ¥é“ï¼Œå–œæ–°åŒæ—§ã€‚ä¼°è®¡ä½ ä¹Ÿæ²¡æ—¶é—´æ€è€ƒè¿‡è¿™äº›å§ã€‚æ—…æ¸¸ï¼Œç”µå½±ï¼Œæ¼”å”±ä¼šï¼Œä¹°ä¹°ä¹°ï¼Ÿè¿™äº›éƒ½æ˜¯æœ‰é’±åæ™®ç½—å¤§ä¼—çš„éœ€æ±‚ç½¢äº†ï¼Œä¸ç®—çˆ±å¥½ã€‚è¯»ä¹¦ï¼Œå†™å­—ï¼Œæ‹vlogï¼ŒçŸ­è§†é¢‘ï¼Ÿä»¿ä½›æ¯ä¸€ç§ï¼Œå–œæ¬¢äº†ä¸€æ®µæ—¶é—´ä»¥åï¼Œå°±é»¯ç„¶è½å¹•ã€‚å•¥æƒ…å†µï¼Œäººæ€»ä¸èƒ½æ²¡æœ‰çˆ±å¥½å§ï¼Œæ€»éœ€è¦æœ‰ä¸€ä¸ªè¿½æ±‚çš„ç›®æ ‡ã€‚æŠ›å¼€è¿™äº›è¿™äº›æˆ‘ä»¬å¹³å¸¸è€³æ¿¡ç›®æŸ“çš„ç­”æ¡ˆï¼Œè¿˜ä¼šæœ‰å…¶ä»–çš„å—ï¼Ÿ\næƒ³äº†ä¸¤å¤©ï¼Œåœ¨ä½ çš„é‚£äº›è¯ä¹‹åï¼Œç»“æœæˆ‘å¥½åƒå‘ç°äº†ä¸€ä¸ªæœ‰äº›å¥½ç©çš„ç­”æ¡ˆ\u0026mdash;-â€œèµšé’±â€\næˆ–è®¸èµšé’±è¿™ä»¶äº‹ï¼Œåœ¨å¾ˆå¤šäººçœ¼é‡Œéƒ½ä¸èƒ½ç®—ä½œä¸€ç§â€œçˆ±å¥½â€ï¼Œä½ å¯èƒ½å¿ƒé‡Œä¹Ÿå¾ˆéš¾æ‰¿è®¤å§ï¼Œè¿™åªæ˜¯ä¸€ç§æ´»çš„å¥½çš„æ‰‹æ®µè€Œå·²ï¼ä½†æ˜¯çœ‹ä½ åšè¿‡çš„äº‹èƒŒåï¼Œå´å‘ç°æ€»ä¹Ÿé€ƒä¸è¿‡å®ƒçš„å½±å­ã€‚è¯»ä¹¦å†™å­—å‡èŒåŠ è–ªï¼Œå‰§æœ¬æ€å¼€åº—å•†ä¸šæ”¶ç›Šï¼Œåšè‡ªåª’ä½“å‘vlogå¸¦æ¥æµé‡ï¼Œç”šè‡³é€›ä¸‰é‡Œå±¯ï¼Œéƒ½çœ‹èƒ½ä¸èƒ½å¸¦è´§èµšå·®ä»·ã€‚å¾ˆå¤šçˆ±å¥½çš„æ–°é²œæ„Ÿæ¸æ¸æ¶ˆå¤±åï¼ŒèƒŒåæ€»è¦æœ‰èƒ½å¤Ÿâ€œæŒ£é’±â€çš„åŠ¨åŠ›æ¥æ”¯æ’‘ã€‚ç°åœ¨ä½ æ‰¾åˆ°äº†è¿™ä¸ªèƒ½å¤Ÿå¸¦æ¥ä¸å°‘æ”¶ç›Šçš„å·¥ä½œå®¤ï¼ŒæŒä¹‹ä»¥æ’åœ°ä»˜å‡ºäº†å‡ ä¹æ‰€æœ‰ã€‚æˆ‘å´åªå½“ä½ æ˜¯åœ¨è¾›åŠ³åœ°å·¥ä½œï¼ˆå½“ç„¶è¿™çš„ç¡®æ˜¯ï¼‰ï¼Œå´å¿½è§†äº†å®ƒèƒŒåèƒ½è®©ä½ æŒç»­è¿½æ±‚çš„åŠ¨åŠ›æºã€‚ä½ è¯´è¿™æ˜¯å±æœºä¸‹çš„ä¸å®‰å…¨æ„Ÿï¼Œæ²¡é”™ï¼Œä½†ä¹Ÿä¸æ­¢äºæ­¤ã€‚æˆ‘è§‰å¾—ï¼Œè¿™ä¹Ÿçš„ç¡®æ˜¯æ¥è‡ªäºä½ æœ¬èº«çš„çƒ­çˆ±å§ï¼Œåªæœ‰çƒ­çˆ±ï¼Œæ‰èƒ½åƒè¿™æ ·åšçš„è¶³å¤Ÿä¹…è¶³å¤Ÿå¥½ã€‚\nå½“æˆ‘æƒ³åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæ„Ÿè§‰å¾ˆå¤šå¾ˆå¤šäº‹éƒ½èƒ½æƒ³é€šäº†ã€‚ä¸ºä»€ä¹ˆä½ èƒ½ååœ¨é‚£é‡Œä¸€æ•´å¤©ï¼Œå¯¹ç€ç”µè„‘æ¯ç‡¥â€œå·¥ä½œâ€å¿˜è®°åƒå–ï¼Œç”šè‡³å¿½ç•¥æˆ‘åœ¨ä½ è¯´çš„è¯ï¼›ä¸ºä»€ä¹ˆä½ èƒ½åœ¨å¾ˆå¤šäº‹ä¸Šä¸æ–­æ¢ç´¢ï¼Œå´åˆä¸æ–­åœ°å–œæ–°åŒæ—§ï¼›ä¸ºä»€ä¹ˆå»äº†è‹±å›½ï¼Œå´åˆæŠŠæ–°ç¯å¢ƒæ–°æœ‹å‹æ”¾åœ¨ä¸€æ—ï¼Œç„¦è™‘ä¸å·²ï¼›ä¸ºä»€ä¹ˆæˆ‘æ€»ä¹Ÿæƒ³ä¸é€šä½ åœ¨è¿½æ±‚ä»€ä¹ˆï¼Œå°±ç®—ç…§é¡¾äº†ä½ çš„æ–¹æ–¹é¢é¢ï¼Œå´æ€»æœ‰è¢«åæ§½å¸®ä¸ä¸Šå¿™ï¼Œè®©ä½ å¤±æœ›ã€‚åŸæ¥ç­”æ¡ˆä¸€ç›´å°±åœ¨çœ¼å‰ï¼Œæˆ‘å´å§‹ç»ˆæ²¡æœ‰æŠŠå®ƒå½“ä½œç­”æ¡ˆï¼Œåšäº†æ— æ•°éé€‰æ‹©é¢˜ï¼Œåˆä¸€ééåœ°å‡ºé”™ã€‚\nèµšé’±å¯ä»¥ä½œä¸ºä¸€ç§çˆ±å¥½æˆ–è€…ç›®æ ‡å—ï¼Œå½“ç„¶ï¼è‡³å°‘å¯¹äºå½“ä¸‹çš„æˆ‘ä»¬æ¥è¯´ï¼Œè¿™çš„ç¡®æ˜¯ä¸€ç§éå¸¸æ£’çš„é€‰æ‹©ã€‚èƒ½å¤Ÿå‘ç°æŒç»­çš„é€”å¾„å¹¶ä¸”åšå¥½å®ƒï¼Œå¹¸è¿è€ŒåˆåŠªåŠ›ï¼ŒåŸæ¥ä½ åšåˆ°äº†ï¼Œç°åœ¨å’Œå°†æ¥ï¼Œå½“ç„¶ä¹Ÿèƒ½å¤Ÿåšåˆ°ã€‚\nå…¶å®æˆ‘æƒ³ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¹‹é—´æœ€å¤§çš„ä¸åŒä¹‹å¤„å§ã€‚ä½ ä¼šä»¥èµšé’±ä¸ºæ˜ç¡®åœ°ç›®æ ‡è€ŒæŒç»­ä»˜å‡ºï¼Œè€Œæˆ‘åªæƒ³æŠŠèµšé’±ä½œä¸ºæ—¥å¸¸è¡Œä¸ºçš„é™„åŠ å±æ€§ã€‚åšçš„äº‹èƒ½èµšåˆ™èµšï¼Œä¸èƒ½ä¹Ÿç½¢ï¼Œæ”¶è·ç»å†ä¹Ÿè¡Œï¼æˆ‘åœ¨â€œè¿½æ±‚â€è¿™ç§æ€ç»´ä¸Šçš„å·®å¼‚ï¼Œè®©æˆ‘ä¸æ–­åŠªåŠ›ï¼Œå´åˆä¸æ–­çš„å‡ºé”™ï¼Œè¯¯è§£ä½ ï¼Œä¸äº†è§£ä½ ã€‚\né‚£åœ¨è¿™æ®µå…³ç³»ä¸­ï¼Œæˆ‘çš„å›°å¢ƒæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘æƒ³æˆ‘æ˜¯æ¸´æœ›å…³ç³»çš„ç¨³å®šã€‚æˆ‘æ„¿æ„ä»˜å‡ºï¼Œæ„¿æ„é™ªä¼´ï¼Œæ„¿æ„æ”¹å˜ã€‚ä½ åœ¨æˆ‘çœ¼é‡Œè¶³å¤Ÿå¥½ï¼Œä»¥è‡³äºåƒä½ è¯´çš„â€œæ€æ ·éƒ½è¡Œâ€ã€‚è€Œä½ æ—¶å¸¸å¸¦ç»™æˆ‘çš„ä¸ç¨³å®šæ„Ÿï¼Œæ€»è®©æˆ‘ç„¦è™‘ï¼Œç°å¿ƒï¼Œå¦å®šã€‚ç°åœ¨æˆ‘æ›´æ˜ç™½äº†äº›ï¼Œä¸ºä»€ä¹ˆæŒä¹…ä»¥æ¥çš„ä»˜å‡ºï¼Œæ€»æ˜¯æ— æ³•è®©ä½ æ»¡æ„ï¼Œåœ¨ä¸€æ¬¡æ¬¡ä»˜å‡ºåçš„å´åˆæ”¶è·å¤±æœ›ï¼Œæœ€åä¸€æ¬¡æ¬¡å¦å®šè‡ªå·±ï¼Œå®³æ€•å»ä¸»åŠ¨æ”¹å˜ã€‚ä½†ç°åœ¨æˆ‘æƒ³ï¼Œæˆ‘çš„ç¡®åœ¨åŠªåŠ›å¹¶ä¸”çš„ç¡®æ›´åŠ äº†è§£ä½ ï¼Œè¿™çš„ç¡®æ¯”æˆ‘æƒ³è±¡çš„éš¾äº†ä¸å°‘ğŸ˜†ï¼Œä½†å´ä»¿ä½›æœ‰äº†ç­”æ¡ˆã€‚\nå°±å¦‚ä½ èµ°ä¹‹å‰æˆ‘è¯´è¿‡çš„ï¼Œè‹±å›½æ¶ˆè´¹å¾ˆé«˜ï¼Œä½†æ˜¯ä½ çš„ç¡®ä¹Ÿä¸è¦å¤ªæ‹…å¿ƒï¼Œä¸ç®¡æ€ä¹ˆè¯´è¿˜æœ‰æˆ‘æ”¯æŒä½ å‘¢ï¼ˆå·²ç»æµ®ç°å‡ºäº†ä½ çš„å˜²è®½è„¸â€œå°±ä½ è¿™ç‚¹å·¥èµ„â€ï¼‰ä½ ä¹Ÿè¦å¼ºã€‚ä½ ç°åœ¨åœ¨è‹±å›½ï¼Œç›¸ä¿¡ä½ ä¹Ÿæ­£åœ¨æ¢ç´¢å¾ˆå¤šæ–¹æ³•äº†ï¼Œåˆè¦åšè·¨å¢ƒï¼Œåˆè¦åšå°çº¢ä¹¦ã€‚ç›¸è·ä¸‡é‡Œï¼Œæˆ‘æŒºéš¾å¸®ä¸Šä»€ä¹ˆå¿™çš„ï¼Œä½†æˆ‘è¿˜æ˜¯æƒ³è¯´è¯´çœ‹æˆ‘æƒ³åˆ°çš„å§ã€‚\nå…¬å¸å®ä¹ \næˆ‘æƒ³å¦‚æœå¯èƒ½ï¼Œæœ‰ä¸€ä¸ªè¡Œä¸šç›¸å…³ï¼Œåˆä¸å¤ªå¿™çš„å®ä¹ å·¥ä½œã€‚è¿™ä¸ªé€‰æ‹©æŒ£é’±ä¹‹ä½™ï¼Œèƒ½å¤Ÿæœ‰æœºä¼šè®¤è¯†ä¸€äº›å¯¹å­¦ä¹ æ›´æ˜¯å¯¹æœªæ¥ç”Ÿæ´»æœ‰ç”¨çš„æœ‹å‹ä»¬ã€‚çŸ¥é“ä½ ç°åœ¨å¾ˆå¿™ï¼Œä½†æ˜¯æ‰¾ç‚¹æ—¶é—´æŠŠç®€å†è¡¥å®Œï¼Ÿè¿™ä¸¤å¤©æ”¹ç®€å†çš„æ—¶å€™ï¼Œç¨ç¨æ”’äº†ä¸€ç‚¹ç»éªŒå§ã€‚å¦‚æœå†™å®Œvogueçš„ï¼Œå¯ä»¥å‘ç»™æˆ‘å†è¡¥å……è¿›å»ã€‚è¶…çº§ç®€å†æœ‰æ—¶å€™ç”¨èµ·æ¥ä¹ŸæŒºæŠ½è±¡çš„ï¼Œè¿˜æ˜¯å¾—å¾®è°ƒã€‚\nè·¨å¢ƒ\nè¿™çš„ç¡®æ˜¯å¾ˆæ–¹ä¾¿çš„æ–¹å¼ã€‚ä¹‹å‰æœ‰ä¸€ä¸ªå¤§å­¦åŒå­¦å­¦ä¿„è¯­çš„ï¼Œåˆ°ä¿„ç½—æ–¯ç•™å­¦ï¼Œåšå¾—æ¯”è¾ƒå¥½ã€‚ä½†æ˜¯å¥¹å½“æ—¶å äº†å‡ ä¸ªä¼˜åŠ¿ï¼š1ï¼‰åšä¿„ç½—æ–¯æ–¹å‘çš„äººå°‘ 2ï¼‰ç•™å­¦æ—¶é—´é•¿ï¼Œæ”’ä¸‹çš„ç”¨æˆ·ç›˜å­è¶Šæ¥è¶Šå¤§ 3ï¼‰åœ¨æœ€åä¸€å¹´ï¼Œå¤§é‡ç”¨æˆ·+ç†Ÿæ‚‰çš„ç‰©æµï¼Œæœ€ç»ˆæ‰åˆ°äº†æˆæœ¬ä½+é‡å¤§ï¼Œæ”¶ç›Šé«˜äº†èµ·æ¥ã€‚è‹±å›½è¿™ä¸ªæ–¹å‘ï¼Œå¦‚æœé‡‡è´­æˆæœ¬ä¸€æ ·çš„è¯ï¼Œè¦æ‹¼ç‰©æµæˆæœ¬å’Œå®ç‰©ä»·æ ¼ã€‚è¿™æ–¹é¢å¦‚æœåšçš„äººå¤šï¼Œå¯èƒ½å¾ˆéš¾æ‹¿ä¸‹ä¼˜åŠ¿ã€‚è€Œä½ ç•™å­¦æ—¶é—´çŸ­ï¼Œå¦‚æœçŸ­æœŸé‡ä¸Šä¸å»ï¼Œæ”¶ç›Šå¾ˆéš¾é«˜èµ·æ¥ï¼Œå°±è¦å›å›½äº†ã€‚\næ‰€ä»¥é™¤äº†æ‹¼æ—¥å¸¸åŒ–å¦†å“ä¸Šçš„ä»·æ ¼ï¼Œæœ‰æ²¡æœ‰å¯èƒ½åšä¸€äº›é«˜ç«¯å“ç‰Œä¸Šçš„å‘¢ï¼Ÿå°±åƒä½ å½“åˆé»‘äº”æ·˜çš„æ¼‚äº®æ­£å“å¤§è¡£ï¼Œæˆ–è€…å…¶ä»–çš„æ—¶å°šå“ç‰Œï¼Œæ­£å¥½å¯ä»¥å‡­å€ŸçœŸäººåœ¨è‹±å›½çš„ä¼˜åŠ¿ï¼Œå……åˆ†æœåŠ¡å¥½æ¶ˆè´¹è€…ï¼Œæ‰“æ¶ˆä»–ä»¬å¯¹äºå‡è´§ã€ç‘•ç–µã€ç‰©æµä¸å¯é è¿™äº›æ–¹é¢çš„é¡¾è™‘ï¼ˆæƒ³æƒ³ä½ å½“æ—¶æ‹…å¿ƒå“ªäº›å› ç´ ï¼‰ã€‚\nå¦å¤–ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å°è¯•åšä¸€äº›ç”µå­å•†å“ï¼Œæ¯”å¦‚åœ¨å›½å¤–å¯ä»¥è½»æ¾æ³¨å†Œçš„chatgptè´¦å·ã€‚å›½å†…ç”±äºå¢™ã€æ²¡æœ‰å›½å¤–æ‰‹æœºå·ï¼Œä¸€èˆ¬äººå¾ˆéš¾ç›´æ¥è‡ªå·±æ³¨å†Œä¸Šè´¦å·ã€‚ç°åœ¨æ·˜å®å¤§æ¦‚è¦å–10-30å—é’±ä¸€ä¸ªå·ï¼Œçœ‹é”€é‡æœ‰çš„èƒ½å–å‡ ç™¾ä¸ªã€‚è€Œæ³¨å†Œå®é™…ä¸Šæ˜¯å…è´¹çš„ã€‚æˆ–è€…æ¢ç´¢ä¸€äº›å…¶ä»–çš„APPã€‚\nå†å¦å¤–ï¼Œä½ çœ‹åœ¨é‚£è¾¹çš„å›½äººä»¬å¯¹å›½å†…çš„å“ªäº›éœ€æ±‚æ¯”è¾ƒé«˜å‘¢ï¼Ÿæˆ–è®¸å¯ä»¥å¯„è¿‡å»å–å–è¯•è¯•ã€‚\nå·¥ä½œå®¤\nè¿™ä¸ªæƒ³å¿…ä½ ä¹Ÿæƒ³åˆ°è¿‡äº†å§ã€‚å¦‚æœå›½å†…å“ç‰Œèƒ½åšä¸€äº›å›½å¤–æ˜æ˜Ÿï¼Œæˆ–è€…å›½å†…è‰ºäººæ¥å®£ä¼ ä¸€ä¸‹å›½å¤–å“ç‰Œï¼Œæˆ–è®¸æ˜¯ä¸€ä¸ªä¸é”™çš„æœºä¼šã€‚å›½å†…è‰ºäººå®£ä¼ æ”¹å–„æ¶ˆè´¹è€…è®¤çŸ¥+è·¨å¢ƒå¸¦è´§ä¸€ä½“ï¼Œå¦‚æœèƒ½æ‰“é€šçš„è¯æƒ³å¿…ä¸æ­¢çœ¼ä¸‹çš„æ”¶ç›Šè¿™ä¹ˆå°ã€‚æˆ–è®¸è¶æœºéƒ½èƒ½è¯•è¯•ä¸€ç›´æƒ³è¿‡çš„ç›´æ’­å¸¦è´§ã€‚\nå°çº¢ä¹¦ æˆ‘çœ‹ç°åœ¨æŒºå¥½çš„ï¼Œä¸»è¦æ˜¯å½¢è±¡ç¾ï¼Œæˆ‘å°±ä¸å¤šè¯´äº†ã€‚ä½†æ˜¯ä½ ä¹Ÿèƒ½çœ‹åˆ°ï¼Œå°çº¢ä¹¦ä¸Šè‹±å›½åšåŒæ ·åšå‡ºè¡Œæ”»ç•¥å†…å®¹çš„å®åœ¨æ˜¯ä¸å°‘ï¼Œå¦‚æœæœ‰å¯èƒ½ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å‘ç°ä¸€äº›å…¶ä»–åœ°æ–¹çš„ç‰¹è‰²å•†å“æ¯”å¦‚ç¾é£Ÿå•¦ä¹‹ç±»çš„ï¼Œåšåˆ°åˆ©å…¹å’Œå‘¨è¾¹åŸé•‡å•†å“çš„ä»£è´­ã€‚\næœ€åå§ï¼Œæˆ‘çœŸçš„è¿˜æ˜¯éå¸¸ä¸æƒ³æ”¾å¼ƒæˆ‘ä»¬çš„å…³ç³»ï¼Œæ€»åœ¨æƒ³æ€ä¹ˆæ‰èƒ½å¸®åˆ°ä½ ï¼Œèƒ½åšçš„æ›´å¥½ã€‚ä½ å¤ªè¦å¼ºäº†ï¼ŒçœŸçš„å¤ªè¾›è‹¦äº†ã€‚ä»¥å¾€æˆ‘åªæƒ³ç€ç…§é¡¾å¥½ä½ çš„ç”Ÿæ´»ï¼Œåƒå¥½å–å¥½ç¡å¥½ã€‚æˆ‘æƒ³æˆ‘çš„ç¡®åœ¨ä¸æ–­â€œæˆé•¿â€åœ°çœ‹å¾…è¿™æ®µå…³ç³»ï¼Œä¸å†ç›²ç›®åœ°ç­‰å¾…ï¼Œè€Œè¦å†å¤šåœ¨ä½ çš„è§’åº¦ä¸ºä½ æƒ³æƒ³ã€‚æŠ±æŠ±ä½ ã€‚\nå°±åƒä½ è¯´çš„ï¼Œè™½ç„¶ä½ ä¸æ€ä¹ˆæ­ç†æˆ‘äº†ï¼Œä½†è‡³å°‘è¿˜æœ‰è”ç³»ï¼Œæ€»è®©æˆ‘ä»¥ä¸ºæœ‰å¸Œæœ›ã€‚ä½†æˆ‘è¿˜æ˜¯ä¸æ­¢æƒ³è¦æœ‰å¸Œæœ›ï¼Œæƒ³å’Œä½ è§é¢ï¼Œå’Œä½ èŠå¤©ã€‚æƒ³å’ŒçŒ«çŒ«ä¸€èµ·ï¼Œç­‰å¤§å®è´å›å®¶ã€‚å¸Œæœ›ä½ èƒ½åˆ«å¤ªè¾›è‹¦ï¼ŒçŒ«çŒ«ä¼šå¿ƒç–¼çš„ã€‚\n","date":"2023-10-16T10:38:00Z","permalink":"https://MyLoveES.github.io/p/letter-for-my-dear/","title":"Letter for my dear"},{"content":"ä¸ç©è´´å§ä¹‹åï¼Œå¾ˆä¹…æ²¡è·Ÿè‡ªå·±è¯´è¿‡è¯äº†ã€‚Hiï¼Œæé”ï¼Œå¥½ä¹…ä¸è§ï¼Œä½ è¿˜å¥½å—ï¼Ÿ\nå‘¨æœ«ä¸¤å¤©ï¼Œæ‰“å¼€äº†æ— æ•°éå¾®ä¿¡èŠå¤©æ¡†ï¼Œæƒ³çœ‹æœ‰æ²¡æœ‰æœŸå¾…çš„æ¶ˆæ¯ï¼Œå“¦å½“ç„¶ï¼Œæ²¡æœ‰ã€‚â€œè¿˜åœ¨æœŸå¾…ä»€ä¹ˆå‘¢ï¼Ÿâ€ç»§ç»­åé—®è‡ªå·±ã€‚æˆ–è®¸è¿™æ®µå…³ç³»ï¼Œå½“æˆ‘ç§Ÿä¸‹è¿™ä¸ªä¸¤å±…å®¤ï¼Œå½“é‚£é—´æ¬¡å§å˜æˆäº†ä¸€æ¡é€€è·¯ï¼Œæœ«ç« å°±å·²å¼€å§‹å¾å¾å†™ä¸‹ã€‚\nç°åœ¨ååœ¨ç”µè„‘å‰ï¼Œä¾ç„¶æ€å¿µå’Œç‰µæŒ‚ç€å¥¹ï¼Œæƒ³å¿µå¥¹çš„æ´»æ³¼ç¾ä¸½ï¼Œå¥¹çš„æ•é”æ™ºæ…§ã€‚æƒ³å¿µèƒ½å’Œå¥¹æ‹¥æŠ±åœ¨ä¸€èµ·çš„ç”œèœœï¼Œæ¬¢ç¬‘æ—¶çš„å¼€å¿ƒï¼Œå»æµ·è¾¹å»æ²™æ¼ æ—¶çš„è‡ªç”±ã€‚å‡ºå›½å‰ï¼Œæˆ‘ä¸€éä¸€éåœ°åˆ·å°çº¢ä¹¦ï¼Œçœ‹å¾®åšçœ‹çŸ¥ä¹ï¼Œåªæ€•æœ‰å‡†å¤‡ä¸å‘¨çš„åœ°æ–¹ï¼ŒæœŸæœ›èƒ½åšå¥½ä¸‡å…¨çš„å‡†å¤‡ï¼Œä¸æƒ³å¥¹å—ä¸€ä¸ç‚¹å§”å±ˆã€‚é‚£å¤©åœ¨æœºåœºé€åˆ«ï¼Œè„‘æµ·é‡Œå°±åœ¨æƒ³ï¼Œâ€œæ¯ä¸€æ¬¡è§é¢éƒ½å½“åšæœ€åä¸€æ¬¡ï¼Œè¿™ä¸ä¼šä¸€è¯­æˆè°¶äº†å§â€ã€‚å¤šå¹´æ„Ÿæƒ…é‡Œï¼Œæˆ‘ä¸€ç›´æ‹¼å‘½å˜åŒ–ç€ï¼Œç”šè‡³è‡ªå·±éƒ½æ„Ÿåˆ°é™Œç”Ÿã€‚æˆ‘å­¦ä¼šå»è·Ÿäººç†è®ºï¼Œå»ç´¢è¦ï¼Œå»å‘å£°ï¼Œåªæƒ³èƒ½å¤Ÿè®©å¥¹æ»¡è¶³ï¼Œå¾—åˆ°å¿«ä¹ã€‚ä½†ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä¹Ÿå§‹ç»ˆèº²åœ¨å¥¹çš„åº‡æŠ¤ä¹‹ä¸‹ï¼Œçœ‹å¥¹åœ¨å‰é¢å†²é”‹é™·é˜µï¼Œåœ¨å¿ƒé‡Œé»˜é»˜çˆ±ç€å¥¹ï¼Œäº«å—ç€å¥¹çš„ç…§é¡¾ã€‚\nå¥¹è¯´çš„æ€»æ˜¯å¯¹çš„ã€‚å¥¹å¾ˆåšæŒè‡ªå·±çš„æƒ³æ³•ï¼Œå¯¹æœªæ¥ï¼Œå¯¹ä¼´ä¾£ï¼Œæœ‰æ˜ç¡®çš„æœŸæœ›ã€‚ç¬¦åˆï¼Œåˆ™äº¤å¾€ï¼›ä¸åˆï¼Œå°±åˆ†å¼€ã€‚è¿™åº”è¯¥æ‰æ˜¯æ­£ç¡®çš„è§£æ³•å§ï¼æˆ‘æ€»ç”˜äºå¹³åº¸ï¼Œå…³ç³»å°šå¥½æ—¶ï¼Œä¸æ€æ”¹å˜ï¼Œä¸€æ¬¡åˆä¸€æ¬¡æŒ½å›ï¼Œå´ä¹Ÿç»ˆäºä¸¢æ‰äº†ä¸€æ¬¡åˆä¸€æ¬¡çš„æœºä¼šã€‚å¥¹å‡ºå›½äº†ï¼Œå­¦è´¹é«˜ï¼Œå…¬å¯“è´µï¼Œè¡£é£Ÿä½è¡Œå¤„å¤„èŠ±é’±ï¼Œæ¶ˆè´¹ä¸Šçš„å‹åŠ›æ‰‘é¢è€Œæ¥ã€‚æˆ‘æ„è¯†åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†æˆ‘åšäº†ä»€ä¹ˆå‘¢ï¼ŸåŠå¥¹æ”¾è½»æ¾ä¸€äº›ï¼Œå…ˆå‡ºå»ç©ç©ã€‚è¿™å½“ç„¶æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œæ‰ªå¿ƒè‡ªé—®ï¼Œæˆ‘ä¼šæœ‰å¿ƒæƒ…å»ç©å—ï¼Ÿææ€•æ›´ç³Ÿã€‚\nä½†å‡ å¹´æ¥ï¼Œæˆ‘æœ€é—æ†¾çš„ï¼Œè¿˜æ˜¯æ²¡èƒ½æ‰¾åˆ°è®©å¥¹èƒ½å¤Ÿå……å®ç‹¬å¤„çš„æ–¹æ³•ã€‚å³ä½¿å»ºè®®è¿‡æ— æ•°ç§æ–¹æ¡ˆï¼Œå´éƒ½å’Œå¥¹çš„çˆ±å¥½å¤§ç›¸å¾„åº­ã€‚å¥¹åˆ°åº•å–œæ¬¢ä»€ä¹ˆå‘¢ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ä¸å†èƒ½å¾—åˆ°ç­”æ¡ˆäº†ï¼Œä½†æˆ‘æ¥å›ç­”ï¼Œâ€œæŒ£é’±â€æˆ–è®¸æ˜¯å¥¹æœ€å¤§çš„çˆ±å¥½ã€‚\næˆ–è®¸å¥¹æ‰€éœ€è¦çš„ï¼Œæ˜¯ä¸€ä¸ªèƒ½æ— å¾®ä¸è‡³ç…§é¡¾å¥¹çš„äººï¼Œç”Ÿæ´»ï¼Œå’Œæ€æƒ³ã€‚è‹¦æ¼çš„æ—¶å€™ï¼Œèƒ½æ•æ„Ÿåœ°å¯Ÿè§‰åˆ°ï¼Œå®‰æ…°å¥¹ï¼Œå¸®åŠ©å¥¹ã€‚åˆä¸€å®šè¦æœ‰ä¸€ä¸ªå¼ºå¤§çš„å†…å¿ƒï¼ŒæŠ—ä½å‹åŠ›ï¼Œå…±åŒæˆé•¿ã€‚æˆ‘å¤©æ€§æ„šç¬¨ï¼Œå¾ˆéš¾å…±æƒ…åˆ°æ‰€æ€æ‰€æƒ³ï¼›å³ä½¿çŒœåˆ°ï¼Œä¹Ÿä¼šçŠ¹çŠ¹è±«è±«ï¼Œæ— æ‰€ä½œä¸ºã€‚\nè¯šç„¶ï¼Œåœ¨è¿™äº›æ€å¿µä¸­ï¼Œä¹Ÿæºæ‚ç€ä¸€ä¸è®¨åŒã€‚ä¸ºä»€ä¹ˆåœ¨æˆ‘ä»˜å‡ºäº†å‡ ä¹æ‰€æœ‰çš„æ—¶å€™ï¼Œå´ä¾ç„¶èƒ½å†³ç„¶åœ°æ”¾ä¸‹æˆ‘ï¼Œæ¯æ¬¡éƒ½æŠŠè¿™æ®µå…³ç³»é¦–å½“å…¶å†²çš„ç½®äºåˆ€ä¸‹ï¼›ä¸ºä»€ä¹ˆæ€»è½»è€Œæ˜“ä¸¾åœ°å¤§å‘é›·éœ†ï¼Œåˆå¿½è§†æˆ‘æ—¥å¸¸çš„åŠªåŠ›ï¼›ä¸ºä»€ä¹ˆåªé¡¾è‡ªå·±è¿‡å¾—æ½‡æ½‡æ´’æ´’ï¼Œå´æ€»è·µè¸æˆ‘çš„è¯‰æ±‚ï¼Œè®©æˆ‘æ„Ÿåˆ°æ›´åŠ ç»æœ›ï¼Œæ›´åŠ å¹½é—­ã€‚æˆ‘è®¨åŒè¿™ä¸€åˆ‡ã€‚å½“æˆ‘ç¿»éç›¸å†Œå´éš¾æ‰¾åˆ°ä¸€å¼ åˆå½±ï¼Œå½“æˆ‘å¯¹å¥¹è¯´è¯å´è¢«åŸ‹å¤´æ— è§†çš„æ—¶å€™ï¼Œä»¿ä½›åœ¨è¿™ä¸ªä¸¤äººä¸–ç•Œä¸­ï¼Œæˆ‘åªæ˜¯ä¸€ä¸ªæ— äººé—®æ´¥ï¼Œéšæ—¶ä¸¢å¼ƒçš„æ‘†ä»¶è€Œå·²ï¼Œæ— äººä¸­æ„æˆ‘çš„å­˜åœ¨ã€‚æˆ‘å¥½åŒæ¶è‡ªå·±ï¼Œæ”¾ä¸‹äº†æˆ‘æƒ³è¦çš„ä¸€åˆ‡ï¼Œå»ç»´æŒä¸€æ®µè·Œè·Œå®•å®•çš„æ„Ÿæƒ…ç”Ÿæ´»ã€‚\nè€Œæˆ‘å¯¹å…³ç³»æ‰€æœŸå¾…çš„ï¼Œåº”è¯¥åªæ˜¯å…³ç³»çš„â€œç¨³å®šâ€ã€‚æˆ‘å¯¹å¥¹æœ‰ç€æ— ç©·çš„ä¿¡ä»»ï¼Œå¸Œæœ›å½¼æ­¤èƒ½å§‹ç»ˆåœ¨ä¸ç‰ºç‰²å½¼æ­¤å…³ç³»çš„å‰æä¸Šæ²Ÿé€šå’Œè§£å†³é—®é¢˜ï¼Œå“ªæœ‰é—®é¢˜æ˜¯ä¸å¯ä»¥è¢«è§£å†³çš„å‘¢ï¼Œæœ‰é—®é¢˜åªè¦è¯´å‡ºæ¥å°±å¥½äº†å˜›ï¼æ®Šä¸çŸ¥ï¼Œå½¼æ­¤é—´é»˜å¥‘çš„å…±æƒ…ï¼Œå´ä¹Ÿæ˜¯è¡¡é‡çˆ±çš„å°ºåº¦ã€‚æˆ–è®¸æˆ‘ä»¬æ—©å·²éƒ½æ„Ÿè§‰åˆ°ï¼Œå½¼æ­¤çš„ä¸é€‚ä»ã€‚ä¸€æ®µæ—¶é—´ä»¥æ¥ï¼Œæˆ‘æ€»æ²‰æººäºç½‘ç»œã€ç›´æ’­æ¥å®£æ³„å‹åŠ›ï¼Œå¯¹äºå¥¹ï¼Œå¯¹äºç”Ÿæ´»ï¼Œæ—©å·²ä¸æŠ±å¸Œæœ›ï¼›å¯¹æ— æ­¢å¢ƒçš„ä»˜å‡ºå’Œæ”¹å˜æ—©å·²æ„Ÿåˆ°ç–²æƒ«ï¼›å¯¹ä¸çŸ¥é“è—åœ¨å“ªä¸ªè§’è½çš„é›·éœ†ï¼Œæ„Ÿåˆ°ææƒ§æ…Œä¹±ã€‚æ¯å¤©çš„ç”Ÿæ´»éƒ½å¦‚å±¥è–„å†°ï¼Œç”Ÿæ€•æœ‰ä¸æ¯«çš„ä¸å¦‚æ„ï¼Œåˆå¼•æ¥å…³ç³»ä¸Šçš„é­æŒã€‚è¯´æ¥å¥½ç¬‘ï¼Œä½ æ•¢ç›¸ä¿¡å—ï¼Œä¸ºäº†è®©å¥¹å¼€å¿ƒï¼Œä¸ºäº†ç»´æŒè¿™æ®µå…³ç³»ï¼Œå› ä¸ºå¾ˆéš¾å’Œå¥¹ååœ¨ä¸€èµ·è§„åˆ’ï¼Œæ‰€ä»¥å¾ˆå¤šäº‹å¾ˆå¤šç‰©ï¼Œæˆ‘éƒ½è¦å‡†å¤‡PLAN DEFGï¼Œä¹°å¥½å„ç§å¤‡ç”¨å“ï¼Œæ¥ä¾›å¥¹æŒ‘é€‰ã€‚æé”ï¼Œä»¥åå½“ä½ å†çœ‹åˆ°è¿™æ®µè¯ï¼Œå†æƒ³èµ·è¿™äº›äº‹ï¼Œä½ ä¾ç„¶ä¼šè§‰å¾—å¥½ç¬‘å—ï¼Ÿè¿™å½“ç„¶ä¸æ˜¯æˆ‘æ‰€æœŸæœ›çš„ç”Ÿæ´»ã€‚æˆ‘å¸Œæœ›èƒ½å’Œå¥¹ï¼Œå¹³ç­‰åœ°æ²Ÿé€šï¼Œä¸ºå¦‚ä½•æˆé•¿ï¼Œä¸ºæˆ‘ä»¬çš„æœªæ¥ä¸€èµ·è°‹åˆ’ã€‚ä½†åœ¨è¿™æ®µå…³ç³»ä¸­ï¼Œæˆ‘çœ‹ä¸åˆ°å¸Œæœ›ï¼Œæˆ‘å°†æ˜¯æ— å£°çš„ã€‚æˆ‘å·²ç»ä¸çŸ¥é“å¤šä¹…ï¼Œæˆ‘å·²ç»å¿«è¦å¿˜äº†æˆ‘è‡ªå·±ï¼Œå¿˜äº†æˆ‘çš„è¯‰æ±‚ï¼Œå¿˜äº†æˆ‘çš„åŸåˆ™ï¼Œåªå‰©ä¸‹æƒ³è¦å’Œå¥¹åœ¨ä¸€èµ·çš„æ¬²æœ›ã€‚ç…§ç…§é•œå­å§æé”ï¼Œå»é•œä¸­ä¸–ç•Œå†’é™©å§ï¼Œä½ è¦æ‰¾åˆ°ä½ è‡ªå·±ã€‚\nå¿«è¦ç»“æŸäº†ï¼è¿™æ®µå½¼æ­¤ä¸é€‚ï¼Œæ— æ³•æ»¡è¶³çš„æ—¥å­ã€‚ç°åœ¨æˆ‘å¿ƒåº•æœ€æœ€æœ€å¸Œæœ›çš„äº‹ï¼Œæ˜¯çœ‹åˆ°å¥¹åœ¨å›½å¤–è¿‡çš„ç‹¬ç«‹ï¼Œå……å®ï¼Œè‡ªç”±ï¼Œå¿«ä¹ï¼Œæ»¡è¶³ã€‚è½»æ¾æŒ£é’±ï¼Œæ— å¿§æ— è™‘ï¼Œäº«å—ç”Ÿæ´»ã€‚æœªæ¥ï¼Œå¸Œæœ›ä½ ä¸€åˆ‡éƒ½å¥½ï¼Œæœ€ååœ¨çˆ±ä½ ä¸€æ¬¡ï¼Œå®ã€‚æˆ‘ä»¬æœªæ¥å†è§çš„æ—¶å€™ï¼Œå¸Œæœ›æˆ‘æ˜¯ä¸€ä¸ªæ‰¾åˆ°äº†è‡ªå·±çš„äººï¼Œæˆ‘ä»¬ä¸€å®šéƒ½èƒ½å˜å¾—æ›´å¥½ï¼\nå…³ç³»ç³Ÿç³•æ—¶ï¼Œæˆ‘å¸¸å¸¸å»å®šä¹‰å“ªä¸ªç¬é—´å°†æ˜¯è¿™æ®µå…³ç³»çš„æœ€åä¸€èˆã€‚ä¸´åˆ°æ—¶å´æ€»åˆæœè½¯ï¼Œåå™¬æ‰æˆ‘è‡ªå·±çš„è¯‰æ±‚ï¼Œæ±‚å¾—ä¸€å¤•å®‰ç¨³ã€‚\nè€Œåœ¨æˆ‘çŒä¸åŠé˜²çš„æ—¶å€™ï¼Œç°åœ¨ï¼Œç»ˆäºï¼Œèˆï¼Œå·²ç„¶è·³èµ·æ¥äº†ã€‚\n","date":"2023-10-15T22:38:00Z","permalink":"https://MyLoveES.github.io/p/last-dance-for-the-relationship/","title":"Last dance for the relationship"},{"content":"å®ï¼Œæˆ‘çœŸçš„å¾ˆæƒ³ä½ ï¼Œæœ‰ä¸€è‚šå­è¯æƒ³è¯´ï¼Œå´åˆç•ç•ç¼©ç¼©ï¼Œæˆ‘å…ˆç”¨æ–‡å­—è¡¨è¾¾ä¸€ä¸‹å§\næˆ‘çœŸçš„å¾ˆèƒ½ç†è§£ä½ ç°åœ¨çš„æ„Ÿå—ï¼Œè¿™æ®µæ—¶é—´æ—¥å¤ä¸€æ—¥çš„ç™¾æ— èŠèµ–ï¼Œè®©ä½ çƒ¦èºäº†å§ã€‚æˆ‘æ²¡èƒ½åšå¥½ï¼ŒçœŸæ˜¯æŠ±æ­‰ã€‚å½“ç„¶æˆ‘ä¹ŸçœŸçš„ç›¸ä¿¡éšç€å®çš„åŠªåŠ›ï¼Œè¿™æ ·çš„æ—¥å­ä¸ä¼šå¾ˆé•¿ï¼Œå½“æœ‰äº†æ–°çš„å·¥ä½œï¼Œæˆ–è€…ç¤¾å›¢æ´»åŠ¨å¤šå¤šçš„æ—¶å€™ï¼Œæ„Ÿå—å¾ˆå¿«å°±ä¼šå¥½èµ·æ¥äº†ï¼Œä½ çš„ç¤¾äº¤å¤©èµ‹å¯æ˜¯MAXå‘¢ã€‚è™½ç„¶ä½ æ€»è¯´äººéš¾ä»¥æ·±äº¤ï¼Œä½†ä¹Ÿä¸å¦¨å¤šä¸èº«è¾¹çš„äººäº¤äº¤å¿ƒå‘€ã€‚\nåœ¨ä½ é¢å‰ï¼Œæˆ‘å¾ˆå°‘è°ˆåŠæˆ‘å¯¹äºæˆ‘ä»¬å…³ç³»çš„æƒ³æ³•å§ï¼Œæ—¢ç„¶ç°åœ¨æœ‰æœºä¼šï¼Œè®©æˆ‘æ¥è¡¨(tu)è¾¾(cao)è¡¨(tu)è¾¾(cao)å§ï¼š\nåœ¨æˆ‘å¿ƒé‡Œï¼Œä½ çš„ç¡®æ˜¯ä¸€ä¸ªè‡ªæˆ‘æ„è¯†éå¸¸(x10)å¼ºçš„äººï¼Œå°±è¯´ä½ å·¥ä½œçš„æ—¶å€™ï¼Œç”šè‡³èƒ½å¿½ç•¥æˆ‘åœ¨è€³è¾¹è¯´çš„è¯ï¼Œå¿½ç•¥æˆ‘æ­£åœ¨åšçš„äº‹ï¼ŒUnbelievableï¼Œæ€ä¹ˆä¼šæœ‰è¿™ç§äººå‘¢ï¼ï¼ï¼ï¼\nå³ä½¿è¿™æ ·ï¼Œä½†æ˜¯åœ¨ä½ å…¨ç¥è´¯æ³¨çš„æ—¶å€™ï¼Œåœ¨æˆ‘çœ¼é‡Œä½ çœŸçš„å¥½ç¾å‘€ï¼Œé‚£é›·å‰é£è¡Œçš„çŠ¶æ€ï¼Œå’Œå¾—åˆ°æ”¶è·æ—¶å¿«ä¹çš„æ ·å­ï¼Œæˆ‘ä¹Ÿæ„Ÿåˆ°å¾ˆå¼€å¿ƒã€‚ä¸´æœŸåŠå°æ—¶æ‹¿ä¸‹å¤§å•ï¼Œç‰›ï¼æˆ‘æ‰“å¿ƒåº•ä¸æ„¿æ„è®©ä½ æ”¹å˜ï¼Œæ„¿æ„çœ‹ä½ ä¿æŒè‡ªæˆ‘ã€‚ï¼ˆç»“æœæˆ‘æ€ä¹ˆæ„Ÿè§‰è¢«åå™¬äº†å‘¢å“ˆå“ˆå“ˆå“ˆå“ˆï¼Œå¼ ä¿¡å“²å”±å¾—å¥½ï¼Œâ€œæ˜¯æˆ‘çµ¦ä½ è‡ªç”±éäº†ç«ï¼ğŸ˜­â€\nåœ¨æˆ‘ä»¬çš„å…³ç³»ä¸­ï¼Œä½ çš„ç¡®ä¿æŒä½äº†ï¼ä¸è¿‡å°±åƒä½ è¯´çš„ï¼Œå°±ç®—æˆ‘æƒ³ä¹Ÿæ”¹å˜ä¸äº†ä½ å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚ä½ å‡­å€Ÿè‡ªå·±çš„åŠªåŠ›å®Œæˆä¸€ä¸ªåˆä¸€ä¸ªæŒ‘æˆ˜ã€‚ç»“æœï¼Œæˆ‘ä»¬è¿æ¥äº†ä¸€ç§â€œä¸å¹³ç­‰â€çš„å…³ç³»ã€‚æˆ‘æ—¢æ„¿æ„çœ‹åˆ°ä½ è‡ªç”±è‡ªåœ¨åœ°åšè‡ªå·±ï¼Œçœ‹ç€ä½ ç‹¬ç«‹å’Œå¼€å¿ƒã€‚ä½†æˆ‘å¿ƒé‡Œä¹Ÿæœ‰è¦æ±‚ï¼Œè¿™æ ·çš„æ—¥å­é•¿äº†ï¼Œæˆ‘å‡ºå»æ—…æ¸¸æƒ³å’Œä½ åˆç…§ï¼Œæ€»ä¹Ÿå¼ ä¸å¼€å£æï¼Œæˆ‘çœŸçš„å¥½å¸Œæœ›èƒ½å¤šä¸€äº›åˆç…§æ¥å›å¿†ä¸€èµ·çš„å¿«ä¹ï¼æƒ³å¤šåˆ†äº«åˆ†äº«å¿ƒåº•çš„æƒ³æ³•å’Œæ„Ÿå—ï¼Œå´æ€•ä¼šè¢«ä½ å˜²ç¬‘å’Œé©³æ–¥ã€‚æœ‰ä¸ç†è§£æ—¶ï¼Œæˆ‘æœ‰æ—¶è§‰å¾—åƒæ˜¯åœ¨æ·±äº•é‡Œä¸€èˆ¬å¹½é—­ï¼›ä½†æ˜¯å’Œä½ åœ¨ä¸€èµ·å¼€å¿ƒæ—¶ï¼Œå¿ƒæƒ…åˆåƒèœ»èœ“ä¸€æ ·ï¼Œé£èˆå’Œè·ƒåŠ¨ã€‚æˆ‘çŸ¥é“æˆ‘åšçš„ä¸å¥½çš„æ—¶å€™ï¼Œè®©ä½ åœ¨å¿«ä¹å’Œå¤±æœ›çš„ç¬é—´ï¼Œä¹Ÿä¼šæœ‰ç±»ä¼¼çš„æ„Ÿå—å§ï¼æˆ‘çœŸçš„å¥½æƒ³æŠ±æŠ±ä½ å“¦ï¼Œå®ã€‚\nå…¶å®æœ‰ä¸€ä»¶äº‹æˆ‘æ‰“å¿ƒåº•ç‰¹åˆ«ä¸å¸Œæœ›å®åšï¼Œå¾ˆä¹…å¾ˆä¹…å¾ˆä¹…äº†ã€‚å°±æ˜¯æˆ‘ä»¬ä¸é«˜å…´çš„æ—¶å€™ï¼Œæ„Ÿè§‰å®æœ‰æ—¶ä¼šæŠŠæˆ‘ä»¬çš„å…³ç³»é¦–å½“å…¶å†²åœ°æ‹¿å‡ºæ¥ï¼Œä½œä¸ºè®©æˆ‘ç—›è‹¦å’Œéš¾è¿‡çš„æ­¦å™¨ï¼Œæˆ³æˆ‘çš„å¿ƒçªå­ã€‚æ—¶é—´ä¹…äº†ï¼Œæˆ‘çš„å¿ƒé‡Œæ€»ä¼šæ„Ÿè§‰â€œä¸å®‰å…¨â€ï¼Œä¼šé•¿æ—¶é—´åœ°å½±å“ç€æˆ‘å»æƒ³ï¼Œ\u0026ldquo;æˆ‘çœŸçš„æ˜¯ä¸€ä¸ªé‡è¦çš„äººå—ï¼Œæˆ‘ä»¬çš„å…³ç³»çœŸçš„è¿™ä¹ˆä¸å€¼ä¸€æå—ï¼ŒçœŸçš„å¯ä»¥éšæ—¶è¢«æŠ›å¼ƒå—ï¼Ÿé‚£å°±è®©æˆ‘è¢«æŠ›å¼ƒå§ï¼\u0026ldquo;ä½†æˆ‘æƒ³ä½ æ—¶ï¼Œè¿™äº›æƒ³æ³•å´åˆåƒæ·é”ä¸€æ ·ç‰¢ç‰¢å›°ä½æˆ‘ï¼Œæˆ‘æ‹¼å‘½å¦å®šè‡ªå·±ï¼Œæˆ‘å¥½ç—›è‹¦ã€‚æˆ‘çœŸçš„çœŸçš„å¸Œæœ›ï¼Œå®ä¸è¦åšè¿™æ ·çš„äº‹æƒ…ã€‚ä¸çŸ¥é“æˆ‘ä»¬çš„å…³ç³»ï¼ŒçœŸçš„å¯ä»¥è‡ªç”±çš„è¡¨è¾¾å—ã€‚å¦‚æœè®©æˆ‘è®¸æ„¿çš„è¯ï¼Œè¿™æ˜¯æˆ‘å”¯ä¸€çš„æœŸæœ›äº†\nå¯¹äºå®è¿™æ®µæ—¶é—´çš„æ¯ç‡¥ï¼Œæˆ‘è¿˜æœ‰äº›å…¶ä»–çš„è¯æƒ³è¯´ï¼Œå®è€å¿ƒçœ‹å®Œå“¦\nå®èƒ½ç‹¬ç«‹å¤„ä¸–ï¼Œèªæ˜ï¼Œåˆè‡ªæˆ‘ï¼ŒçœŸçš„å¾ˆå¥½ã€‚ä½†æ˜¯ï¼Œä½ ä¸æ“…é•¿å¤„ç†ä¸€ä¸ªäººçš„æ—¶å…‰ã€‚æ€»æ˜¯è®©ç¹å¿™çš„å·¥ä½œå¡«æ»¡è‡ªå·±ï¼Œå´åˆæ€»åœ¨ä¸€ä¸ªäººçš„æ—¶å€™æ— æ‰€äº‹äº‹ã€‚æˆ‘æ€»èˆä¸å¾—ç¦»å¼€ä½ ï¼Œæƒ³åœ¨ä½ æ²¡äº‹çš„æ—¶å€™ï¼Œéšæ—¶èƒ½å‡ºç°åœ¨ä½ é¢å‰ï¼Œé™ªä¼´ä½ ï¼Œä¸€èµ·å‡ºè¡Œã€‚\nè™½ç„¶æœ‰æ—¶å¾ˆå–œæ¬¢è¿™ç§â€œä¾èµ–â€ï¼Œå³ä½¿æˆ‘å¾ˆä¸æƒ³å‰²èˆæ‰ï¼Œä½†æ˜¯æˆ‘å¸Œæœ›ï¼Œä½ èƒ½å¤Ÿæ‰¾åˆ°çœŸæ­£å–œæ¬¢çš„çˆ±å¥½ï¼Œå°±ç®—æ˜¯ä¸ä¾èµ–æˆ‘åˆå¦‚ä½•ã€‚å¸Œæœ›è¿™äº›èƒ½è®©ä½ å˜çš„æ›´ç‹¬ç«‹æ›´è‡ªæˆ‘ï¼ä½ å¾ˆèªæ˜å¾ˆæ•æ„Ÿï¼Œæˆ–è®¸å¿ƒç†å­¦å’Œä½ æ‰€æ„Ÿå…´è¶£çš„æ³•å­¦éƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ï¼ï¼ˆåˆ©å…¹çš„å¿ƒç†å­¦å¥½åƒä¹Ÿä¸é”™ï¼Œæˆ–è®¸å¯ä»¥æ—å¬æ—å¬ï¼‰æœ‰äº›äº‹æ˜¯éœ€è¦éšç€æ—¶é—´ä¸æ–­æµé€ï¼ŒåšæŒä½æ‰èƒ½å‘ç°å…¶ä¸­çš„ç¾å¦™å‘€ã€‚\næˆ‘è§‰å¾—æˆ‘æ˜¯å±äºå¾ˆèƒ½ç»™è‡ªå·±æ‰¾äº‹çš„äººï¼Œè„‘å­é‡Œæƒ³è¦å­¦çš„ä¸œè¥¿ä¼°è®¡è¶³å¤Ÿå †åˆ°ä¸‹è¾ˆå­äº†ã€‚æƒ³å’Œä½ ä¸€èµ·çœ‹å†å²ï¼Œå­¦è¯­è¨€ï¼Œä¸‹å›´æ£‹ï¼Œç”šè‡³æœ€è¿‘è¿˜æƒ³çœ‹å¿ƒç†å­¦ï¼ˆç«Ÿç„¶èƒ½æŠŠå¤æ‚çš„äººæ€§è§£é‡Šå¹¶å½’ç±»ï¼Œå¤ªç¥å¥‡äº†ï¼ï¼ï¼çœŸçš„æ¨èå®ä¹Ÿçœ‹çœ‹ï¼‰å¥½å¥‡å¿ƒç®€ç›´æ³›æ»¥æˆç¾ã€‚ç”šè‡³ä¼šä¸ºäº†å†™æ¼‚äº®çš„ä»£ç ä»˜å‡ºå¤šå‡ å€çš„åŠªåŠ›ï¼Œä»è¿™äº›ç¢ç‰‡ä¸­æ±²å–ä¸€äº›å¿«ä¹å’Œæ»¡è¶³ã€‚å®åœ¨å›½å¤–ï¼Œæˆ‘èƒ½åˆ†äº«çš„æœºä¼šå°‘äº†ï¼Œä½†æ˜¯æ–°çš„ç¯å¢ƒæˆ–è®¸æ›´æœ‰æ–°çš„ä¸»é¢˜å‘¢ã€‚å³ä½¿åœ¨å›½å†…ï¼Œæˆ‘ä¹Ÿæƒ³å’Œå®ä¸€èµ·ä¸Šè¯¾è¯»PPTï¼Œè¿˜ä¸€ç›´å¸Œæœ›å’Œå®ä¸€èµ·å­¦ä¸€é—¨å¤–è¯­ï¼Œæ³•è¯­è¥¿ç­ç‰™è¯­æ—¥è¯­éŸ©è¯­ä¿„è¯­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·å»å·´å¡ç½—é‚£ï¼Œå¾·å›½çœ‹é£æ™¯\nå®ï¼Œåƒä½ è¿™æ ·èƒ½åšæŒè‡ªæˆ‘çš„äººæ ¼çœŸçš„å¾ˆå¥½ï¼Œä½ ä¸€å®šèƒ½å¤Ÿå‘ç°å…´è¶£å¹¶ä¸”åšæŒä¸‹å»çš„ï¼Œå˜å¾—æ›´ç‹¬ç«‹æ›´åŠ è‡ªæˆ‘ã€‚æˆ‘ä¹Ÿå¸Œæœ›èƒ½å¤Ÿå’Œä½ ä¸€èµ·åº¦è¿‡è¿™æ®µæ¯ç‡¥è€Œåˆéš¾è¿‡çš„æ—¥å­ï¼Œæˆ‘ä¼šåŠªåŠ›åšå¥½ç‰µèµ·ä½ çš„æ‰‹æ¥\næˆ‘çŸ¥é“ï¼Œæˆ‘éå¸¸éå¸¸ä¸ä¼šåˆ†äº«ï¼Œä¸ä¼šå“„äººï¼Œä¹Ÿå¾ˆéš¾å’Œä½ ä¸€èµ·äº«å—å…±åŒçš„æ—¶é—´ï¼ˆä¸èƒ½ä¸€èµ·å‡ºå»æ—…æ¸¸æ‹ç…§ğŸ˜­ï¼‰ã€‚æˆ‘æƒ³ï¼Œæˆ‘ä¼šåŠªåŠ›è®©è‡ªå·±çš„ç”Ÿæ´»å……ç›ˆèµ·æ¥ï¼Œå˜å¾—é²œæ´»ï¼Œå’Œä½ åˆ†äº«å–œæ‚¦ã€‚æˆ–è®¸å½“æˆ‘åšåˆ°çš„æ—¶å€™ï¼Œæˆ‘éƒ½è¦å˜æˆä¸€ä¸ªå¤–å‘çš„äººäº†ï¼Œä¸€ä¸ªæƒ³åªå¯¹å®å¤–å‘çš„äºº\næˆ‘æ˜¯ä¸ªå¤§ç›´ç”·ï¼Œæ•´å¤©åªçŸ¥é“é—®é—®é¢˜ï¼Œä¸ä¼šèŠå¤©ä¸ä¼šè®²æ•…äº‹å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ è¿™é—­å¡çš„çŠ¶æ€ä¹Ÿè®©æˆ‘éš¾å— æˆ‘ä¸€å®šèƒ½å˜æˆæ›´å¥½çš„äºº è®©æˆ‘ä»¬çš„å…³ç³»å˜å¾—æ›´å¥½\næˆ‘çˆ±ä½ ï¼Œå¾ˆæƒ³ä½ ï¼ŒæŠ±æŠ±ä½  å®\n","date":"2023-10-13T10:38:00Z","permalink":"https://MyLoveES.github.io/p/letter-for-my-dear/","title":"Letter for my dear"},{"content":"ä¸€ã€èƒŒæ™¯ æ‰‹æœºåŸç”Ÿé€šè¯åº”ç”¨ï¼Œå®ç°æµå¼è¯­éŸ³ç¿»è¯‘ã€‚\näºŒã€å·®å¼‚ å’Œä»¥å¾€å®¢æˆ·æ¥å…¥ä¸åŒï¼Œéœ€è¦æˆ‘ä»¬è‡ªè¡Œç›‘å¬RTPæµ(é€šè¿‡SDPæè¿°æ–‡ä»¶)ï¼Œå¹¶ä¸”ç»ˆç«¯è¾“å…¥çš„éŸ³é¢‘æµå¹¶éæˆ‘ä»¬å¯æ¥å—çš„WAV/PCMæ ¼å¼ï¼Œè€Œæ˜¯AMR-WBï¼Œéœ€è¦æˆ‘ä»¬ç›‘å¬RTPæµè·å–éŸ³é¢‘æ•°æ®ã€‚ç»ˆç«¯é€šä¿¡è®¾å¤‡æ˜¯ç°ç½‘è®¾å¤‡ï¼Œç¼–ç æ–¹å¼æ— æ³•å˜æ›´ï¼Œéœ€è¦æˆ‘ä»¬æ¥å®ç°éŸ³é¢‘æ•°æ®çš„è§£ç ã€‚\nåˆç‰ˆå®ç° å€ŸåŠ©FFmpegè¾“å…¥SDPç›‘å¬å¯¹åº”åœ°å€çš„RTPï¼Œå¹¶æ ¹æ®SDPä¸­æè¿°çš„éŸ³é¢‘ç¼–ç è¿›è¡Œè§£ç ä»¥åŠè½¬æ ¼å¼ï¼Œç›´æ¥è¾“å‡ºåˆ°WAVæ–‡ä»¶ä¸­ã€‚Javaç¨‹åºè¯»å–WAVæ–‡ä»¶ï¼ŒåšASR+ç¿»è¯‘ã€‚\nä¸‰ã€é¢„æœŸå¤–çš„å›°éš¾ä¸è§£å†³æ–¹å¼ 1. AMR-WBç¼–ç éŸ³é¢‘ï¼ŒFFmpegä¸èƒ½å®Œå…¨æ”¯æŒè§£ç  AMR-WBç¼–ç åˆ†ä¸ºä¸¤ç§ï¼ŒBandwidth-efficient å’Œ Octet-alignedã€‚\né˜…è¯»RFC 4867åè®®åï¼Œå‘ç°bandwidth-efficientå’Œoctet-alignedä¹‹é—´çš„å·®è·å¹¶ä¸å¤§ï¼Œå†…å®¹ä¸å˜ï¼Œåªæ˜¯æ’é™¤äº†ä¸­é—´çš„å¡«å……å­—èŠ‚ï¼Œæ›´ç´§å‡‘äº†äº›ï¼š\nbandwidth efficient header: table: payload: octet aligned header: table: payload: ç»ˆç«¯æ‰€é‡‡ç”¨çš„AMR-WBå¹¶éå¸¸è§çš„Octet-alignedï¼Œè€Œæ˜¯Bandwidth-efficientã€‚ä¸å¹¸ï¼ŒFFmpegå¹¶ä¸æ”¯æŒè¿™ç§æ¨¡å¼çš„ç¼–ç ï¼šrtpdec_amr.c æ–¹æ¡ˆ1: python(RTPè§£ç +é‡ç¼–ç ) -\u0026gt; ffmpegè½¬æ ¼å¼ -\u0026gt; ASR è¿ç»´å¸®å¿™æ‰¾åˆ°äº†ä¸€ä¸ªè„šæœ¬ï¼Œå¯ä»¥å®ç°AMR-WB Bandwidth-efficientéŸ³é¢‘çš„è§£ç ï¼Œå¹¶æå–å‡ºå…¶ä¸­æœ‰æ•ˆçš„payloadï¼Œè¾“å‡ºåˆ°æ–‡ä»¶ä¸­ã€‚æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶å¯ä»¥é€šè¿‡ffmpegè¿›ä¸€æ­¥è½¬æ ¼å¼ï¼Œå¾—åˆ°å¯æ¥å—çš„WAVã€‚åŸºäºè¿™ä¸ªè„šæœ¬ï¼Œè¿ç»´å¼€å‘äº†ä¸€ä¸ªç®€å•çš„è§£ç å™¨ï¼Œé’ˆå¯¹äºè¿™ç§æ ¼å¼ï¼Œç›‘å¬RTPæµå¹¶è½¬ç ã€‚ ä½†æ˜¯ï¼Œè¿™ç§æ–¹å¼ä¼šå¸¦æ¥æ–°çš„é—®é¢˜ï¼š\nå¦‚æœç»ˆç«¯çš„æ•°æ®ä¸æ˜¯AMRæ ¼å¼ï¼Œä¸é€‚ç”¨äºè¿™æ¡è·¯ï¼Œè¿˜éœ€è¦èµ°è€æµç¨‹ï¼Œæ‰€ä»¥å¯¹äºéŸ³é¢‘å¤„ç†ä¼šåˆ†æˆä¸¤æ¡è·¯ï¼š å¦‚æœåœ¨é€šä¿¡è¿‡ç¨‹ä¸­å‘ç”ŸéŸ³é¢‘ç¼–ç çš„å˜åŒ–ï¼ˆSDPä¿¡æ¯æ›´æ–°ï¼‰ï¼ŒJavaæœåŠ¡éœ€è¦åœ¨ä¸¤æ¡è·¯ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œå¢åŠ äº†ç¨³å®šæ€§é£é™©å’Œå¤æ‚åº¦ã€‚æ‰€ä»¥åœ¨æœ‰äº†ä¿åº•æ–¹æ¡ˆä¹‹åï¼Œç»§ç»­å°è¯•å¦ä¸€ç§æ–¹å¼ã€‚ æ–¹æ¡ˆ2: ä¿®æ”¹ffmpegï¼Œæ”¯æŒAMR Bandwidth-efficientç¼–ç  1.ç®€å•åˆ†æä¸€ä¸‹FFmpegå¯¹amrçš„è§£ç éƒ¨åˆ†ï¼Œå¯¹äºoctet-alignedæ¨¡å¼ï¼Œå®é™…ä¸Šå°±æ˜¯æŒ‰ç…§å­—èŠ‚è¯»å–ï¼Œé€å¸§å‰¥ç¦»æ•°æ®ï¼Œé€åˆ°åé¢çš„decoderï¼š æœ€ç»ˆé€å»è½¬ç çš„audio-dataç»“æ„ï¼š é‚£ä¹ˆå¯¹äºbandwidth-efficientï¼Œpayloadä¸€è‡´çš„å‰æä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦é‡å†™è§£æé€»è¾‘ï¼ŒæŒ‰ä½è¯»å–ï¼Œå¹¶åœ¨é€‚å½“çš„ä½ç½®å¡«å……0bitï¼Œå³å¯è½¬åŒ–æˆoctet-alignedæ¨¡å¼çš„æ•°æ®ï¼Œç»§ç»­åé¢çš„è§£ç ï¼š 2. é™éŸ³æœŸé—´ï¼Œè§£ç å™¨ä¸å·¥ä½œ å½“ç¢°åˆ°SIDçš„æ—¶å€™ï¼ŒAMR-decoderä¸ä¼šå¯¹éŸ³é¢‘æ•°æ®è¿›è¡Œè§£ç ï¼Œè€Œæ˜¯é€‰æ‹©â€œå¿½ç•¥â€ã€‚é€ æˆåœ¨é™éŸ³çš„ä¸€æ®µæ—¶é—´å†…ï¼ŒæœåŠ¡æ— æ³•æ”¶åˆ°è§£ç åçš„æ•°æ®ï¼Œä¹Ÿå°±æ— æ³•å‘ASRå‘é€éŸ³é¢‘æ•°æ®ã€‚è€ŒASRæ— æ³•æ”¶åˆ°è¶³å¤Ÿçš„éŸ³é¢‘ï¼Œä¹Ÿæ— æ³•è¿›è¡Œè¯†åˆ«ï¼Œä»ç»ˆç«¯ä½“éªŒæ¥çœ‹ï¼Œåƒæ˜¯ä¸€å¥è¯çš„æœ€åå‡ ä¸ªå­—â€œè¢«åäº†â€ï¼Œç›´åˆ°å¼€å§‹è¯´ä¸‹ä¸€å¥è¯æ‰ç»§ç»­è¯†åˆ«ï¼š æ–¹æ¡ˆ1: è®©FFmpegæ”¯æŒSIDè§£ç æ—¶å¡«å……é™éŸ³æ•°æ® éš¾åº¦å¤§ï¼Œå¦\næ–¹æ¡ˆ2: è®©ASRæ”¯æŒå®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·æ–­å¥ï¼Œæ–­å¥åç»§ç»­ç»´æŒwebsocketè¯†åˆ« ç®—æ³•æ”¹åŠ¨éº»çƒ¦ï¼Œå¦\næ–¹æ¡ˆ3: NIOå¼‚æ­¥ä»socketè¯»å–æ•°æ®ï¼ŒåŠ è®¾è¶…æ—¶æ—¶é—´ åœ¨é™éŸ³æ—¶æ®µå†…ï¼Œå°†æ— æ³•æ”¶åˆ°bytesï¼Œä¸€æ—¦è§¦å‘è¶…æ—¶ï¼Œå®¢æˆ·ç«¯ä¸»åŠ¨æ–­å¼€websocketï¼Œè§¦å‘ASRæ–­å¥ï¼Œç„¶åå†é‡æ–°å»ºç«‹æ–°çš„é“¾æ¥\nå››ã€æœ€ç»ˆå®ç° ","date":"2023-08-29T00:00:00Z","permalink":"https://MyLoveES.github.io/p/ffmpeg-develop-for-amrwb-bandwidth-efficient/","title":"ffmpeg develop for amrwb bandwidth efficient"},{"content":" R: 4.3.2 (2023-10-31)\nR studio: 2023.12.1+402 (2023.12.1+402)\n1. Manage customer hierarchical 1.1 segmentation According to the demographics data provided, \u0026lsquo;Emplyment\u0026rsquo; data was excluded because it was related to salary. The data with \u0026lsquo;salary=7\u0026rsquo; was removed because it was invalid. \u0026lsquo;Regions\u0026rsquo; are simplified to 3. Finally the continuous vectors are normalized and the ordinal variables are factored.\nConsidering data contains ordinal varibles and continous variables, we segment customers into four groups based on hierarchical clustering, which differentiation between groups was more appropriate than three or five groups.\n1.1.1 import and check data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 \u0026gt; seg.df \u0026lt;- read.csv(\u0026#34;1_demographics.csv\u0026#34;, stringsAsFactors = TRUE) \u0026gt; head(seg.df, n = 5) Consumer_id Age_Group Gender Salary Education Employment Location_by_region Choco_Consumption 1 352 1 2 1 2 3 4 0 2 103 3 2 3 1 1 1 1 3 17 1 1 1 1 4 1 1 4 66 1 1 1 1 3 1 1 5 329 2 1 1 1 8 1 1 Sustainability_Score 1 -1.15059 2 0.50287 3 -1.14517 4 -0.46688 5 -2.08817 \u0026gt; summary(seg.df, digits = 2) Consumer_id Age_Group Gender Salary Education Employment Location_by_region Min. : 1 Min. :1.0 Min. :1.0 Min. :0.0 Min. :1.0 Min. : 1.0 Min. :1.0 1st Qu.: 95 1st Qu.:1.0 1st Qu.:1.0 1st Qu.:1.0 1st Qu.:2.0 1st Qu.: 1.0 1st Qu.:1.0 Median :190 Median :2.0 Median :2.0 Median :2.0 Median :2.0 Median : 2.0 Median :1.0 Mean :190 Mean :2.2 Mean :1.7 Mean :2.3 Mean :2.3 Mean : 2.4 Mean :1.3 3rd Qu.:284 3rd Qu.:3.0 3rd Qu.:2.0 3rd Qu.:3.0 3rd Qu.:3.0 3rd Qu.: 3.0 3rd Qu.:1.0 Max. :378 Max. :4.0 Max. :2.0 Max. :7.0 Max. :4.0 Max. :10.0 Max. :8.0 Choco_Consumption Sustainability_Score Min. :0 Min. :-3.26 1st Qu.:2 1st Qu.:-0.61 Median :3 Median : 0.14 Mean :3 Mean : 0.00 3rd Qu.:4 3rd Qu.: 0.68 Max. :5 Max. : 2.04 \u0026gt; \u0026gt; ### 1.1.1 remove consumer_id in data set, and set consumer_id as row name \u0026gt; rownames(seg.df) \u0026lt;- seg.df[, 1] \u0026gt; seg.df \u0026lt;- seg.df[, -1] \u0026gt; #### remove salary = 7, invalid data \u0026gt; seg.df \u0026lt;- seg.df[seg.df$Salary != 7, ] \u0026gt; #### remove Employment, which related to Salary \u0026gt; seg.df \u0026lt;- subset(seg.df, select = -Employment) \u0026gt; #### just split region to 3 groups \u0026gt; seg.df$Location_by_region[seg.df$Location_by_region \u0026gt; 2] \u0026lt;- 3 1 2 3 4 5 6 hist(seg.df$Sustainability_Score, main = \u0026#34;All customers\u0026#34;, xlab = \u0026#34;Sustainability_Score\u0026#34;, ylab = \u0026#34;Count\u0026#34;, col = \u0026#34;lightblue\u0026#34; # colore the bars ) {% asset_image final_1.png %}\n1 2 3 4 5 6 hist(seg.df$Choco_Consumption, main = \u0026#34;All customers\u0026#34;, xlab = \u0026#34;Choco_Consumption\u0026#34;, ylab = \u0026#34;Count\u0026#34;, col = \u0026#34;lightblue\u0026#34; # colore the bars ) {% asset_image final_2.png %}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 \u0026gt; head(seg.df, n = 5) Age_Group Gender Salary Education Location_by_region Choco_Consumption Sustainability_Score 352 1 2 1 2 3 0 -1.15059 103 3 2 3 1 1 1 0.50287 17 1 1 1 1 1 1 -1.14517 66 1 1 1 1 1 1 -0.46688 329 2 1 1 1 1 1 -2.08817 \u0026gt; summary(seg.df, digits = 2) Age_Group Gender Salary Education Location_by_region Choco_Consumption Min. :1.0 Min. :1.0 Min. :0.0 Min. :1.0 Min. :1.0 Min. :0 1st Qu.:1.0 1st Qu.:1.0 1st Qu.:1.0 1st Qu.:2.0 1st Qu.:1.0 1st Qu.:2 Median :2.0 Median :2.0 Median :2.0 Median :2.0 Median :1.0 Median :3 Mean :2.1 Mean :1.7 Mean :2.2 Mean :2.3 Mean :1.2 Mean :3 3rd Qu.:3.0 3rd Qu.:2.0 3rd Qu.:3.0 3rd Qu.:3.0 3rd Qu.:1.0 3rd Qu.:4 Max. :4.0 Max. :2.0 Max. :6.0 Max. :4.0 Max. :3.0 Max. :5 Sustainability_Score Min. :-3.3e+00 1st Qu.:-6.1e-01 Median : 1.4e-01 Mean :-9.6e-05 3rd Qu.: 6.8e-01 Max. : 2.0e+00 \u0026gt; str(seg.df) \u0026#39;data.frame\u0026#39;:\t373 obs. of 7 variables: $ Age_Group : int 1 3 1 1 2 4 2 1 1 1 ... $ Gender : int 2 2 1 1 1 1 2 2 1 1 ... $ Salary : int 1 3 1 1 1 4 2 3 3 3 ... $ Education : int 2 1 1 1 1 1 1 2 2 2 ... $ Location_by_region : num 3 1 1 1 1 1 1 1 1 1 ... $ Choco_Consumption : int 0 1 1 1 1 1 1 1 1 1 ... $ Sustainability_Score: num -1.151 0.503 -1.145 -0.467 -2.088 ... \u0026gt; seg.df.sc \u0026lt;- seg.df \u0026gt; #### just scale continous variables \u0026gt; seg.df.sc[, c(6,7)] \u0026lt;- scale(seg.df[ , c(6,7)]) \u0026gt; #### factor ordered ordinals \u0026gt; seg.df.sc$Age_Group \u0026lt;- factor(seg.df.sc$Age_Group, ordered = TRUE) \u0026gt; seg.df.sc$Salary \u0026lt;- factor(seg.df.sc$Salary, ordered = TRUE) \u0026gt; seg.df.sc$Education \u0026lt;- factor(seg.df.sc$Education, ordered = TRUE) \u0026gt; seg.df.sc$Gender \u0026lt;- factor(seg.df.sc$Gender, ordered = FALSE) \u0026gt; seg.df.sc$Location_by_region \u0026lt;- factor(seg.df.sc$Location_by_region, ordered = FALSE) \u0026gt; head(seg.df.sc, n = 5) Age_Group Gender Salary Education Location_by_region Choco_Consumption Sustainability_Score 352 1 2 1 2 3 -2.449983 -1.1457402 103 3 2 3 1 1 -1.627442 0.5008876 17 1 1 1 1 1 -1.627442 -1.1403426 66 1 1 1 1 1 -1.627442 -0.4648553 329 2 1 1 1 1 -1.627442 -2.0794461 \u0026gt; summary(seg.df.sc, digits = 2) Age_Group Gender Salary Education Location_by_region Choco_Consumption Sustainability_Score 1:140 1:119 0: 34 1: 76 1:299 Min. :-2.450 Min. :-3.25 2:120 2:254 1:116 2:183 2: 58 1st Qu.:-0.805 1st Qu.:-0.61 3: 35 2: 40 3: 43 3: 16 Median : 0.018 Median : 0.14 4: 78 3:123 4: 71 Mean : 0.000 Mean : 0.00 4: 41 3rd Qu.: 0.840 3rd Qu.: 0.68 5: 14 Max. : 1.663 Max. : 2.03 6: 5 \u0026gt; str(seg.df.sc) \u0026#39;data.frame\u0026#39;:\t373 obs. of 7 variables: $ Age_Group : Ord.factor w/ 4 levels \u0026#34;1\u0026#34;\u0026lt;\u0026#34;2\u0026#34;\u0026lt;\u0026#34;3\u0026#34;\u0026lt;\u0026#34;4\u0026#34;: 1 3 1 1 2 4 2 1 1 1 ... $ Gender : Factor w/ 2 levels \u0026#34;1\u0026#34;,\u0026#34;2\u0026#34;: 2 2 1 1 1 1 2 2 1 1 ... $ Salary : Ord.factor w/ 7 levels \u0026#34;0\u0026#34;\u0026lt;\u0026#34;1\u0026#34;\u0026lt;\u0026#34;2\u0026#34;\u0026lt;\u0026#34;3\u0026#34;\u0026lt;..: 2 4 2 2 2 5 3 4 4 4 ... $ Education : Ord.factor w/ 4 levels \u0026#34;1\u0026#34;\u0026lt;\u0026#34;2\u0026#34;\u0026lt;\u0026#34;3\u0026#34;\u0026lt;\u0026#34;4\u0026#34;: 2 1 1 1 1 1 1 2 2 2 ... $ Location_by_region : Factor w/ 3 levels \u0026#34;1\u0026#34;,\u0026#34;2\u0026#34;,\u0026#34;3\u0026#34;: 3 1 1 1 1 1 1 1 1 1 ... $ Choco_Consumption : num -2.45 -1.63 -1.63 -1.63 -1.63 ... $ Sustainability_Score: num -1.146 0.501 -1.14 -0.465 -2.079 ... 1.1.2 hclust() Considering data contains ordinal varibles and continous variables, use hclust().\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026gt; ### 1.1.2 Hierarchical clustering: hclust() \u0026gt; seg.dist \u0026lt;- dist(seg.df.sc) \u0026gt; # seg.dist \u0026lt;- daisy(seg.df.sc, metric = \u0026#34;gower\u0026#34;) \u0026gt; as.matrix(seg.dist)[1:7, 1:7] 352 103 17 66 329 241 34 352 0.000000 4.048204 2.5839125 2.6721113 2.923762 4.977689 2.821760 103 4.048204 0.000000 3.4195960 3.1516122 3.557825 2.618749 1.799080 17 2.583913 3.419596 0.0000000 0.6754873 1.371829 4.254911 1.811081 66 2.672111 3.151612 0.6754873 0.0000000 1.899185 4.358532 1.738220 329 2.923762 3.557825 1.3718292 1.8991849 0.000000 3.657826 2.038581 241 4.977689 2.618749 4.2549114 4.3585316 3.657826 0.000000 3.118659 34 2.821760 1.799080 1.8110812 1.7382205 2.038581 3.118659 0.000000 \u0026gt; seg.hc \u0026lt;- hclust(seg.dist, method=\u0026#34;complete\u0026#34;) \u0026gt; plot(seg.hc) {% asset_image final_3.png %}\n1 \u0026gt; rect.hclust(seg.hc, k=4, border = \u0026#34;red\u0026#34;) {% asset_image final_4.png %}\n1 2 3 4 5 \u0026gt; seg.hc.segment \u0026lt;- cutree(seg.hc, k=4) #membership vector for 4 groups \u0026gt; table(seg.hc.segment) #counts seg.hc.segment 1 2 3 4 78 172 88 35 data size of groups\n1 2 3 4 5 6 7 \u0026gt; clusplot(seg.df, seg.hc.segment, + color = TRUE, #color the groups + shade = TRUE, #shade the ellipses for group membership + labels = 4, #label only the groups, not the individual points + lines = 0, #omit distance lines between groups + main = \u0026#34;Hierarchical cluster plot\u0026#34; # figure title + ) {% asset_image final_5.png %}\nGraph split to 4 groups\n1 2 3 4 5 6 \u0026gt; aggregate(seg.df, list(seg.hc.segment), mean) Group.1 Age_Group Gender Salary Education Location_by_region Choco_Consumption Sustainability_Score 1 1 1.692308 1.602564 1.756410 2.000000 1.282051 3.333333 -1.1191478 2 2 1.441860 1.686047 1.616279 1.819767 1.377907 2.668605 0.3161955 3 3 3.272727 1.659091 3.818182 2.977273 1.011364 3.397727 0.1015306 4 4 3.685714 1.885714 2.228571 3.542857 1.057143 2.657143 0.6839269 Well-differentiated: Salary(Group3)ã€Education(Group4)ã€Choco_Consumption(Group1ã€Group3)\n1 \u0026gt; boxplot(seg.df$Salary ~ seg.hc.segment, ylab = \u0026#34;Salary\u0026#34;, xlab = \u0026#34;Cluster\u0026#34;) {% asset_image final_6.png %}\nWell-differentiated: Salary(Group3)\n1 \u0026gt; boxplot(seg.df$Education ~ seg.hc.segment, ylab = \u0026#34;Education\u0026#34;, xlab = \u0026#34;Cluster\u0026#34;) {% asset_image final_7.png %}\nWell-differentiated: Education(Group4)\n1 \u0026gt; boxplot(seg.df$Choco_Consumption ~ seg.hc.segment, ylab = \u0026#34;Choco_Consumption\u0026#34;, xlab = \u0026#34;Cluster\u0026#34;) {% asset_image final_8.png %}\nDifferentiated not welled, ignore\n1.1.3 Conclusion Group. Age_Group Gender Salary Education Location_by_region Choco_Consumption Sustainability_Score 1 1.692308 1.602564 1.75641 2.000000 1.282051 3.333333 -1.1191478 2 1.441860 1.686047 1.61628 1.819767 1.377907 2.668605 0.3161955 3 3.272727 1.659091 3.81818 2.977273 1.011364 3.397727 0.1015306 4 3.685714 1.885714 2.22857 3.542857 1.057143 2.657143 0.6839269 Graph split to 4 groups(Only explained 50.93% of the data), we see that group3 is modestly well-differentiated. 88 customers with higher salary and higher consumption of choco, means more potential to pay at a higher price. Second target is group4, higher educated rate and more sensitive to sustainability, companies can move towards sustainability and attract potential highly educated customers.\n1.2 Factor analysis Remove unnecesssary columns from data: product_id,company_location,review_date,country_of_bean_origin,first_taste,second_taste,third_taste. Use heatmap and corrplot to visualizing the relation between factors. Finally using PCA find the position of brand, and looking for future brand positioning.\n1.2.1 import and check data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 \u0026gt; brand.ratings \u0026lt;- read.csv(\u0026#34;2_chocolate_rating.csv\u0026#34;, stringsAsFactors = TRUE) \u0026gt; \u0026gt; #### remove unnecessary columns \u0026gt; brand.ratings \u0026lt;- subset(brand.ratings, select = -c(product_id,company_location,review_date,country_of_bean_origin,first_taste,second_taste,third_taste)) \u0026gt; head(brand.ratings) brand cocoa_percent rating counts_of_ingredients cocoa_butter vanilla organic salt sugar sweetener 1 A. Morin 70 4.00 2 4 8 8 2 9 7 2 A. Morin 70 3.75 1 1 4 7 1 1 1 3 A. Morin 70 3.50 2 3 5 9 2 9 5 4 A. Morin 70 2.75 1 6 10 8 3 4 5 5 A. Morin 70 3.50 1 1 5 8 1 9 9 6 A. Morin 63 3.75 2 8 9 5 3 8 7 \u0026gt; summary(brand.ratings) brand cocoa_percent rating counts_of_ingredients cocoa_butter vanilla organic salt Soma : 11 Min. : 60.00 Min. :2.250 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Min. : 1.000 Arete : 10 1st Qu.: 70.00 1st Qu.:3.000 1st Qu.: 2.000 1st Qu.: 3.000 1st Qu.: 6.000 1st Qu.: 3.000 1st Qu.: 2.000 Cacao de Origen : 10 Median : 70.00 Median :3.250 Median : 4.000 Median : 6.000 Median : 8.000 Median : 5.000 Median : 5.500 hexx : 8 Mean : 71.53 Mean :3.285 Mean : 5.078 Mean : 5.663 Mean : 7.407 Mean : 5.275 Mean : 5.384 Smooth Chocolator, The: 8 3rd Qu.: 74.00 3rd Qu.:3.500 3rd Qu.: 9.000 3rd Qu.: 8.000 3rd Qu.: 9.000 3rd Qu.: 8.000 3rd Qu.: 9.000 A. Morin : 7 Max. :100.00 Max. :4.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 Max. :10.000 (Other) :204 sugar sweetener Min. : 1.000 Min. : 1.000 1st Qu.: 2.000 1st Qu.: 3.000 Median : 4.000 Median : 4.000 Mean : 4.155 Mean : 4.415 3rd Qu.: 6.000 3rd Qu.: 6.000 Max. :10.000 Max. :10.000 \u0026gt; str(brand.ratings) \u0026#39;data.frame\u0026#39;:\t258 obs. of 10 variables: $ brand : Factor w/ 56 levels \u0026#34;A. Morin\u0026#34;,\u0026#34;Altus aka Cao Artisan\u0026#34;,..: 1 1 1 1 1 1 1 2 2 2 ... $ cocoa_percent : num 70 70 70 70 70 63 70 60 60 60 ... $ rating : num 4 3.75 3.5 2.75 3.5 3.75 3.5 3 2.75 2.5 ... $ counts_of_ingredients: int 2 1 2 1 1 2 1 2 2 3 ... $ cocoa_butter : int 4 1 3 6 1 8 1 1 1 1 ... $ vanilla : int 8 4 5 10 5 9 5 7 8 9 ... $ organic : int 8 7 9 8 8 5 7 5 10 8 ... $ salt : int 2 1 2 3 1 3 1 2 1 1 ... $ sugar : int 9 1 9 4 9 8 5 8 7 3 ... $ sweetener : int 7 1 5 5 9 7 1 7 7 3 ... 1.2.2 Rescaling the data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 \u0026gt; brand.sc \u0026lt;- brand.ratings \u0026gt; brand.sc[,2:10] \u0026lt;- scale (brand.ratings[,2:10]) \u0026gt; head(brand.sc) brand cocoa_percent rating counts_of_ingredients cocoa_butter vanilla organic salt sugar sweetener 1 A. Morin -0.315311 1.8112654 -0.8883386 -0.5795367 0.2596824 0.96349072 -0.9958673 1.7971812 1.2538261 2 A. Morin -0.315311 1.1780588 -1.1769927 -1.6251343 -1.4919010 0.60989099 -1.2901786 -1.1703244 -1.6561032 3 A. Morin -0.315311 0.5448522 -0.8883386 -0.9280692 -1.0540051 1.31709044 -0.9958673 1.7971812 0.2838497 4 A. Morin -0.315311 -1.3547676 -1.1769927 0.1175284 1.1354741 0.96349072 -0.7015560 -0.0575098 0.2838497 5 A. Morin -0.315311 0.5448522 -1.1769927 -1.6251343 -1.0540051 0.96349072 -1.2901786 1.7971812 2.2238026 6 A. Morin -1.755138 1.1780588 -0.8883386 0.8145935 0.6975783 -0.09730845 -0.7015560 1.4262430 1.2538261 \u0026gt; summary(brand.sc) brand cocoa_percent rating counts_of_ingredients cocoa_butter vanilla organic Soma : 11 Min. :-2.3722 Min. :-2.62118 Min. :-1.1770 Min. :-1.6251 Min. :-2.8056 Min. :-1.51171 Arete : 10 1st Qu.:-0.3153 1st Qu.:-0.72156 1st Qu.:-0.8883 1st Qu.:-0.9281 1st Qu.:-0.6161 1st Qu.:-0.80451 Cacao de Origen : 10 Median :-0.3153 Median :-0.08835 Median :-0.3110 Median : 0.1175 Median : 0.2597 Median :-0.09731 hexx : 8 Mean : 0.0000 Mean : 0.00000 Mean : 0.0000 Mean : 0.0000 Mean : 0.0000 Mean : 0.00000 Smooth Chocolator, The: 8 3rd Qu.: 0.5074 3rd Qu.: 0.54485 3rd Qu.: 1.1322 3rd Qu.: 0.8146 3rd Qu.: 0.6976 3rd Qu.: 0.96349 A. Morin : 7 Max. : 5.8554 Max. : 1.81127 Max. : 1.4209 Max. : 1.5117 Max. : 1.1355 Max. : 1.67069 (Other) :204 salt sugar sweetener Min. :-1.29018 Min. :-1.17032 Min. :-1.6561 1st Qu.:-0.99587 1st Qu.:-0.79939 1st Qu.:-0.6861 Median : 0.03422 Median :-0.05751 Median :-0.2011 Mean : 0.00000 Mean : 0.00000 Mean : 0.0000 3rd Qu.: 1.06431 3rd Qu.: 0.68437 3rd Qu.: 0.7688 Max. : 1.35862 Max. : 2.16812 Max. : 2.7088 \u0026gt; str(brand.sc) \u0026#39;data.frame\u0026#39;:\t258 obs. of 10 variables: $ brand : Factor w/ 56 levels \u0026#34;A. Morin\u0026#34;,\u0026#34;Altus aka Cao Artisan\u0026#34;,..: 1 1 1 1 1 1 1 2 2 2 ... $ cocoa_percent : num -0.315 -0.315 -0.315 -0.315 -0.315 ... $ rating : num 1.811 1.178 0.545 -1.355 0.545 ... $ counts_of_ingredients: num -0.888 -1.177 -0.888 -1.177 -1.177 ... $ cocoa_butter : num -0.58 -1.625 -0.928 0.118 -1.625 ... $ vanilla : num 0.26 -1.49 -1.05 1.14 -1.05 ... $ organic : num 0.963 0.61 1.317 0.963 0.963 ... $ salt : num -0.996 -1.29 -0.996 -0.702 -1.29 ... $ sugar : num 1.7972 -1.1703 1.7972 -0.0575 1.7972 ... $ sweetener : num 1.254 -1.656 0.284 0.284 2.224 ... \u0026gt; cor(brand.sc[,2:10]) cocoa_percent rating counts_of_ingredients cocoa_butter vanilla organic salt sugar sweetener cocoa_percent 1.000000000 -0.052546644 0.07123417 0.077370649 -0.02206531 -0.04113143 0.17036000 -0.03957938 0.003483658 rating -0.052546644 1.000000000 0.01437280 0.005272191 -0.09133055 0.04277047 -0.04554864 0.03054233 0.003668166 counts_of_ingredients 0.071234169 0.014372799 1.00000000 0.711183570 0.05157357 -0.57011292 0.72006935 -0.10961457 -0.106926187 cocoa_butter 0.077370649 0.005272191 0.71118357 1.000000000 -0.02054327 -0.50977572 0.74932496 -0.13708717 -0.040725138 vanilla -0.022065307 -0.091330547 0.05157357 -0.020543269 1.00000000 0.08983402 -0.00917223 0.07187530 0.111933243 organic -0.041131426 0.042770467 -0.57011292 -0.509775721 0.08983402 1.00000000 -0.61074144 0.10206892 0.091787605 salt 0.170360004 -0.045548635 0.72006935 0.749324961 -0.00917223 -0.61074144 1.00000000 -0.13863007 -0.134994219 sugar -0.039579384 0.030542330 -0.10961457 -0.137087169 0.07187530 0.10206892 -0.13863007 1.00000000 0.629589888 sweetener 0.003483658 0.003668166 -0.10692619 -0.040725138 0.11193324 0.09178760 -0.13499422 0.62958989 1.000000000 \u0026gt; corrplot(cor(brand.sc[,2:10]), order = \u0026#34;hclust\u0026#34;) {% asset_image final_9.png %}\norganic un-related with countsOfIngredientsã€cocoaButter and salt salt related with countsOfIngredients and cocoaButter\n1.2.3 Mean rating by brand 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 \u0026gt; brand.mean \u0026lt;- aggregate(. ~ brand, data=brand.sc, mean) \u0026gt; brand.mean brand cocoa_percent rating counts_of_ingredients cocoa_butter vanilla organic salt sugar sweetener 1 A. Morin -0.521000636 0.63531027 -1.05328377 -0.7786981 -0.36588308 0.76143373 -1.03791178 0.84334011 0.283849693 2 Altus aka Cao Artisan -1.857983139 -1.19646594 -0.81617505 -1.6251343 -0.06873946 0.69829093 -1.21660078 0.22069385 0.041355584 3 Ambrosia -0.366733424 0.06994724 -0.88833857 -1.0152024 -0.28768739 1.05189065 -1.14302296 -0.61391709 -0.686126742 4 Amedei -0.109621404 -0.59491968 -0.77287693 -0.6492432 0.34726159 0.96349072 -0.93700505 0.38761604 1.156828484 5 Arete -0.253604135 0.67149350 -1.06153103 -0.9629225 0.25968242 0.68061094 -1.08416070 -0.28007272 -0.007143237 6 Bonnat 0.198913020 1.17805877 -1.03266562 -0.8409361 -0.39716135 1.05189065 -1.06944513 0.03522475 0.162602639 7 Brasstown aka It\u0026#39;s Chocolate -0.191897250 0.92477613 -1.11926184 -0.7886562 0.43484076 0.89277077 -0.99586731 0.01667784 0.574842623 8 Brazen -0.315311020 -0.56325935 -1.03266562 -0.8409361 0.04073450 0.52149106 -1.14302296 -0.15024435 -0.443632633 9 Bright -0.041058199 0.12271446 -1.08077463 -1.2766018 -1.34593569 1.31709044 -1.19207484 1.67353512 0.607175171 10 Burnt Fork Bend -0.726690252 -0.51049213 -0.88833857 -0.3471816 -0.76207456 0.84562414 -0.99586731 0.18978233 -0.686126742 11 Cacao de Origen 0.507447444 -0.40495770 -1.06153103 -1.1023355 -0.17821343 1.06957063 -1.14302296 0.16505312 0.332348515 12 Castronovo -0.212466212 0.06994724 -1.17699266 -0.5795367 -0.17821343 1.14029058 -0.99586731 0.31342840 0.283849693 13 Chocolarder -0.109621404 -1.51306923 -1.10482914 -0.3181373 0.58810431 1.22869051 -0.84871166 0.31342840 0.283849693 14 Chocolate Con Amor -0.058199000 -0.56325935 -0.96050209 -0.1438710 0.25968242 0.87509079 -0.84871166 0.68436660 0.041355584 15 Chocolate Makers 1.227361100 0.54485218 -1.03266562 -1.6251343 0.69757827 0.96349072 -1.29017861 -1.17032439 -0.686126742 16 Domori -0.315311020 1.17805877 -0.88833857 -1.2766018 0.47863035 0.60989099 -0.99586731 0.31342840 0.041355584 17 Dormouse 0.850263471 -0.93262986 -1.08077463 -1.2766018 0.40564770 0.37415785 -1.09397107 -0.67574013 -0.201138524 18 Durci -0.315311020 0.75592104 -0.79212054 -0.9861580 -0.03224814 0.96349072 -1.14302296 1.24077389 0.930500649 19 East Van Roasters -0.315311020 0.54485218 -1.08077463 -1.1604242 0.84354355 0.84562414 -1.09397107 0.06613627 0.283849693 20 Fossa 0.044645808 -0.40495770 -0.74401152 -0.9280692 0.36915638 0.87509079 -0.92228948 0.59163205 0.283849693 21 Franceschi -0.109621404 -0.17881249 -1.05328377 -0.8782789 -0.05310033 1.21606195 -1.03791178 0.31342840 0.075997600 22 Fresco -0.178184609 0.22824889 -0.16670333 -0.6957142 0.18669978 -0.27410831 0.03422224 0.37525143 -0.524464002 23 Georgia Ramon 0.370321033 0.12271446 0.84358600 0.6403272 0.69757827 -0.92237447 0.67189673 0.37525143 -0.039475785 24 Habitual 0.164631417 -0.61602657 0.60304092 0.5241497 0.40564770 -0.33304160 0.77000049 0.18978233 0.283849693 25 hexx 0.070357010 -0.87986264 0.41060485 0.2917947 0.09547148 -0.62770803 0.36532246 -0.24297890 0.405096747 26 Hogarth 0.233194623 -0.29942327 0.89169501 0.5822385 0.40564770 -0.21517503 0.42663731 -0.11933283 0.203018324 27 Holy Cacao -0.315311020 0.06994724 0.41060485 0.7274604 0.47863035 -0.71610797 1.13788962 -0.33571345 -0.079891470 28 Johnny Iuzzini 0.219481982 0.41821086 0.84358600 0.2569414 0.60999910 -0.73378795 0.71113823 0.46180368 0.186852050 29 Kto 0.096068212 -0.72156100 0.84358600 0.8145935 0.69757827 -0.59234806 0.59341371 -0.42844799 0.089854406 30 Kyya 0.198913020 -1.14369872 0.55493190 0.5822385 0.69757827 -0.45090817 1.26051933 0.93165873 0.122186954 31 Laia aka Chat-Noir 0.233194623 -0.93262986 0.65114993 0.3498834 0.25968242 -0.92237447 0.86810426 1.05530479 0.768837910 32 Letterpress -0.315311020 0.75592104 -0.11859432 0.4660610 0.69757827 -0.09730845 0.96620803 -0.30480193 0.283849693 33 Mana 0.507447444 -1.77690531 0.26627781 0.1175284 0.11371714 -0.92237447 0.47568919 0.06613627 -0.201138524 34 Map Chocolate -0.521000636 0.33378332 0.50682289 0.2917947 0.25968242 -0.98130776 0.32853354 -0.42844799 0.122186954 35 Maverick -0.315311020 0.06994724 1.06007657 0.9888598 0.47863035 -0.98130776 0.54926702 0.22069385 -0.079891470 36 Mike \u0026amp; Becky -0.315311020 -0.51049213 0.07384175 0.8145935 0.69757827 -0.92237447 0.08327413 -0.18115586 0.283849693 37 Milton -0.315311020 0.86145548 1.42089418 0.4660610 0.47863035 0.07949141 0.32853354 0.68436660 0.041355584 38 Naive 0.198913020 -1.03816429 0.84358600 0.8145935 0.47863035 -0.62770803 1.35862310 -0.42844799 -0.443632633 39 Nibble 0.096068212 -1.35476759 0.77142247 0.7274604 0.25968242 -0.89290783 0.99073397 0.03522475 -0.079891470 40 Nuance -0.315311020 -0.08835441 1.34873066 0.3789278 0.36915638 -1.06970769 0.10780007 -0.24297890 0.405096747 41 Pacari -0.315311020 0.86145548 1.42089418 0.9017266 0.58810431 -0.80450790 0.99073397 0.68436660 -0.201138524 42 Palette de Bine 0.541729047 -0.29942327 0.55493190 0.4079722 0.55161299 -0.39197489 1.06431180 0.49889750 0.688006541 43 Pangea 0.576010649 0.12271446 1.22845812 1.0469485 0.40564770 -0.80450790 0.47568919 -0.18115586 0.122186954 44 Pralus 0.713137060 -0.24665605 0.91574952 0.7274604 0.58810431 -0.36250824 0.40211137 -0.15024435 0.041355584 45 Pump Street Bakery 0.987389881 -0.40495770 -0.02237629 0.8145935 -0.98102248 -0.21517503 0.96620803 -0.42844799 -0.281969894 46 Pura Delizia -0.521000636 0.54485218 -0.59968447 0.4660610 -1.49190097 -0.45090817 0.47568919 -0.24297890 -0.201138524 47 Qantu -0.315311020 0.33378332 -0.11859432 0.9307710 -0.17821343 -0.45090817 1.16241556 -0.42844799 -0.039475785 48 Sirene 1.712200909 0.63531027 0.80234970 0.5158513 -0.67866582 -0.34987968 0.72795602 -0.42844799 -0.478274648 49 Smooth Chocolator, The -0.469578232 0.78230465 0.33844133 0.8145935 -0.94453116 -0.98130776 0.69642267 -0.70665164 -0.504256160 50 Soma -0.090922348 0.89023759 0.44996678 0.5294305 -0.41706571 0.22414584 0.26164461 -0.66449957 -0.730216579 51 Soul 0.198913020 0.22824889 0.77142247 0.6403272 -1.05400512 -0.89290783 1.06431180 -0.52118254 -0.564879687 52 Szanto Tibor -0.315311020 0.38655053 0.84358600 0.2917947 -0.72558324 -0.89290783 0.62284484 -0.89212074 -0.928620850 53 Taste Artisan 0.713137060 0.33378332 1.22845812 0.6984160 0.25968242 0.37415785 0.77000049 -0.79938619 -0.362801263 54 Terroir -0.178184609 0.22824889 0.55493190 0.5822385 -1.49190097 -0.68664132 0.62284484 -0.30480193 -0.766958111 55 Tribar -0.006776596 -0.08835441 -0.02237629 0.2917947 -0.39716135 -0.98130776 1.21146745 -0.42844799 0.041355584 56 Zak\u0026#39;s -0.829535060 -0.24665605 1.27656714 1.3373923 -1.05400512 -0.71610797 0.77000049 -0.52118254 -0.443632633 \u0026gt; \u0026gt; rownames(brand.mean) \u0026lt;- brand.mean[, 1] \u0026gt; #### Use brand for the row name \u0026gt; brand.mean \u0026lt;- brand.mean [, -1] \u0026gt; brand.mean cocoa_percent rating counts_of_ingredients cocoa_butter vanilla organic salt sugar sweetener A. Morin -0.521000636 0.63531027 -1.05328377 -0.7786981 -0.36588308 0.76143373 -1.03791178 0.84334011 0.283849693 Altus aka Cao Artisan -1.857983139 -1.19646594 -0.81617505 -1.6251343 -0.06873946 0.69829093 -1.21660078 0.22069385 0.041355584 Ambrosia -0.366733424 0.06994724 -0.88833857 -1.0152024 -0.28768739 1.05189065 -1.14302296 -0.61391709 -0.686126742 Amedei -0.109621404 -0.59491968 -0.77287693 -0.6492432 0.34726159 0.96349072 -0.93700505 0.38761604 1.156828484 Arete -0.253604135 0.67149350 -1.06153103 -0.9629225 0.25968242 0.68061094 -1.08416070 -0.28007272 -0.007143237 Bonnat 0.198913020 1.17805877 -1.03266562 -0.8409361 -0.39716135 1.05189065 -1.06944513 0.03522475 0.162602639 Brasstown aka It\u0026#39;s Chocolate -0.191897250 0.92477613 -1.11926184 -0.7886562 0.43484076 0.89277077 -0.99586731 0.01667784 0.574842623 Brazen -0.315311020 -0.56325935 -1.03266562 -0.8409361 0.04073450 0.52149106 -1.14302296 -0.15024435 -0.443632633 Bright -0.041058199 0.12271446 -1.08077463 -1.2766018 -1.34593569 1.31709044 -1.19207484 1.67353512 0.607175171 Burnt Fork Bend -0.726690252 -0.51049213 -0.88833857 -0.3471816 -0.76207456 0.84562414 -0.99586731 0.18978233 -0.686126742 Cacao de Origen 0.507447444 -0.40495770 -1.06153103 -1.1023355 -0.17821343 1.06957063 -1.14302296 0.16505312 0.332348515 Castronovo -0.212466212 0.06994724 -1.17699266 -0.5795367 -0.17821343 1.14029058 -0.99586731 0.31342840 0.283849693 Chocolarder -0.109621404 -1.51306923 -1.10482914 -0.3181373 0.58810431 1.22869051 -0.84871166 0.31342840 0.283849693 Chocolate Con Amor -0.058199000 -0.56325935 -0.96050209 -0.1438710 0.25968242 0.87509079 -0.84871166 0.68436660 0.041355584 Chocolate Makers 1.227361100 0.54485218 -1.03266562 -1.6251343 0.69757827 0.96349072 -1.29017861 -1.17032439 -0.686126742 Domori -0.315311020 1.17805877 -0.88833857 -1.2766018 0.47863035 0.60989099 -0.99586731 0.31342840 0.041355584 Dormouse 0.850263471 -0.93262986 -1.08077463 -1.2766018 0.40564770 0.37415785 -1.09397107 -0.67574013 -0.201138524 Durci -0.315311020 0.75592104 -0.79212054 -0.9861580 -0.03224814 0.96349072 -1.14302296 1.24077389 0.930500649 East Van Roasters -0.315311020 0.54485218 -1.08077463 -1.1604242 0.84354355 0.84562414 -1.09397107 0.06613627 0.283849693 Fossa 0.044645808 -0.40495770 -0.74401152 -0.9280692 0.36915638 0.87509079 -0.92228948 0.59163205 0.283849693 Franceschi -0.109621404 -0.17881249 -1.05328377 -0.8782789 -0.05310033 1.21606195 -1.03791178 0.31342840 0.075997600 Fresco -0.178184609 0.22824889 -0.16670333 -0.6957142 0.18669978 -0.27410831 0.03422224 0.37525143 -0.524464002 Georgia Ramon 0.370321033 0.12271446 0.84358600 0.6403272 0.69757827 -0.92237447 0.67189673 0.37525143 -0.039475785 Habitual 0.164631417 -0.61602657 0.60304092 0.5241497 0.40564770 -0.33304160 0.77000049 0.18978233 0.283849693 hexx 0.070357010 -0.87986264 0.41060485 0.2917947 0.09547148 -0.62770803 0.36532246 -0.24297890 0.405096747 Hogarth 0.233194623 -0.29942327 0.89169501 0.5822385 0.40564770 -0.21517503 0.42663731 -0.11933283 0.203018324 Holy Cacao -0.315311020 0.06994724 0.41060485 0.7274604 0.47863035 -0.71610797 1.13788962 -0.33571345 -0.079891470 Johnny Iuzzini 0.219481982 0.41821086 0.84358600 0.2569414 0.60999910 -0.73378795 0.71113823 0.46180368 0.186852050 Kto 0.096068212 -0.72156100 0.84358600 0.8145935 0.69757827 -0.59234806 0.59341371 -0.42844799 0.089854406 Kyya 0.198913020 -1.14369872 0.55493190 0.5822385 0.69757827 -0.45090817 1.26051933 0.93165873 0.122186954 Laia aka Chat-Noir 0.233194623 -0.93262986 0.65114993 0.3498834 0.25968242 -0.92237447 0.86810426 1.05530479 0.768837910 Letterpress -0.315311020 0.75592104 -0.11859432 0.4660610 0.69757827 -0.09730845 0.96620803 -0.30480193 0.283849693 Mana 0.507447444 -1.77690531 0.26627781 0.1175284 0.11371714 -0.92237447 0.47568919 0.06613627 -0.201138524 Map Chocolate -0.521000636 0.33378332 0.50682289 0.2917947 0.25968242 -0.98130776 0.32853354 -0.42844799 0.122186954 Maverick -0.315311020 0.06994724 1.06007657 0.9888598 0.47863035 -0.98130776 0.54926702 0.22069385 -0.079891470 Mike \u0026amp; Becky -0.315311020 -0.51049213 0.07384175 0.8145935 0.69757827 -0.92237447 0.08327413 -0.18115586 0.283849693 Milton -0.315311020 0.86145548 1.42089418 0.4660610 0.47863035 0.07949141 0.32853354 0.68436660 0.041355584 Naive 0.198913020 -1.03816429 0.84358600 0.8145935 0.47863035 -0.62770803 1.35862310 -0.42844799 -0.443632633 Nibble 0.096068212 -1.35476759 0.77142247 0.7274604 0.25968242 -0.89290783 0.99073397 0.03522475 -0.079891470 Nuance -0.315311020 -0.08835441 1.34873066 0.3789278 0.36915638 -1.06970769 0.10780007 -0.24297890 0.405096747 Pacari -0.315311020 0.86145548 1.42089418 0.9017266 0.58810431 -0.80450790 0.99073397 0.68436660 -0.201138524 Palette de Bine 0.541729047 -0.29942327 0.55493190 0.4079722 0.55161299 -0.39197489 1.06431180 0.49889750 0.688006541 Pangea 0.576010649 0.12271446 1.22845812 1.0469485 0.40564770 -0.80450790 0.47568919 -0.18115586 0.122186954 Pralus 0.713137060 -0.24665605 0.91574952 0.7274604 0.58810431 -0.36250824 0.40211137 -0.15024435 0.041355584 Pump Street Bakery 0.987389881 -0.40495770 -0.02237629 0.8145935 -0.98102248 -0.21517503 0.96620803 -0.42844799 -0.281969894 Pura Delizia -0.521000636 0.54485218 -0.59968447 0.4660610 -1.49190097 -0.45090817 0.47568919 -0.24297890 -0.201138524 Qantu -0.315311020 0.33378332 -0.11859432 0.9307710 -0.17821343 -0.45090817 1.16241556 -0.42844799 -0.039475785 Sirene 1.712200909 0.63531027 0.80234970 0.5158513 -0.67866582 -0.34987968 0.72795602 -0.42844799 -0.478274648 Smooth Chocolator, The -0.469578232 0.78230465 0.33844133 0.8145935 -0.94453116 -0.98130776 0.69642267 -0.70665164 -0.504256160 Soma -0.090922348 0.89023759 0.44996678 0.5294305 -0.41706571 0.22414584 0.26164461 -0.66449957 -0.730216579 Soul 0.198913020 0.22824889 0.77142247 0.6403272 -1.05400512 -0.89290783 1.06431180 -0.52118254 -0.564879687 Szanto Tibor -0.315311020 0.38655053 0.84358600 0.2917947 -0.72558324 -0.89290783 0.62284484 -0.89212074 -0.928620850 Taste Artisan 0.713137060 0.33378332 1.22845812 0.6984160 0.25968242 0.37415785 0.77000049 -0.79938619 -0.362801263 Terroir -0.178184609 0.22824889 0.55493190 0.5822385 -1.49190097 -0.68664132 0.62284484 -0.30480193 -0.766958111 Tribar -0.006776596 -0.08835441 -0.02237629 0.2917947 -0.39716135 -0.98130776 1.21146745 -0.42844799 0.041355584 Zak\u0026#39;s -0.829535060 -0.24665605 1.27656714 1.3373923 -1.05400512 -0.71610797 0.77000049 -0.52118254 -0.443632633 \u0026gt; heatmap.2(as.matrix(brand.mean),main = \u0026#34;Brand attributes\u0026#34;, trace = \u0026#34;none\u0026#34;, key = FALSE, dend = \u0026#34;none\u0026#34; + #turn off some options {% asset_image final_10.png %}\nSome brands related with salt, such as Letterpressã€Qantuã€Pacariã€Kyyaã€Naive\nSome brands related with organic, such as Amedei, Fossa, Castronovo\n1.2.4 Principal component analysis (PCA) using princomp() 1 2 3 4 5 6 7 8 9 10 \u0026gt; brand.pc\u0026lt;- princomp(brand.mean, cor = TRUE) \u0026gt; #We added \u0026#34;cor =TRUE\u0026#34; to use correlation-based one. \u0026gt; summary(brand.pc) Importance of components: Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9 Standard deviation 1.9484877 1.3240155 1.0553760 0.94838484 0.84633623 0.57860956 0.41928231 0.37770849 0.259982952 Proportion of Variance 0.4218449 0.1947797 0.1237576 0.09993709 0.07958722 0.03719878 0.01953307 0.01585152 0.007510126 Cumulative Proportion 0.4218449 0.6166246 0.7403822 0.84031927 0.91990650 0.95710528 0.97663835 0.99248987 1.000000000 \u0026gt; plot(brand.pc,type=\u0026#34;l\u0026#34;) # scree plot {% asset_image final_11.png %}\nThe elbow occurs at component three. This suggests that the first two components explain most of the variation in the observed brand rating.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 \u0026gt; loadings(brand.pc) # pc loadings Loadings: Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9 cocoa_percent 0.121 0.765 0.271 0.553 rating -0.329 -0.242 0.903 counts_of_ingredients 0.466 0.144 0.133 0.274 -0.149 0.748 -0.283 cocoa_butter 0.477 -0.140 -0.122 -0.595 -0.185 0.579 vanilla 0.502 0.376 0.207 -0.686 0.230 -0.185 organic -0.471 0.131 0.102 -0.778 -0.359 salt 0.484 0.106 0.107 -0.557 -0.649 sugar -0.215 0.482 -0.384 0.416 0.593 -0.151 0.113 sweetener -0.190 0.596 -0.134 0.202 0.137 -0.700 0.183 Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9 SS loadings 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 Proportion Var 0.111 0.111 0.111 0.111 0.111 0.111 0.111 0.111 0.111 Cumulative Var 0.111 0.222 0.333 0.444 0.556 0.667 0.778 0.889 1.000 \u0026gt; brand.pc$scores # the principal components Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9 A. Morin -2.6821054 -0.082708580 -1.40994821 0.570725489 0.49085251 0.18338461 0.117281714 -0.138449624 0.222125496 Altus aka Cao Artisan -2.9741352 -0.051591141 -1.85995919 -2.563339244 -1.66300987 0.13097903 0.303201868 0.526449188 -0.685437305 Ambrosia -1.9137525 -2.368899919 0.43991523 -0.678527355 -0.77889642 0.36199971 -0.253511595 0.148898733 -0.152691868 Amedei -2.5823723 1.971553363 0.06548182 -0.167118353 0.21991151 -1.30388873 -0.375674781 0.417123292 -0.136679953 Arete -2.1702056 -0.945790574 0.23190842 0.654926657 -0.90339862 -0.27205032 0.180399208 -0.080326426 0.100535236 Bonnat -2.4005578 -1.197899532 0.06190293 1.469628715 0.58042613 -0.38552569 -0.087080145 0.039968656 0.074068756 Brasstown aka It\u0026#39;s Chocolate -2.5497691 0.133527483 -0.04061230 1.395805810 -0.61251377 -0.84180356 -0.089560874 -0.144162160 0.067272450 Brazen -1.8184009 -1.005611722 0.43555261 -1.230147922 -0.63002787 0.45912632 0.170468440 -0.064477406 0.311590190 Bright -3.7037423 0.414163869 -1.63190725 0.102700490 2.86213684 0.36906420 0.152388138 0.310865000 -0.197363762 Burnt Fork Bend -1.6625728 -1.709402032 -0.88207876 -1.644843428 0.11059053 0.87662539 -0.500865703 -0.110214495 0.338455701 Cacao de Origen -2.5921821 0.055824774 1.09974476 -0.257029615 0.95579544 -0.36550650 0.021096186 0.264035914 -0.075674123 Castronovo -2.5325352 -0.126752242 -0.25831283 -0.004046483 0.33156085 -0.30554860 -0.467607448 -0.168878318 0.136666647 Chocolarder -2.2207668 1.307802587 0.85864663 -1.705624676 -0.19506501 -0.01428509 -0.914520915 -0.321239544 0.159779149 Chocolate Con Amor -1.9007761 0.670491949 0.11709196 -0.620348573 0.29421634 0.61769812 -0.560130738 -0.436771908 0.551468923 Chocolate Makers -1.8579245 -2.204259441 3.65327660 0.944749264 -0.79385429 0.31025351 0.457780690 0.080184237 -0.112091537 Domori -2.4717189 -0.418555050 -0.30112024 1.476626951 -0.84493987 0.44418967 0.556201865 -0.176971531 -0.065225214 Dormouse -1.6163747 -0.573790680 2.78616294 -0.984778126 -0.16073317 -0.22828856 0.696346544 0.154284014 0.109237073 Durci -3.2467009 1.366316064 -1.36938755 1.343686021 0.79119360 -0.14124389 0.102989715 0.247099878 -0.003073146 East Van Roasters -2.6837728 0.239396951 0.28472215 0.845396828 -1.26174552 -0.10762521 0.162505518 -0.184706997 -0.053798374 Fossa -2.3465473 0.884673550 0.38912206 -0.217906869 0.17706864 0.37032870 -0.012113749 0.052158396 -0.059241914 Franceschi -2.5865116 -0.208023319 0.17214188 -0.311579190 0.23054852 0.18080777 -0.351825508 -0.065850200 -0.063028223 Fresco -0.3431384 -0.507481093 -0.23229647 0.070751997 -0.33561536 1.27981256 0.841690012 -0.383017742 -0.156670600 Georgia Ramon 1.6232155 1.150676748 0.26498134 0.776042896 -0.08787525 0.73021028 0.360040767 -0.145401030 0.344721165 Habitual 1.0620088 1.408417040 0.20679968 -0.256329143 0.14603119 -0.09654839 -0.199263082 -0.042347238 -0.204890356 hexx 0.8945803 0.986405829 0.27911766 -0.823341471 0.05290067 -0.91137130 0.215896857 0.391037893 -0.053665334 Hogarth 1.1469231 0.888298143 0.44801300 0.146795869 -0.11225173 -0.17267348 -0.413312452 0.421796760 -0.079016305 Holy Cacao 1.7193074 0.226734338 -0.30964828 0.129600701 -0.98426850 -0.25298514 -0.041078309 -0.590556142 -0.164351653 Johnny Iuzzini 1.1253895 1.247567957 -0.14097718 1.171762685 -0.05453896 0.49259097 0.472104322 -0.020333808 -0.091573476 Kto 1.7272265 0.973823067 0.71344746 -0.485155153 -0.79385313 -0.32876367 -0.322610016 0.219131057 0.094206766 Kyya 1.2196443 2.392140992 0.08609881 -0.785365838 0.47176421 0.99700206 -0.064627360 -0.702134952 -0.261062705 Laia aka Chat-Noir 0.8806390 2.923105952 -0.50273622 -0.361966792 1.15349356 -0.04033924 0.617548018 0.031480014 -0.089609639 Letterpress 0.6051745 0.398736717 -0.33394102 1.207590405 -1.13574976 -0.76005043 -0.322059257 -0.881592716 -0.346321885 Mana 1.2424524 0.909518098 1.17916492 -2.030151126 0.60130333 0.37155938 0.705169097 0.001056193 0.138418715 Map Chocolate 1.1256970 -0.001899391 -0.73005688 0.332513635 -1.15181151 -0.66036279 0.518289540 0.244298956 0.097515381 Maverick 1.8456138 0.805863125 -0.78667732 0.280711960 -0.66679650 0.50954160 0.004065933 0.125501441 0.473074791 Mike \u0026amp; Becky 0.9510565 1.163163024 -0.11474326 -0.450192192 -1.05889582 -0.66072297 0.126707167 -0.134120447 0.814806996 Milton 0.7017978 0.850904718 -1.16300943 1.527503410 -0.35819662 1.14825504 -0.584746995 0.519632202 -0.228518041 Naive 2.4417443 0.319089869 0.92180468 -1.140138484 -0.48419779 0.39789802 -0.287084848 -0.378335636 -0.356746232 Nibble 1.9734880 1.140361527 0.32957158 -1.481479461 0.07908308 0.20080213 0.090557597 -0.062747307 -0.042790815 Nuance 1.4332957 0.986854337 -0.52270722 0.204845388 -0.84737962 -0.60103767 0.416043810 1.168117101 0.091201132 Pacari 1.9470450 0.841192378 -1.30359005 1.428220851 -0.52541881 1.35461573 -0.045551375 -0.117106120 0.063566252 Palette de Bine 0.9298584 2.257452252 0.37466152 0.618514285 0.71206947 -0.35624249 0.067529550 -0.227881300 -0.381700241 Pangea 2.0918919 0.743086202 0.64457687 0.845258973 0.09714474 -0.12746214 -0.154811282 0.523133595 0.462947830 Pralus 1.5025425 0.848741299 1.24672256 0.437250083 0.09124140 0.12844654 -0.313421202 0.312496177 0.232607192 Pump Street Bakery 1.6307924 -1.119099536 1.05475875 -0.464568575 1.97645672 -0.54624494 -0.286472980 -0.427151024 0.025087747 Pura Delizia 0.5045011 -2.031682772 -1.77111102 -0.238237657 0.96235532 -0.92302206 0.202111967 -0.518488381 0.184936862 Qantu 1.4325823 -0.555242055 -0.70143518 0.194149325 -0.26356820 -0.83060181 -0.317473645 -0.896013710 -0.059255689 Sirene 2.0287743 -1.465866212 1.95083466 1.357465166 2.09862837 0.23708772 0.107912320 0.223293081 0.027220665 Smooth Chocolator, The 1.9426612 -2.219944073 -1.28110363 0.197984376 -0.10148814 -0.56237841 0.234920584 -0.116630110 0.250077177 Soma 1.0272560 -2.276609319 -0.13465029 0.682516433 -0.32209432 0.33522067 -0.710966281 0.028455663 -0.046039440 Soul 2.3573617 -1.820518931 -0.34243984 -0.138235420 0.91362197 -0.10331072 0.292826044 0.090846725 -0.195176426 Szanto Tibor 2.1190874 -2.573833100 -0.46454741 -0.315723730 -0.48273243 0.27114066 0.403885143 0.332333083 -0.201129415 Taste Artisan 1.8160636 -0.801618403 1.48053048 0.899555134 -0.11734995 0.13028873 -1.102099959 0.394653864 -0.541862665 Terroir 1.7764533 -2.426405123 -1.13302992 -0.574480808 1.08742023 0.25221874 0.173655136 0.175666615 0.038227332 Tribar 1.5130001 -0.385955737 -0.26682521 -0.265539271 0.26746465 -0.96064380 0.684999665 -0.541489005 -0.348867793 Zak\u0026#39;s 2.5174379 -1.426444229 -1.78790183 -1.117084841 -0.02701300 -0.28062025 -0.678142919 0.633397547 0.043738507 \u0026gt; \u0026gt; biplot(brand.pc, main = \u0026#34;Brand positioning\u0026#34;) {% asset_image final_12.png %}\nIf the brand wants to enhance its differentiation from other brands, brand can focus on balancing the organic and rating aspects. This is more in line with the sustainable development mentioned earlier, and there are fewer brands in this position.\nAnd then, we can use brand.mean or colMeans to calculate the difference distance to target brand.\n1.2.5 move forward Suppose we already have the basis for organic, such as brand Casttronovo. If we want to move forward rating, such as brand Fresco, we should increasing its emphasis on salt, counts_of_ingredients and cocoa_butter. And decrease organic and sweetener.\n1 2 3 \u0026gt; colMeans(brand.mean[c(\u0026#34;Fresco\u0026#34;, \u0026#34;Burnt Fork Bend\u0026#34;, \u0026#34;Pura Delizia\u0026#34;), ]) - brand.mean[\u0026#34;Castronovo\u0026#34;,] cocoa_percent rating counts_of_ingredients cocoa_butter vanilla organic salt sugar sweetener Castronovo -0.2628256 0.01758907 0.6254172 0.3872584 -0.5108785 -1.100088 0.833882 -0.2060768 -0.7544261 1.2.6 Factor analysis using factanal() * 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026gt; nScree(brand.mean) noc naf nparallel nkaiser 1 3 1 3 3 \u0026gt; eigen(cor(brand.mean)) eigen() decomposition $values [1] 3.79660426 1.75301693 1.11381847 0.89943381 0.71628501 0.33478902 0.17579766 0.14266370 0.06759114 $vectors [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [1,] 0.12098228 -0.05345466 0.76473607 -0.27140650 -0.55335160 -0.042715830 -0.083872256 -0.007471336 -0.09439350 [2,] -0.03942608 0.32895808 -0.24216956 -0.90269635 0.08112631 0.003969369 -0.055740640 0.075143751 -0.03707461 [3,] 0.46644017 -0.14377172 -0.07741629 -0.13320854 0.03448633 -0.274086437 0.149381901 -0.747725837 0.28337944 [4,] 0.47713568 -0.09241339 -0.13970215 -0.02062616 -0.07299798 0.121853132 0.595019898 0.184888897 -0.57918020 [5,] -0.01644575 -0.50210677 0.37649227 -0.20692681 0.68649303 -0.230097021 0.034521520 0.185411405 -0.05715541 [6,] -0.47064300 0.09168746 0.13106717 -0.05057970 -0.07718575 -0.101646053 0.778103705 0.009240990 0.35851266 [7,] 0.48412835 -0.10647051 -0.08160011 -0.02823560 -0.10696045 0.059388537 0.008685290 0.557037340 0.64922598 [8,] -0.21518798 -0.48173066 -0.38411284 -0.08077891 -0.41618156 -0.593141261 -0.082256717 0.151363976 -0.11340603 [9,] -0.19005934 -0.59649010 -0.13377738 -0.20151517 -0.13720262 0.699691310 0.004010208 -0.182634411 0.08836494 \u0026gt; brand.fa \u0026lt;- factanal(brand.mean, factors = 2, rotation = \u0026#34;varimax\u0026#34;, scores = \u0026#34;regression\u0026#34;) \u0026gt; \u0026gt; brand.fl\u0026lt;- brand.fa$loadings[, 1:2] \u0026gt; plot(brand.fl,type=\u0026#34;n\u0026#34;) # set up plot \u0026gt; text(brand.fl,labels=names(brand.mean),cex=.7) {% asset_image final_13.png %}\n1 2 3 \u0026gt; brand.fs \u0026lt;- brand.fa$scores \u0026gt; plot(brand.fl,type=\u0026#34;n\u0026#34;) # set up plot \u0026gt; text(brand.fl,labels=rownames(brand.mean),cex=.7) {% asset_image final_14.png %}\n2. Managing Sustainable Competitive Advantage 2.1 Choice-Based Conjoint Analysis 2.1.1 import and check data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 \u0026gt; cbc.df \u0026lt;- read.csv(\u0026#34;5_conjoint.csv\u0026#34;, stringsAsF .... [TRUNCATED] \u0026gt; head(cbc.df, n = 5) Consumer_id Block Choice_id Alternative Choice Origin Manufacture Energy Nuts Tokens Organic Premium Fairtrade Sugar Price 1 1 1 1 1 1 Venezuela Developed Low Nuts only No No Yes Yes High 3 2 1 1 1 2 0 Venezuela UnderDeveloped Low Nuts only Keep \u0026amp; Use No No Yes Low 5 3 1 1 1 3 0 Peru Developing High No Donate Yes No No High 7 4 1 1 2 1 0 Ecuador UnderDeveloped Low Nuts and Fruit Donate Yes No No High 3 5 1 1 2 2 0 Venezuela Developed Low No No No Yes Yes Low 3 Age_Group Gender Salary Education Employment Location_by_region Choco_Consumption Sustainability_Score 1 1 2 1 2 1 1 2 -0.6645 2 1 2 1 2 1 1 2 -0.6645 3 1 2 1 2 1 1 2 -0.6645 4 1 2 1 2 1 1 2 -0.6645 5 1 2 1 2 1 1 2 -0.6645 \u0026gt; summary(cbc.df, digits = 2) Consumer_id Block Choice_id Alternative Choice Origin Manufacture Energy Nuts Min. : 1 Min. :1.0 Min. : 1 Min. :1 Min. :0.00 Ecuador :1902 Developed :1418 High:2356 No :2317 1st Qu.: 95 1st Qu.:3.0 1st Qu.: 473 1st Qu.:1 1st Qu.:0.00 Peru :1506 Developing :2311 Low :3314 Nuts and Fruit:1420 Median :190 Median :4.0 Median : 946 Median :2 Median :0.00 Venezuela:2262 UnderDeveloped:1941 Nuts only :1933 Mean :190 Mean :4.5 Mean : 946 Mean :2 Mean :0.33 3rd Qu.:284 3rd Qu.:6.0 3rd Qu.:1418 3rd Qu.:3 3rd Qu.:1.00 Max. :378 Max. :8.0 Max. :1890 Max. :3 Max. :1.00 Tokens Organic Premium Fairtrade Sugar Price Age_Group Gender Salary Education Employment Donate :1418 No :2664 No :2652 No :2646 High:2670 Min. :2.0 Min. :1.0 Min. :0.0 Min. :0.0 Min. :1.0 Min. : 1.0 Keep \u0026amp; Use:1945 Yes:3006 Yes:3018 Yes:3024 Low :3000 1st Qu.:3.0 1st Qu.:1.0 1st Qu.:1.0 1st Qu.:1.0 1st Qu.:2.0 1st Qu.: 1.0 No :2307 Median :4.0 Median :1.0 Median :2.0 Median :2.0 Median :2.0 Median : 2.0 Mean :4.5 Mean :1.5 Mean :1.6 Mean :2.3 Mean :1.8 Mean : 2.4 3rd Qu.:5.0 3rd Qu.:2.0 3rd Qu.:2.0 3rd Qu.:3.0 3rd Qu.:2.0 3rd Qu.: 3.0 Max. :7.0 Max. :2.0 Max. :2.0 Max. :7.0 Max. :2.0 Max. :10.0 Location_by_region Choco_Consumption Sustainability_Score Min. :1.0 Min. :1 Min. :-3.26 1st Qu.:1.0 1st Qu.:2 1st Qu.:-0.61 Median :1.0 Median :2 Median : 0.14 Mean :1.2 Mean :2 Mean : 0.00 3rd Qu.:1.0 3rd Qu.:2 3rd Qu.: 0.68 Max. :2.0 Max. :2 Max. : 2.04 \u0026gt; str(cbc.df) \u0026#39;data.frame\u0026#39;:\t5670 obs. of 23 variables: $ Consumer_id : int 1 1 1 1 1 1 1 1 1 1 ... $ Block : int 1 1 1 1 1 1 1 1 1 1 ... $ Choice_id : int 1 1 1 2 2 2 3 3 3 4 ... $ Alternative : int 1 2 3 1 2 3 1 2 3 1 ... $ Choice : int 1 0 0 0 0 1 0 0 1 0 ... $ Origin : Factor w/ 3 levels \u0026#34;Ecuador\u0026#34;,\u0026#34;Peru\u0026#34;,..: 3 3 2 1 3 3 1 2 3 1 ... $ Manufacture : Factor w/ 3 levels \u0026#34;Developed\u0026#34;,\u0026#34;Developing\u0026#34;,..: 1 3 2 3 1 2 1 2 3 2 ... $ Energy : Factor w/ 2 levels \u0026#34;High\u0026#34;,\u0026#34;Low\u0026#34;: 2 2 1 2 2 1 2 1 2 1 ... $ Nuts : Factor w/ 3 levels \u0026#34;No\u0026#34;,\u0026#34;Nuts and Fruit\u0026#34;,..: 3 3 1 2 1 2 3 1 2 3 ... $ Tokens : Factor w/ 3 levels \u0026#34;Donate\u0026#34;,\u0026#34;Keep \u0026amp; Use\u0026#34;,..: 3 2 1 1 3 2 3 2 2 1 ... $ Organic : Factor w/ 2 levels \u0026#34;No\u0026#34;,\u0026#34;Yes\u0026#34;: 1 1 2 2 1 1 2 2 1 2 ... $ Premium : Factor w/ 2 levels \u0026#34;No\u0026#34;,\u0026#34;Yes\u0026#34;: 2 1 1 1 2 2 2 1 2 1 ... $ Fairtrade : Factor w/ 2 levels \u0026#34;No\u0026#34;,\u0026#34;Yes\u0026#34;: 2 2 1 1 2 2 2 1 2 2 ... $ Sugar : Factor w/ 2 levels \u0026#34;High\u0026#34;,\u0026#34;Low\u0026#34;: 1 2 1 1 2 1 1 2 2 2 ... $ Price : num 3 5 7 3 3 7 7 4 3 5 ... $ Age_Group : int 1 1 1 1 1 1 1 1 1 1 ... $ Gender : int 2 2 2 2 2 2 2 2 2 2 ... $ Salary : int 1 1 1 1 1 1 1 1 1 1 ... $ Education : int 2 2 2 2 2 2 2 2 2 2 ... $ Employment : int 1 1 1 1 1 1 1 1 1 1 ... $ Location_by_region : int 1 1 1 1 1 1 1 1 1 1 ... $ Choco_Consumption : int 2 2 2 2 2 2 2 2 2 2 ... $ Sustainability_Score: num -0.664 -0.664 -0.664 -0.664 -0.664 ... \u0026gt; cbc.df \u0026lt;- subset(cbc.df, select = -c(Block,Age_Group,Gender,Salary, Education, Employment, Location_by_region, Choco_Consumption, Sustainability_Score)) \u0026gt; head(cbc.df, n = 5) Consumer_id Choice_id Alternative Choice Origin Manufacture Energy Nuts Tokens Organic Premium Fairtrade Sugar Price 1 1 1 1 1 Venezuela Developed Low Nuts only No No Yes Yes High 3 2 1 1 2 0 Venezuela UnderDeveloped Low Nuts only Keep \u0026amp; Use No No Yes Low 5 3 1 1 3 0 Peru Developing High No Donate Yes No No High 7 4 1 2 1 0 Ecuador UnderDeveloped Low Nuts and Fruit Donate Yes No No High 3 5 1 2 2 0 Venezuela Developed Low No No No Yes Yes Low 3 \u0026gt; summary(cbc.df, digits = 2) Consumer_id Choice_id Alternative Choice Origin Manufacture Energy Nuts Tokens Organic Min. : 1 Min. : 1 Min. :1 Min. :0.00 Ecuador :1902 Developed :1418 High:2356 No :2317 Donate :1418 No :2664 1st Qu.: 95 1st Qu.: 473 1st Qu.:1 1st Qu.:0.00 Peru :1506 Developing :2311 Low :3314 Nuts and Fruit:1420 Keep \u0026amp; Use:1945 Yes:3006 Median :190 Median : 946 Median :2 Median :0.00 Venezuela:2262 UnderDeveloped:1941 Nuts only :1933 No :2307 Mean :190 Mean : 946 Mean :2 Mean :0.33 3rd Qu.:284 3rd Qu.:1418 3rd Qu.:3 3rd Qu.:1.00 Max. :378 Max. :1890 Max. :3 Max. :1.00 Premium Fairtrade Sugar Price No :2652 No :2646 High:2670 Min. :2.0 Yes:3018 Yes:3024 Low :3000 1st Qu.:3.0 Median :4.0 Mean :4.5 3rd Qu.:5.0 Max. :7.0 \u0026gt; str(cbc.df) \u0026#39;data.frame\u0026#39;:\t5670 obs. of 14 variables: $ Consumer_id: int 1 1 1 1 1 1 1 1 1 1 ... $ Choice_id : int 1 1 1 2 2 2 3 3 3 4 ... $ Alternative: int 1 2 3 1 2 3 1 2 3 1 ... $ Choice : int 1 0 0 0 0 1 0 0 1 0 ... $ Origin : Factor w/ 3 levels \u0026#34;Ecuador\u0026#34;,\u0026#34;Peru\u0026#34;,..: 3 3 2 1 3 3 1 2 3 1 ... $ Manufacture: Factor w/ 3 levels \u0026#34;Developed\u0026#34;,\u0026#34;Developing\u0026#34;,..: 1 3 2 3 1 2 1 2 3 2 ... $ Energy : Factor w/ 2 levels \u0026#34;High\u0026#34;,\u0026#34;Low\u0026#34;: 2 2 1 2 2 1 2 1 2 1 ... $ Nuts : Factor w/ 3 levels \u0026#34;No\u0026#34;,\u0026#34;Nuts and Fruit\u0026#34;,..: 3 3 1 2 1 2 3 1 2 3 ... $ Tokens : Factor w/ 3 levels \u0026#34;Donate\u0026#34;,\u0026#34;Keep \u0026amp; Use\u0026#34;,..: 3 2 1 1 3 2 3 2 2 1 ... $ Organic : Factor w/ 2 levels \u0026#34;No\u0026#34;,\u0026#34;Yes\u0026#34;: 1 1 2 2 1 1 2 2 1 2 ... $ Premium : Factor w/ 2 levels \u0026#34;No\u0026#34;,\u0026#34;Yes\u0026#34;: 2 1 1 1 2 2 2 1 2 1 ... $ Fairtrade : Factor w/ 2 levels \u0026#34;No\u0026#34;,\u0026#34;Yes\u0026#34;: 2 2 1 1 2 2 2 1 2 2 ... $ Sugar : Factor w/ 2 levels \u0026#34;High\u0026#34;,\u0026#34;Low\u0026#34;: 1 2 1 1 2 1 1 2 2 2 ... $ Price : num 3 5 7 3 3 7 7 4 3 5 ... 1 2 3 4 \u0026gt; xtabs(Choice~Origin, data=cbc.df) Origin Ecuador Peru Venezuela 709 495 686 Ecuador(38%) \u0026gt; Venezuela(36%) \u0026gt; Peru(26%)\n1 2 3 4 \u0026gt; xtabs(Choice~Manufacture, data=cbc.df) Manufacture Developed Developing UnderDeveloped 436 893 561 Developing \u0026gt; UnderDeveloped \u0026gt; Developed\n1 2 3 4 \u0026gt; xtabs(Choice~Energy, data=cbc.df) Energy High Low 922 968 Energy low nearly equals high\n1 2 3 4 \u0026gt; xtabs(Choice~Nuts, data=cbc.df) Nuts No Nuts and Fruit Nuts only 568 520 802 Nuts Only(42%) \u0026gt; No(30%) \u0026gt; with Fruit(28%)\n1 2 3 4 \u0026gt; xtabs(Choice~Tokens, data=cbc.df) Tokens Donate Keep \u0026amp; Use No 532 740 618 Tokens Keep\u0026amp;Use(39%) \u0026gt; No(32%) \u0026gt; Donate(28%)\n1 2 3 4 \u0026gt; xtabs(Choice~Organic, data=cbc.df) Organic No Yes 739 1151 Organic Yes(60%) \u0026gt; No(40%)\n1 2 3 4 \u0026gt; xtabs(Choice~Premium, data=cbc.df) Premium No Yes 394 1496 Premium Yes(80%) \u0026gt; No(20%)\n1 2 3 4 \u0026gt; xtabs(Choice~Fairtrade, data=cbc.df) Fairtrade No Yes 846 1044 Fairtrade Yes(55%) \u0026gt; No(45%)\n1 2 3 4 \u0026gt; xtabs(Choice~Sugar, data=cbc.df) Sugar High Low 1205 685 Sugar High(64%) \u0026gt; Low(36%)\n2.1.2 prepare the data 1 2 3 4 5 6 7 8 9 cbc.df$Origin \u0026lt;- relevel(cbc.df$Origin, ref = \u0026#34;Venezuela\u0026#34;) cbc.df$Manufacture \u0026lt;- relevel(cbc.df$Manufacture, ref = \u0026#34;UnderDeveloped\u0026#34;) cbc.df$Energy \u0026lt;- relevel(cbc.df$Energy, ref = \u0026#34;Low\u0026#34;) cbc.df$Nuts \u0026lt;- relevel(cbc.df$Nuts, ref = \u0026#34;No\u0026#34;) cbc.df$Tokens \u0026lt;- relevel(cbc.df$Tokens, ref = \u0026#34;No\u0026#34;) cbc.df$Organic \u0026lt;- relevel(cbc.df$Organic, ref = \u0026#34;No\u0026#34;) cbc.df$Premium \u0026lt;- relevel(cbc.df$Premium, ref = \u0026#34;No\u0026#34;) cbc.df$Fairtrade \u0026lt;- relevel(cbc.df$Fairtrade, ref = \u0026#34;No\u0026#34;) cbc.df$Sugar \u0026lt;- relevel(cbc.df$Sugar, ref = \u0026#34;Low\u0026#34;) 2.1.3 Multinomial conjoint model estimation with mlogit() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 \u0026gt; cbc.mlogit \u0026lt;- dfidx(cbc.df, choice=\u0026#34;Choice\u0026#34;, + idx=list(c(\u0026#34;Choice_id\u0026#34;, \u0026#34;Consumer_id\u0026#34;), \u0026#34;Alternative\u0026#34;)) \u0026gt; model\u0026lt;-mlogit(Choice ~ 0+Origin+Manufacture+Energy+Nuts+Tokens+Organic+Premium+Fairtrade+Sugar+Price, data=cbc.mlogit) \u0026gt; kable(summary(model)$CoefTable) | | Estimate| Std. Error| z-value| Pr(\u0026gt;\u0026amp;#124;z\u0026amp;#124;)| |:---------------------|----------:|----------:|----------:|------------------:| |OriginEcuador | 0.2265894| 0.0836676| 2.7082082| 0.0067648| |OriginPeru | 0.2194174| 0.0753628| 2.9114832| 0.0035972| |ManufactureDeveloped | 0.0396353| 0.0812293| 0.4879435| 0.6255898| |ManufactureDeveloping | -0.2157812| 0.1743582| -1.2375742| 0.2158740| |EnergyHigh | 0.4153950| 0.1814621| 2.2891551| 0.0220703| |NutsNuts and Fruit | 0.3435879| 0.0820605| 4.1870067| 0.0000283| |NutsNuts only | 0.2629300| 0.0751140| 3.5004111| 0.0004645| |TokensDonate | 0.5203778| 0.0821382| 6.3353922| 0.0000000| |TokensKeep \u0026amp; Use | 0.1345164| 0.0721562| 1.8642397| 0.0622881| |OrganicYes | 0.3947520| 0.0614207| 6.4270217| 0.0000000| |PremiumYes | 1.3982032| 0.0666952| 20.9640710| 0.0000000| |FairtradeYes | 0.4648390| 0.0613058| 7.5822972| 0.0000000| |SugarHigh | 0.6121655| 0.0632706| 9.6753519| 0.0000000| |Price | -0.0824375| 0.0207685| -3.9693491| 0.0000721| Demonstrated that positive value of utility means prefer than reference value, meanwhile negative value indicates that they prefer reference level.\nIn case of the Nuts attribute, customers prefer more nuts, etc.\n2.1.4 Model fit 1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; model.constraint \u0026lt;-mlogit(Choice ~ 0+Nuts, data = cbc.mlogit) \u0026gt; lrtest(model, model.constraint) Likelihood ratio test Model 1: Choice ~ 0 + Origin + Manufacture + Energy + Nuts + Tokens + Organic + Premium + Fairtrade + Sugar + Price Model 2: Choice ~ 0 + Nuts #Df LogLik Df Chisq Pr(\u0026gt;Chisq) 1 14 -1566.0 2 2 -2021.2 -12 910.45 \u0026lt; 2.2e-16 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Means the larger model (our first model) fits the data better. So, we should keep all the variables.\n2.1.5 Interpreting Conjoint Analysis Findings According to mlogit() results, customers prefer:\nHigher energy More Nuts Donate loyalty points with chocolates Be Organic Farmers paid a premium price Faire trade certified Higher sugar Lower price Origin Ecuador or Peru Developed Manufacture We test the prediction for the first six choice sets in the data.\n1 2 3 4 5 6 7 8 9 10 11 \u0026gt; kable(head(predict(model,cbc.mlogit))) | 1| 2| 3| |---------:|---------:|---------:| | 0.6954121| 0.0868465| 0.2177414| | 0.2571232| 0.2116132| 0.5312636| | 0.6276737| 0.0693051| 0.3030212| | 0.3751338| 0.3188902| 0.3059760| | 0.2320737| 0.6858870| 0.0820393| | 0.6530199| 0.2196068| 0.1273733| We can see that, in group 2, choice 3 is more prefered, which means customers may pay more for higher energy and higher nuts and fruit.\nAnd then, Measure the accuracy of prediction across all data:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026gt; predicted_alternative \u0026lt;- apply(predict(model,cbc.mlogit),1,which.max) \u0026gt; selected_alternative \u0026lt;- cbc.mlogit$Alternative[cbc.mlogit$Choice\u0026gt;0] \u0026gt; confusionMatrix(table(predicted_alternative,selected_alternative),positive = \u0026#34;1\u0026#34;) Confusion Matrix and Statistics selected_alternative predicted_alternative 1 2 3 1 315 104 102 2 142 705 140 3 102 61 219 Overall Statistics Accuracy : 0.6556 95% CI : (0.6336, 0.677) No Information Rate : 0.4603 P-Value [Acc \u0026gt; NIR] : \u0026lt; 2.2e-16 Kappa : 0.4522 Mcnemar\u0026#39;s Test P-Value : 4.785e-08 Statistics by Class: Class: 1 Class: 2 Class: 3 Sensitivity 0.5635 0.8103 0.4751 Specificity 0.8452 0.7235 0.8859 Pos Pred Value 0.6046 0.7143 0.5733 Neg Pred Value 0.8218 0.8173 0.8395 Prevalence 0.2958 0.4603 0.2439 Detection Rate 0.1667 0.3730 0.1159 Detection Prevalence 0.2757 0.5222 0.2021 Balanced Accuracy 0.7044 0.7669 0.6805 If the predictions were random, the accuracy would be 33.3% (for three alternatives). Our simple model is doing much better than that â€“ although it is not perfect.\n2.2 Willingness to pay 2.2.1 What is the Nuts\u0026rsquo; value 1 2 3 \u0026gt; (coef(model)[\u0026#34;NutsNuts and Fruit\u0026#34;]-coef(model)[\u0026#34;NutsNuts only\u0026#34;]) / (-coef(model)[\u0026#34;Price\u0026#34;]) NutsNuts and Fruit 0.9784127 The dollar value of an upgrade from Nuts only to Nuts and Fruit.\n2.2.2 Willingness to Pay for an Attribute Upgrade 1 2 3 \u0026gt; coef(model)[\u0026#34;NutsNuts and Fruit\u0026#34;] / (-coef(model)[\u0026#34;Price\u0026#34;]) NutsNuts and Fruit 4.167859 The dollar value of an upgrade from No Nuts to Nuts and Fruit (No Nuts is reference level. Hence its coeff is 0)\n1 2 3 \u0026gt; coef(model)[\u0026#34;EnergyHigh\u0026#34;] / (-coef(model)[\u0026#34;Price\u0026#34;]) EnergyHigh 5.038907 The dollar value of an upgrade from Energy Low to Energy High (Energy Low is reference level. Hence its coeff is 0)\n2.3 Market Basket 2.3.1 Retail Transaction Data: Groceries 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 \u0026gt; retail.raw \u0026lt;- readLines(\u0026#34;6_groceries.dat\u0026#34;) \u0026gt; head(retail.raw) [1] \u0026#34;fruit, semi-finished bread, margarine, ready soups\u0026#34; \u0026#34;crisps and nuts, yogurt, coffee\u0026#34; [3] \u0026#34;whole milk\u0026#34; \u0026#34;pip fruit, yogurt, cream cheese, meat spreads\u0026#34; [5] \u0026#34;milk chocolate, whole milk, condensed milk, dark chocolate\u0026#34; \u0026#34;whole milk, butter, yogurt, rice, abrasive cleaner\u0026#34; \u0026gt; tail(retail.raw) [1] \u0026#34;crisps and nuts, milk chocolate, domestic eggs, zwieback, ketchup, soda, dishes\u0026#34; [2] \u0026#34;sausage, chicken, sweet, hamburger meat, fruit, grapes, biscuits and crackers, whole milk, butter, whipped/sour cream, flour, coffee, red/blush wine, salty snack, milk chocolate, hygiene articles, napkins\u0026#34; [3] \u0026#34;cooking milk chocolate\u0026#34; [4] \u0026#34;chicken, fruit, milk chocolate, butter, yogurt, frozen dessert, domestic eggs, bread, rum, cling film/bags\u0026#34; [5] \u0026#34;semi-finished bread, bottled water, soda, bottled beer\u0026#34; [6] \u0026#34;chicken, crisps and nuts, milk chocolate, vinegar, shopping bags\u0026#34; \u0026gt; summary(retail.raw) Length Class Mode 9835 character character \u0026gt; retail.list \u0026lt;- strsplit(retail.raw, \u0026#34;,\u0026#34;) \u0026gt; names(retail.list) \u0026lt;- paste(\u0026#34;Trans\u0026#34;, 1:length(retail.list)) \u0026gt; str(retail.list) List of 9835 $ Trans 1 : chr [1:4] \u0026#34;fruit\u0026#34; \u0026#34; semi-finished bread\u0026#34; \u0026#34; margarine\u0026#34; \u0026#34; ready soups\u0026#34; $ Trans 2 : chr [1:3] \u0026#34;crisps and nuts\u0026#34; \u0026#34; yogurt\u0026#34; \u0026#34; coffee\u0026#34; $ Trans 3 : chr \u0026#34;whole milk\u0026#34; $ Trans 4 : chr [1:4] \u0026#34;pip fruit\u0026#34; \u0026#34; yogurt\u0026#34; \u0026#34; cream cheese\u0026#34; \u0026#34; meat spreads\u0026#34; $ Trans 5 : chr [1:4] \u0026#34;milk chocolate\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; condensed milk\u0026#34; \u0026#34; dark chocolate\u0026#34; $ Trans 6 : chr [1:5] \u0026#34;whole milk\u0026#34; \u0026#34; butter\u0026#34; \u0026#34; yogurt\u0026#34; \u0026#34; rice\u0026#34; ... $ Trans 7 : chr \u0026#34;bread\u0026#34; $ Trans 8 : chr [1:5] \u0026#34;milk chocolate\u0026#34; \u0026#34; UHT-milk\u0026#34; \u0026#34; bread\u0026#34; \u0026#34; bottled beer\u0026#34; ... $ Trans 9 : chr \u0026#34;potted plants\u0026#34; $ Trans 10 : chr [1:2] \u0026#34;whole milk\u0026#34; \u0026#34; cereals\u0026#34; $ Trans 11 : chr [1:5] \u0026#34;crisps and nuts\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; white bread\u0026#34; \u0026#34; bottled water\u0026#34; ... $ Trans 12 : chr [1:9] \u0026#34;fruit\u0026#34; \u0026#34; crisps and nuts\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; butter\u0026#34; ... $ Trans 13 : chr \u0026#34;sweet\u0026#34; $ Trans 14 : chr [1:3] \u0026#34;frankfurter\u0026#34; \u0026#34; bread\u0026#34; \u0026#34; soda\u0026#34; $ Trans 15 : chr [1:2] \u0026#34;chicken\u0026#34; \u0026#34; crisps and nuts\u0026#34; $ Trans 16 : chr [1:4] \u0026#34;butter\u0026#34; \u0026#34; sugar\u0026#34; \u0026#34; fruit/vegetable juice\u0026#34; \u0026#34; newspapers\u0026#34; $ Trans 17 : chr \u0026#34;fruit/vegetable juice\u0026#34; $ Trans 18 : chr \u0026#34;packaged fruit/vegetables\u0026#34; $ Trans 19 : chr \u0026#34;milk chocolate\u0026#34; $ Trans 20 : chr \u0026#34;specialty bar\u0026#34; $ Trans 21 : chr \u0026#34;milk chocolate\u0026#34; $ Trans 22 : chr [1:2] \u0026#34;butter milk\u0026#34; \u0026#34; pastry\u0026#34; $ Trans 23 : chr \u0026#34;whole milk\u0026#34; $ Trans 24 : chr [1:5] \u0026#34;crisps and nuts\u0026#34; \u0026#34; cream cheese\u0026#34; \u0026#34; processed cheese\u0026#34; \u0026#34; detergent\u0026#34; ... $ Trans 25 : chr [1:11] \u0026#34;crisps and nuts\u0026#34; \u0026#34; biscuits and crackers\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; frozen dessert\u0026#34; ... $ Trans 26 : chr [1:2] \u0026#34;bottled water\u0026#34; \u0026#34; canned beer\u0026#34; $ Trans 27 : chr \u0026#34;yogurt\u0026#34; $ Trans 28 : chr [1:4] \u0026#34;sausage\u0026#34; \u0026#34; bread\u0026#34; \u0026#34; soda\u0026#34; \u0026#34; milk chocolate\u0026#34; $ Trans 29 : chr \u0026#34;milk chocolate\u0026#34; $ Trans 30 : chr [1:6] \u0026#34;brown bread\u0026#34; \u0026#34; soda\u0026#34; \u0026#34; fruit/vegetable juice\u0026#34; \u0026#34; canned beer\u0026#34; ... $ Trans 31 : chr [1:4] \u0026#34;yogurt\u0026#34; \u0026#34; beverages\u0026#34; \u0026#34; bottled water\u0026#34; \u0026#34; specialty bar\u0026#34; $ Trans 32 : chr [1:7] \u0026#34;hamburger meat\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; bread\u0026#34; \u0026#34; spices\u0026#34; ... $ Trans 33 : chr [1:5] \u0026#34;biscuits and crackers\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; beverages\u0026#34; ... $ Trans 34 : chr [1:8] \u0026#34;beef\u0026#34; \u0026#34; berries\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; whole milk\u0026#34; ... $ Trans 35 : chr [1:3] \u0026#34;sweet\u0026#34; \u0026#34; grapes\u0026#34; \u0026#34; detergent\u0026#34; $ Trans 36 : chr [1:2] \u0026#34;pastry\u0026#34; \u0026#34; soda\u0026#34; $ Trans 37 : chr \u0026#34;fruit/vegetable juice\u0026#34; $ Trans 38 : chr \u0026#34;canned beer\u0026#34; $ Trans 39 : chr [1:4] \u0026#34;biscuits and crackers\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; dessert\u0026#34; $ Trans 40 : chr [1:3] \u0026#34;fruit\u0026#34; \u0026#34; zwieback\u0026#34; \u0026#34; newspapers\u0026#34; $ Trans 41 : chr [1:6] \u0026#34;sausage\u0026#34; \u0026#34; bread\u0026#34; \u0026#34; soda\u0026#34; \u0026#34; canned beer\u0026#34; ... $ Trans 42 : chr [1:13] \u0026#34;crisps and nuts\u0026#34; \u0026#34; biscuits and crackers\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; yogurt\u0026#34; ... $ Trans 43 : chr [1:2] \u0026#34;berries\u0026#34; \u0026#34; yogurt\u0026#34; $ Trans 44 : chr \u0026#34;canned beer\u0026#34; $ Trans 45 : chr [1:8] \u0026#34;butter milk\u0026#34; \u0026#34; yogurt\u0026#34; \u0026#34; cream cheese\u0026#34; \u0026#34; spread cheese\u0026#34; ... $ Trans 46 : chr \u0026#34;coffee\u0026#34; $ Trans 47 : chr [1:2] \u0026#34;pastry\u0026#34; \u0026#34; bottled water\u0026#34; $ Trans 48 : chr \u0026#34;bread\u0026#34; $ Trans 49 : chr \u0026#34;misc. beverages\u0026#34; $ Trans 50 : chr [1:10] \u0026#34;biscuits and crackers\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; butter\u0026#34; \u0026#34; curd\u0026#34; ... $ Trans 51 : chr [1:4] \u0026#34;sausage\u0026#34; \u0026#34; bread\u0026#34; \u0026#34; cat food\u0026#34; \u0026#34; newspapers\u0026#34; $ Trans 52 : chr \u0026#34;canned beer\u0026#34; $ Trans 53 : chr [1:4] \u0026#34;ham\u0026#34; \u0026#34; grapes\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; whole milk\u0026#34; $ Trans 54 : chr [1:10] \u0026#34;turkey\u0026#34; \u0026#34; crisps and nuts\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; curd\u0026#34; ... $ Trans 55 : chr [1:5] \u0026#34;whole milk\u0026#34; \u0026#34; yogurt\u0026#34; \u0026#34; processed cheese\u0026#34; \u0026#34; pickled vegetables\u0026#34; ... $ Trans 56 : chr [1:4] \u0026#34;whole milk\u0026#34; \u0026#34; curd\u0026#34; \u0026#34; yogurt\u0026#34; \u0026#34; pastry\u0026#34; $ Trans 57 : chr [1:3] \u0026#34;packaged fruit/vegetables\u0026#34; \u0026#34; brown bread\u0026#34; \u0026#34; canned beer\u0026#34; $ Trans 58 : chr [1:7] \u0026#34;bread\u0026#34; \u0026#34; oil\u0026#34; \u0026#34; bottled water\u0026#34; \u0026#34; chewing gum\u0026#34; ... $ Trans 59 : chr [1:6] \u0026#34;ham\u0026#34; \u0026#34; sweet\u0026#34; \u0026#34; whipped/sour cream\u0026#34; \u0026#34; ice cream\u0026#34; ... $ Trans 60 : chr [1:3] \u0026#34;bread\u0026#34; \u0026#34; pastry\u0026#34; \u0026#34; sugar\u0026#34; $ Trans 61 : chr [1:7] \u0026#34;milk chocolate\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; frozen vegetables\u0026#34; \u0026#34; canned fish\u0026#34; ... $ Trans 62 : chr [1:2] \u0026#34;sausage\u0026#34; \u0026#34; pastry\u0026#34; $ Trans 63 : chr [1:3] \u0026#34;sausage\u0026#34; \u0026#34; sweet\u0026#34; \u0026#34; whole milk\u0026#34; $ Trans 64 : chr [1:5] \u0026#34;frankfurter\u0026#34; \u0026#34; crisps and nuts\u0026#34; \u0026#34; bread\u0026#34; \u0026#34; brown bread\u0026#34; ... $ Trans 65 : chr [1:3] \u0026#34;bread\u0026#34; \u0026#34; pastry\u0026#34; \u0026#34; soda\u0026#34; $ Trans 66 : chr \u0026#34;whole milk\u0026#34; $ Trans 67 : chr [1:2] \u0026#34;curd cheese\u0026#34; \u0026#34; coffee\u0026#34; $ Trans 68 : chr [1:2] \u0026#34;red/blush wine\u0026#34; \u0026#34; newspapers\u0026#34; $ Trans 69 : chr [1:3] \u0026#34;sausage\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; curd\u0026#34; $ Trans 70 : chr [1:8] \u0026#34;crisps and nuts\u0026#34; \u0026#34; pip fruit\u0026#34; \u0026#34; berries\u0026#34; \u0026#34; whole milk\u0026#34; ... $ Trans 71 : chr \u0026#34;red/blush wine\u0026#34; $ Trans 72 : chr [1:7] \u0026#34;whole milk\u0026#34; \u0026#34; butter\u0026#34; \u0026#34; margarine\u0026#34; \u0026#34; specialty fat\u0026#34; ... $ Trans 73 : chr [1:8] \u0026#34;frankfurter\u0026#34; \u0026#34; fruit\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; domestic eggs\u0026#34; ... $ Trans 74 : chr [1:3] \u0026#34;whole milk\u0026#34; \u0026#34; meat spreads\u0026#34; \u0026#34; soda\u0026#34; $ Trans 75 : chr \u0026#34;frozen potato products\u0026#34; $ Trans 76 : chr [1:4] \u0026#34;milk chocolate\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; bread\u0026#34; \u0026#34; sugar\u0026#34; $ Trans 77 : chr [1:5] \u0026#34;fruit\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; curd\u0026#34; \u0026#34; butter milk\u0026#34; ... $ Trans 78 : chr [1:5] \u0026#34;flour\u0026#34; \u0026#34; salt\u0026#34; \u0026#34; bottled water\u0026#34; \u0026#34; fruit/vegetable juice\u0026#34; ... $ Trans 79 : chr [1:4] \u0026#34;sugar\u0026#34; \u0026#34; bottled water\u0026#34; \u0026#34; soda\u0026#34; \u0026#34; bottled beer\u0026#34; $ Trans 80 : chr [1:2] \u0026#34;frozen meals\u0026#34; \u0026#34; coffee\u0026#34; $ Trans 81 : chr \u0026#34;milk chocolate\u0026#34; $ Trans 82 : chr [1:10] \u0026#34;biscuits and crackers\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; frozen vegetables\u0026#34; \u0026#34; domestic eggs\u0026#34; ... $ Trans 83 : chr [1:4] \u0026#34;biscuits and crackers\u0026#34; \u0026#34; onions\u0026#34; \u0026#34; hard cheese\u0026#34; \u0026#34; frozen vegetables\u0026#34; $ Trans 84 : chr [1:7] \u0026#34;herbs\u0026#34; \u0026#34; condensed milk\u0026#34; \u0026#34; frozen vegetables\u0026#34; \u0026#34; salt\u0026#34; ... $ Trans 85 : chr \u0026#34;bottled water\u0026#34; $ Trans 86 : chr [1:7] \u0026#34;sausage\u0026#34; \u0026#34; biscuits and crackers\u0026#34; \u0026#34; onions\u0026#34; \u0026#34; yogurt\u0026#34; ... $ Trans 87 : chr [1:2] \u0026#34;coffee\u0026#34; \u0026#34; newspapers\u0026#34; $ Trans 88 : chr [1:3] \u0026#34;beef\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; whipped/sour cream\u0026#34; $ Trans 89 : chr [1:2] \u0026#34;berries\u0026#34; \u0026#34; yogurt\u0026#34; $ Trans 90 : chr \u0026#34;soda\u0026#34; $ Trans 91 : chr \u0026#34;berries\u0026#34; $ Trans 92 : chr [1:3] \u0026#34;fruit/vegetable juice\u0026#34; \u0026#34; salty snack\u0026#34; \u0026#34; candles\u0026#34; $ Trans 93 : chr [1:4] \u0026#34;fruit\u0026#34; \u0026#34; butter milk\u0026#34; \u0026#34; yogurt\u0026#34; \u0026#34; cream cheese\u0026#34; $ Trans 94 : chr [1:9] \u0026#34;beef\u0026#34; \u0026#34; hamburger meat\u0026#34; \u0026#34; fruit\u0026#34; \u0026#34; berries\u0026#34; ... $ Trans 95 : chr \u0026#34;detergent\u0026#34; $ Trans 96 : chr [1:2] \u0026#34;grapes\u0026#34; \u0026#34; photo/film\u0026#34; $ Trans 97 : chr [1:9] \u0026#34;sausage\u0026#34; \u0026#34; sliced cheese\u0026#34; \u0026#34; bread\u0026#34; \u0026#34; brown bread\u0026#34; ... $ Trans 98 : chr [1:10] \u0026#34;chicken\u0026#34; \u0026#34; hamburger meat\u0026#34; \u0026#34; fruit\u0026#34; \u0026#34; crisps and nuts\u0026#34; ... $ Trans 99 : chr [1:3] \u0026#34;whole milk\u0026#34; \u0026#34; yogurt\u0026#34; \u0026#34; brown bread\u0026#34; [list output truncated] \u0026gt; \u0026gt; some(retail.list) #note: random sample; your results may vary $`Trans 918` [1] \u0026#34;beef\u0026#34; \u0026#34; fruit\u0026#34; \u0026#34; UHT-milk\u0026#34; \u0026#34; brown bread\u0026#34; \u0026#34; soda\u0026#34; \u0026#34; bottled beer\u0026#34; [7] \u0026#34; canned beer\u0026#34; \u0026#34; dark chocolate\u0026#34; $`Trans 1371` [1] \u0026#34;bottled beer\u0026#34; $`Trans 1563` [1] \u0026#34;bread\u0026#34; $`Trans 2440` [1] \u0026#34;shopping bags\u0026#34; $`Trans 3235` [1] \u0026#34;bottled water\u0026#34; \u0026#34; bottled beer\u0026#34; $`Trans 3260` [1] \u0026#34;frankfurter\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; whole milk\u0026#34; \u0026#34; spread cheese\u0026#34; [5] \u0026#34; sugar\u0026#34; \u0026#34; soda\u0026#34; \u0026#34; bottled beer\u0026#34; \u0026#34; house keeping products\u0026#34; $`Trans 8306` [1] \u0026#34;beef\u0026#34; \u0026#34; sweet\u0026#34; \u0026#34; grapes\u0026#34; \u0026#34; berries\u0026#34; [5] \u0026#34; biscuits and crackers\u0026#34; \u0026#34; milk chocolate\u0026#34; \u0026#34; packaged fruit/vegetables\u0026#34; \u0026#34; yogurt\u0026#34; [9] \u0026#34; newspapers\u0026#34; $`Trans 9069` [1] \u0026#34;berries\u0026#34; \u0026#34; biscuits and crackers\u0026#34; \u0026#34; whipped/sour cream\u0026#34; \u0026#34; soda\u0026#34; $`Trans 9315` [1] \u0026#34;whole milk\u0026#34; $`Trans 9404` [1] \u0026#34;sausage\u0026#34; \u0026#34; bottled water\u0026#34; \u0026#34; canned beer\u0026#34; \u0026#34; hygiene articles\u0026#34; \u0026#34; shopping bags\u0026#34; \u0026gt; retail.trans \u0026lt;- as(retail.list, \u0026#34;transactions\u0026#34;) #takes a few seconds Warning message: In asMethod(object) : removing duplicated items in transactions \u0026gt; summary(retail.trans) transactions as itemMatrix in sparse format with 9835 rows (elements/itemsets/transactions) and 324 columns (items) and a density of 0.01357711 most frequent items: whole milk milk chocolate bread soda yogurt (Other) 1796 1782 1473 1421 1147 35645 element (itemset/transaction) length distribution: sizes 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 2159 1643 1301 1007 854 649 553 433 346 250 178 116 80 73 56 46 27 13 16 10 9 4 4 1 1 27 28 29 32 1 3 1 1 Min. 1st Qu. Median Mean 3rd Qu. Max. 1.000 2.000 3.000 4.399 6.000 32.000 includes extended item information - examples: labels 1 abrasive cleaner 2 artif. sweetener 3 baby cosmetics includes extended transaction information - examples: transactionID 1 Trans 1 2 Trans 2 3 Trans 3 Looking at the summary() of the resulting object, we see that the transaction-by-item matrix is 9,835 rows by 324 columns. Of those 3.1 million intersections, only 1% have positive data (density) because most items are not purchased in most transactions. Item whole milk appears the most frequently and occurs in 1,796 baskets of all transactions. 2,159 of the transactions contain only a single item (â€œsizesâ€ = 1) and the median basket size is 3 items.\n2.3.2 Retail Transaction Data: Groceries We now use apriori(data, parameters = \u0026hellip;) to find association rules with the apriori algorithm. At a conceptual level, the apriori algorithm searches through the item sets that frequently occur in a list of transactions. For each item set, it evaluates the various possible rules that express associations among the items at or above a particular level of support, and then retains the rules that show confidence above some threshold value. To control the extent that apriori() searches, we use the parameter=list() control to instruct the algorithm to search rules that have a minimum support of 0.01 (1% transactions) and extract the ones that further demonstrate a minimum confidence of 0.3. The resulting rules set is assigned to the groc.rules object:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026gt; inspect(head(retail.trans,3)) items transactionID [1] { margarine, ready soups, semi-finished bread, fruit} Trans 1 [2] { coffee, yogurt, crisps and nuts} Trans 2 [3] {whole milk} Trans 3 \u0026gt; # Finding rules \u0026gt; groc.rules \u0026lt;- apriori(retail.trans, parameter = list(supp=0.01, conf=0.3, target=\u0026#34;rules\u0026#34;)) Apriori Parameter specification: confidence minval smax arem aval originalSupport maxtime support minlen maxlen target ext 0.3 0.1 1 none FALSE TRUE 5 0.01 1 10 rules TRUE Algorithmic control: filter tree heap memopt load sort verbose 0.1 TRUE TRUE FALSE TRUE 2 TRUE Absolute minimum support count: 98 set item appearances ...[0 item(s)] done [0.00s]. set transactions ...[324 item(s), 9835 transaction(s)] done [0.01s]. sorting and recoding items ... [97 item(s)] done [0.00s]. creating transaction tree ... done [0.01s]. checking subsets of size 1 2 3 4 done [0.00s]. writing ... [118 rule(s)] done [0.00s]. creating S4 object ... done [0.00s]. \u0026ldquo;sorting and recoding items \u0026hellip; [97 item(s)] done [0.00s].\u0026rdquo;: tells us that the rules found are using 97 of the total number of items. If this number is too small (only a tiny set of your items) or too large (almost all of them), then you might wish to adjust the support and confidence levels.\n\u0026ldquo;writing \u0026hellip; [118 rule(s)] done [0.00s].\u0026rdquo;: Next, check the number of rules found, as indicated on the â€œwriting \u0026hellip;â€ line. In this case, the algorithm found 118 rules. If this number is too low, it suggests the need to lower the support or confidence levels; if it is too high (such as many more rules than items), you might increase the support or confidence levels.\nOnce we have a rule set from apriori(), we use inspect(rules) to examine the association rules. The complete list of 118 from above is too long to examine here, so we select a subset of them with high lift, lift \u0026gt; 3. We find that five of the rules in our set have lift greater than 3.0:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026gt; inspect(subset(groc.rules, lift \u0026gt; 3)) lhs rhs support confidence coverage lift count [1] { sausage} =\u0026gt; {frankfurter} 0.01006609 1.0000000 0.01006609 16.956897 99 [2] {sweet} =\u0026gt; { biscuits and crackers} 0.01006609 0.3256579 0.03091002 4.085262 99 [3] { onions} =\u0026gt; { milk chocolate} 0.01301474 0.5446809 0.02389426 3.006137 128 [4] { fruit} =\u0026gt; { biscuits and crackers} 0.01128622 0.3074792 0.03670564 3.857217 111 [5] { butter, milk chocolate} =\u0026gt; { whole milk} 0.01260803 0.5876777 0.02145399 3.218157 124 [6] { pip fruit, whole milk} =\u0026gt; { milk chocolate} 0.01189629 0.5652174 0.02104728 3.119480 117 [7] { domestic eggs, milk chocolate} =\u0026gt; { whole milk} 0.01230300 0.5654206 0.02175902 3.096276 121 [8] { crisps and nuts, yogurt} =\u0026gt; { whole milk} 0.01047280 0.5953757 0.01759024 3.260312 103 [9] { crisps and nuts, whole milk} =\u0026gt; { yogurt} 0.01047280 0.4186992 0.02501271 3.590154 103 [10] { crisps and nuts, yogurt} =\u0026gt; { milk chocolate} 0.01006609 0.5722543 0.01759024 3.158317 99 [11] { crisps and nuts, milk chocolate} =\u0026gt; { yogurt} 0.01006609 0.3750000 0.02684291 3.215453 99 [12] { crisps and nuts, whole milk} =\u0026gt; { milk chocolate} 0.01372649 0.5487805 0.02501271 3.028763 135 [13] { biscuits and crackers, yogurt} =\u0026gt; { whole milk} 0.01230300 0.5960591 0.02064057 3.264054 121 [14] { biscuits and crackers, yogurt} =\u0026gt; { milk chocolate} 0.01148958 0.5566502 0.02064057 3.072197 113 The first rule tells us that if a transaction contains {sausage} then it is also relatively more likely to contain {frankfurter}. The support shows that the combination appears in 1% of baskets, and the lift shows that the combination is 17Ã— more likely to occur together than one would expect from the individual rates of incidence alone.\nA store might form several insights on the basis of such information. For instance, the store might create a display for frankfurter near the sausage to encourage shoppers who are examining sausage to purchase those frankfurter with them. It might also suggest putting coupons for frankfurter in the sausage area or featuring recipe cards somewhere in the store.\n1 plot(groc.rules) {% asset_image final_15.png %}\nIn that chart, we see that most rules involve item combinations that infrequently occur (that is, they have low support) while confidence is relatively smoothly distributed.\nSimply showing points is not very useful, and a key feature with arulesViz is interactive plotting. In the above figure, there are some rules on the upper left with a high lift. We can use interactive plotting to inspect those rules. To do this, add interactive=TRUE to the plot() command:\n1 plot(groc.rules, engine = \u0026#34;plotly\u0026#34;, interactive=TRUE) {% asset_image final_16.png %}\nOne rule tells us that the combination {crisps and nuts, yogurt} occurs in about 1.0 % of baskets (support=0.0105), and when it occurs, it highly likely includes {whole milk} (confidence= 0.595). The combination occurs 3 times more often than we would expect from the individual incidence rates of {crisps and nuts, yogurt} and {whole milk} considered separately (lift=3.26).\nA common goal in market basket analysis is to find rules with high lift. We can find such rules easily by sorting the larger set of rules by lift. We extract the 15 rules with the highest lift using sort() to order the rules by lift and to take 50 from the head():\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026gt; # Finding and Plotting Subsets of Rules \u0026gt; groc.hi \u0026lt;- head(sort(groc.rules, by=\u0026#34;lift\u0026#34;), 15) \u0026gt; inspect(groc.hi) lhs rhs support confidence coverage lift count [1] { sausage} =\u0026gt; {frankfurter} 0.01006609 1.0000000 0.01006609 16.956897 99 [2] {sweet} =\u0026gt; { biscuits and crackers} 0.01006609 0.3256579 0.03091002 4.085262 99 [3] { fruit} =\u0026gt; { biscuits and crackers} 0.01128622 0.3074792 0.03670564 3.857217 111 [4] { crisps and nuts, whole milk} =\u0026gt; { yogurt} 0.01047280 0.4186992 0.02501271 3.590154 103 [5] { biscuits and crackers, yogurt} =\u0026gt; { whole milk} 0.01230300 0.5960591 0.02064057 3.264054 121 [6] { crisps and nuts, yogurt} =\u0026gt; { whole milk} 0.01047280 0.5953757 0.01759024 3.260312 103 [7] { butter, milk chocolate} =\u0026gt; { whole milk} 0.01260803 0.5876777 0.02145399 3.218157 124 [8] { crisps and nuts, milk chocolate} =\u0026gt; { yogurt} 0.01006609 0.3750000 0.02684291 3.215453 99 [9] { crisps and nuts, yogurt} =\u0026gt; { milk chocolate} 0.01006609 0.5722543 0.01759024 3.158317 99 [10] { pip fruit, whole milk} =\u0026gt; { milk chocolate} 0.01189629 0.5652174 0.02104728 3.119480 117 [11] { domestic eggs, milk chocolate} =\u0026gt; { whole milk} 0.01230300 0.5654206 0.02175902 3.096276 121 [12] { biscuits and crackers, yogurt} =\u0026gt; { milk chocolate} 0.01148958 0.5566502 0.02064057 3.072197 113 [13] { crisps and nuts, whole milk} =\u0026gt; { milk chocolate} 0.01372649 0.5487805 0.02501271 3.028763 135 [14] { onions} =\u0026gt; { milk chocolate} 0.01301474 0.5446809 0.02389426 3.006137 128 [15] { butter, whole milk} =\u0026gt; { milk chocolate} 0.01260803 0.5414847 0.02328419 2.988497 124 Support and lift are identical for an item set regardless of the itemsâ€™ order within a rule (left-hand or right- hand side of the rule). However, confidence reflects direction because it computes the occurrence of the right-hand set conditional on the left-hand side set. A graph display of rules may be useful to seek themes and patterns at a higher level. We chart the top 15 rules byliftwithplot(\u0026hellip; ,method=â€œgraphâ€):\n{% asset_image final_17.png %}\nThe positioning of items on the resulting graph may differ for your system, but the item clusters should be similar. Each circle represents a rule, with inbound arrows coming from items on the left-hand side of the rule and outbound arrows going to the right-hand side. The size (area) of the circle represents the ruleâ€™s support, and shade represents lift (darker indicates higher lift).\n3 Managing Resources Trade-offs 3.1 Selecting Advertising platforms 3.1.1 import and check data 1 2 3 spending.data \u0026lt;- read.csv(\u0026#34;7_advertising.csv\u0026#34;) str(spending.data) plot(spending.data$radio, spending.data$sales) {% asset_image final_18.png %}\n1 plot(spending.data$magazines, spending.data$sales) {% asset_image final_19.png %}\n1 plot(spending.data$social_media, spending.data$sales) {% asset_image final_20.png %}\n1 plot(spending.data$search_ads, spending.data$sales) {% asset_image final_21.png %}\n1 plot(spending.data$tv, spending.data$sales) {% asset_image final_22.png %}\n1 plot(spending.data$newspaper, spending.data$sales) {% asset_image final_23.png %}\n3.1.2 Selecting Advertising platforms 3.1.2.1 line 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026gt; ## line \u0026gt; regression_1 \u0026lt;- lm(sales ~ radio + magazines + social_media + search_ads + tv + newspaper, data=spending.data) \u0026gt; # 83.14% explained \u0026gt; summary(regression_1) Call: lm(formula = sales ~ radio + magazines + social_media + search_ads + tv + newspaper, data = spending.data) Residuals: Min 1Q Median 3Q Max -1389.11 -73.13 43.17 114.90 835.69 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 323.0262 40.8171 7.914 1.9e-13 *** radio 15.2914 1.0354 14.768 \u0026lt; 2e-16 *** magazines -0.5535 3.5231 -0.157 0.875 social_media 1.8449 1.2796 1.442 0.151 search_ads -1.6499 2.0874 -0.790 0.430 tv 4.6694 0.2177 21.447 \u0026lt; 2e-16 *** newspaper 0.7353 0.9618 0.764 0.446 --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 214.3 on 193 degrees of freedom Multiple R-squared: 0.8365,\tAdjusted R-squared: 0.8314 F-statistic: 164.5 on 6 and 193 DF, p-value: \u0026lt; 2.2e-16 3.1.2.2 log 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 \u0026gt; ## log \u0026gt; summary(spending.data$radio) Min. 1st Qu. Median Mean 3rd Qu. Max. 0.04 9.30 22.00 23.23 36.35 79.60 \u0026gt; summary(spending.data$magazines) Min. 1st Qu. Median Mean 3rd Qu. Max. 0.030 1.050 3.420 4.828 6.383 61.160 \u0026gt; summary(spending.data$social_media) Min. 1st Qu. Median Mean 3rd Qu. Max. 0.245 7.050 18.137 22.289 33.523 90.800 \u0026gt; summary(spending.data$search_ads) Min. 1st Qu. Median Mean 3rd Qu. Max. 0.1568 5.6442 11.6133 14.2485 21.4547 50.3014 \u0026gt; summary(spending.data$tv) Min. 1st Qu. Median Mean 3rd Qu. Max. 0.70 74.38 149.75 147.04 218.82 296.40 \u0026gt; summary(spending.data$newspaper) Min. 1st Qu. Median Mean 3rd Qu. Max. 0.30 12.75 25.75 30.55 45.10 114.00 \u0026gt; \u0026gt; regression_2 \u0026lt;- lm(log(sales) ~ log(radio) + log(magazines) + log(social_media) + log(search_ads) + log(tv) + log(newspaper), data=spending.data) \u0026gt; # 90.15% explained \u0026gt; summary(regression_2) Call: lm(formula = log(sales) ~ log(radio) + log(magazines) + log(social_media) + log(search_ads) + log(tv) + log(newspaper), data = spending.data) Residuals: Min 1Q Median 3Q Max -0.53768 -0.08809 -0.01695 0.07090 0.58515 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 5.066700 0.063064 80.342 \u0026lt;2e-16 *** log(radio) 0.143520 0.008449 16.986 \u0026lt;2e-16 *** log(magazines) 0.016958 0.015932 1.064 0.2885 log(social_media) 0.024575 0.015334 1.603 0.1107 log(search_ads) -0.037193 0.016400 -2.268 0.0244 * log(tv) 0.364471 0.013843 26.329 \u0026lt;2e-16 *** log(newspaper) 0.001954 0.017739 0.110 0.9124 --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.13 on 193 degrees of freedom Multiple R-squared: 0.9045,\tAdjusted R-squared: 0.9015 F-statistic: 304.7 on 6 and 193 DF, p-value: \u0026lt; 2.2e-16 3.1.2.3 log better 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026gt; regression \u0026lt;- lm(log(sales) ~ log(radio) + log(tv), data=spending.data) \u0026gt; # 89.93% explained \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ log(radio) + log(tv), data = spending.data) Residuals: Min 1Q Median 3Q Max -0.53810 -0.09115 -0.01295 0.06795 0.58926 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 5.098303 0.050058 101.85 \u0026lt;2e-16 *** log(radio) 0.146733 0.008299 17.68 \u0026lt;2e-16 *** log(tv) 0.356862 0.009271 38.49 \u0026lt;2e-16 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1315 on 197 degrees of freedom Multiple R-squared: 0.9003,\tAdjusted R-squared: 0.8993 F-statistic: 889.6 on 2 and 197 DF, p-value: \u0026lt; 2.2e-16 3.1.3 Allocating Marketing Budget Sum elasticity\n1 0.49 = 0.14 + 0.35 Ratio of elasticity\n1 0.2857 = 0.14 / 0.49 TV of elasticity\n1 0.7143 = 0.35 / 0.49 Obtain elasticities from model\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026gt; mean(spending.data$radio) [1] 23.2297 \u0026gt; mean(spending.data$tv) [1] 147.0425 \u0026gt; mean(spending.data$sales) [1] 1402.25 \u0026gt; \u0026gt; # radio \u0026gt; # A 1% increase in radio advertising results in a 0.26% increase in sales. \u0026gt; 0.143520 * (23.2297 / 1402.25) [1] 0.002377555 \u0026gt; \u0026gt; # tv \u0026gt; # A 1% increase in tv advertising results in a 0.26% increase in sales. \u0026gt; 0.364471 * (147.0425 / 1402.25) [1] 0.0382191 3.1.4 Advertising Carryover Effect We are assumed to retain a 10% of your previous advertising stock.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 \u0026gt; adstock \u0026lt;- function(x, rate){ + return(as.numeric(stats::filter(x=x, filter=rate, method=\u0026#34;recursive\u0026#34;))) + } \u0026gt; \u0026gt; spending.data \u0026lt;- spending.data %\u0026gt;% mutate(tv_adstock = adstock(tv,0.1), + magazines_adstock = adstock(magazines, 0.1), + social_media_adstock = adstock(social_media, 0.1), + search_ads_adstock = adstock(search_ads, 0.1), + newspaper_adstock = adstock(newspaper, 0.1), + radio_adstock = adstock(radio, 0.1)) \u0026gt; \u0026gt; regression_with_stock \u0026lt;- lm(log(sales) ~ log(radio_adstock) + log(magazines_adstock) + log(social_media_adstock) + log(search_ads_adstock) + log(tv_adstock) + log(newspaper_adstock), data=spending.data) \u0026gt; # 90.15% explained \u0026gt; summary(regression_with_stock) Call: lm(formula = log(sales) ~ log(radio_adstock) + log(magazines_adstock) + log(social_media_adstock) + log(search_ads_adstock) + log(tv_adstock) + log(newspaper_adstock), data = spending.data) Residuals: Min 1Q Median 3Q Max -1.08867 -0.06993 0.00508 0.06916 0.53508 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 4.253505 0.098083 43.366 \u0026lt;2e-16 *** log(radio_adstock) 0.186030 0.013809 13.472 \u0026lt;2e-16 *** log(magazines_adstock) 0.010671 0.019567 0.545 0.5861 log(social_media_adstock) 0.018066 0.020384 0.886 0.3766 log(search_ads_adstock) -0.040954 0.022445 -1.825 0.0696 . log(tv_adstock) 0.484510 0.019831 24.432 \u0026lt;2e-16 *** log(newspaper_adstock) 0.009142 0.023393 0.391 0.6964 --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1566 on 193 degrees of freedom Multiple R-squared: 0.8615,\tAdjusted R-squared: 0.8572 F-statistic: 200 on 6 and 193 DF, p-value: \u0026lt; 2.2e-16 \u0026gt; spending.data \u0026lt;- spending.data %\u0026gt;% mutate(tv_adstock = adstock(tv,0.1), + radio_adstock = adstock(radio, 0.1)) \u0026gt; \u0026gt; regression_with_stock \u0026lt;- lm(log(sales) ~ log(radio_adstock) + log(tv_adstock), data=spending.data) \u0026gt; # 85.65% explained \u0026gt; summary(regression_with_stock) Call: lm(formula = log(sales) ~ log(radio_adstock) + log(tv_adstock), data = spending.data) Residuals: Min 1Q Median 3Q Max -1.09358 -0.07401 -0.00318 0.07187 0.59975 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 4.30635 0.08387 51.34 \u0026lt;2e-16 *** log(radio_adstock) 0.18899 0.01318 14.34 \u0026lt;2e-16 *** log(tv_adstock) 0.47064 0.01503 31.30 \u0026lt;2e-16 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.157 on 197 degrees of freedom Multiple R-squared: 0.858,\tAdjusted R-squared: 0.8565 F-statistic: 594.9 on 2 and 197 DF, p-value: \u0026lt; 2.2e-16 3.1.5 Synergy Effect 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 \u0026gt; # synergy effect \u0026gt; center \u0026lt;- function(x) { scale(x, scale = F)} \u0026gt; \u0026gt; regression \u0026lt;- lm(log(sales) ~ log(radio) + log(magazines) + log(social_media) + log(search_ads) + log(tv) + log(newspaper) + log(radio) * log(tv), data=spending.data) \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ log(radio) + log(magazines) + log(social_media) + log(search_ads) + log(tv) + log(newspaper) + log(radio) * log(tv), data = spending.data) Residuals: Min 1Q Median 3Q Max -0.29003 -0.07859 -0.02022 0.04670 0.54257 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 5.880586 0.111464 52.758 \u0026lt; 2e-16 *** log(radio) -0.117384 0.032064 -3.661 0.000325 *** log(magazines) 0.026573 0.013728 1.936 0.054378 . log(social_media) 0.029733 0.013181 2.256 0.025215 * log(search_ads) -0.034111 0.014086 -2.422 0.016386 * log(tv) 0.182792 0.024784 7.375 4.79e-12 *** log(newspaper) -0.007208 0.015271 -0.472 0.637475 log(radio):log(tv) 0.058409 0.006992 8.354 1.30e-14 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1116 on 192 degrees of freedom Multiple R-squared: 0.93,\tAdjusted R-squared: 0.9274 F-statistic: 364.2 on 7 and 192 DF, p-value: \u0026lt; 2.2e-16 \u0026gt; \u0026gt; regression \u0026lt;- lm(log(sales) ~ log(radio) + log(tv) + log(radio) * log(tv), data=spending.data) \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ log(radio) + log(tv) + log(radio) * log(tv), data = spending.data) Residuals: Min 1Q Median 3Q Max -0.29435 -0.07741 -0.02310 0.05873 0.59461 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 5.870204 0.104963 55.926 \u0026lt; 2e-16 *** log(radio) -0.108507 0.032403 -3.349 0.000974 *** log(tv) 0.184361 0.022818 8.080 6.53e-14 *** log(radio):log(tv) 0.057335 0.007097 8.079 6.54e-14 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1142 on 196 degrees of freedom Multiple R-squared: 0.9252,\tAdjusted R-squared: 0.9241 F-statistic: 808.3 on 3 and 196 DF, p-value: \u0026lt; 2.2e-16 \u0026gt; \u0026gt; spending.data \u0026lt;- spending.data %\u0026gt;% mutate(radio_log_centered = center(log(radio)), + tv_log_centered = center(log(tv)), + newspaper_log_centered = center(log(newspaper)), + magazines_log_centered = center(log(magazines)), + social_media_log_centered = center(log(social_media)), + search_ads_log_centered = center(log(search_ads))) \u0026gt; \u0026gt; regression \u0026lt;- lm(log(sales) ~ radio_log_centered + magazines_log_centered + social_media_log_centered + search_ads_log_centered + tv_log_centered + newspaper_log_centered + radio_log_centered * tv_log_centered, data=spending.data) \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ radio_log_centered + magazines_log_centered + social_media_log_centered + search_ads_log_centered + tv_log_centered + newspaper_log_centered + radio_log_centered * tv_log_centered, data = spending.data) Residuals: Min 1Q Median 3Q Max -0.29003 -0.07859 -0.02022 0.04670 0.54257 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 7.169892 0.007894 908.260 \u0026lt; 2e-16 *** radio_log_centered 0.155506 0.007395 21.027 \u0026lt; 2e-16 *** magazines_log_centered 0.026573 0.013728 1.936 0.0544 . social_media_log_centered 0.029733 0.013181 2.256 0.0252 * search_ads_log_centered -0.034111 0.014086 -2.422 0.0164 * tv_log_centered 0.343443 0.012150 28.267 \u0026lt; 2e-16 *** newspaper_log_centered -0.007208 0.015271 -0.472 0.6375 radio_log_centered:tv_log_centered 0.058409 0.006992 8.354 1.3e-14 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1116 on 192 degrees of freedom Multiple R-squared: 0.93,\tAdjusted R-squared: 0.9274 F-statistic: 364.2 on 7 and 192 DF, p-value: \u0026lt; 2.2e-16 \u0026gt; \u0026gt; regression \u0026lt;- lm(log(sales) ~ radio_log_centered + tv_log_centered + radio_log_centered * tv_log_centered, data=spending.data) \u0026gt; summary(regression) Call: lm(formula = log(sales) ~ radio_log_centered + tv_log_centered + radio_log_centered * tv_log_centered, data = spending.data) Residuals: Min 1Q Median 3Q Max -0.29435 -0.07741 -0.02310 0.05873 0.59461 Coefficients: Estimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 7.169879 0.008074 888.050 \u0026lt; 2e-16 *** radio_log_centered 0.159367 0.007374 21.611 \u0026lt; 2e-16 *** tv_log_centered 0.342059 0.008256 41.429 \u0026lt; 2e-16 *** radio_log_centered:tv_log_centered 0.057335 0.007097 8.079 6.54e-14 *** --- Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 Residual standard error: 0.1142 on 196 degrees of freedom Multiple R-squared: 0.9252,\tAdjusted R-squared: 0.9241 F-statistic: 808.3 on 3 and 196 DF, p-value: \u0026lt; 2.2e-16 3.2 Compare groups 3.2.1 import and check data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026gt; ad.df \u0026lt;- read.csv(\u0026#34;8_clickstream.csv\u0026#34;, stringsAsFactors = TRUE) \u0026gt; summary(ad.df) visit_date condition time_spent_homepage_sec clicked_article 13/04/2020: 1045 quality:15000 Min. :46.10 Min. :0.0000 23/04/2020: 1042 taste :15000 1st Qu.:49.32 1st Qu.:0.0000 02/04/2020: 1038 Median :50.00 Median :1.0000 31/03/2020: 1033 Mean :50.00 Mean :0.6054 15/04/2020: 1031 3rd Qu.:50.67 3rd Qu.:1.0000 27/04/2020: 1029 Max. :54.02 Max. :1.0000 (Other) :23782 clicked_like clicked_share Min. :0.0000 Min. :0.00000 1st Qu.:0.0000 1st Qu.:0.00000 Median :0.0000 Median :0.00000 Mean :0.1177 Mean :0.03143 3rd Qu.:0.0000 3rd Qu.:0.00000 Max. :1.0000 Max. :1.00000 \u0026gt; str(ad.df) \u0026#39;data.frame\u0026#39;:\t30000 obs. of 6 variables: $ visit_date : Factor w/ 30 levels \u0026#34;01/04/2020\u0026#34;,\u0026#34;02/04/2020\u0026#34;,..: 30 30 30 30 30 30 30 30 30 30 ... $ condition : Factor w/ 2 levels \u0026#34;quality\u0026#34;,\u0026#34;taste\u0026#34;: 2 2 2 2 2 2 2 2 2 2 ... $ time_spent_homepage_sec: num 49 48.9 49.1 49.3 50.4 ... $ clicked_article : int 1 1 1 0 0 1 1 1 1 0 ... $ clicked_like : int 0 0 0 1 1 0 0 0 0 0 ... $ clicked_share : int 1 0 0 0 0 0 0 0 0 0 ... \u0026gt; ad.df$clicked_article \u0026lt;- factor(ad.df$clicked_article, ordered = FALSE) \u0026gt; ad.df$clicked_like \u0026lt;- factor(ad.df$clicked_like, ordered = FALSE) \u0026gt; ad.df$clicked_share \u0026lt;- factor(ad.df$clicked_share, ordered = FALSE) 3.2.2 Descriptives by group 3.2.2.1 seconds spent vary for two versions of ads. 1 2 3 4 5 \u0026gt; # seconds spent vary for two versions of ads. \u0026gt; aggregate(time_spent_homepage_sec ~ condition, data = ad.df, mean) condition time_spent_homepage_sec 1 quality 49.99489 2 taste 49.99909 3.2.2.2 the frequency with which different combinations of condition and like occur 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026gt; table(ad.df$condition, ad.df$clicked_article) 0 1 quality 5873 9127 taste 5965 9035 \u0026gt; table(ad.df$condition, ad.df$clicked_like) 0 1 quality 13964 1036 taste 12506 2494 \u0026gt; table(ad.df$condition, ad.df$clicked_share) 0 1 quality 14550 450 taste 14507 493 3.2.3 Visualization by group 1 \u0026gt; histogram(~ clicked_article | condition, data = ad.df) {% asset_image final_24.png %}\n1 \u0026gt; histogram(~ clicked_like | condition, data = ad.df) {% asset_image final_25.png %}\n1 \u0026gt; histogram(~ clicked_share | condition, data = ad.df) {% asset_image final_26.png %}\n1 2 \u0026gt; ad.mean \u0026lt;- aggregate(time_spent_homepage_sec ~ condition, data = ad.df, mean) \u0026gt; barchart(time_spent_homepage_sec ~ condition, data = ad.mean, col = \u0026#34;grey\u0026#34;) {% asset_image final_27.png %}\n3.2.4 Statistical tests 3.2.4.1 chisp.test() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 \u0026gt; # chisp.test() \u0026gt; chisq.test(table(ad.df$clicked_article, ad.df$condition)) Pearson\u0026#39;s Chi-squared test with Yates\u0026#39; continuity correction data: table(ad.df$clicked_article, ad.df$condition) X-squared = 1.1555, df = 1, p-value = 0.2824 \u0026gt; chisq.test(table(ad.df$clicked_like, ad.df$condition)) Pearson\u0026#39;s Chi-squared test with Yates\u0026#39; continuity correction data: table(ad.df$clicked_like, ad.df$condition) X-squared = 681.57, df = 1, p-value \u0026lt; 2.2e-16 \u0026gt; chisq.test(table(ad.df$clicked_share, ad.df$condition)) Pearson\u0026#39;s Chi-squared test with Yates\u0026#39; continuity correction data: table(ad.df$clicked_share, ad.df$condition) X-squared = 1.9313, df = 1, p-value = 0.1646 3.2.4.2 t.test() 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026gt; # t.test() \u0026gt; t.test(time_spent_homepage_sec ~ condition, data = ad.df) Welch Two Sample t-test data: time_spent_homepage_sec by condition t = -0.36288, df = 29997, p-value = 0.7167 alternative hypothesis: true difference in means between group quality and group taste is not equal to 0 95 percent confidence interval: -0.02691480 0.01850573 sample estimates: mean in group quality mean in group taste 49.99489 49.99909 3.2.4.3 anova 1 2 3 4 5 6 7 8 \u0026gt; ad.aov.con \u0026lt;- aov(time_spent_homepage_sec ~ condition, data = ad.df) \u0026gt; anova(ad.aov.con) Analysis of Variance Table Response: time_spent_homepage_sec Df Sum Sq Mean Sq F value Pr(\u0026gt;F) condition 1 0.1 0.13259 0.1317 0.7167 Residuals 29998 30204.2 1.00687 ","date":"2023-04-05T00:00:00Z","permalink":"https://MyLoveES.github.io/p/r-final/","title":"R final"},{"content":"ä¸€ã€é¡¹ç›®ç”Ÿæˆ 1. Spring Initializr è®¿é—® Spring Initializr çš„ç½‘ç«™ï¼šhttps://start.spring.io/ é€‰æ‹©è¯­è¨€å’Œ Spring Boot ç‰ˆæœ¬ã€‚é»˜è®¤æ˜¯ Java å’Œæœ€æ–°ç‰ˆæœ¬çš„ Spring Bootã€‚ é€‰æ‹©é¡¹ç›®å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬ Groupã€Artifactã€Nameã€Descriptionã€Package Name ç­‰ä¿¡æ¯ã€‚ é€‰æ‹©é¡¹ç›®ä¾èµ–ï¼Œæ¯”å¦‚ Webã€JPAã€Security ç­‰ã€‚æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©æ‰€éœ€ä¾èµ–ï¼Œå¯ä»¥ä½¿ç”¨æœç´¢æ¡†è¿›è¡Œæœç´¢ã€‚ ç¡®è®¤ä¸Šé¢çš„ä¿¡æ¯éƒ½å¡«å†™æ­£ç¡®åï¼Œç‚¹å‡» Generate æŒ‰é’®ï¼Œå³å¯ç”Ÿæˆä¸€ä¸ªåŸºäº Maven çš„ Spring Boot é¡¹ç›®çš„å‹ç¼©åŒ…ã€‚ ä¸‹è½½è¯¥å‹ç¼©åŒ…ï¼Œå¹¶è§£å‹åˆ°æœ¬åœ°ç£ç›˜ä¸Šã€‚ 2ã€Spring Boot CLI é¦–å…ˆï¼Œä½ éœ€è¦å®‰è£… Spring Boot CLIã€‚ä½ å¯ä»¥å‚è€ƒ Spring Boot å®˜æ–¹æ–‡æ¡£ä¸­çš„å®‰è£…æŒ‡å—ï¼šhttps://docs.spring.io/spring-boot/docs/current/reference/html/getting-started.html#getting-started.installing.cli æ‰“å¼€å‘½ä»¤è¡Œç»ˆç«¯ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªåŸºäº Maven çš„ Spring Boot é¡¹ç›®ï¼š 1 spring init --build maven --groupId=com.weasley --artifactId=file-center --name=file-center --description=\u0026#34;file-center\u0026#34; file-center æ„å¤–æƒ…å†µ Java - Gradle - Springboot ç‰ˆæœ¬ 1 2 3 https://stackoverflow.com/questions/74931848/spring-boot-3-x-upgrade-could-not-resolve-org-springframework-bootspring-boot Go to the settings --\u0026gt; Build, Execution, Deployment --\u0026gt; Build Tools --\u0026gt; Gradle. Click on your gradle project under \u0026#39;Gradle Projects\u0026#39;. Choose your Gradle JVM for the project äºŒã€å­æ¨¡å— 1) submodule-common 1 2 3 1) mkdir submodule-common 2) mkdir -p src/main/java/com/weasley/common 3) mkdir -p src/main/resources 2) submodule-domain 1 2 3 1) mkdir submodule-domain 2) mkdir -p src/main/java/com/weasley/domain 3) mkdir -p src/main/resources 3) submodule-application 1 2 3 1) mkdir submodule-application 2) mkdir -p src/main/java/com/weasley/application 3) mkdir -p src/main/resources 4) submodule-interface 1 2 3 1) mkdir submodule-interface 2) mkdir -p src/main/java/com/weasley/interface 3) mkdir -p src/main/resources 5) submodule-infrastructure 1 2 3 1) mkdir submodule-infrastructure 2) mkdir -p src/main/java/com/weasley/infrastructure 3) mkdir -p src/main/resources 2.1 gradle æ ¹ç›®å½• setting.gradle\n1 2 3 4 5 include \u0026#39;submodule-common\u0026#39; include \u0026#39;submodule-domain\u0026#39; include \u0026#39;submodule-application\u0026#39; include \u0026#39;submodule-interface\u0026#39; include \u0026#39;submodule-infrastructure\u0026#39; æ ¹ç›®å½• build.gradle\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 // å®šä¹‰é¡¹ç›®æ„å»ºæ‰€éœ€çš„ä»“åº“å’Œä¾èµ–é¡¹ // å®šä¹‰é¡¹ç›®æ„å»ºæ‰€éœ€çš„ä»“åº“å’Œä¾èµ–é¡¹ buildscript { repositories { mavenCentral() } dependencies { classpath(\u0026#39;org.springframework.boot:spring-boot-gradle-plugin:3.0.4\u0026#39;) } } plugins { id \u0026#39;java\u0026#39; id \u0026#39;groovy\u0026#39; id \u0026#39;java-library\u0026#39; id \u0026#39;org.springframework.boot\u0026#39; version \u0026#39;3.0.4\u0026#39; id \u0026#39;io.spring.dependency-management\u0026#39; version \u0026#39;1.1.0\u0026#39; } allprojects{ group = \u0026#39;com.weasley\u0026#39; version = \u0026#39;0.0.1-SNAPSHOT\u0026#39; sourceCompatibility = \u0026#39;17\u0026#39; repositories { mavenCentral() } dependencyManagement { imports { mavenBom \u0026#39;org.springframework.boot:spring-boot-dependencies:3.0.4\u0026#39; } } } subprojects { apply plugin: \u0026#39;java\u0026#39; apply plugin: \u0026#39;java-library\u0026#39; apply plugin: \u0026#39;groovy\u0026#39; apply plugin: \u0026#39;org.springframework.boot\u0026#39; apply plugin: \u0026#39;io.spring.dependency-management\u0026#39; dependencies {} tasks.named(\u0026#39;test\u0026#39;) { useJUnitPlatform() } } 2.2 maven 1 mvn archetype:generate -DgroupId=com.weasley -DartifactId=sdk-common -Dversion=1.0.0 -DinteractiveMode=false ä¸‰ã€å¢åŠ é€šç”¨ä¾èµ– 1. spring-boot-devtools 1 developmentOnly \u0026#39;org.springframework.boot:spring-boot-devtools\u0026#39; 2. lombok 1 2 compileOnly \u0026#39;org.projectlombok:lombok:1.18.20\u0026#39; annotationProcessor \u0026#39;org.projectlombok:lombok:1.18.20\u0026#39; 3. spring-boot-configuration-processor 1 annotationProcessor \u0026#34;org.springframework.boot:spring-boot-configuration-processor\u0026#34; 4. validation 1 implementation group: \u0026#39;org.springframework.boot\u0026#39;, name: \u0026#39;spring-boot-starter-validation\u0026#39;, version: \u0026#39;3.0.4\u0026#39; 5. mapstruct 1 2 implementation \u0026#39;org.mapstruct:mapstruct:1.5.3.Final\u0026#39; annotationProcessor \u0026#39;org.mapstruct:mapstruct-processor:1.5.3.Final\u0026#39; 6. knife4j 1 implementation group: \u0026#39;com.github.xiaoymin\u0026#39;, name: \u0026#39;knife4j-openapi3-jakarta-spring-boot-starter\u0026#39;, version: \u0026#39;4.0.0\u0026#39; 7. mybatis plus 1 2 3 4 implementation group: \u0026#39;com.baomidou\u0026#39;, name: \u0026#39;mybatis-plus-boot-starter\u0026#39;, version: \u0026#39;3.5.3.1\u0026#39; implementation group: \u0026#39;com.baomidou\u0026#39;, name: \u0026#39;mybatis-plus-generator\u0026#39;, version: \u0026#39;3.5.3.1\u0026#39; implementation group: \u0026#39;org.freemarker\u0026#39;, name: \u0026#39;freemarker\u0026#39;, version: \u0026#39;2.3.31\u0026#39; implementation group: \u0026#39;mysql\u0026#39;, name: \u0026#39;mysql-connector-java\u0026#39;, version: \u0026#39;8.0.32\u0026#39; 8. spock 1 2 testImplementation group: \u0026#39;org.spockframework\u0026#39;, name: \u0026#39;spock-core\u0026#39;, version: \u0026#39;2.3-groovy-4.0\u0026#39; testImplementation group: \u0026#39;org.spockframework\u0026#39;, name: \u0026#39;spock-spring\u0026#39;, version: \u0026#39;2.3-groovy-4.0\u0026#39; 9. h2 1 testImplementation group: \u0026#39;com.h2database\u0026#39;, name: \u0026#39;h2\u0026#39;, version: \u0026#39;2.1.214\u0026#39; 10. embedded-redis 1 2 3 testImplementation (group: \u0026#39;it.ozimov\u0026#39;, name: \u0026#39;embedded-redis\u0026#39;, version: \u0026#39;0.7.3\u0026#39;) { exclude group: \u0026#39;org.slf4j\u0026#39;, module: \u0026#39;slf4j-simple\u0026#39; } 11. actuator 1 implementation group: \u0026#39;org.springframework.boot\u0026#39;, name: \u0026#39;spring-boot-starter-actuator\u0026#39;, version: \u0026#39;3.0.5\u0026#39; 12. redission 1 implementation group: \u0026#39;org.redisson\u0026#39;, name: \u0026#39;redisson-spring-boot-starter\u0026#39;, version: \u0026#39;3.20.0\u0026#39; 13. caffeine 1 implementation group: \u0026#39;com.github.ben-manes.caffeine\u0026#39;, name: \u0026#39;caffeine\u0026#39;, version: \u0026#39;3.1.5\u0026#39; 14. hutool-core 1 2 implementation group: \u0026#39;cn.hutool\u0026#39;, name: \u0026#39;hutool-core\u0026#39;, version: \u0026#39;5.8.15\u0026#39; implementation group: \u0026#39;cn.hutool\u0026#39;, name: \u0026#39;hutool-extra\u0026#39;, version: \u0026#39;5.8.16\u0026#39; 15. minio 1 implementation group: \u0026#39;io.minio\u0026#39;, name:\u0026#39;minio\u0026#39;, version: \u0026#39;8.4.3\u0026#39; 16. vavr 1 implementation group: \u0026#39;io.vavr\u0026#39;, name: \u0026#39;vavr\u0026#39;, version: \u0026#39;0.10.4\u0026#39; 17. apm 1 implementation group: \u0026#39;org.apache.skywalking\u0026#39;, name: \u0026#39;apm-toolkit-logback-1.x\u0026#39;, version: \u0026#39;8.15.0\u0026#39; 18. json-path 1 implementation group: \u0026#39;com.jayway.jsonpath\u0026#39;, name: \u0026#39;json-path\u0026#39;, version: \u0026#39;2.8.0\u0026#39; æ·»åŠ æ•°æ®åº“è¡¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 import com.baomidou.mybatisplus.generator.FastAutoGenerator; import com.baomidou.mybatisplus.generator.config.OutputFile; import com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine; import org.junit.jupiter.api.Test; import java.util.Collections; public class CodeGenerator { @Test public void generator() { FastAutoGenerator.create(\u0026#34;jdbc:mysql://localhost:3306/file_center?serverTimezone=Asia/Shanghai\u0026#34;, \u0026#34;\u0026#34;, \u0026#34;\u0026#34;) .globalConfig(builder -\u0026gt; { builder.author(\u0026#34;baomidou\u0026#34;) // è®¾ç½®ä½œè€… .enableSwagger() // å¼€å¯ swagger æ¨¡å¼ .fileOverride() // è¦†ç›–å·²ç”Ÿæˆæ–‡ä»¶ .outputDir(\u0026#34;/Users/disco/Downloads/outputFileCenter\u0026#34;); // æŒ‡å®šè¾“å‡ºç›®å½• }) .packageConfig(builder -\u0026gt; { builder.parent(\u0026#34;com.baomidou.mybatisplus.samples.generator\u0026#34;) // è®¾ç½®çˆ¶åŒ…å .moduleName(\u0026#34;system\u0026#34;) // è®¾ç½®çˆ¶åŒ…æ¨¡å—å .pathInfo(Collections.singletonMap(OutputFile.xml, \u0026#34;/Users/disco/Downloads/outputFileCenter\u0026#34;)); // è®¾ç½®mapperXmlç”Ÿæˆè·¯å¾„ }) .strategyConfig(builder -\u0026gt; { builder.addInclude(Collections.emptyList()); // è®¾ç½®éœ€è¦ç”Ÿæˆçš„è¡¨å // .addTablePrefix(\u0026#34;t_\u0026#34;, \u0026#34;c_\u0026#34;); // è®¾ç½®è¿‡æ»¤è¡¨å‰ç¼€ }) .templateEngine(new FreemarkerTemplateEngine()) // ä½¿ç”¨Freemarkerå¼•æ“æ¨¡æ¿ï¼Œé»˜è®¤çš„æ˜¯Velocityå¼•æ“æ¨¡æ¿ .execute(); } } ","date":"2023-03-18T00:00:00Z","permalink":"https://MyLoveES.github.io/p/build-spring-project/","title":"Build spring project"},{"content":"è¡¨ file å­—æ®µ ç±»å‹ è¯´æ˜ id long, primary key è‡ªå¢ä¸»é”® file_id varchar, business key ä¸šåŠ¡ä¸»é”®ï¼Œæ–‡ä»¶Id fs_key varchar æ–‡ä»¶å­˜å‚¨key file_md5 varchar æ–‡ä»¶md5 create_time datetime åˆ›å»ºæ—¶é—´ update_time datetime æ›´æ–°æ—¶é—´ file_owner å­—æ®µ ç±»å‹ è¯´æ˜ id long, primary key è‡ªå¢ä¸»é”® file_id varchar, business key ä¸šåŠ¡ä¸»é”®ï¼Œæ–‡ä»¶Id file_name varchar æ–‡ä»¶å file_type varchar æ–‡ä»¶ç±»å‹ status integer çŠ¶æ€ï¼›0å¤±æ•ˆï¼Œ1æœ‰æ•ˆï¼Œ2æ’é˜Ÿä¸­ï¼Œ3ä¸Šä¼ ä¸­ï¼Œ4ä¸‹è½½ä¸­ï¼Œ-3ä¸Šä¼ å¤±è´¥ï¼Œ-4ä¸‹è½½å¤±è´¥ owner_id varchar æ‹¥æœ‰è€…Id create_time datetime åˆ›å»ºæ—¶é—´ update_time datetime æ›´æ–°æ—¶é—´ file_download å­—æ®µ ç±»å‹ è¯´æ˜ id long, primary key è‡ªå¢ä¸»é”® file_download_id varchar, business key ä¸šåŠ¡ä¸»é”®ï¼Œæ–‡ä»¶ä¸‹è½½Id file_id varchar, business key ä¸šåŠ¡ä¸»é”®ï¼Œæ–‡ä»¶Id file_origin_path varchar åŸå§‹æ–‡ä»¶è·¯å¾„ download_retry_times integer é‡è¯•æ¬¡æ•° callback_required integer æ˜¯å¦éœ€è¦å›è°ƒ callback_url varchar å›è°ƒURL callback_retry_time integer å›è°ƒé‡è¯•æ¬¡æ•° callback_status integer å›è°ƒçŠ¶æ€ï¼›0ç­‰å¾…å›è°ƒï¼Œ1å›è°ƒæˆåŠŸï¼Œ-1å›è°ƒå¤±è´¥ callback_result varchar å›è°ƒç»“æœ create_time datetime åˆ›å»ºæ—¶é—´ update_time datetime æ›´æ–°æ—¶é—´ æ³¨æ„çš„ç‚¹ å°è£…SDK å®¢æˆ·ç«¯ç™»è®°æ–‡ä»¶ï¼Œç›´ä¼ å­˜å‚¨å¼•æ“ï¼Œå†æ¬¡ç¡®è®¤çŠ¶æ€ æµç¨‹å›¾ å®¢æˆ·ç«¯ä¸Šä¼  å®¢æˆ·ç«¯æäº¤ æ–°å»ºé¡¹ç›® 1. init 1 spring init --groupId=com.weasley --artifactId=file-center --name=file-center --description=\u0026#34;file-center\u0026#34; file-center 2. module æ ¹ç›®å½• setting.gradle\n1 2 3 4 include \u0026#39;file-center-common\u0026#39; include \u0026#39;file-center-domain\u0026#39; include \u0026#39;file-center-application\u0026#39; include \u0026#39;file-center-interface\u0026#39; æ ¹ç›®å½• build.gradle\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 // å®šä¹‰é¡¹ç›®æ„å»ºæ‰€éœ€çš„ä»“åº“å’Œä¾èµ–é¡¹ // å®šä¹‰é¡¹ç›®æ„å»ºæ‰€éœ€çš„ä»“åº“å’Œä¾èµ–é¡¹ buildscript { repositories { mavenCentral() } dependencies { classpath(\u0026#39;org.springframework.boot:spring-boot-gradle-plugin:3.0.4\u0026#39;) } } plugins { id \u0026#39;java\u0026#39; id \u0026#39;groovy\u0026#39; id \u0026#39;java-library\u0026#39; id \u0026#39;org.springframework.boot\u0026#39; version \u0026#39;3.0.4\u0026#39; id \u0026#39;io.spring.dependency-management\u0026#39; version \u0026#39;1.1.0\u0026#39; } allprojects{ group = \u0026#39;com.weasley\u0026#39; version = \u0026#39;0.0.1-SNAPSHOT\u0026#39; sourceCompatibility = \u0026#39;17\u0026#39; repositories { mavenCentral() } dependencyManagement { imports { mavenBom \u0026#39;org.springframework.boot:spring-boot-dependencies:3.0.4\u0026#39; } } } subprojects { apply plugin: \u0026#39;java\u0026#39; apply plugin: \u0026#39;java-library\u0026#39; apply plugin: \u0026#39;groovy\u0026#39; apply plugin: \u0026#39;org.springframework.boot\u0026#39; apply plugin: \u0026#39;io.spring.dependency-management\u0026#39; dependencies { implementation group: \u0026#39;org.springframework.boot\u0026#39;, name: \u0026#39;spring-boot-starter-web\u0026#39; implementation \u0026#39;org.springframework.boot:spring-boot-starter\u0026#39; testImplementation \u0026#39;org.springframework.boot:spring-boot-starter-test\u0026#39; // devtools compileOnly \u0026#39;org.springframework.boot:spring-boot-devtools\u0026#39; // lombok compileOnly \u0026#39;org.projectlombok:lombok:1.18.26\u0026#39; annotationProcessor \u0026#39;org.projectlombok:lombok:1.18.26\u0026#39; // spring-boot-configuration-processor annotationProcessor \u0026#34;org.springframework.boot:spring-boot-configuration-processor\u0026#34; // spring-boot-starter-validation implementation group: \u0026#39;org.springframework.boot\u0026#39;, name: \u0026#39;spring-boot-starter-validation\u0026#39;, version: \u0026#39;3.0.4\u0026#39; // https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-actuator implementation group: \u0026#39;org.springframework.boot\u0026#39;, name: \u0026#39;spring-boot-starter-actuator\u0026#39;, version: \u0026#39;3.0.5\u0026#39; // mapstruct implementation \u0026#39;org.mapstruct:mapstruct:1.5.3.Final\u0026#39; annotationProcessor \u0026#39;org.mapstruct:mapstruct-processor:1.5.3.Final\u0026#39; // knife4j implementation group: \u0026#39;com.github.xiaoymin\u0026#39;, name: \u0026#39;knife4j-openapi3-jakarta-spring-boot-starter\u0026#39;, version: \u0026#39;4.1.0\u0026#39; // mybatis plus implementation group: \u0026#39;com.baomidou\u0026#39;, name: \u0026#39;mybatis-plus-boot-starter\u0026#39;, version: \u0026#39;3.5.3.1\u0026#39; implementation group: \u0026#39;com.baomidou\u0026#39;, name: \u0026#39;mybatis-plus-generator\u0026#39;, version: \u0026#39;3.5.3.1\u0026#39; implementation group: \u0026#39;org.freemarker\u0026#39;, name: \u0026#39;freemarker\u0026#39;, version: \u0026#39;2.3.31\u0026#39; implementation group: \u0026#39;mysql\u0026#39;, name: \u0026#39;mysql-connector-java\u0026#39;, version: \u0026#39;8.0.32\u0026#39; // spock testImplementation group: \u0026#39;org.spockframework\u0026#39;, name: \u0026#39;spock-core\u0026#39;, version: \u0026#39;2.3-groovy-4.0\u0026#39; testImplementation group: \u0026#39;org.spockframework\u0026#39;, name: \u0026#39;spock-spring\u0026#39;, version: \u0026#39;2.3-groovy-4.0\u0026#39; // h2 testImplementation group: \u0026#39;com.h2database\u0026#39;, name: \u0026#39;h2\u0026#39;, version: \u0026#39;2.1.214\u0026#39; // embedded-redis testImplementation (group: \u0026#39;it.ozimov\u0026#39;, name: \u0026#39;embedded-redis\u0026#39;, version: \u0026#39;0.7.3\u0026#39; ) { exclude group: \u0026#39;org.slf4j\u0026#39;, module: \u0026#39;slf4j-simple\u0026#39; } // redission implementation group: \u0026#39;org.redisson\u0026#39;, name: \u0026#39;redisson-spring-boot-starter\u0026#39;, version: \u0026#39;3.20.0\u0026#39; // https://mvnrepository.com/artifact/com.github.ben-manes.caffeine/caffeine implementation group: \u0026#39;com.github.ben-manes.caffeine\u0026#39;, name: \u0026#39;caffeine\u0026#39;, version: \u0026#39;3.1.5\u0026#39; // hutool-core implementation group: \u0026#39;cn.hutool\u0026#39;, name: \u0026#39;hutool-core\u0026#39;, version: \u0026#39;5.8.15\u0026#39; implementation group: \u0026#39;cn.hutool\u0026#39;, name: \u0026#39;hutool-extra\u0026#39;, version: \u0026#39;5.8.16\u0026#39; // minio implementation group: \u0026#39;io.minio\u0026#39;, name:\u0026#39;minio\u0026#39;, version: \u0026#39;8.4.3\u0026#39; // vavr implementation group: \u0026#39;io.vavr\u0026#39;, name: \u0026#39;vavr\u0026#39;, version: \u0026#39;0.10.4\u0026#39; implementation group: \u0026#39;org.apache.skywalking\u0026#39;, name: \u0026#39;apm-toolkit-logback-1.x\u0026#39;, version: \u0026#39;8.15.0\u0026#39; // https://mvnrepository.com/artifact/com.jayway.jsonpath/json-path implementation group: \u0026#39;com.jayway.jsonpath\u0026#39;, name: \u0026#39;json-path\u0026#39;, version: \u0026#39;2.8.0\u0026#39; } tasks.named(\u0026#39;test\u0026#39;) { useJUnitPlatform() } } 1) file-center-common 1 2 3 1) mkdir file-center-common 2) mkdir -p src/main/java/com/weasley/common 3) mkdir -p src/main/resources 2) file-center-domain 1 2 3 1) mkdir file-center-domain 2) mkdir -p src/main/java/com/weasley/domain 3) mkdir -p src/main/resources 3) file-center-application 1 2 3 1) mkdir file-center-application 2) mkdir -p src/main/java/com/weasley/application 3) mkdir -p src/main/resources 4) file-center-interface 1 2 3 1) mkdir file-center-interface 2) mkdir -p src/main/java/com/weasley/interface 3) mkdir -p src/main/resources 5) file-center-infrastructure 1 2 3 1) mkdir file-center-infrastructure 2) mkdir -p src/main/java/com/weasley/infrastructure 3) mkdir -p src/main/resources 3. boot scripts 4. logback 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;include resource=\u0026#34;org/springframework/boot/logging/logback/defaults.xml\u0026#34;/\u0026gt; \u0026lt;springProperty scope=\u0026#34;context\u0026#34; name=\u0026#34;spring.application.name\u0026#34; source=\u0026#34;spring.application.name\u0026#34;/\u0026gt; \u0026lt;!--å®šä¹‰æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨åœ°å€ å‹¿åœ¨ LogBack çš„é…ç½®ä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„--\u0026gt; \u0026lt;property name=\u0026#34;logging.path\u0026#34; value=\u0026#34;log\u0026#34;/\u0026gt; \u0026lt;property name=\u0026#34;CONSOLE_LOG_PATTERN\u0026#34; value=\u0026#34;%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr([${PID:- }]){magenta} %clr([%X{tid}]){magenta} %clr([%X{requestId}]){magenta} %clr([%X{requestPath}]){magenta} %clr([%X{requestIp}]){magenta} %clr(---){faint} %clr([%15.15t]){faint}%clr([%X{chainId}]){faint}%clr([%X{stageId}]){faint} %clr(%-50.50logger{49}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}\u0026#34;/\u0026gt; \u0026lt;property name=\u0026#34;ROLL_FILE_LOG_PATTERN\u0026#34; value=\u0026#34;%d{yyyy-MM-dd HH:mm:ss.SSS} ${LOG_LEVEL_PATTERN:-%5p} [${PID:- }] [%X{tid}] [%X{requestId}] [%X{requestPath}] [%X{requestIp}] --- [%t][%X{chainId}][%X{stageId}] %-50.50logger{49} : %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}\u0026#34;/\u0026gt; \u0026lt;!-- æ§åˆ¶å°è¾“å‡º --\u0026gt; \u0026lt;appender name=\u0026#34;STDOUT\u0026#34; class=\u0026#34;ch.qos.logback.core.ConsoleAppender\u0026#34;\u0026gt; \u0026lt;!-- æ—¥å¿—è¾“å‡ºç¼–ç  --\u0026gt; \u0026lt;encoder class=\u0026#34;ch.qos.logback.core.encoder.LayoutWrappingEncoder\u0026#34;\u0026gt; \u0026lt;layout class=\u0026#34;org.apache.skywalking.apm.toolkit.log.logback.v1.x.mdc.TraceIdMDCPatternLogbackLayout\u0026#34;\u0026gt; \u0026lt;pattern\u0026gt;${CONSOLE_LOG_PATTERN}\u0026lt;/pattern\u0026gt; \u0026lt;/layout\u0026gt; \u0026lt;/encoder\u0026gt; \u0026lt;/appender\u0026gt; \u0026lt;!-- æ§åˆ¶å°å¼‚æ­¥è¾“å‡º --\u0026gt; \u0026lt;appender name=\u0026#34;STDOUTASYNC\u0026#34; class=\u0026#34;ch.qos.logback.classic.AsyncAppender\u0026#34;\u0026gt; \u0026lt;!-- ä¸ä¸¢å¤±æ—¥å¿—.é»˜è®¤çš„,å¦‚æœé˜Ÿåˆ—çš„80%å·²æ»¡,åˆ™ä¼šä¸¢å¼ƒTRACTã€DEBUGã€INFOçº§åˆ«çš„æ—¥å¿— --\u0026gt; \u0026lt;discardingThreshold\u0026gt;0\u0026lt;/discardingThreshold\u0026gt; \u0026lt;!-- æ›´æ”¹é»˜è®¤çš„é˜Ÿåˆ—çš„æ·±åº¦,è¯¥å€¼ä¼šå½±å“æ€§èƒ½.é»˜è®¤å€¼ä¸º256 --\u0026gt; \u0026lt;queueSize\u0026gt;512\u0026lt;/queueSize\u0026gt; \u0026lt;!-- æ·»åŠ é™„åŠ çš„appender,æœ€å¤šåªèƒ½æ·»åŠ ä¸€ä¸ª --\u0026gt; \u0026lt;appender-ref ref=\u0026#34;STDOUT\u0026#34;/\u0026gt; \u0026lt;/appender\u0026gt; \u0026lt;!-- æŒ‰ç…§æ¯å¤©ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ --\u0026gt; \u0026lt;appender name=\u0026#34;FILE\u0026#34; class=\u0026#34;ch.qos.logback.core.rolling.RollingFileAppender\u0026#34;\u0026gt; \u0026lt;file\u0026gt;${logging.path}/${spring.application.name}.log\u0026lt;/file\u0026gt; \u0026lt;rollingPolicy class=\u0026#34;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy\u0026#34;\u0026gt; \u0026lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºçš„æ–‡ä»¶å--\u0026gt; \u0026lt;FileNamePattern\u0026gt;${logging.path}/${spring.application.name}.log.%d{yyyy-MM-dd}.%i.log\u0026lt;/FileNamePattern\u0026gt; \u0026lt;maxFileSize\u0026gt;100MB\u0026lt;/maxFileSize\u0026gt; \u0026lt;MaxHistory\u0026gt;7\u0026lt;/MaxHistory\u0026gt; \u0026lt;totalSizeCap\u0026gt;1GB\u0026lt;/totalSizeCap\u0026gt; \u0026lt;/rollingPolicy\u0026gt; \u0026lt;encoder class=\u0026#34;ch.qos.logback.core.encoder.LayoutWrappingEncoder\u0026#34;\u0026gt; \u0026lt;layout class=\u0026#34;org.apache.skywalking.apm.toolkit.log.logback.v1.x.mdc.TraceIdMDCPatternLogbackLayout\u0026#34;\u0026gt; \u0026lt;!--æ ¼å¼åŒ–è¾“å‡ºï¼š%dè¡¨ç¤ºæ—¥æœŸï¼Œ%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦--\u0026gt; \u0026lt;pattern\u0026gt;${ROLL_FILE_LOG_PATTERN}\u0026lt;/pattern\u0026gt; \u0026lt;/layout\u0026gt; \u0026lt;/encoder\u0026gt; \u0026lt;/appender\u0026gt; \u0026lt;!-- æ—¥å¿—æ–‡ä»¶å¼‚æ­¥è¾“å‡º --\u0026gt; \u0026lt;appender name=\u0026#34;FILEASYNC\u0026#34; class=\u0026#34;ch.qos.logback.classic.AsyncAppender\u0026#34;\u0026gt; \u0026lt;!-- ä¸ä¸¢å¤±æ—¥å¿—.é»˜è®¤çš„,å¦‚æœé˜Ÿåˆ—çš„80%å·²æ»¡,åˆ™ä¼šä¸¢å¼ƒTRACTã€DEBUGã€INFOçº§åˆ«çš„æ—¥å¿— --\u0026gt; \u0026lt;discardingThreshold\u0026gt;0\u0026lt;/discardingThreshold\u0026gt; \u0026lt;!-- æ›´æ”¹é»˜è®¤çš„é˜Ÿåˆ—çš„æ·±åº¦,è¯¥å€¼ä¼šå½±å“æ€§èƒ½.é»˜è®¤å€¼ä¸º256 --\u0026gt; \u0026lt;queueSize\u0026gt;512\u0026lt;/queueSize\u0026gt; \u0026lt;!-- æ·»åŠ é™„åŠ çš„appender,æœ€å¤šåªèƒ½æ·»åŠ ä¸€ä¸ª --\u0026gt; \u0026lt;appender-ref ref=\u0026#34;FILE\u0026#34;/\u0026gt; \u0026lt;/appender\u0026gt; \u0026lt;root level=\u0026#34;INFO\u0026#34;\u0026gt; \u0026lt;appender-ref ref=\u0026#34;STDOUTASYNC\u0026#34;/\u0026gt; \u0026lt;appender-ref ref=\u0026#34;FILEASYNC\u0026#34;/\u0026gt; \u0026lt;/root\u0026gt; \u0026lt;/configuration\u0026gt; 5. docs 6. SQL generate 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 import com.baomidou.mybatisplus.generator.FastAutoGenerator; import com.baomidou.mybatisplus.generator.config.OutputFile; import com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine; import org.junit.jupiter.api.Test; import java.util.Collections; public class CodeGenerator { @Test public void generator() { FastAutoGenerator.create(\u0026#34;jdbc:mysql://localhost:3306/file_center?serverTimezone=Asia/Shanghai\u0026#34;, \u0026#34;\u0026#34;, \u0026#34;\u0026#34;) .globalConfig(builder -\u0026gt; { builder.author(\u0026#34;baomidou\u0026#34;) // è®¾ç½®ä½œè€… .enableSwagger() // å¼€å¯ swagger æ¨¡å¼ .fileOverride() // è¦†ç›–å·²ç”Ÿæˆæ–‡ä»¶ .outputDir(\u0026#34;/Users/disco/Downloads/outputFileCenter\u0026#34;); // æŒ‡å®šè¾“å‡ºç›®å½• }) .packageConfig(builder -\u0026gt; { builder.parent(\u0026#34;com.baomidou.mybatisplus.samples.generator\u0026#34;) // è®¾ç½®çˆ¶åŒ…å .moduleName(\u0026#34;system\u0026#34;) // è®¾ç½®çˆ¶åŒ…æ¨¡å—å .pathInfo(Collections.singletonMap(OutputFile.xml, \u0026#34;/Users/disco/Downloads/outputFileCenter\u0026#34;)); // è®¾ç½®mapperXmlç”Ÿæˆè·¯å¾„ }) .strategyConfig(builder -\u0026gt; { builder.addInclude(Collections.emptyList()); // è®¾ç½®éœ€è¦ç”Ÿæˆçš„è¡¨å // .addTablePrefix(\u0026#34;t_\u0026#34;, \u0026#34;c_\u0026#34;); // è®¾ç½®è¿‡æ»¤è¡¨å‰ç¼€ }) .templateEngine(new FreemarkerTemplateEngine()) // ä½¿ç”¨Freemarkerå¼•æ“æ¨¡æ¿ï¼Œé»˜è®¤çš„æ˜¯Velocityå¼•æ“æ¨¡æ¿ .execute(); } } 7.application.yml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 spring: application: name: file_center profiles: active: test mvc: pathmatch: matching-strategy: ant_path_matcher datasource: url: jdbc:mysql://localhost:3306/file_center?serverTimezone=Asia/Shanghai username: root password: platform123456 driver-class-name: com.mysql.cj.jdbc.Driver servlet: multipart: enabled: true max-file-size: 100MB max-request-size: 200MB data: redis: timeout: 1000 host: 127.0.0.1 port: 6379 password: YpWcTLkW lettuce: pool: max-active: 100 max-wait: 500 max-idle: 10 min-idle: 10 time-between-eviction-runs: 10s lock: engine: lock-caffeine timeout-seconds: 1 expire-seconds: 120 caffeine: capacity: 10000 maximum-size: 20000 storage: engine: storage-minio local: enabled: true region: asia bucket: file-center minio: enabled: true region: zh-cn-beijing bucket: file-center endpoint: http://127.0.0.1:9000 sslEnable: false accessKey: 4MrQwqp2WyeAh33S secretKey: DCA3sYbWHZlAcwcEHD1foRRVcbiSqqrX custom: executor: configs: stage-download: executor-name: stage-download queue-capacity: 100 core-pool-size: 40 max-pool-size: 100 allow-core-Thread-time-out: false keep-alive-seconds: 20 await-termination: false await-termination-seconds: 5000 abort-policy: block stage-upload: executor-name: stage-upload queue-capacity: 200 core-pool-size: 40 max-pool-size: 100 allow-core-Thread-time-out: false keep-alive-seconds: 20 await-termination: false await-termination-seconds: 5000 abort-policy: block stage-callback: executor-name: stage-callback queue-capacity: 300 core-pool-size: 40 max-pool-size: 100 allow-core-Thread-time-out: false keep-alive-seconds: 20 await-termination: false await-termination-seconds: 5000 abort-policy: block http-callback: executor-name: dispatcher-http-callback queue-capacity: 400 core-pool-size: 40 max-pool-size: 100 allow-core-Thread-time-out: false keep-alive-seconds: 20 await-termination: false await-termination-seconds: 5000 abort-policy: block http: configs: http-callback: client-name: http-callback dispatcher-executor-name: dispatcher-http-callback call-timeout-milliseconds: 1000 connect-timeout-milliseconds: 1000 readTimeoutMilliseconds: 1000 writeTimeoutMilliseconds: 1000 connectionMaxPoolSize: 100 keepAliveSeconds: 20 maxRequests: 300 maxRequestsPerHost: 50 mybatis-plus: mapper-locations: classpath:mappers/*.xml type-aliases-package: com.weasley.infrastructure.db.model configuration: log-impl: org.apache.ibatis.logging.stdout.StdOutImpl swagger: enable: true knife4j: enable: true management: endpoints: web: exposure: include: health,info,metrics,threadpool exclude: shutdown monitor: log: enable: true report: enable: true 8. file-center-common 1) ErrorCode 2) Response 3) Global Exception 4) Response advice 5) Submodule build.gradle 1 2 3 4 # unittest tasks.named(\u0026#39;test\u0026#39;) { useJUnitPlatform() } ","date":"2023-03-18T00:00:00Z","permalink":"https://MyLoveES.github.io/p/self-file/","title":"Self - file"},{"content":"é¡¹ç›®ç»“æ„ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 . â”œâ”€â”€ HELP.md â”œâ”€â”€ README.md â”œâ”€â”€ mvnw â”œâ”€â”€ mvnw.cmd â”œâ”€â”€ pom.xml â””â”€â”€ src â”œâ”€â”€ main â”‚Â â”œâ”€â”€ java â”‚Â â”‚Â â””â”€â”€ com â”‚Â â”‚Â â””â”€â”€ mylovees â”‚Â â”‚Â â””â”€â”€ sweet7 â”‚Â â”‚Â â””â”€â”€ Sweet7Application.java â”‚Â â””â”€â”€ resources â”‚Â â””â”€â”€ application.properties â””â”€â”€ test â””â”€â”€ java â””â”€â”€ com â””â”€â”€ mylovees â””â”€â”€ sweet7 â””â”€â”€ Sweet7ApplicationTests.java ","date":"2022-11-02T00:00:00Z","permalink":"https://MyLoveES.github.io/p/%E6%90%AD%E5%BB%BAddd%E8%84%9A%E6%89%8B%E6%9E%B6/","title":"æ­å»ºDDDè„šæ‰‹æ¶"},{"content":"maven add module æ ¹ç›®å½•pomæ·»åŠ  1 \u0026lt;packaging\u0026gt;pom\u0026lt;/packaging\u0026gt; maven æ·»åŠ module 1 mvn archetype:generate -DgroupId=com.sweet7 -DartifactId=sweet7-domain -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false ","date":"2022-11-01T00:00:00Z","permalink":"https://MyLoveES.github.io/p/maven-related/","title":"Maven related"},{"content":"Qï¼šå¤„ç†å™¨ã€è¿›ç¨‹æˆ–è€…èŠ‚ç‚¹å„è‡ªç‹¬ç«‹ï¼Œå¦‚ä½•æ‰èƒ½å¤Ÿè¾¾æˆå…±è¯†ï¼Ÿ ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒèŠ‚ç‚¹é—´å¯ä»¥å½¼æ­¤ä¼ é€’æ¶ˆæ¯è¾¾æˆä¸€è‡´ã€‚ä½†æ˜¯æœ‰æ•…éšœèŠ‚ç‚¹å­˜åœ¨çš„æ˜¯æ—¶å€™ï¼Œæ•…éšœèŠ‚ç‚¹å¯èƒ½ä¼šå‘å…¶ä»–èŠ‚ç‚¹å‘é€ä¸€ä¸ªé”™è¯¯å€¼ï¼Œæˆ–è€…å‘é€ä¸€äº›éšå³å€¼ï¼Œç”šè‡³ä¸å‘é€ï¼Œå¯¼è‡´æ¯ä¸ªå¤„ç†å™¨è·å–åˆ°ä¸åŒçš„æ•°æ®ï¼Œæœ€ç»ˆè®¡ç®—å‡ºä¸ä¸€è‡´çš„ç»“æœã€‚\n1 æ¯”å¦‚ï¼Œå¤„ç†å™¨é—´çš„æ—¶é’ŸåŒæ­¥ï¼Œé›†ç¾¤æœåŠ¡å™¨é—´çš„æ•°æ®åŒæ­¥ Reaching Agreement in the Presence of Faults è®ºæ–‡ä½œè€…æå‡ºä¸€ç§æ–¹æ³•æ¥æ¶ˆé™¤é”™è¯¯å¤„ç†å™¨çš„å½±å“ - é€šè¿‡ä½¿ç”¨å¾ªç¯å¤šè½®çš„ä¿¡æ¯äº¤æ¢æ–¹æ¡ˆæ¥å¤„ç†;è¿™æ ·çš„æ–¹æ¡ˆå¯èƒ½ä¼šè¿«ä½¿æœ‰é”™è¯¯çš„å¤„ç†å™¨æš´éœ²è‡ªå·±æœ‰é”™è¯¯ï¼Œæˆ–è€…è‡³å°‘ä½¿å…¶è¡Œä¸ºä¸æ²¡æœ‰é”™è¯¯çš„å¤„ç†å™¨ä¿æŒä¸€è‡´ï¼Œä»è€Œä½¿åè€…èƒ½å¤Ÿè¾¾æˆä¸€è‡´(å½“ç„¶ï¼Œæ˜¯åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹)ã€‚\nAssumptions å‡è®¾æ€»å…±æœ‰nä¸ªç‹¬ç«‹èŠ‚ç‚¹ï¼Œå…¶ä¸­é”™è¯¯èŠ‚ç‚¹mä¸ªï¼Œå¹¶ä¸”ä¸çŸ¥é“å…·ä½“æ˜¯å“ªäº›èŠ‚ç‚¹å‡ºç°äº†é—®é¢˜ã€‚èŠ‚ç‚¹ä¹‹é—´åªèƒ½åŒæ–¹å½¼æ­¤é€šä¿¡ï¼Œå¹¶ä¸”å‡è®¾æ•°æ®ä¼ è¾“æ˜¯æœ‰ä¿éšœçš„å¹¶ä¸”æ— å»¶è¿Ÿã€‚æ¥æ”¶æ–¹å¯ä»¥è¯†åˆ«æ¶ˆæ¯çš„å‘å‡ºè€…ã€‚\næ¯ä¸ªèŠ‚ç‚¹nå…·æœ‰ç§æœ‰å€¼Vnï¼ˆå¯ä»¥ç†è§£ä¸ºå½“å‰è¯¥èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œæ¯”å¦‚è´Ÿè½½ç­‰ï¼‰ã€‚å¯¹äºç»™å®šçš„mã€nï¼Œé€šè¿‡å½¼æ­¤é—´çš„ä¿¡æ¯äº¤æ¢ï¼Œè®©æ¯ä¸ªèŠ‚ç‚¹æŒæœ‰ä¸€ä¸ªæ‰€æœ‰èŠ‚ç‚¹ç§æœ‰å€¼çš„å‘é‡ã€‚æœ€ç»ˆè¾¾æˆï¼š\néæ•…éšœèŠ‚ç‚¹èƒ½å¤Ÿè®¡ç®—å¾—åˆ°å®Œå…¨ç›¸åŒçš„å‘é‡; è¯¥å‘é‡ä¸­ï¼Œéé”™è¯¯èŠ‚ç‚¹çš„æ‰€å¯¹åº”çš„å…ƒç´ å…ƒç´ ï¼Œæ˜¯è¯¥èŠ‚ç‚¹çš„ç§æœ‰å€¼ ä¸¾ä¸ªä¾‹å­ï¼š\n{% asset_img ReachAggrement-finger1.png finger1 %}\näº¤äº’ä¸€è‡´æ€§ è™½ç„¶æˆ‘ä»¬ä¸éœ€è¦æœ€ç»ˆçŸ¥é“å“ªäº›èŠ‚ç‚¹æ˜¯æœ‰é—®é¢˜çš„ï¼Œä¸é”™è¯¯èŠ‚ç‚¹å¯¹åº”çš„å‘é‡å…ƒç´ ä¹Ÿå¯ä»¥æ˜¯ä»»æ„çš„;ä½†æ˜¯æ­£ç¡®èŠ‚ç‚¹å¯¹äºé”™è¯¯èŠ‚ç‚¹çš„å‘é‡å…ƒç´ å¿…é¡»æ˜¯ä¸€è‡´çš„ã€‚\næ¯”å¦‚ä¸‹é¢çš„è¿™ç§æƒ…å†µæ˜¯ä¸è¢«æ¥å—çš„ï¼š {% asset_img ReachAggrement-finger2.png finger2 %}\næ­£ç¡®èŠ‚ç‚¹å¯¹æ‰€æœ‰èŠ‚ç‚¹(åŒ…æ‹¬æœ‰æ•…éšœçš„èŠ‚ç‚¹)æŒæœ‰çš„å€¼è¾¾æˆå…±è¯†ï¼Œæœ€ç»ˆå¾—åˆ°ï¼ˆäº¤äº’å¼ï¼‰ä¸€è‡´æ€§å‘é‡ã€‚è¿™æ ·ï¼Œæ¯ä¸ªèŠ‚ç‚¹å°±èƒ½å¤Ÿé€šè¿‡å¯¹è¯¥å‘é‡çš„è®¡ç®—ï¼Œç»§ç»­å¾—åˆ°ä¸šåŠ¡ä¸Šçš„æ‰€éœ€è¦çš„å€¼ã€‚\nå•èŠ‚ç‚¹é”™è¯¯ n=4, m=1 é¦–å…ˆå¯ä»¥å‡è®¾ n=4, m=1ã€‚è¿›è¡Œä¸¤è½®ä¿¡æ¯äº¤æ¢ï¼š\nå„ä¸ªèŠ‚ç‚¹å…ˆæŠŠè‡ªå·±çš„ç§æœ‰å€¼å‘ç»™å…¶ä»–èŠ‚ç‚¹ å„ä¸ªèŠ‚ç‚¹å½¼æ­¤äº¤æ¢ç¬¬ä¸€è½®æ”¶åˆ°çš„ä¿¡æ¯ åœ¨ä¿¡æ¯äº¤æ¢è¿‡ç¨‹ä¸­ï¼Œé”™è¯¯èŠ‚ç‚¹å¯èƒ½ä¼šå‘å‡ºé”™è¯¯çš„å€¼ï¼Œæˆ–è€…ä¸å‘å‡ºä»»ä½•å€¼ï¼Œæ¥å¹²æ‰°å…¶ä»–æ­£å¸¸èŠ‚ç‚¹çš„è®¡ç®—ã€‚å¯¹äºä¸€ä¸ªæ­£å¸¸èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°èŠ‚ç‚¹Nçš„æ¶ˆæ¯ï¼Œä¼šå°†å…¶ç½®ä¸ºé»˜è®¤å€¼ï¼ˆå‡è®¾ä¸ºNULLï¼‰ã€‚\nSTEP1:\n{% asset_img ReachAggrement-finger3.png finger3 %} STEP2:\n{% asset_img ReachAggrement-finger4.png finger4 %}\nåœ¨ä¸¤è½®ä¿¡æ¯äº¤æ¢å®Œæˆåï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæŒæœ‰â€œä¸€ç»„â€å‘é‡å€¼å…ƒç´ ã€‚èŠ‚ç‚¹å¯ä»¥é€‰å–â€œå¤šæ•°â€ä½œä¸ºè®¤å¯çš„å…ƒç´ å€¼ï¼Œå½¢æˆæœ€ç»ˆçš„å‘é‡ã€‚ {% asset_img ReachAggrement-finger5.png finger5 %}\nå¤šèŠ‚ç‚¹é”™è¯¯ ä»…ä»…ä¸¤è½®ä¿¡æ¯äº¤æ¢ä¸è¶³ä»¥è¾¾æˆå…±è¯†ï¼š\nSTEP1:\n{% asset_img ReachAggrement-finger6.png finger6 %}\nSTEP2:\n{% asset_img ReachAggrement-finger7.png finger7 %}\nFinally:\n{% asset_img ReachAggrement-finger8.png finger8 %}\nç»§ç»­ä¸‹ä¸€è½®äº¤æ¢ä¿¡æ¯\u0026hellip;\u0026hellip;..\nm+1 è½®åï¼š\nP: èŠ‚ç‚¹é›†åˆ V: å€¼çš„é›†åˆ å®šä¹‰ï¼š\n1ï¼‰w=p1p2p3\u0026hellip;.pr, Ïƒ(w) æ„ä¸º pr -\u0026gt; p(r-1) -\u0026gt; p(r-2) -\u0026gt; Â·Â·Â· -\u0026gt; p2 -\u0026gt; p1ï¼ŒVpræœ€ç»ˆæµè½¬åˆ°p1çš„ç»“æœã€‚\n2ï¼‰å¯¹äºä¸€ä¸ªå•èŠ‚ç‚¹ï¼ŒÏƒ(p) = Vp\n3ï¼‰å¦‚æœä¸€ä¸ªèŠ‚ç‚¹qæ˜¯æ­£å¸¸çš„ï¼Œé‚£ä¹ˆä»–ä¸€å®šæ»¡è¶³ï¼šå¯¹äºä»»æ„çš„é›†åˆç»„æˆçš„å­—ä¸²wå’Œä»»æ„èŠ‚ç‚¹pï¼Œ\nÏƒ(pqw) = Ïƒ(qw) åŒç†å¦‚æœä¸€ä¸ªé›†åˆå…¨éƒ¨æ˜¯æ­£å¸¸èŠ‚ç‚¹ï¼Œé‚£ä¹ˆé›†åˆæ‰€ç»„æˆçš„å­—ä¸² w=p1p2p3...prï¼Œå’Œä¸€ä¸ªä»»æ„èŠ‚ç‚¹p', ä¸€å®šèƒ½å¤Ÿæ»¡è¶³ Ïƒ(pwp') = Ïƒ(wp') é‚£ä¹ˆï¼Œé€šè¿‡å¦‚ä¸‹æ–¹æ³•å¸®åŠ©pèŠ‚ç‚¹å¾—åˆ°qå€¼ï¼ˆæ€»èŠ‚ç‚¹nï¼Œé”™è¯¯èŠ‚ç‚¹mï¼Œn\u0026gt;=3m+1ï¼‰ï¼š\nå¯¹äºé›†åˆPçš„æŸä¸ªå¤§å°è¶…è¿‡(n+m)/2çš„å­é›†Qï¼ŒÏƒp(pwq) = v å¯¹äºæ¯ä¸ªé•¿åº¦ä¸å¤§äºmçš„å­—ä¸²wï¼ˆå–è‡ªQï¼‰éƒ½æˆç«‹ï¼Œé‚£ä¹ˆpè®°å½•ä¸‹vï¼› å¦åˆ™ï¼Œç®—æ³•å°†é€’å½’åº”ç”¨m-1ï¼Œn-1ï¼Œä½¿P-{q}æ¥æ›¿ä»£Pï¼Œå¹¶ä¸”å¯¹äºæ¯ä¸ªé•¿åº¦ä¸å¤§äºmçš„å­—ä¸²wï¼ˆå–è‡ªäºP-{q}ï¼‰ Ïƒp'(pw) = Ïƒp(pwq) å¦‚æœåœ¨è¿™å‘é‡n-1ä¸ªå…ƒç´ é‡Œæœ‰è‡³å°‘(n+m)/2ä¸ªå…ƒç´ å€¼ç›¸åŒï¼Œpè®°å½•ä¸‹è¯¥å€¼ï¼Œå¦åˆ™è®°å½•NILå€¼ã€‚ step1ï¼šï¼ˆç›®çš„æ˜¯ç¡®å®šæºèŠ‚ç‚¹qæ­£ç¡®ä¸å¦ï¼‰ä¸€å®šèƒ½å¤Ÿæ‰¾åˆ°ä¸€ä¸ªå…¨éƒ¨æ˜¯æ­£å¸¸èŠ‚ç‚¹çš„é›†åˆQ(size \u0026lt;= m)ï¼Œä½¿å¾—æ­£å¸¸çš„æºèŠ‚ç‚¹qçš„å€¼ï¼Œç»è¿‡Qå¤„ç†åï¼Œä¾ç„¶ä¸å˜ã€‚ {% asset_img ReachAggrement-finger9.png finger9 %}\nstep2ï¼šï¼ˆç›®çš„æ˜¯å¯¹é”™è¯¯èŠ‚ç‚¹çš„å€¼è¾¾æˆå…±è¯†ï¼‰å¦‚æœæºèŠ‚ç‚¹qæ²¡èƒ½æ»¡è¶³step1ï¼Œè¯´æ˜qåœ¨ä¹±å‘å€¼ï¼Œqæ˜¯ä¸€ä¸ªé—®é¢˜èŠ‚ç‚¹ã€‚\nqå‘då‘é€Xï¼š {% asset_img ReachAggrement-finger10.png finger10 %}\nqå‘eå‘é€Yï¼š {% asset_img ReachAggrement-finger11.png finger11 %}\næ‰€ä»¥qçš„å€¼æ˜¯å¤šå°‘ä¸é‡è¦äº†ï¼Œé‡è¦çš„æ˜¯å…¶ä»–èŠ‚ç‚¹è¦å¯¹qçš„å€¼è¾¾æˆå…±è¯†ã€‚åšæ³•ï¼ŒæŠŠé—®é¢˜èŠ‚ç‚¹qè¸¢å‡ºå»ï¼Œè¯¢é—®å…¶ä»–èŠ‚ç‚¹ï¼Œåœ¨ä»–ä»¬çœ¼é‡Œï¼Œqæ˜¯å¤šå°‘ã€‚å¦‚æœæŸä¸ªå€¼Vq\u0026rsquo;è¶…è¿‡åŠæ•°è®¤å¯ï¼Œé‚£ä¹ˆå°±ä»¥Vq\u0026rsquo;ä½œä¸ºqçš„å€¼ï¼Œå¦åˆ™ï¼Œè®°é»˜è®¤å€¼NILã€‚å³ï¼š\nÏƒp'(pw) = Ïƒp'(pwq') = Ïƒp(pwq'q) = Ïƒp(pwq) p é—®q\u0026rsquo;ï¼ˆä¸­é—´ä¹Ÿç»è¿‡äº†step1çš„å¤„ç†ï¼‰ï¼Œä½ çœ¼é‡Œqæ˜¯å¤šå°‘ï¼Ÿå¦‚æœè·å¾—äº†ä¸ä¸€è‡´çš„ç­”æ¡ˆï¼Œè¯´æ˜q\u0026rsquo;ä¹Ÿæœ‰é—®é¢˜ï¼Œè¸¢äº†ï¼Œå†é—®å…¶ä»–èŠ‚ç‚¹ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªæ­£å¸¸èŠ‚ç‚¹è®¤å¯çš„å€¼Vq'1\næœ€ç»ˆï¼Œpå¾—åˆ°äº†å…¶ä»–æ‰€æœ‰æ­£å¸¸èŠ‚ç‚¹çœ¼é‡Œçš„qå€¼: Vq'1 Vq'2 \u0026hellip;.. Vq\u0026rsquo;kï¼Œå¦‚æœåœ¨è¿™ä¸­é—´ï¼ŒæŸä¸ªå€¼Vq\u0026rsquo;mè¶…è¿‡äº†åŠæ•°ï¼Œé‚£ä¹ˆä»¥Vq\u0026rsquo;mä½œä¸ºqçš„å€¼ï¼Œå¦å€¼å–é»˜è®¤å€¼NILã€‚\nè¿™ä¸ªè¿‡ç¨‹å°±åƒæ˜¯è¯¢é—®â€œè®¤å¯å€¼â€ï¼Œåªè¦è·å¾—äº†è¶³å¤Ÿå¤šçš„â€œè®¤å¯â€ï¼Œå°±å¯è§†Vqä¸ºqçš„å€¼ã€‚\nn=7, m=2 ä»¥Aä¸ºä¸»è§†è§’\nstep1: æ¯ä¸ªèŠ‚ç‚¹æŠŠè‡ªå·±çš„å€¼å‘é€ç»™å…¶ä»–èŠ‚ç‚¹ {% asset_img ReachAggrement-finger12.png finger12 %}\nstep2: æ¯ä¸ªèŠ‚ç‚¹åˆ†äº«ä¸Šä¸€è½®æ¥æ”¶åˆ°çš„å€¼ step3: æ¯ä¸ªèŠ‚ç‚¹å†æ¬¡åˆ†äº«ä¸Šä¸€è½®æ¥æ”¶åˆ°çš„å€¼ {% asset_img ReachAggrement-finger13.png finger13 %}\nå¯¹äºä¸€ä¸ªæ­£å¸¸èŠ‚ç‚¹ï¼Œç»è¿‡å­é›†Qï¼ŒæŠµè¾¾Açš„å€¼ä¸ä¼šå˜ {% asset_img ReachAggrement-finger14.png finger14 %}\nå¯¹äºä¸€ä¸ªéæ­£å¸¸èŠ‚ç‚¹ï¼Œç»è¿‡å­é›†Qï¼ŒæŠµè¾¾Açš„å€¼å¯èƒ½ä¼šå˜ã€‚æ­¤æ—¶éœ€è¦è¸¢å‡ºé”™è¯¯èŠ‚ç‚¹ï¼Œæ¥è¾¾æˆå€¼çš„ä¸€è‡´ {% asset_img ReachAggrement-finger15.png finger15 %}\n{% asset_img ReachAggrement-finger16.png finger16 %}\næ‹œå åº­å›½ç‹æ”¾ä¸‹æ‰‹ä¸­çš„ Reaching_agreement_in_the_presence_of_faults.pdfï¼Œé™·å…¥æ²‰æ€ã€‚\n{% asset_img ReachAggrement-finger17.png finger17 %}\næœ€è¿‘ä»–çš„å†›é˜Ÿæ­£åœ¨æ”»æ‰“æ•Œæ–¹åŒæ ·å¼ºå¤§çš„åŸæ± ï¼Œéœ€è¦å°†é¢†ä»¬ååŒä¸€è‡´æ‰å¯åˆ¶èƒœã€‚è€Œä»–ä¹ŸçŸ¥é“ï¼Œå°†å†›ä»¬ä¸­é—´æœ‰å›å¾’ï¼Œæ­£å› æ­¤è¿›æ”»æ‰è€½æè®¸ä¹…ã€‚å¿½ç„¶ä»–çœ‰å¤´ä¸€çš±ï¼Œè®¡ä¸Šå¿ƒæ¥ï¼\n{% asset_img ReachAggrement-finger18.png finger18 %}\nå›½ç‹ç©¶ç«Ÿæƒ³åˆ°äº†ä»€ä¹ˆåŠæ³•å‘¢ï¼Ÿè¯·çœ‹ä¸‹å›ï¼š\n{% asset_img ReachAggrement-finger19.png finger19 %}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 å›æƒ³ä¸€ä¸‹ï¼Œä¸Šä¸€èŠ‚ç»™å‡ºçš„è¿‡ç¨‹éœ€è¦ä¸¤è½®ä¿¡æ¯äº¤æ¢ï¼Œç¬¬ä¸€è½®â€œæˆ‘çš„ç§æœ‰å€¼æ˜¯â€ï¼Œç¬¬äºŒè½®â€œèŠ‚ç‚¹xå‘Šè¯‰æˆ‘ä»–çš„ç§æœ‰å€¼æ˜¯....â€ã€‚åœ¨mä¸ªèŠ‚ç‚¹æ•…éšœçš„ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéœ€è¦m + 1è½®é€šä¿¡ã€‚ä¸ºäº†æè¿°è¯¥ç®—æ³•ï¼Œå¯ä»¥ä»¥æ›´é€šç”¨çš„æ–¹å¼æè¿°è¿™ç§æ¶ˆæ¯äº¤æ¢ã€‚ \u0026lt;center\u0026gt;P: èŠ‚ç‚¹é›†åˆ\u0026lt;/center\u0026gt; \u0026lt;center\u0026gt;V: å€¼çš„é›†åˆ\u0026lt;/center\u0026gt; å¯¹äº k\u0026gt;=1. å®šä¹‰k-scenarioä¸ºä»éç©ºå­—ç¬¦ä¸²ï¼ˆå¯èƒ½å«æœ‰é‡å¤ï¼‰P(length \u0026lt;= k+1) æ˜ å°„åˆ° Vã€‚å¯¹äºä¸€ä¸ªç»™å‡ºçš„k-level scenario Ïƒ å’Œå­—ç¬¦ä¸² w= p1p2...pr, 2\u0026lt;=r\u0026lt;=k+1, Ïƒ(w) æ„ä¸º pr-\\\u0026gt;p(r-1)-\\\u0026gt;p(r-2)-\u0026gt;Â·Â·Â·-\\\u0026gt;p2-\\\u0026gt;p1, ã€pr çš„ç§æœ‰å€¼ã€‘ã€‚å¯¹äºä¸€ä¸ªå•ä¸€å…ƒç´ çš„å­—ç¬¦ä¸²pï¼ŒÏƒpæŒ‡ä»£pçš„ç§æœ‰å€¼Vpã€‚ä¸€ä¸ªk-level scenario æ€»ç»“äº†kè½®ä¿¡æ¯äº¤æ¢çš„ç»“æœã€‚(è¯·æ³¨æ„ï¼Œå¦‚æœä¸€ä¸ªé”™è¯¯çš„èŠ‚ç‚¹ä¼ªé€ å…¶ä»–èŠ‚ç‚¹ç»™å®ƒçš„ä¿¡æ¯ï¼Œè¿™å°±ç›¸å½“äºå¯¹ç»™å®ƒçš„å€¼é€ å‡ã€‚)å¯¹äºä¸€ä¸ªæ­£å¸¸èŠ‚ç‚¹å­é›†ï¼Œåªæœ‰å¯èƒ½æ˜¯ç¡®å®šçš„æ˜ å°„ï¼šå°¤å…¶æ˜¯ï¼Œä¸€ä¸ªæ­£å¸¸èŠ‚ç‚¹åœ¨ä¼ é€’æ¶ˆæ¯æ—¶æ€»æ˜¯è¯šå®çš„ï¼Œæ‰€ä»¥å¯¹äºä¸€ä¸ªæ­£å¸¸èŠ‚ç‚¹qï¼Œä»»æ„èŠ‚ç‚¹pï¼Œä»¥åŠå­—ç¬¦ä¸²wæ¥è¯´ï¼Œä¸€ä¸ªscenarioä¸€å®šæ»¡è¶³ï¼šï¼ˆä¹Ÿå°±æ˜¯ä¼ é€’åˆ°qçš„å­—ç¬¦ä¸²ä¼šåŸå°ä¸åŠ¨åœ°ä¼ è¾¾ç»™pï¼‰ \u0026lt;center\u0026gt;Ïƒ(pqw) = Ïƒ(qw)\u0026lt;/center\u0026gt; èŠ‚ç‚¹påœ¨scenario Ïƒæ¥æ”¶çš„æ¶ˆæ¯ç”±Ïƒpå¯¹ä»¥på¼€å¤´çš„å­—ç¬¦ä¸²çš„é™åˆ¶æ“ä½œç»™å‡º(è¿™å¥è¯å¥½éš¾ç†è§£ï¼Œæˆ‘æ„Ÿè§‰æ˜¯åœ¨è¡¨è¾¾ï¼Œsecnario Ïƒ æ˜¯ç»™æ¥æºå­—ä¸²åŠ äº†ä¸€ä¸ªpå¤´)ã€‚ç°åœ¨æˆ‘ä»¬è¦æè¿°ï¼Œå¯¹äºä»»æ„m\u0026gt;=0,n\u0026gt;=3m+1, è®¡ç®—pçš„è¿‡ç¨‹ã€‚å¯¹äºä¸€ä¸ªç»™å®šçš„Ïƒp, å…¶ä¸­äº¤äº’ä¸€è‡´æ€§å‘é‡çš„å…ƒç´ å¯¹åº”ç€æ¯ä¸ªèŠ‚ç‚¹pã€‚è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š 1. å¯¹äºPçš„æŸä¸ªå¤§å°\u0026gt;(n+m)/2çš„å­é›†Qï¼ŒÏƒp(pwq) = v å¯¹äºæ¯ä¸ªé•¿åº¦\u0026lt;=mçš„å­—ä¸²wï¼ˆå–è‡ªQï¼‰éƒ½æˆç«‹ï¼Œé‚£ä¹ˆpè®°å½•ä¸‹vï¼› 2. å¦åˆ™ï¼Œç®—æ³•å°†é€’å½’åº”ç”¨m-1ï¼Œn-1ï¼Œä½¿P-{q}æ¥æ›¿ä»£Pï¼Œå¹¶ä¸”å¯¹äºæ¯ä¸ªé•¿åº¦ä¸å¤§äºmçš„å­—ä¸²wï¼ˆå–è‡ªäºP-{q}ï¼‰ \u0026lt;center\u0026gt;Ïƒp\u0026#39;(pw) = Ïƒp(pwq)\u0026lt;/center\u0026gt; å¦‚æœåœ¨è¿™å‘é‡n-1ä¸ªå…ƒç´ é‡Œæœ‰è‡³å°‘(n+m)/2ä¸ªå…ƒç´ å€¼ç›¸åŒï¼Œpè®°å½•ä¸‹è¯¥å€¼ï¼Œå¦åˆ™è®°å½•NILå€¼ã€‚ Ïƒp\u0026#39;ååº”äº†m-level Ïƒçš„å­åœºæ™¯ï¼Œå…¶ä¸­qè¢«æ’é™¤åœ¨å¤–ï¼Œå¹¶ä¸”åœ¨Ïƒp\u0026#39;æ¯ä¸ªèŠ‚ç‚¹çš„ç§æœ‰å€¼æ˜¯å®ƒç›´æ¥ä»Ïƒä¸­çš„qè·å¾—çš„å€¼ã€‚ é€šè¿‡å¯¹mè¿›è¡Œçº¦ç®€ï¼Œè¯æ˜ä¸Šè¿°ç®—æ³•ç¡®å®ä¿è¯äº†äº¤äº’ä¸€è‡´æ€§: Basis m=0ã€‚æ­¤æ—¶æ²¡æœ‰èŠ‚ç‚¹æ˜¯é”™è¯¯çš„ï¼Œç®—æ³•æ€»æ˜¯åœ¨ç¬¬ä¸€æ­¥ç»“æŸã€‚pè®°å½•Vqä¸ºqçš„ç§æœ‰å€¼ï¼› Induction Step m\u0026gt;0. å¦‚æœqæ˜¯æ­£å¸¸èŠ‚ç‚¹ï¼Œå¯¹äºæ¥è‡ªäºæ­£å¸¸èŠ‚ç‚¹é›†åˆçš„ï¼Œé•¿åº¦ä¸å¤§äºmçš„å­—ä¸²wï¼ˆåŒ…æ‹¬ç©ºä¸²ï¼‰ï¼ŒÏƒp(pwq)=Vqã€‚è¿™ä¸ªé›†åˆåŒ…å«äº†n-mä¸ªæˆå‘˜ï¼Œå¤šäº(n+m)/2ï¼Œæ»¡è¶³äº†æ¡ä»¶1. æ­¤å¤–ï¼Œæ»¡è¶³è¿™äº›è¦æ±‚çš„ä»»ä½•å…¶ä»–é›†åˆå¿…ç„¶åŒ…å«ä¸€ä¸ªæ­£å¸¸èŠ‚ç‚¹, å› ä¸ºé›†åˆæ•°é‡å¤§äº(n+m)/2ï¼Œè€Œn\u0026gt;=3m+1. å› æ­¤ä¹Ÿå¿…ç„¶å¾—åˆ°Vqä½œä¸ºå¯ç”¨å€¼ã€‚å› æ­¤ç®—æ³•åœ¨ç¬¬(1)æ­¥ç»ˆæ­¢ï¼ŒpæŒ‰è¦æ±‚è®°å½•Vqä¸ºqçš„ç§æœ‰å€¼ã€‚ ç°åœ¨å‡è®¾qæ˜¯é”™è¯¯çš„ã€‚æˆ‘ä»¬å¿…é¡»è¡¨æ˜pè®°å½•ä¸‹çš„qç§æœ‰å€¼Vqå’Œå…¶ä»–æ­£å¸¸èŠ‚ç‚¹ä¸€è‡´ã€‚ é¦–å…ˆè€ƒè™‘è¿™ç§æƒ…å†µï¼špå’Œå…¶ä»–èŠ‚ç‚¹p\u0026#39;éƒ½åœ¨step1ç»“æŸï¼Œä»–ä»¬éƒ½æ‰¾åˆ°äº†ä¸€ä¸ªåˆé€‚çš„é›†åˆQã€‚ç”±äºæ¯ä¸ªé›†åˆéƒ½åŒ…å«æœ‰(n+m)/2ä¸ªæˆå‘˜ï¼Œå¹¶ä¸”ç”±äºPæ€»å…±åªæœ‰nä¸ªæˆå‘˜ï¼Œä¸¤ä¸ªé›†åˆå¿…é¡»æœ‰è¶…è¿‡2((n + m)/2) - n = mä¸ªå…¬å…±æˆå‘˜ã€‚å› ä¸ºå…¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå¿…é¡»æ˜¯æ­£å¸¸çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªé›†åˆå¿…é¡»äº§ç”Ÿç›¸åŒçš„å€¼vã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å‡è®¾p\u0026#39;åœ¨step1é€€å‡ºäº†ï¼Œæ‰¾åˆ°äº†åˆé€‚çš„é›†åˆQä»¥åŠå€¼vï¼Œå¹¶ä¸”pæ‰§è¡Œstep2. ","date":"2022-08-11T00:00:00Z","permalink":"https://MyLoveES.github.io/p/reaching-agreement-in-the-presence-of-faults/","title":"Reaching agreement in the presence of faults"},{"content":"Byzantine Generals Problem ä¸€ç»„æ‹œå åº­å°†å†›åˆ†åˆ«å„ç‡é¢†ä¸€æ”¯å†›é˜Ÿå…±åŒå›´å›°ä¸€åº§åŸå¸‚ã€‚ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œå°†å„æ”¯å†›é˜Ÿçš„è¡ŒåŠ¨ç­–ç•¥é™å®šä¸ºè¿›æ”»æˆ–æ’¤ç¦»ä¸¤ç§ã€‚å› ä¸ºéƒ¨åˆ†å†›é˜Ÿè¿›æ”»éƒ¨åˆ†å†›é˜Ÿæ’¤ç¦»å¯èƒ½ä¼šé€ æˆç¾éš¾æ€§åæœï¼Œå› æ­¤å„ä½å°†å†›å¿…é¡»é€šè¿‡æŠ•ç¥¨æ¥è¾¾æˆä¸€è‡´ç­–ç•¥ï¼Œå³æ‰€æœ‰å†›é˜Ÿä¸€èµ·è¿›æ”»æˆ–æ‰€æœ‰å†›é˜Ÿä¸€èµ·æ’¤ç¦»ã€‚å› ä¸ºå„ä½å°†å†›åˆ†å¤„åŸå¸‚ä¸åŒæ–¹å‘ï¼Œä»–ä»¬åªèƒ½é€šè¿‡ä¿¡ä½¿äº’ç›¸è”ç³»ã€‚åœ¨æŠ•ç¥¨è¿‡ç¨‹ä¸­æ¯ä½å°†å†›éƒ½å°†è‡ªå·±æŠ•ç¥¨ç»™è¿›æ”»è¿˜æ˜¯æ’¤é€€çš„ä¿¡æ¯é€šè¿‡ä¿¡ä½¿åˆ†åˆ«é€šçŸ¥å…¶ä»–æ‰€æœ‰å°†å†›ï¼Œè¿™æ ·ä¸€æ¥æ¯ä½å°†å†›æ ¹æ®è‡ªå·±çš„æŠ•ç¥¨å’Œå…¶ä»–æ‰€æœ‰å°†å†›é€æ¥çš„ä¿¡æ¯å°±å¯ä»¥çŸ¥é“å…±åŒçš„æŠ•ç¥¨ç»“æœè€Œå†³å®šè¡ŒåŠ¨ç­–ç•¥ã€‚\nç³»ç»Ÿçš„é—®é¢˜åœ¨äºï¼Œå¯èƒ½å°†å†›ä¸­å‡ºç°å›å¾’ï¼Œä»–ä»¬ä¸ä»…å¯èƒ½å‘è¾ƒä¸ºç³Ÿç³•çš„ç­–ç•¥æŠ•ç¥¨ï¼Œè¿˜å¯èƒ½é€‰æ‹©æ€§åœ°å‘é€æŠ•ç¥¨ä¿¡æ¯ã€‚å‡è®¾æœ‰9ä½å°†å†›æŠ•ç¥¨ï¼Œå…¶ä¸­1åå›å¾’ã€‚8åå¿ è¯šçš„å°†å†›ä¸­å‡ºç°äº†4äººæŠ•è¿›æ”»ï¼Œ4äººæŠ•æ’¤ç¦»çš„æƒ…å†µã€‚è¿™æ—¶å€™å›å¾’å¯èƒ½æ•…æ„ç»™4åæŠ•è¿›æ”»çš„å°†é¢†é€ä¿¡è¡¨ç¤ºæŠ•ç¥¨è¿›æ”»ï¼Œè€Œç»™4åæŠ•æ’¤ç¦»çš„å°†é¢†é€ä¿¡è¡¨ç¤ºæŠ•æ’¤ç¦»ã€‚è¿™æ ·ä¸€æ¥åœ¨4åæŠ•è¿›æ”»çš„å°†é¢†çœ‹æ¥ï¼ŒæŠ•ç¥¨ç»“æœæ˜¯5äººæŠ•è¿›æ”»ï¼Œä»è€Œå‘èµ·è¿›æ”»ï¼›è€Œåœ¨4åæŠ•æ’¤ç¦»çš„å°†å†›çœ‹æ¥åˆ™æ˜¯5äººæŠ•æ’¤ç¦»ã€‚è¿™æ ·å„æ”¯å†›é˜Ÿçš„ä¸€è‡´ååŒå°±é­åˆ°äº†ç ´åã€‚\nç”±äºå°†å†›ä¹‹é—´éœ€è¦é€šè¿‡ä¿¡ä½¿é€šè®¯ï¼Œå›å˜å°†å†›å¯èƒ½é€šè¿‡ä¼ªé€ ä¿¡ä»¶æ¥ä»¥å…¶ä»–å°†å†›çš„èº«ä»½å‘é€å‡æŠ•ç¥¨ã€‚è€Œå³ä½¿åœ¨ä¿è¯æ‰€æœ‰å°†å†›å¿ è¯šçš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸èƒ½æ’é™¤ä¿¡ä½¿è¢«æ•Œäººæˆªæ€ï¼Œç”šè‡³è¢«æ•Œäººé—´è°æ›¿æ¢ç­‰æƒ…å†µã€‚å› æ­¤å¾ˆéš¾é€šè¿‡ä¿è¯äººå‘˜å¯é æ€§åŠé€šè®¯å¯é æ€§æ¥è§£å†³é—®é¢˜ã€‚\nå‡ä½¿é‚£äº›å¿ è¯šï¼ˆæˆ–æ˜¯æ²¡æœ‰å‡ºé”™ï¼‰çš„å°†å†›ä»ç„¶èƒ½é€šè¿‡å¤šæ•°å†³å®šæ¥å†³å®šä»–ä»¬çš„æˆ˜ç•¥ï¼Œä¾¿ç§°è¾¾åˆ°äº†æ‹œå åº­å®¹é”™ã€‚åœ¨æ­¤ï¼Œç¥¨éƒ½ä¼šæœ‰ä¸€ä¸ªé¢„è®¾å€¼ï¼Œè‹¥è®¯æ¯ï¼ˆç¥¨ï¼‰æ²¡æœ‰è¢«æ”¶åˆ°ï¼Œåˆ™ä½¿ç”¨æ­¤é¢„è®¾å€¼æ¥æŠ•ç¥¨ã€‚\nä¸Šè¿°çš„æ•…äº‹å¯¹æ˜ åˆ°è®¡ç®—æœºç³»ç»Ÿé‡Œï¼Œå°†å†›ä¾¿æˆäº†è®¡ç®—æœºï¼Œè€Œä¿¡å·®å°±æ˜¯é€šè®¯ç³»ç»Ÿã€‚è™½ç„¶ä¸Šè¿°çš„é—®é¢˜æ¶‰åŠäº†ç”µå­åŒ–çš„å†³ç­–æ”¯æ´ä¸èµ„è®¯å®‰å…¨ï¼Œå´æ²¡åŠæ³•å•çº¯çš„ç”¨å¯†ç å­¦ä¸æ•°ä½ç­¾ç« æ¥è§£å†³ã€‚å› ä¸ºç”µè·¯é”™è¯¯ä»å¯èƒ½å½±å“æ•´ä¸ªåŠ å¯†è¿‡ç¨‹ï¼Œè¿™ä¸æ˜¯å¯†ç å­¦ä¸æ•°ä½ç­¾ç« æ¼”ç®—æ³•åœ¨è§£å†³çš„é—®é¢˜ã€‚å› æ­¤è®¡ç®—æœºå°±æœ‰å¯èƒ½å°†é”™è¯¯çš„ç»“æœé€å‡ºå»ï¼Œäº¦å¯èƒ½å¯¼è‡´é”™è¯¯çš„å†³ç­–ã€‚\n","date":"2022-07-11T00:00:00Z","permalink":"https://MyLoveES.github.io/p/%E6%8B%9C%E5%8D%A0%E5%BA%AD%E5%B0%86%E5%86%9B-%E5%8C%85%E5%90%AB%E6%81%B6%E6%84%8F%E8%8A%82%E7%82%B9%E7%9A%84%E5%85%B1%E8%AF%86%E9%97%AE%E9%A2%98/","title":"æ‹œå åº­å°†å†› - åŒ…å«æ¶æ„èŠ‚ç‚¹çš„å…±è¯†é—®é¢˜"},{"content":"INTRODUCTION A reliable computer system must be able to cope with the failure of one or more of its components. A failed component may exhibit a type of behavior that is often overlooked\u0026ndash;namely, sending conflicting information to different parts of the system. The problem of coping with this type of failure is expressed abstractly as the Byzantine Generals Problem. We devote the major part of the paper to a discussion of this abstract problem and conclude by indicating how our solutions can be used in implementing a reliable computer system. We imagine that several divisions of the Byzantine army are camped outside an enemy city, each division commanded by its own general. The generals can communicate with one another only by messenger. After observing the enemy, they must decide upon a common plan of action. However, some of the generals may be traitors, trying to prevent the loyal generals from reaching agreement. The generals must have an algorithm to guarantee that\nä¸€ä¸ªå¯é çš„è®¡ç®—æœºç³»ç»Ÿå¿…é¡»èƒ½å¤Ÿåº”ä»˜å®ƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªéƒ¨ä»¶çš„æ•…éšœã€‚ä¸€ä¸ªå¤±è´¥çš„ç»„ä»¶å¯èƒ½ä¼šè¡¨ç°å‡ºä¸€ç§ç»å¸¸è¢«å¿½ç•¥çš„è¡Œä¸ºâ€”â€”å³ï¼Œå‘ç³»ç»Ÿçš„ä¸åŒéƒ¨åˆ†å‘é€å†²çªçš„ä¿¡æ¯ã€‚åº”å¯¹è¿™ç§ç±»å‹çš„å¤±è´¥çš„é—®é¢˜è¢«æŠ½è±¡åœ°è¡¨è¾¾ä¸ºæ‹œå åº­å°†å†›é—®é¢˜ã€‚æˆ‘ä»¬å°†è®ºæ–‡çš„ä¸»è¦éƒ¨åˆ†ç”¨äºè®¨è®ºè¿™ä¸€æŠ½è±¡é—®é¢˜ï¼Œå¹¶é€šè¿‡è¡¨æ˜æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆå¯ä»¥ç”¨äºå®ç°ä¸€ä¸ªå¯é çš„è®¡ç®—æœºç³»ç»Ÿã€‚æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæ‹œå åº­å†›é˜Ÿçš„å‡ ä¸ªå¸ˆåœ¨æ•Œäººçš„åŸå¸‚å¤–æ‰è¥ï¼Œæ¯ä¸ªå¸ˆç”±è‡ªå·±çš„å°†å†›æŒ‡æŒ¥ã€‚å°†å†›ä»¬åªèƒ½é€šè¿‡ä¿¡ä½¿ç›¸äº’è”ç³»ã€‚åœ¨è§‚å¯Ÿæ•Œäººä¹‹åï¼Œä»–ä»¬å¿…é¡»å†³å®šä¸€ä¸ªå…±åŒçš„è¡ŒåŠ¨è®¡åˆ’ã€‚ç„¶è€Œï¼Œæœ‰äº›å°†å†›å¯èƒ½æ˜¯å›å¾’ï¼Œè¯•å›¾é˜»æ­¢å¿ è¯šçš„å°†å†›è¾¾æˆåè®®ã€‚å°†å†›ä»¬è‚¯å®šæœ‰ç®—æ³•æ¥ä¿è¯:\nA. All loyal generals decide upon the same plan of action. The loyal generals will all do what the algorithm says they should, but the traitors may do anything they wish. The algorithm must guarantee condition A regardless of what the traitors do. The loyal generals should not only reach agreement, but should agree upon a reasonable plan. We therefore also want to insure that.\nA. æ‰€æœ‰å¿ è¯šçš„å°†å†›éƒ½å†³å®šç›¸åŒçš„è¡ŒåŠ¨è®¡åˆ’ã€‚ å¿ è¯šçš„å°†å†›éƒ½ä¼šæŒ‰ç…§ç®—æ³•çš„è¦æ±‚è¡Œäº‹ï¼Œè€Œå›å¾’åˆ™å¯ä»¥éšå¿ƒæ‰€æ¬²ã€‚ç®—æ³•å¿…é¡»ä¿è¯ä¸ç®¡å›å¾’åšäº†ä»€ä¹ˆ, æ‰€æœ‰å¿ è¯šçš„å°†å†›éƒ½å†³å®šç›¸åŒçš„è¡ŒåŠ¨è®¡åˆ’ã€‚å¿ è¯šçš„å°†å†›ä»¬ä¸ä»…è¦è¾¾æˆä¸€è‡´ï¼Œè€Œä¸”è¦å•†å®šä¸€ä¸ªåˆç†çš„è®¡åˆ’ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå¸Œæœ›ç¡®ä¿è¿™ä¸€ç‚¹\nB. A small number of traitors cannot cause the loyal generals to adopt a bad plan. B. å°‘æ•°å›å¾’ä¸èƒ½ä½¿å¿ è¯šçš„å°†å†›é‡‡å–é”™è¯¯çš„è®¡åˆ’ã€‚\nCondition B is hard to formalize, since it requires saying precisely what a bad plan is, and we do not attempt to do so. Instead, we consider how the generals reach a decision. Each general observes the enemy and communicates his observations to the others. Let v(i) be the information communicated by the ith general. Each general uses some method for combining the values v (1) \u0026hellip;.. v(n) into a single plan of action, where n is the number of generals. Condition A is achieved by having all generals use the same method for combining the information, and Condition B is achieved by using a robust method. For example, if the only decision to be made is whether to attack or retreat, then v(i) con be General i\u0026rsquo;s opinion of which option is best, and the final decision can be based upon a majority vote among them. A small number of traitors can affect the decision only if the loyal generals were almost equally divided between the two possibilities, in which case neither decision could be called bad. While this approach may not be the only way to satisfy conditions A and B, it is the only one we know of. It assumes a method by which the generals communicate their values v (i) to one another. The obvious method is for the ith general to send v (i) by messenger to each other general. However, this does not work, because satisfying condition A requires that every loyal general obtain the same values v(1) \u0026hellip;.. v(n), and a traitorous general may send different values to different generals. For condition A to be satisfied, the following must be true:\næ¡ä»¶Bå¾ˆéš¾å»å…·è±¡åŒ–ï¼Œå› ä¸ºå®ƒéœ€è¦å‡†ç¡®åœ°è¯´æ¸…æ¥šé”™è¯¯çš„è®¡åˆ’æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬ä¸æ‰“ç®—å»å…·ä½“æè¿°å®ƒã€‚ç›¸åï¼Œæˆ‘ä»¬è€ƒè™‘å°†å†›ä»¬å¦‚ä½•è¾¾æˆè¿™ä¸ªå…±è¯†ã€‚æ¯ä¸ªå°†å†›è§‚å¯Ÿæ•Œäººå¹¶ä¸”å’Œå…¶ä»–äººæ²Ÿé€šä»–çš„è§‚å¯Ÿç»“æœã€‚è®¾v(i)æ˜¯å°†å†›iæ‰€ä¼ è¾¾çš„ä¿¡æ¯ï¼Œæ¯ä¸ªå°†å†›ä½¿ç”¨ä¸€äº›æ–¹æ³•æ¥è®©v(1)~v(n)å½¢æˆä¸€ä¸ªå…·ä½“çš„è¡ŒåŠ¨ã€‚æ¡ä»¶Aæ˜¯é€šè¿‡è®©æ‰€æœ‰çš„å°†å†›ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•æ¥ç»„åˆä¿¡æ¯æ¥å®ç°çš„ï¼Œæ¡ä»¶Bæ˜¯é€šè¿‡ä½¿ç”¨é²æ£’çš„æ–¹æ³•æ¥å®ç°çš„ã€‚æ¯”å¦‚ï¼Œå¦‚æœå†³ç­–æ˜¯å»è¿›æ”»æˆ–è€…æ’¤é€€ï¼Œv(i)æ˜¯å°†å†›iè®¤ä¸ºæœ€ä½³çš„é€‰é¡¹ï¼Œæœ€ç»ˆç»“è®ºå¯ä»¥é€šè¿‡ä»–ä»¬çš„å¤šæ•°æŠ•ç¥¨å†³å®šã€‚åªæœ‰å½“å¿ è¯šçš„å°†é¢†å‡ ä¹å¹³åˆ†ä¸¤ç§å¯èƒ½æ€§æ—¶ï¼Œå°‘æ•°å›å¾’æ‰èƒ½å½±å“å†³ç­–ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»»ä½•ä¸€ä¸ªå†³ç­–éƒ½ä¸èƒ½è¢«ç§°ä¸ºé”™è¯¯çš„å†³å®šã€‚è™½ç„¶è¿™ç§æ–¹æ³•å¯èƒ½ä¸æ˜¯æ»¡è¶³æ¡ä»¶Aå’ŒBçš„å”¯ä¸€æ–¹æ³•ï¼Œä½†å®ƒæ˜¯æˆ‘ä»¬æ‰€çŸ¥é“çš„å”¯ä¸€æ–¹æ³•ã€‚å®ƒå‡å®šäº†ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå°†å†›ä»¬äº’ç›¸ä¼ è¾¾ä»–ä»¬çš„ä»·å€¼è§‚v (i)ã€‚æœ€æ˜æ˜¾çš„æ–¹æ³•æ˜¯ç¬¬iä¸ªå°†å†›é€šè¿‡ä¿¡ä½¿å‘é€v (i)ç»™å…¶ä»–å°†å†›ã€‚ç„¶è€Œï¼Œè¿™æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºæ»¡è¶³æ¡ä»¶Aè¦æ±‚æ¯ä¸ªå¿ è¯šçš„å°†å†›éƒ½è·å¾—ç›¸åŒçš„å€¼v(1) \u0026hellip;..V (n)ï¼Œä¸€ä¸ªå›å˜çš„å°†å†›å¯èƒ½ä¼šå‘ä¸åŒçš„å°†å†›ä¼ è¾¾ä¸åŒçš„ä»·å€¼è§‚ã€‚è¦æ»¡è¶³æ¡ä»¶Aï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶:\n1) Every loyal general must obtain the same information v (1) \u0026hellip;. , v (n). Condition 1 implies that a general cannot necessarily use a value of v(i) obtained directly from the ith general, since a traitorous ith general may send different values to different generals. This means that unless we are careful, in meeting condition 1 we might introduce the possibility that the generals use a value of v (i) different from the one sent by the ith general\u0026ndash;even though the ith general is loyal. We must not allow this to happen if condition B is to be met. For example, we cannot permit a few traitors to cause the loya generals to base their decision upon the values \u0026ldquo;retreat\u0026rdquo;,\u0026hellip;, \u0026ldquo;retreat\u0026rdquo; if every loyal general sent the value \u0026ldquo;attack\u0026rdquo;. We therefore have the following requirement for each i:\næ¯ä¸ªå¿ è¯šçš„å°†å†›å¿…é¡»è·å¾—ç›¸åŒçš„ä¿¡æ¯v (1) \u0026hellip;.ï¼Œ v(n)ã€‚ æ¡ä»¶1è¡¨æ˜ï¼Œå°†å†›ä¸èƒ½ä½¿ç”¨ç›´æ¥ä»ç¬¬iä¸ªå°†å†›å¤„è·å¾—çš„v(i)çš„å€¼ï¼Œå› ä¸ºå›å˜çš„ç¬¬iä¸ªå°†å†›å¯èƒ½ä¼šå‘ä¸åŒçš„å°†å†›å‘é€ä¸åŒçš„å€¼ã€‚è¿™æ„å‘³ç€ï¼Œé™¤éæˆ‘ä»¬å¾ˆå°å¿ƒï¼Œåœ¨æ»¡è¶³æ¡ä»¶1æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¼•å…¥è¿™æ ·ä¸€ç§å¯èƒ½æ€§:å°†å†›ä½¿ç”¨çš„v (i)å€¼ä¸ç¬¬iä¸ªå°†å†›å‘é€çš„å€¼ä¸åŒâ€”â€”å³ä½¿ç¬¬iä¸ªå°†å†›æ˜¯å¿ è¯šçš„ã€‚å¦‚æœè¦æ»¡è¶³æ¡ä»¶Bï¼Œæˆ‘ä»¬å†³ä¸èƒ½å…è®¸è¿™ç§æƒ…å†µå‘ç”Ÿã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¸èƒ½å…è®¸å°‘æ•°å›å¾’ä½¿å¿ è¯šå°†å†›ä»¬æ ¹æ® â€œretreatâ€\u0026hellip;..\u0026ldquo;retreat\u0026rdquo; çš„ä»·å€¼è§‚ä½œå‡ºå†³å®šï¼Œå¦‚æœæ¯ä¸€ä¸ªå¿ è¯šçš„å°†å†›éƒ½å‘å‡ºâ€œè¿›æ”»â€çš„æŒ‡ä»¤ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªiæœ‰ä»¥ä¸‹è¦æ±‚:\n2) If the ith general is loyal, then the value that he sends must be used by every loyal general as the value of v (i). å¦‚æœç¬¬iä¸ªå°†å†›æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆä»–å‘é€çš„å€¼å¿…é¡»è¢«æ¯ä¸ªå¿ è¯šçš„å°†å†›ç”¨ä½œv (i)çš„å€¼ã€‚ We can rewrite condition I as the condition that for every i (whether or not the ith general is loyal):\n1\u0026rsquo;. Any two loyal generals use the same value of v(i).\nConditions 1\u0026rsquo; and 2 are both conditions on the single value sent by the ith general. We can therefore restrict our consideration to the problem of how a single general sends his value to the others. We phrase this in terms of a commanding general sending an order to his lieutenants, obtaining the following problem. Byzantine Generals Problem. A commanding general must send an order to his n - 1 lieutenant generals such that\næ¡ä»¶1\u0026rsquo;å’Œ2éƒ½æ˜¯ç¬¬iä¸ªå°†å†›å‘é€çš„å•ä¸ªå€¼çš„æ¡ä»¶ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬çš„è€ƒè™‘é™åˆ¶åœ¨ä¸€ä¸ªå°†å†›å¦‚ä½•æŠŠä»–çš„å€¼ä¼ é€’ç»™å…¶ä»–äººçš„é—®é¢˜ä¸Šã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªå°†å†›å‘ä»–çš„å‰¯æ‰‹ä»¬å‘å‡ºå‘½ä»¤çš„æ–¹å¼æ¥è¡¨è¿°è¿™ä¸ªé—®é¢˜ï¼Œå¾—åˆ°äº†ä¸‹é¢çš„é—®é¢˜ã€‚æ‹œå åº­å°†å†›çš„é—®é¢˜ã€‚ä¸€ä½æŒ‡æŒ¥å®˜å¿…é¡»å‘ä»–çš„n - 1åä¸­å°†å‘å‡ºè¿™æ ·çš„å‘½ä»¤:\nIC1. All loyal lieutenants obey the same order. IC2. If the commanding general is loyal, then every loyal lieutenant obeys the order he sends. IC1ã€‚æ‰€æœ‰å¿ è¯šçš„ä¸­å°‰éƒ½æœä»åŒä¸€æ¡å‘½ä»¤ã€‚ IC2ã€‚å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆæ¯ä¸ªå¿ è¯šçš„ä¸­å°‰éƒ½ä¼šæœä»ä»–çš„å‘½ä»¤ã€‚\nConditions IC1 and IC2 are called the interactive consistency conditions. Note that if the commander is loyal, then IC1 follows from IC2. However, the commander need not be loyal. To solve our original problem, the ith general sends his value of v(i) by using a solution to the Byzantine Generals Problem to send the order \u0026ldquo;use v (i) as my value\u0026rdquo;, with the other generals acting as the lieutenants.\nIC1å’ŒIC2ç§°ä¸ºäº¤äº’ä¸€è‡´æ€§æ¡ä»¶ã€‚æ³¨æ„ï¼Œå¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼ŒIC1åŒ…å«äºIC2ã€‚ä½†æ˜¯æŒ‡æŒ¥å®˜ä¸ä¸€å®šæ˜¯å¿ è¯šçš„ã€‚ä¸ºäº†è§£å†³æˆ‘ä»¬æœ€åˆçš„é—®é¢˜ï¼Œç¬¬iä¸ªå°†å†›å‘å‡ºä»–çš„å€¼v(i)ï¼Œé€šè¿‡ä½¿ç”¨æ‹œå åº­å°†å†›é—®é¢˜çš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå‘é€å‘½ä»¤â€œä½¿ç”¨v(i)ä½œä¸ºæˆ‘çš„å€¼â€ï¼Œå…¶ä»–å°†å†›å……å½“ä¸­å°‰ã€‚\n2. IMPOSSIBILITY RESULTS ä¸å¯èƒ½çš„ç»“æœ The Byzantine Generals Problem seems deceptively simple. Its difficulty is indicated by the surprising fact that if the generals can send only oral messages, then no solution will work unless more than two-thirds of the generals are loyal. In particular, with only three generals, no solution can work in the presence of a single traitor. An oral message is one whose contents are completely under the control of the sender, so a traitorous sender can transmit any possible message. Such a message corresponds to the type of message that computers normally send to one another. In Section 4 we consider signed, written messages, for which this is not true.\nWe now show that with oral messages no solution for three generals can handle a single traitor. For simplicity, we consider the case in which the only possible decisions are \u0026ldquo;attack\u0026rdquo; or \u0026ldquo;retreat\u0026rdquo;. Let us first examine the scenario pictured in Figure 1 in which the commander is loyal and sends an \u0026ldquo;attack\u0026rdquo; order, but Lieutenant 2 is a traitor and reports to Lieutenant 1 that he received a \u0026ldquo;retreat\u0026rdquo; order. For IC2 to be satisfied, Lieutenant 1 must obey the order to attack.\nNow consider another scenario, shown in Figure 2, in which the commander is a traitor and sends an \u0026ldquo;attack\u0026rdquo; order to Lieutenant 1 and a \u0026ldquo;retreat\u0026rdquo; order to Lieutenant 2. Lieutenant 1 does not know who the traitor is, and he cannot tell what message the commander actually sent to Lieutenant 2. Hence, the scenarios in these two pictures appear exactly the same to Lieutenant 1. If the traitor lies consistently, then there is no way for Lieutenant 1 to distinguish between these two situations, so he must obey the \u0026ldquo;attack\u0026rdquo; order in both of them. Hence, whenever Lieutenant 1 receives an \u0026ldquo;attack\u0026rdquo; order from the commander, he must obey it.\næ‹œå åº­å°†å†›é—®é¢˜çœ‹ä¼¼ç®€å•ã€‚ä»–çš„å›°éš¾ç‚¹åœ¨äºï¼Œå¦‚æœå°†å†›ä»¬åªèƒ½å£å¤´ä¼ é€’ä¿¡æ¯ï¼Œé‚£ä¹ˆé™¤éä¸‰åˆ†ä¹‹äºŒçš„å°†å†›æ˜¯å¿ è¯šçš„ï¼Œå¦åˆ™ä¸ä¼šæœ‰è§£å†³æ–¹æ¡ˆã€‚ç‰¹åˆ«æ˜¯ï¼Œåªæœ‰ä¸‰ä¸ªå°†å†›ï¼Œä»»ä½•è§£å†³æ–¹æ¡ˆåœ¨ä¸€ä¸ªå›å¾’é¢å‰éƒ½æ— æ³•å¥æ•ˆã€‚å£å¤´ä¿¡æ¯çš„å†…å®¹å®Œå…¨åœ¨å‘é€è€…çš„æ§åˆ¶ä¹‹ä¸‹ï¼Œæ‰€ä»¥ä¸€ä¸ªå›å›½çš„å‘é€è€…å¯ä»¥ä¼ é€’ä»»ä½•å¯èƒ½çš„ä¿¡æ¯ã€‚è¿™ç§æ¶ˆæ¯å¯¹åº”äºè®¡ç®—æœºé€šå¸¸ç›¸äº’å‘é€çš„æ¶ˆæ¯ç±»å‹ã€‚åœ¨ç¬¬4èŠ‚ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ç­¾åçš„ä¹¦é¢æ¶ˆæ¯, å¯¹äºè¿™æ ·çš„æ¶ˆæ¯ï¼Œè¿™æ˜¯åšä¸åˆ°çš„ï¼ˆæŒ‡çš„æ˜¯ç­¾åçš„ä¹¦é¢æ¶ˆæ¯ï¼Œä¸ä¼šè®©å›å¾’éšæ„ä¼ é€’æ¶ˆæ¯ï¼‰ã€‚\næˆ‘ä»¬ç°åœ¨è¯æ˜ï¼Œé€šè¿‡å£å¤´æ¶ˆæ¯ï¼Œä¸‰ä¸ªå°†å†›çš„è§£å†³æ–¹æ¡ˆå¯¹ä»˜ä¸äº†ä¸€ä¸ªå›å¾’ã€‚è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å›¾1æ‰€ç¤ºçš„åœºæ™¯:æŒ‡æŒ¥å®˜å¾ˆå¿ è¯šï¼Œå‘å‡ºäº†â€œæ”»å‡»â€å‘½ä»¤ï¼Œä½†ä¸­å°‰2æ˜¯å›å¾’ï¼Œä»–å‘ä¸­å°‰1æŠ¥å‘Šä»–æ”¶åˆ°äº†â€œæ’¤é€€â€å‘½ä»¤ã€‚ä¸ºäº†ä½¿IC2æ»¡æ„ï¼Œä¸­å°‰1å¿…é¡»æœä»æ”»å‡»å‘½ä»¤ã€‚\nç°åœ¨è€ƒè™‘å¦ä¸€ç§åœºæ™¯ï¼Œå¦‚å›¾2æ‰€ç¤ºï¼Œå…¶ä¸­æŒ‡æŒ¥å®˜æ˜¯å›å¾’ï¼Œå‘ä¸­å°‰1å‘é€â€œæ”»å‡»â€å‘½ä»¤ï¼Œå‘ä¸­å°‰2å‘é€â€œæ’¤é€€â€å‘½ä»¤ã€‚ä¸­å°‰1ä¸çŸ¥é“å›å¾’æ˜¯è°ï¼Œä»–ä¹Ÿä¸çŸ¥é“æŒ‡æŒ¥å®˜åˆ°åº•ç»™ä¸­å°‰2å‘äº†ä»€ä¹ˆä¿¡æ¯ã€‚å› æ­¤ï¼Œåœ¨ä¸­å°‰1çœ‹æ¥ï¼Œè¿™ä¸¤å¹…å›¾ä¸­çš„åœºæ™¯æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚å¦‚æœå›å¾’ä¸€ç›´è¯´è°ï¼Œé‚£ä¹ˆä¸­å°‰1å°±æ²¡æœ‰åŠæ³•åŒºåˆ†è¿™ä¸¤ç§æƒ…å†µï¼Œæ‰€ä»¥ä»–å¿…é¡»åœ¨ä¸¤ç§æƒ…å†µä¸‹éƒ½æœä»â€œæ”»å‡»â€å‘½ä»¤ã€‚å› æ­¤ï¼Œæ¯å½“ä¸­å°‰æ”¶åˆ°æŒ‡æŒ¥å®˜çš„â€œæ”»å‡»â€å‘½ä»¤æ—¶ï¼Œä»–å¿…é¡»éµå®ˆã€‚\nHowever, a similar argument shows that if Lieutenant 2 receives a \u0026ldquo;retreat\u0026rdquo; order from the commander then he must obey it even if Lieutenant 1 tells him that the commander said \u0026ldquo;attack\u0026rdquo;. Therefore, in the scenario of Figure 2, Lieutenant 2 must obey the \u0026ldquo;retreat\u0026rdquo; order while Lieutenant 1 obeys the \u0026ldquo;attack\u0026rdquo; order, thereby violating condition IC1. Hence, no solution exists for three generals that works in the presence of a single traitor.\nThis argument may appear convincing, but we strongly advise the reader to be very suspicious of such nonrigorous reasoning. Although this result is indeed correct, we have seen equally plausible \u0026ldquo;proofs\u0026rdquo; of invalid results. We know of no area in computer science or mathematics in which informal reasoning is more likely to lead to errors than in the study of this type of algorithm. For a rigorous proof of the impossibility of a three-general solution that can handle a single traitor, we refer the reader to [3].\nç„¶è€Œï¼Œä¸€ä¸ªç±»ä¼¼çš„è®ºç‚¹è¡¨æ˜ï¼Œå¦‚æœä¸­å°‰2æ”¶åˆ°æŒ‡æŒ¥å®˜çš„â€œæ’¤é€€â€å‘½ä»¤ï¼Œé‚£ä¹ˆä»–å¿…é¡»éµå®ˆï¼Œå³ä½¿ä¸­å°‰1å‘Šè¯‰ä»–æŒ‡æŒ¥å®˜è¯´çš„æ˜¯â€œæ”»å‡»â€ã€‚å› æ­¤ï¼Œåœ¨å›¾2åœºæ™¯ä¸­ï¼Œä¸­å°‰2å¿…é¡»æœä»â€œæ’¤é€€â€å‘½ä»¤ï¼Œè€Œä¸­å°‰1å¿…é¡»æœä»â€œè¿›æ”»â€å‘½ä»¤ï¼Œå› æ­¤è¿åäº†æ¡ä»¶IC1ã€‚å› æ­¤ï¼Œåœ¨ä¸€ä¸ªå›å¾’åœ¨åœºçš„æƒ…å†µä¸‹ï¼Œä¸‰ä¸ªå°†å†›æ˜¯ä¸å­˜åœ¨è§£å†³æ–¹æ¡ˆçš„ã€‚\nUsing this result, we can show that no solution with fewer than 3m + 1 generals can cope with m traitors. The proof is by contradiction\u0026ndash;we assume such a solution for a group of 3m or fewer and use it to construct a three-general solution to the Byzantine Generals Problem that works with one traitor, which we know to be impossible. To avoid confusion between the two algorithms, we call the generals of the assumed solution Albanian generals, and those of the constructed solution Byzantine generals. Thus, starting from an algorithm that allows 3m or fewer Albanian generals to cope with m traitors, we construct a solution that allows three Byzantine generals to handle a single traitor.\nThe three-general solution is obtained by having each of the Byzantine generals simulate approximately one-third of the Albanian generals, so that each Byzantine general is simulating at most m Albanian generals. The Byzantine commander simulates the Albanian commander plus at most m - 1 Albanian lieutenants, and each of the two Byzantine lieutenants simulates at most m Albanian lieutenants. Since only one Byzantine general can be a traitor, and he simulates at most m Albanians, at most m of the Albanian generals are traitors. Hence, the assumed solution guarantees that IC1 and IC2 hold for the Albanian generals. By IC1, all the Albanian lieutenants being simulated by a loyal Byzantine lieutenant obey the same order, which is the order he is to obey. It is easy to check that conditions IC1 and IC2 of the Albanian generals solution imply the corresponding conditions for the Byzantine generals, so we have constructed the required impossible solution.\nåˆ©ç”¨è¿™ä¸ªç»“æœï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜ï¼Œå°‘äº3m + 1ä¸ªå°†å†›çš„è§£æ— æ³•åº”å¯¹mä¸ªå›å¾’ã€‚è¯æ˜æ–¹æ³•æ˜¯çŸ›ç›¾çš„â€”â€”æˆ‘ä»¬å‡è®¾è¿™æ ·çš„è§£å¯¹äº3mæˆ–æ›´å°‘çš„ä¸€ç¾¤äººæ¥è¯´ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥æ„å»ºä¸€ä¸ªé€‚ç”¨äºä¸‰ä¸ªå°†å†›ï¼Œä¸€ä¸ªå›å¾’çš„æ‹œå åº­å°†å†›é—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚ä¸ºäº†é¿å…ä¸¤ç§ç®—æ³•ä¹‹é—´çš„æ··æ·†ï¼Œæˆ‘ä»¬ç§°å‡è®¾è§£çš„å°†å†›ä¸ºé˜¿å°”å·´å°¼äºšå°†å†›ï¼Œè€Œç§°æ„é€ è§£çš„å°†å†›ä¸ºæ‹œå åº­å°†å†›ã€‚å› æ­¤ï¼Œä»ä¸€ä¸ªå…è®¸3mæˆ–æ›´å°‘çš„é˜¿å°”å·´å°¼äºšå°†å†›å¯¹ä»˜mä¸ªå›å¾’çš„ç®—æ³•å¼€å§‹ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªå…è®¸3ä¸ªæ‹œå åº­å°†å†›å¯¹ä»˜ä¸€ä¸ªå›å¾’çš„è§£å†³æ–¹æ¡ˆã€‚\nä¸‰ä¸ªå°†å†›çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”±æ¯ä¸ªæ‹œå åº­å°†å†›æ¨¡æ‹Ÿå¤§çº¦ä¸‰åˆ†ä¹‹ä¸€çš„é˜¿å°”å·´å°¼äºšå°†å†›å¾—åˆ°çš„ï¼Œè¿™æ ·æ¯ä¸ªæ‹œå åº­å°†å†›æœ€å¤šæ¨¡æ‹Ÿmä¸ªé˜¿å°”å·´å°¼äºšå°†å†›ã€‚æ‹œå åº­æŒ‡æŒ¥å®˜æ¨¡æ‹Ÿé˜¿å°”å·´å°¼äºšæŒ‡æŒ¥å®˜åŠ ä¸Šæœ€å¤šm - 1ä¸ªé˜¿å°”å·´å°¼äºšä¸­å°‰ï¼Œä¸¤ä¸ªæ‹œå åº­ä¸­å°‰åˆ†åˆ«æ¨¡æ‹Ÿæœ€å¤šmä¸ªé˜¿å°”å·´å°¼äºšä¸­å°‰ã€‚å› ä¸ºåªæœ‰ä¸€ä¸ªæ‹œå åº­å°†å†›å¯ä»¥æ˜¯å›å¾’ï¼Œè€Œä¸”ä»–æœ€å¤šæ¨¡æ‹Ÿäº†mä¸ªé˜¿å°”å·´å°¼äºšäººï¼Œæ‰€ä»¥æœ€å¤šmä¸ªé˜¿å°”å·´å°¼äºšå°†å†›æ˜¯å›å¾’ã€‚å› æ­¤ï¼Œå‡å®šçš„è§£å†³æ–¹æ¡ˆä¿è¯äº†IC1å’ŒIC2é€‚ç”¨äºé˜¿å°”å·´å°¼äºšå°†å†›ã€‚åœ¨IC1ä¸­ï¼Œæ‰€æœ‰çš„é˜¿å°”å·´å°¼äºšä¸­å°‰éƒ½è¢«æ¨¡æ‹Ÿæˆä¸€ä¸ªå¿ è¯šçš„æ‹œå åº­ä¸­å°‰ï¼Œæœä»åŒä¸€æ¡å‘½ä»¤ï¼Œè¿™æ˜¯ä»–å¿…é¡»æœä»çš„å‘½ä»¤ã€‚å¾ˆå®¹æ˜“æ£€æŸ¥é˜¿å°”å·´å°¼äºšå°†å†›è§£çš„æ¡ä»¶IC1å’ŒIC2æ„å‘³ç€å¯¹åº”çš„æ‹œå åº­å°†å†›è§£çš„æ¡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬å·²ç»æ„é€ äº†æ‰€éœ€çš„ä¸å¯èƒ½è§£ã€‚\nOne might think that the difficulty in solving the Byzantine Generals Problem stems from the requirement of reaching exact agreement. We now demonstrate that this is not the case by showing that reaching approximate agreement is just as hard as reaching exact agreement. Let us assume that instead of trying to agree on a precise battle plan, the generals must agree only upon an approximate time of attack. More precisely, we assume that the commander orders the time of the attack, and we require the following two conditions to hold:\næœ‰äººå¯èƒ½ä¼šè®¤ä¸ºï¼Œè§£å†³æ‹œå åº­å°†å†›é—®é¢˜çš„å›°éš¾æºäºè¾¾æˆç¡®åˆ‡åè®®çš„è¦æ±‚ã€‚æˆ‘ä»¬ç°åœ¨é€šè¿‡è¡¨æ˜è¾¾æˆè¿‘ä¼¼ä¸€è‡´å’Œè¾¾æˆç²¾ç¡®ä¸€è‡´ä¸€æ ·å›°éš¾æ¥è¯æ˜ï¼Œæƒ…å†µå¹¶éå¦‚æ­¤ã€‚è®©æˆ‘ä»¬å‡è®¾ï¼Œå°†é¢†ä»¬ä¸å¿…å°±ç²¾ç¡®çš„ä½œæˆ˜è®¡åˆ’è¾¾æˆä¸€è‡´ï¼Œè€Œåªéœ€å°±å¤§è‡´çš„è¿›æ”»æ—¶é—´è¾¾æˆä¸€è‡´ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œæˆ‘ä»¬å‡è®¾æŒ‡æŒ¥å®˜ä¸‹ä»¤æ”»å‡»çš„æ—¶é—´ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æ‰èƒ½ç»´æŒä¸‹å»:\nIC1 \u0026lsquo;. All loyal lieutenants attack within 10 minutes of one another. IC2\u0026rsquo;. If the commanding general is loyal, then every loyal lieutenant attacks within 10 minutes of the time given in the commander\u0026rsquo;s order.\nIC1â€ã€‚æ‰€æœ‰å¿ è¯šçš„ä¸­å°‰éƒ½åœ¨ååˆ†é’Ÿå†…äº’ç›¸æ”»å‡»ã€‚ IC2â€ã€‚å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆæ¯ä¸ªå¿ è¯šçš„ä¸­å°‰åœ¨æŒ‡æŒ¥å®˜å‘½ä»¤çš„10åˆ†é’Ÿå†…æ”»å‡»ã€‚ (We assume that the orders are given and processed the day before the attack and that the time at which an order is received is irrelevant\u0026ndash;only the attack time given in the order matters.}\n(æˆ‘ä»¬å‡è®¾å‘½ä»¤æ˜¯åœ¨æ”»å‡»å‘ç”Ÿçš„å‰ä¸€å¤©å‘å‡ºå¹¶å¤„ç†çš„ï¼Œè€Œæ¥æ”¶åˆ°å‘½ä»¤çš„æ—¶é—´æ˜¯æ— å…³ç´§è¦çš„â€”â€”åªæœ‰å‘½ä»¤ä¸­ç»™å‡ºçš„æ”»å‡»æ—¶é—´æ˜¯é‡è¦çš„ã€‚)\nLike the Byzantine Generals Problem, this problem is unsolvable unless more than two-thirds of the generals are loyal. We prove this by first showing that if there were a solution for three generals that coped with one traitor, then we could construct a three-general solution to the Byzantine Generals Problem that also worked in the presence of one traitor. Suppose the commander wishes to send an \u0026ldquo;attack\u0026rdquo; or \u0026ldquo;retreat\u0026rdquo; order. He orders an attack by sending an attack time of 1:00 and orders a retreat by sending an attack time of 2:00, using the assumed algorithm. Each lieutenant uses the following procedure to obtain his order.\nå°±åƒæ‹œå åº­å°†å†›é—®é¢˜ä¸€æ ·ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯æ— æ³•è§£å†³çš„ï¼Œé™¤éè¶…è¿‡ä¸‰åˆ†ä¹‹äºŒçš„å°†å†›æ˜¯å¿ è¯šçš„ã€‚æˆ‘ä»¬é¦–å…ˆè¯æ˜ï¼Œå¦‚æœæœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥è§£å†³ä¸‰ä¸ªå°†å†›åŒæ—¶å¯¹ä»˜ä¸€ä¸ªå›å¾’ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„å»ºä¸€ä¸ªè§£å†³ä¸‰å°†å†›ä¸€å›å¾’çš„æ‹œå åº­å°†å†›é—®é¢˜ã€‚å‡è®¾æŒ‡æŒ¥å®˜æƒ³è¦å‘å‡ºâ€œè¿›æ”»â€æˆ–â€œæ’¤é€€â€çš„å‘½ä»¤ã€‚ä»–é€šè¿‡å‘é€1ç‚¹çš„æ”»å‡»æ—¶é—´æ¥å‘½ä»¤æ”»å‡»ï¼Œé€šè¿‡å‘é€2ç‚¹çš„æ”»å‡»æ—¶é—´æ¥å‘½ä»¤æ’¤é€€ï¼Œä½¿ç”¨å‡è®¾çš„ç®—æ³•ã€‚æ¯ä¸ªä¸­å°‰éƒ½ä½¿ç”¨ä»¥ä¸‹ç¨‹åºæ¥è·å¾—å‘½ä»¤ã€‚\n(1) After receiving the attack time from the commander, a lieutenant does one of the following: (a) If the time is 1:10 or earlier, then attack. (b) If the time is 1:50 or later, then retreat. (c) Otherwise, continue to step (2). (2) Ask the other lieutenant what decision he reached in step (1). (a) If the other lieutenant reached a decision, then make the same decision he did. (b) Otherwise, retreat. It follows from IC2\u0026rsquo; that if the commander is loyal, then a loyal lieutenant will obtain the correct order in step (1), so IC2 is satisfied. If the commander is loyal, then IC1 follows from IC2, so we need only prove IC1 under the assumption that the commander is a traitor. Since there is at most one traitor, this means that both lieutenants are loyal. It follows from ICI\u0026rsquo; that if one lieutenant decides to attack in step (1), then the other cannot decide to retreat in step (1). Hence, either they will both come to the same decision in step (1) or at least one of them will defer his decision until step (2). In this case, it is easy to see that they both arrive at the same decision, so IC1 is satisfied. We have therefore constructed a three-general solution to the Byzantine Generals Problem that handles one traitor, which is impossible. Hence, we cannot have a three-general algorithm that maintains ICI\u0026rsquo; and IC2\u0026rsquo; in the presence of a traitor. The method of having one general simulate m others can now be used to prove that no solution with fewer than 3rn + 1 generals can cope with m traitors. The proof is similar to the one for the original Byzantine Generals Problem and is left to the reader.\nç”±IC2â€™å¯çŸ¥ï¼Œå¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆå¿ è¯šçš„ä¸­å°‰å°†åœ¨æ­¥éª¤(1)ä¸­è·å¾—æ­£ç¡®çš„å‘½ä»¤ï¼Œå› æ­¤IC2æ˜¯æ»¡è¶³çš„ã€‚å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆIC1ä»IC2ç»§æ‰¿è€Œæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨æŒ‡æŒ¥å®˜æ˜¯å›å¾’çš„å‡è®¾ä¸‹è¯æ˜IC1ã€‚å› ä¸ºæœ€å¤šæœ‰ä¸€ä¸ªå›å¾’ï¼Œè¿™æ„å‘³ç€ä¸¤ä¸ªä¸­å°‰éƒ½æ˜¯å¿ è¯šçš„ã€‚æ ¹æ®ICI\u0026rsquo;å¯çŸ¥ï¼Œå¦‚æœä¸€ä¸ªä¸­å°‰åœ¨æ­¥éª¤(1)ä¸­å†³å®šè¿›æ”»ï¼Œé‚£ä¹ˆå¦ä¸€ä¸ªä¸­å°‰åœ¨æ­¥éª¤(1)ä¸­å°±ä¸èƒ½å†³å®šæ’¤é€€ã€‚å› æ­¤ï¼Œä»–ä»¬è¦ä¹ˆåœ¨æ­¥éª¤(1)ä¸­éƒ½åšå‡ºç›¸åŒçš„å†³å®šï¼Œè¦ä¹ˆè‡³å°‘æœ‰ä¸€ä¸ªä¼šæ¨è¿Ÿåˆ°æ­¥éª¤(2)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“çœ‹åˆ°ä»–ä»¬éƒ½åšå‡ºäº†ç›¸åŒçš„å†³å®šï¼Œæ‰€ä»¥IC1æ˜¯æ»¡æ„çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªè§£å†³ä¸‰å°†å†›ï¼Œä¸€å›å¾’çš„åŠæ³•ï¼Œä½†è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸èƒ½æœ‰ä¸€ä¸ªä¸‰å°†å†›ç®—æ³•ï¼Œåœ¨å›å¾’å­˜åœ¨çš„æƒ…å†µä¸‹ä¿æŒICI\u0026rsquo;å’ŒIC2\u0026rsquo;ã€‚ç”¨ä¸€ä¸ªå°†å†›æ¨¡æ‹Ÿmä¸ªå…¶ä»–å°†å†›æ¨¡æ‹Ÿçš„æ–¹æ³•ç°åœ¨å¯ä»¥ç”¨æ¥è¯æ˜ï¼Œæ²¡æœ‰ä¸€ä¸ªå°äº3rn + 1ä¸ªå°†å†›çš„è§£å¯ä»¥å¯¹ä»˜mä¸ªå›å¾’ã€‚è¿™ä¸ªè¯æ˜ç±»ä¼¼äºåŸæ¥çš„æ‹œå åº­å°†å†›é—®é¢˜ï¼Œç•™ç»™è¯»è€…ã€‚\n3. A SOLUTION WITH ORAL MESSAGES 3.ä¸€ä¸ªå£å¤´ä¿¡æ¯çš„è§£å†³æ–¹æ¡ˆ\nWe showed above that for a solution to the Byzantine Generals Problem using oral messages to cope with rn traitors, there must be at least 3m + 1 generals. We now give a solution that works for 3m + 1 or more generals. However, we first specify exactly what we mean by \u0026ldquo;oral messages\u0026rdquo;. Each general is supposed to execute some algorithm that involves sending messages to the other generals, and we assume that a loyal general correctly executes his algorithm. The definition of an oral message is embodied in the following assumptions which we make for the generals\u0026rsquo; message system:\næˆ‘ä»¬åœ¨ä¸Šé¢å±•ç¤ºè¿‡ï¼Œè¦æƒ³è§£å†³æ‹œå åº­å°†å†›é—®é¢˜ï¼Œç”¨å£å¤´ä¿¡æ¯æ¥å¯¹ä»˜rnå›å¾’ï¼Œè‡³å°‘éœ€è¦300m + 1åå°†å†›ã€‚æˆ‘ä»¬ç°åœ¨ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆé€‚ç”¨äº3m + 1æˆ–æ›´å¤šçš„å°†å†›ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬é¦–å…ˆå…·ä½“è¯´æ˜æˆ‘ä»¬æ‰€è¯´çš„â€œå£å¤´ä¿¡æ¯â€æ˜¯ä»€ä¹ˆæ„æ€ã€‚æ¯ä¸ªå°†å†›éƒ½åº”è¯¥æ‰§è¡Œä¸€äº›ç®—æ³•åŒ…æ‹¬å‘å…¶ä»–å°†å†›å‘é€æ¶ˆæ¯ï¼Œæˆ‘ä»¬å‡è®¾ä¸€ä¸ªå¿ è¯šçš„å°†å†›æ­£ç¡®åœ°æ‰§è¡Œä»–çš„ç®—æ³•ã€‚å£å¤´ä¿¡æ¯çš„å®šä¹‰ä½“ç°åœ¨æˆ‘ä»¬å¯¹å°†å†›ä¿¡æ¯ç³»ç»Ÿåšå‡ºçš„ä»¥ä¸‹å‡è®¾:\nA1. Every message that is sent is delivered correctly.\nA2. The receiver of a message knows who sent it.\nA3. The absence of a message can be detected.\nA1. å‘é€çš„æ¯ä¸ªæ¶ˆæ¯éƒ½è¢«æ­£ç¡®åœ°ä¼ é€’ã€‚ A2. æ¶ˆæ¯çš„æ¥æ”¶è€…çŸ¥é“æ˜¯è°å‘é€çš„ã€‚\nA3. å¯ä»¥æ£€æµ‹åˆ°æ¶ˆæ¯çš„ç¼ºå¤±ã€‚\nAssumptions A1 and A2 prevent a traitor from interfering with the communication between two other generals, since by A1 he cannot interfere with the messages they do send, and by A2 he cannot confuse their intercourse by introducing spurious messages. Assumption A3 will foil a traitor who tries to prevent a decision by simply not sending messages. The practical implementation of these assumptions is discussed in Section 6.\nå‡è®¾A1å’ŒA2å¯ä»¥é˜²æ­¢å›å¾’å¹²æ‰°å¦å¤–ä¸¤ä½å°†å†›ä¹‹é—´çš„é€šä¿¡ï¼Œå› ä¸ºA1ä¸èƒ½å¹²æ‰°ä»–ä»¬å®é™…å‘é€çš„ä¿¡æ¯ï¼Œè€ŒA2ä¸èƒ½é€šè¿‡å¼•å…¥è™šå‡ä¿¡æ¯æ¥æ··æ·†ä»–ä»¬çš„é€šä¿¡ã€‚å‡è®¾A3å°†æŒ«è´¥è¯•å›¾é€šè¿‡ä¸å‘é€æ¶ˆæ¯æ¥é˜»æ­¢å†³ç­–çš„å›å¾’ã€‚ç¬¬6èŠ‚å°†è®¨è®ºè¿™äº›å‡è®¾çš„å®é™…å®ç°ã€‚\nThe algorithms in this section and in the following one require that each general be able to send messages directly to every other general. In Section 5, we describe algorithms which do not have this requirement.\nA traitorous commander may decide not to send any order. Since the lieuten- ants must obey some order, they need some default order to obey in this case. We let RETREAT be this default order.\næœ¬èŠ‚å’Œä¸‹ä¸€èŠ‚ä¸­çš„ç®—æ³•è¦æ±‚æ¯ä¸ªå°†å†›èƒ½å¤Ÿç›´æ¥å‘å…¶ä»–å°†å†›å‘é€æ¶ˆæ¯ã€‚åœ¨ç¬¬5èŠ‚ä¸­ï¼Œæˆ‘ä»¬æè¿°çš„ç®—æ³•æ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚\nå›å›½çš„æŒ‡æŒ¥å®˜å¯ä»¥å†³å®šä¸å‘å‡ºä»»ä½•å‘½ä»¤ã€‚ç”±äºä¸­å°‰å¿…é¡»æœä»æŸäº›å‘½ä»¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»–ä»¬éœ€è¦ä¸€äº›é»˜è®¤çš„å‘½ä»¤æ¥æœä»ã€‚æˆ‘ä»¬è®©æ’¤é€€æˆä¸ºè¿™ä¸ªé»˜è®¤çš„å‘½ä»¤ã€‚\nWe inductively define the Oral Message algorithms OM(m), for all nonnegative integers m, by which a commander sends an order to n - 1 lieutenants. We show that OM(m) solves the Byzantine Generals Problem for 3m + 1 or more generals in the presence of at most m traitors. We find it more convenient to describe this algorithm in terms of the lieutenants \u0026ldquo;obtaining a value\u0026rdquo; rather than \u0026ldquo;obeying an order\u0026rdquo;.\næˆ‘ä»¬å½’çº³åœ°å®šä¹‰äº†å£å¤´æ¶ˆæ¯ç®—æ³•OM(m)ï¼Œå¯¹äºæ‰€æœ‰éè´Ÿæ•´æ•°mï¼ŒæŒ‡æŒ¥å®˜é€šè¿‡å®ƒå‘n - 1ä¸ªä¸­å°‰å‘é€å‘½ä»¤ã€‚æˆ‘ä»¬è¯æ˜OM(m)åœ¨æœ€å¤šmä¸ªå›å¾’å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œè§£å†³äº†3m + 1æˆ–æ›´å¤šå°†å†›çš„æ‹œå åº­å°†å†›é—®é¢˜ã€‚æˆ‘ä»¬å‘ç°ç”¨ä¸­å°‰â€œè·å–ä¸€ä¸ªå€¼â€æ¥æè¿°è¿™ä¸ªç®—æ³•æ¯”ç”¨â€œæœä»ä¸€ä¸ªå‘½ä»¤â€æ¥æè¿°æ›´æ–¹ä¾¿ã€‚\nThe algorithm assumes a function majority with the property that if a majority of the values vi equal v, then majority (V1,Â·Â·Â·, vn-1 equals v. (Actually, it assumes a sequence of such functions\u0026ndash;one for each n.) There are two natural choices for the value of majority(v1, \u0026hellip;, vn-1):\nè¯¥ç®—æ³•å‡è®¾å‡½æ•°å…·æœ‰å¦‚ä¸‹å±æ€§:å¦‚æœå¤§å¤šæ•°å€¼viç­‰äºvï¼Œé‚£ä¹ˆå¤§å¤šæ•°(V1,Â·Â·Â·ï¼Œvn-1)ç­‰äºv(å®é™…ä¸Šï¼Œå®ƒå‡è®¾æœ‰ä¸€ä¸ªè¿™æ ·çš„å‡½æ•°åºåˆ—â€”â€”æ¯ä¸ªnå¯¹åº”ä¸€ä¸ªå‡½æ•°)ã€‚å¤šæ•°çš„å€¼æœ‰ä¸¤ä¸ªè‡ªç„¶çš„é€‰æ‹©(v1ï¼Œâ€¦, vn-1):\nThe majority value among the vi if it exists, otherwise the value RETREAT;\nThe median of the vi, assuming that they come from an ordered set.\nå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¸ºviä¸­çš„å¤šæ•°å€¼ï¼Œå¦åˆ™ä¸ºRETREATå€¼ï¼›\nviçš„ä¸­ä½æ•°ï¼Œå‡è®¾å®ƒä»¬æ¥è‡ªä¸€ä¸ªæœ‰åºé›†åˆã€‚\nThe following algorithm requires only the aforementioned property of majority.\nä¸‹é¢çš„ç®—æ³•åªéœ€è¦ä¸Šè¿°çš„å¤šæ•°å±æ€§ã€‚\nAlgorithm OM(0).\n(1) The commander sends his value to every lieutenant.\n(2) Each lieutenant uses the value he receives from the commander, or uses the value RETREAT if he receives no value.\n(1) æŒ‡æŒ¥å®˜å°†ä»–çš„å€¼å‘é€ç»™æ¯ä¸ªä¸­å°‰ã€‚\n(2) æ¯ä¸ªä¸­å°‰ä½¿ç”¨ä»–ä»æŒ‡æŒ¥å®˜é‚£é‡Œæ”¶åˆ°çš„å€¼ï¼Œå¦‚æœä»–æ²¡æœ‰æ”¶åˆ°å€¼ï¼Œåˆ™ä½¿ç”¨RETREATã€‚\nAlgorithm OM(m), m \u0026gt; O.\n(1) The commander sends his value to every lieutenant.\n(2) For each i, let vi be the value Lieutenant i receives from the commander, or else be RETREAT if he receives no value. Lieutenant i acts as the commander in Algorithm OM(m - 1) to send the value vi to each of the n - 2 other lieutenants.\n(3) For each i, and each j ~ i, let vj be the value Lieutenant i received from Lieutenant j in step (2) (using Algorithm OM(m - 1)), or else RETREAT if he received no such value. Lieutenant i uses the value majority (vl \u0026hellip;.. vn-1).\n(1) å¸ä»¤å‘˜å‘æ¯ä¸€ä¸ªä¸­å°‰æŠ¥ä¿¡ã€‚\n(2) å¯¹äºæ¯ä¸€ä¸ªi, viä¸ºä¸­å°‰iä»æŒ‡æŒ¥å®˜é‚£é‡Œå¾—åˆ°çš„å€¼ï¼Œå¦åˆ™ä¸ºæ’¤é€€ï¼Œå¦‚æœä»–æ²¡æœ‰å¾—åˆ°å€¼ã€‚ä¸­å°‰iä½œä¸ºç®—æ³•OM(m - 1)ä¸­çš„æŒ‡æŒ¥å®˜ï¼Œå°†å€¼viå‘é€ç»™n - 2ä¸ªå…¶ä»–ä¸­å°‰ã€‚\n(3) å¯¹äºæ¯ä¸ªiå’Œæ¯ä¸ªj ~ iï¼Œè®©vjä¸ºæ­¥éª¤(2)ä¸­ä¸­å°‰iä»ä¸­å°‰jå¤„å¾—åˆ°çš„å€¼(ä½¿ç”¨ç®—æ³•OM(m - 1))ï¼Œå¦‚æœæ²¡æœ‰å¾—åˆ°è¯¥å€¼åˆ™æ’¤é€€ã€‚ä¸­å°‰iä½¿ç”¨çš„å€¼å¤šæ•°(vl \u0026hellip;..vn-1)ã€‚\nTo understand how this algorithm works, we consider the case m = 1, n = 4. Figure 3 illustrates the messages received by Lieutenant 2 when the commander sends the value v and Lieutenant 3 is a traitor. In the first step of OM(1), the commander sends v to all three lieutenants. In the second step, Lieutenant 1 sends the value v to Lieutenant 2, using the trivial algorithm OM(0). Also in the second step, the traitorous Lieutenant 3 sends Lieutenant 2 some other value x. In step 3, Lieutenant 2 then has v1 = v2 = v and v3 = x, so he obtains the correct value v = majority(v, v, x).\nä¸ºäº†ç†è§£è¿™ä¸ªç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬å‡å®š m=1, n=4ã€‚å›¾ä¸‰é˜é‡Šäº†ï¼Œå½“æŒ‡æŒ¥å®˜å‘é€å€¼vå¹¶ä¸”å½“å‰¯å®˜3æ˜¯ä¸€åå›å¾’çš„æ—¶å€™ï¼Œå‰¯å®˜2æ¥æ”¶åˆ°çš„å€¼ã€‚ç¬¬ä¸€æ­¥OM(1)ä¸­ï¼ŒæŒ‡æŒ¥å®˜å‘é€vç»™æ‰€æœ‰çš„å‰¯å®˜ã€‚ç¬¬äºŒæ­¥ï¼Œå‰¯å®˜1å‘é€vç»™å‰¯å®˜2ï¼Œä½¿ç”¨OM(0)ã€‚åœ¨ç¬¬äºŒæ­¥ï¼Œå›å¾’å‰¯å®˜3å‘é€ç»™å‰¯å®˜2ä¸€äº›å…¶ä»–å€¼ï¼Œæ¯”å¦‚xã€‚ç¬¬ä¸‰æ­¥ï¼Œå‰¯å®˜2æœ‰äº†v1=v2=v and v3=xï¼Œæ‰€ä»¥å®ƒç»´æŒäº†æ­£ç¡®çš„v=majority(v,v,x)ã€‚\nNext, we see what happens if the commander is a traitor. Figure 4 shows the values received by the lieutenants if a traitorous commander sends three arbitrary values x, y, and z to the three lieutenants. Each lieutenant obtains v1 = x, v2 = y, and v3 = z, so they all obtain the same value majority(x, y, z) in step (3), regardless of whether or not any of the three values x, y, and z are equal.\nç„¶åï¼Œæˆ‘ä»¬å†æ¥çœ‹å¦‚æœæŒ‡æŒ¥å®˜æ˜¯ä¸€åå›å¾’çš„è¯ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚å›¾4å±•ç¤ºäº†å‰¯å®˜ä»¬æ¥æ”¶åˆ°çš„å€¼ï¼Œå½“æŒ‡æŒ¥å®˜æ˜¯å›å¾’æ—¶ï¼Œä»–åˆ†åˆ«å‘é€ä¸‰ä¸ªå€¼ç»™ä¸‰ä¸ªå‰¯å®˜ï¼šx,y,zã€‚æ¯ä¸ªå‰¯å®˜ä¿æŒç€v1 = x, v2 = y, and v3 = zï¼Œæ‰€ä»¥ä»–ä»¬éƒ½ä¿æŒç€ç›¸åŒçš„majority(x,y,z).\nThe recursive algorithm OM(m) invokes n - 1 separate executions of the algorithm OM(m - 1), each of which invokes n - 2 executions of OM(m - 2), etc. This means that, for m \u0026gt; 1, a lieutenant sends many separate messages to each other lieutenant. There must be some way to distinguish among these different messages. The reader can verify that all ambiguity is removed if each lieutenant i prefixes the number i to the value vi that he sends in step (2). As the recursion \u0026ldquo;unfolds,\u0026rdquo; the algorithm OM(m - k) will be called (n - 1) \u0026hellip; (n - k) times to send a value prefixed by a sequence of k lieutenants\u0026rsquo; numbers.\né€’å½’ç®—æ³•OM(m)è°ƒç”¨ç®—æ³•OM(m - 1)çš„n - 1æ¬¡å•ç‹¬æ‰§è¡Œï¼Œå…¶æ¯æ¬¡è°ƒç”¨OM(m - 2)çš„n - 2æ¬¡æ‰§è¡Œï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿™æ„å‘³ç€ï¼Œå¯¹äºm\u0026gt;1ï¼Œä¸€ä¸ªä¸­å°‰å‘å…¶ä»–æ¯ä¸ªä¸­å°‰å‘é€äº†è®¸å¤šå•ç‹¬çš„ä¿¡æ¯ã€‚å¿…é¡»æœ‰æŸç§æ–¹æ³•æ¥åŒºåˆ†è¿™äº›ä¸åŒçš„ä¿¡æ¯ã€‚è¯»è€…å¯ä»¥éªŒè¯ï¼Œå¦‚æœæ¯ä¸ªä¸­å°‰iåœ¨ä»–åœ¨æ­¥éª¤(2)ä¸­å‘é€çš„å€¼viå‰åŠ ä¸Šæ•°å­—iï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ¨¡ç³Šæ€§éƒ½ä¼šè¢«æ¶ˆé™¤ã€‚éšç€é€’å½’â€œå±•å¼€â€ï¼Œç®—æ³•OM(m-k)å°†è¢«è°ƒç”¨ (n - 1) \u0026hellip; (n - k) æ¬¡å»å‘é€ä¸€ä¸ªå‰ç¼€æ˜¯kä¸ªå‰¯å®˜åºå·çš„åºåˆ—å€¼çš„valueã€‚\nTo prove the correctness of the algorithm OM{m) for arbitrary m, we first prove the following lemma.\nä¸ºäº†è¯æ˜ä»»æ„mçš„ç®—æ³•OM(m)çš„æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬é¦–å…ˆè¦è¯æ˜ä»¥ä¸‹å®šç†ã€‚\nLEMMA 1. For any m and k, Algorithm OM (m ) satisfies IC2 if there are more than 2k + m generals and at most k traitors.\nLEMMA 1. å¯¹äºä»»ä½•må’Œkï¼Œå¦‚æœæœ‰è¶…è¿‡2k+mçš„å°†å†›å’Œæœ€å¤škçš„å›å¾’ï¼Œç®—æ³•OMï¼ˆmï¼‰æ»¡è¶³IC2ã€‚\nPROOF. The proof is by induction on m. IC2 only specifies what must happen if the commander is loyal. Using A1, it is easy to see that the trivial algorithm OM(0) works if the commander is loyal, so the lemma is true for m = 0. We now assume it is true for m-1(m\u0026gt;0), and prove it for m.\nIn step (1), the loyal commander sends a value v to all n - 1 lieutenants. In step (2), each loyal lieutenant applies OM(m - 1) with n - 1 generals. Since by hypothesis n\u0026gt;2k+m, we have n-1\u0026gt;2k+(m- 1),so we can apply the induction hypothesis to conclude that every loyal lieutenant gets vj = v for each loyal Lieutenant j. Since there are at most k traitors, and n - 1 \u0026gt; 2k + (m - 1) \u0026gt; 2k, a majority of the n - 1 lieutenants are loyal. Hence, each loyal lieutenant has vi = v for a majority of the n - 1 values i, so he obtains majority(v1 \u0026hellip;. , vn-1) = v in step (3), proving IC2.\nè¯æ˜ã€‚è¯æ˜æ˜¯é€šè¿‡å¯¹mçš„å½’çº³ã€‚IC2åªè§„å®šäº†å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œå¿…é¡»å‘ç”Ÿä»€ä¹ˆã€‚åˆ©ç”¨A1ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹åˆ°ï¼Œå¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œç®—æ³•OM(0)æ˜¯æœ‰æ•ˆçš„ï¼Œæ‰€ä»¥è¯¥å®šç†å¯¹äºm=0æ¥è¯´æ˜¯çœŸçš„ã€‚\nåœ¨æ­¥éª¤ï¼ˆ1ï¼‰ä¸­ï¼Œå¿ è¯šçš„æŒ‡æŒ¥å®˜å‘æ‰€æœ‰n-1åä¸­å°‰å‘é€ä¸€ä¸ªå€¼vã€‚åœ¨æ­¥éª¤ï¼ˆ2ï¼‰ä¸­ï¼Œæ¯ä¸ªå¿ è¯šçš„ä¸­å°‰å‘n-1ä¸ªå°†å†›åº”ç”¨OMï¼ˆm - 1ï¼‰ã€‚ç”±äºå‡è®¾n\u0026gt;2k+mï¼Œæˆ‘ä»¬æœ‰n-1\u0026gt;2k+(m-1),æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åº”ç”¨å½’çº³å‡è®¾å¾—å‡ºç»“è®ºï¼šæ¯ä¸ªå¿ è¯šçš„ä¸­å°‰jå¾—åˆ°vj=vã€‚ç”±äºæœ€å¤šåªæœ‰kä¸ªå›å¾’ï¼Œè€Œn-1\u0026gt;2k+(m-1)\u0026gt;2kï¼Œn-1ä¸ªä¸­å°‰çš„å¤§å¤šæ•°æ˜¯å¿ è¯šçš„ã€‚å› æ­¤ï¼Œæ¯ä¸ªå¿ è¯šçš„ä¸­å°‰åœ¨n - 1çš„å¤§å¤šæ•°å€¼iä¸­éƒ½æœ‰vi = vï¼Œæ‰€ä»¥ä»–åœ¨æ­¥éª¤(3)ä¸­å¾—åˆ°major(v1 \u0026hellip;. , vn-1) = vï¼Œè¯æ˜äº†IC2ã€‚\nThe following theorem asserts that Algorithm OM(m) solves the Byzantine Generals Problem.\nä»¥ä¸‹å®šç†æ–­è¨€ï¼Œç®—æ³•OM(m)è§£å†³äº†æ‹œå åº­å°†å†›é—®é¢˜ã€‚\nTHEOREM 1. For any m, Algorithm OM (m ) satisfies conditions IC1 and IC2 if there are more than 3m generals and at most m traitors.\nå®šç†1. å¯¹äºä»»ä½•mï¼Œå¦‚æœæœ‰è¶…è¿‡3mä¸ªå°†å†›å’Œæœ€å¤šmä¸ªå›å¾’ï¼Œåˆ™ç®—æ³•OMï¼ˆm ï¼‰æ»¡è¶³æ¡ä»¶IC1å’ŒIC2ã€‚\nPROOF. The proof is by induction on m. If there are no traitors, then it is easy to see that OM(0) satisfies IC1 and IC2. We therefore assume that the theorem is true for OM(m - 1) and prove it for OM(m), m \u0026gt; 0.\nWe first consider the case in which the commander is loyal. By taking k equal to m in Lemma 1, we see that OM(m) satisfies IC2. IC1 follows from IC2 if the commander is loyal, so we need only verify IC1 in the case that the commander is a traitor.\nThere are at most m traitors, and the commander is one of them, so at most m - 1 of the lieutenants are traitors. Since there are more than 3m generals, there are more than 3m - 1 lieutenants, and 3m - 1 \u0026gt; 3(m - 1). We may therefore apply the induction hypothesis to conclude that OM(m - 1) satisfies conditions IC1 and IC2. Hence, for each j, any two loyal lieutenants get the same value for vj in step (3). (This follows from IC2 if one of the two lieutenants is Lieutenant j, and from IC1 Otherwise.) Hence, any two loyal lieutenants get the same vector of values vl \u0026hellip;.. Vn-1, and therefore obtain the same value majority(vl \u0026hellip;.. Vn-1) in step (3), proving IC1.\nè¯æ˜ã€‚å¦‚æœæ²¡æœ‰å›å¾’ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“çœ‹å‡ºOM(0)æ»¡è¶³IC1å’ŒIC2ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å‡è®¾è¯¥å®šç†å¯¹OM(m - 1)æ˜¯çœŸçš„ï¼Œå¹¶å¯¹OM(m)ï¼Œm\u0026gt;0è¿›è¡Œè¯æ˜ã€‚\næˆ‘ä»¬é¦–å…ˆè€ƒè™‘å¸ä»¤å‘˜æ˜¯å¿ è¯šçš„æƒ…å†µã€‚é€šè¿‡å°†kç­‰åŒäºç»“è®º1ä¸­çš„mï¼Œæˆ‘ä»¬çœ‹åˆ°OM(m)æ»¡è¶³IC2ã€‚å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼ŒIC1ç”±IC2å¾—å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨æŒ‡æŒ¥å®˜æ˜¯å›å¾’çš„æƒ…å†µä¸‹éªŒè¯IC1ã€‚\næœ€å¤šæœ‰mä¸ªå›å¾’ï¼Œè€ŒæŒ‡æŒ¥å®˜æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œæ‰€ä»¥æœ€å¤šæœ‰m-1ä¸ªä¸­å°‰æ˜¯å›å¾’ã€‚ç”±äºæœ‰è¶…è¿‡3ç±³çš„å°†å†›ï¼Œæ‰€ä»¥æœ‰è¶…è¿‡3ç±³-1çš„ä¸­å°‰ï¼Œè€Œä¸”3ç±³-1\u0026gt;3ï¼ˆç±³-1ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¿ç”¨å½’çº³å‡è®¾å¾—å‡ºç»“è®ºï¼šOM(m - 1)æ»¡è¶³æ¡ä»¶IC1å’ŒIC2ã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸ªjï¼Œä»»ä½•ä¸¤ä¸ªå¿ è¯šçš„å‰¯æ‰‹åœ¨æ­¥éª¤ï¼ˆ3ï¼‰ä¸­å¾—åˆ°çš„vjå€¼éƒ½æ˜¯ä¸€æ ·çš„ã€‚(å¦‚æœä¸¤ä¸ªä¸­å°‰ä¸­çš„ä¸€ä¸ªæ˜¯ä¸­å°‰jï¼Œè¿™ç”±IC2å¾—å‡ºï¼Œå¦åˆ™ç”±IC1å¾—å‡ºï¼‰ã€‚å› æ­¤ï¼Œä»»ä½•ä¸¤ä¸ªå¿ è¯šçš„ä¸­å°‰éƒ½ä¼šå¾—åˆ°ç›¸åŒçš„ä»·å€¼å‘é‡vl \u0026hellip;.. Vn-1ï¼Œå› æ­¤åœ¨æ­¥éª¤(3)ä¸­è·å¾—ç›¸åŒçš„å€¼ majority(vl \u0026hellip;.. Vn-1)ï¼Œè¯æ˜äº†IC1ã€‚\n4. A SOLUTION WITH SIGNED MESSAGES ç­¾åæ¶ˆæ¯æ–¹æ¡ˆ\nAs we saw from the scenario of Figures 1 and 2, it is the traitors\u0026rsquo; ability to lie that makes the Byzantine Generals Problem so difficult. The problem becomes easier to solve if we can restrict that ability. One way to do this is to allow the generals to send unforgeable signed messages. More precisely, we add to A1-A3 the A4\n(a) A loyal general\u0026rsquo;s signature cannot be forged, and any alteration of the contents of his signed messages can be detected.\n(b) Anyone can verify the authenticity of a general\u0026rsquo;s signature.\næ­£å¦‚æˆ‘ä»¬ä»å›¾1å’Œå›¾2çš„æƒ…æ™¯ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œæ­£æ˜¯å›å¾’çš„æ’’è°èƒ½åŠ›ä½¿æ‹œå åº­å°†å†›é—®é¢˜å˜å¾—å¦‚æ­¤å›°éš¾ã€‚å¦‚æœæˆ‘ä»¬èƒ½é™åˆ¶è¿™ç§èƒ½åŠ›ï¼Œé—®é¢˜å°±ä¼šå˜å¾—æ›´å®¹æ˜“è§£å†³ã€‚åšåˆ°è¿™ä¸€ç‚¹çš„ä¸€ä¸ªæ–¹æ³•æ˜¯å…è®¸å°†å†›ä»¬å‘é€ä¸å¯ä¼ªé€ çš„ç­¾åä¿¡æ¯ã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œæˆ‘ä»¬åœ¨A1-A3ä¸­åŠ å…¥A4\n(a) å¿ è¯šçš„å°†å†›çš„ç­¾åä¸èƒ½è¢«ä¼ªé€ ï¼Œä»»ä½•å¯¹å…¶ç­¾åä¿¡æ¯å†…å®¹çš„ç¯¡æ”¹éƒ½èƒ½è¢«å‘ç°ã€‚\n(b) ä»»ä½•äººéƒ½å¯ä»¥éªŒè¯ä¸€ä¸ªå°†å†›çš„ç­¾åçš„çœŸå®æ€§ã€‚\nNote that we make no assumptions about a traitorous general\u0026rsquo;s signature. In particular, we allow his signature to be forged by another traitor, thereby permitting collusion among the traitors.\nNow that we have introduced signed messages, our previous argument that four generals are required to cope with one traitor no longer holds. In fact, a three-general solution does exist. We now give an algorithm that copes with m traitors for any number of generals. (The problem is vacuous if there are fewer than m + 2 generals.)\nè¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¯¹å›å›½å°†å†›çš„ç­¾åä¸åšä»»ä½•å‡è®¾ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬å…è®¸ä»–çš„ç­¾åè¢«å¦ä¸€ä¸ªå›å¾’ä¼ªé€ ï¼Œä»è€Œå…è®¸å›å¾’ä¹‹é—´çš„å‹¾ç»“ã€‚\næ—¢ç„¶æˆ‘ä»¬å·²ç»å¼•å…¥äº†ç­¾åä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹‹å‰çš„è®ºç‚¹ï¼Œå³éœ€è¦å››åå°†å†›æ¥åº”å¯¹ä¸€ä¸ªå›å¾’å°±ä¸å†æˆç«‹äº†ã€‚äº‹å®ä¸Šï¼Œä¸€ä¸ªä¸‰å°†å†›çš„è§£å†³æ–¹æ¡ˆç¡®å®å­˜åœ¨ã€‚æˆ‘ä»¬ç°åœ¨ç»™å‡ºä¸€ä¸ªç®—æ³•ï¼Œå¯ä»¥åº”å¯¹ä»»ä½•æ•°é‡çš„å°†å†›çš„mä¸ªå›å¾’ã€‚(å¦‚æœå°‘äºm+2ä¸ªå°†å†›ï¼Œè¿™ä¸ªé—®é¢˜å°±æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼‰ã€‚\nIn our algorithm, the commander sends a signed order to each of his lieutenants. Each lieutenant then adds his signature to that order and sends it to the other lieutenants, who add their signatures and send it to others, and so on. This means that a lieutenant must effectivelyreceive one signed message, make several copies of it, and sign and send those copies. It does not matter how these copies are obtained; a single message might be photocopied, or else each message might consist of a stack of identical messages which are signed and distributed as required.\nåœ¨æˆ‘ä»¬çš„ç®—æ³•ä¸­ï¼ŒæŒ‡æŒ¥å®˜å‘ä»–çš„æ¯ä¸ªä¸­å°‰å‘é€ä¸€ä¸ªç­¾åçš„å‘½ä»¤ã€‚ç„¶åæ¯ä¸ªä¸­å°‰åœ¨è¯¥å‘½ä»¤ä¸ŠåŠ ä¸Šè‡ªå·±çš„ç­¾åï¼Œå¹¶å°†å…¶å‘é€ç»™å…¶ä»–ä¸­å°‰ï¼Œå…¶ä»–ä¸­å°‰å†åŠ ä¸Šè‡ªå·±çš„ç­¾åï¼Œå¹¶å°†å…¶å‘é€ç»™å…¶ä»–äººï¼Œå¦‚æ­¤åå¤ã€‚è¿™æ„å‘³ç€ï¼Œä¸€ä¸ªä¸­å°‰å¿…é¡»æœ‰æ•ˆåœ°æ¥æ”¶ä¸€ä»½å·²ç­¾ç½²çš„ä¿¡æ¯ï¼Œå°†å…¶å¤åˆ¶å‡ ä»½ï¼Œå¹¶ç­¾ç½²å’Œå‘é€è¿™äº›å‰¯æœ¬ã€‚å¦‚ä½•è·å¾—è¿™äº›å‰¯æœ¬å¹¶ä¸é‡è¦ï¼›ä¸€ä»½ç”µæ–‡å¯èƒ½æ˜¯å¤å°çš„ï¼Œå¦åˆ™æ¯ä»½ç”µæ–‡å¯èƒ½ç”±ä¸€å ç›¸åŒçš„ç”µæ–‡ç»„æˆï¼Œè¿™äº›ç”µæ–‡æŒ‰è¦æ±‚è¿›è¡Œç­¾ç½²å’Œåˆ†å‘ã€‚\nOur algorithm assumes a function choice which is applied to a set of orders to /obtain a single one. The only requirements we make for this function are\nIf the set V consists of the single element v, then choice(V) = v. choice(Q) = RETREAT, where Ã¸ is the empty set. æˆ‘ä»¬çš„ç®—æ³•å‡å®šæœ‰ä¸€ä¸ªå‡½æ•°é€‰æ‹©ï¼Œå®ƒè¢«åº”ç”¨äºä¸€ç»„å‘½ä»¤ï¼Œä»¥è·å¾—ä¸€ä¸ªå•ä¸€çš„å‘½ä»¤ã€‚æˆ‘ä»¬å¯¹è¿™ä¸ªå‡½æ•°çš„å”¯ä¸€è¦æ±‚æ˜¯\nå¦‚æœé›†åˆVç”±å•ä¸€å…ƒç´ vç»„æˆï¼Œé‚£ä¹ˆé€‰æ‹©(V)=vã€‚ choice(Q) = RETREATï¼Œå…¶ä¸­æ˜¯Ã¸ç©ºé›†ã€‚ Note that one possible definition is to let choice(V) be the median element of V \u0026ndash; assuming that there is an ordering of the elements.\nIn the following algorithm, we let x:i denote the value x signed by General i. Thus, v:j:i denotes the value v signed by j, and then that value v:j signed by i. We let General 0 be the commander. In this algorithm, each lieutenant i maintains a set Vi, containng the set of properly signed orders he has received so far. (If the commander is loyal, then this set should never contain more than a single element.) Do not confuse Vi, the set of orders he has received, with the set of messages that he has received. There may be many different messages with the same order.\nè¯·æ³¨æ„ï¼Œä¸€ä¸ªå¯èƒ½çš„å®šä¹‰æ˜¯è®©choice(V)æ˜¯Vçš„ä¸­ä½æ•°å…ƒç´ \u0026ndash;å‡è®¾å…ƒç´ æ˜¯æœ‰åºçš„ã€‚\nåœ¨ä¸‹é¢çš„ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬è®©x:iè¡¨ç¤ºç”±iå°†å†›ç­¾ç½²çš„å€¼xã€‚å› æ­¤ï¼Œv:j:iè¡¨ç¤ºç”±jç­¾ç½²çš„å€¼vï¼Œç„¶åæ˜¯ç”±iç­¾ç½²çš„é‚£ä¸ªå€¼v:jã€‚æˆ‘ä»¬è®©0å°†å†›åšæŒ‡æŒ¥å®˜ã€‚åœ¨è¿™ä¸ªç®—æ³•ä¸­ï¼Œæ¯ä¸ªä¸­å°‰iç»´æŠ¤ä¸€ä¸ªé›†åˆViï¼ŒåŒ…å«ä»–è¿„ä»Šä¸ºæ­¢æ”¶åˆ°çš„æ­£ç¡®ç­¾ç½²çš„å‘½ä»¤é›†åˆã€‚(å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆè¿™ä¸ªé›†åˆå°±ä¸åº”è¯¥åŒ…å«è¶…è¿‡ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚ä¸è¦æŠŠViï¼Œå³ä»–æ‰€æ”¶åˆ°çš„å‘½ä»¤é›†ï¼Œä¸ä»–æ‰€æ”¶åˆ°çš„ä¿¡æ¯é›†æ··æ·†èµ·æ¥ã€‚åŒä¸€ä¸ªå‘½ä»¤å¯èƒ½æœ‰è®¸å¤šä¸åŒçš„ä¿¡æ¯ã€‚\nAlgorithm SM (m).\nInitially Vi = 0. (1) The commander signs and sends his value to every lieutenant.\n(2) For each i:\n(A) If Lieutenant i receives a message of the form v:0 from the commander and he has not yet received any order, then\n(i) he lets V equal (v); (ii) he sends the message v:0:i to everyother lieutenant. (B) If Lieutenant i receives a message of the form v:0:j1:Â·Â·Â·:jk and v is not in the set Vi, then\n(i) he adds v to Vi;\n(ii) if k \u0026lt; m, then he sends the message v:0:j1:Â·Â·Â·:jk:i to every lieutenant other than j1\u0026hellip;..,jk.\n(3) For each i: When Lieutenant i will receive no more messages, he obeys the order choice(Vi).\næœ€åˆï¼ŒVi = 0ã€‚\n(1) æŒ‡æŒ¥å®˜ç­¾ç½²å¹¶å°†ä»–çš„å‘½ä»¤å‘é€ç»™æ¯ä¸ªä¸­å°‰ã€‚\n(2) å¯¹äºæ¯ä¸ªiï¼š\n(A) å¦‚æœiä¸­å°‰ä»æŒ‡æŒ¥å®˜é‚£é‡Œæ”¶åˆ°å½¢å¼ä¸ºv:0çš„ä¿¡æ¯ï¼Œå¹¶ä¸”ä»–è¿˜æ²¡æœ‰æ”¶åˆ°ä»»ä½•å‘½ä»¤ï¼Œé‚£ä¹ˆ\n(i) ä»–è®©Vç­‰äºï¼ˆvï¼‰ã€‚\n(ii)ä»–å°†ä¿¡æ¯v:0:iå‘é€ç»™å…¶ä»–æ‰€æœ‰çš„ä¸­å°‰ã€‚\n(B) å¦‚æœiä¸­å°‰æ”¶åˆ°ä¸€ä¸ªå½¢å¼ä¸ºv:0:j1:\u0026ndash;:jkçš„ä¿¡æ¯ï¼Œå¹¶ä¸”vä¸åœ¨é›†åˆVä¸­ï¼Œé‚£ä¹ˆ\n(i) ä»–å°†våŠ å…¥Viã€‚\n(ii) å¦‚æœk \u0026lt; mï¼Œé‚£ä¹ˆä»–å°†ä¿¡æ¯v:0:j1:\u0026mdash;:jk:iå‘é€ç»™é™¤j1\u0026hellip;..,jkä¹‹å¤–çš„æ¯ä¸ªä¸­å°‰ã€‚\n(3) å¯¹äºæ¯ä¸ªiã€‚å½“ä¸­å°‰iä¸ä¼šå†æ”¶åˆ°ä¿¡æ¯æ—¶ï¼Œä»–å°±ä¼šæœä»choice(Vi)çš„å‘½ä»¤ã€‚\nNote that in step (2), Lieutenant i ignores any message containing an order v that is already in the set Vi.\nè¯·æ³¨æ„ï¼Œåœ¨æ­¥éª¤ï¼ˆ2ï¼‰ä¸­ï¼Œä¸­å°‰iä¼šå¿½ç•¥ä»»ä½•åŒ…å«å·²ç»åœ¨é›†åˆViä¸­çš„å‘½ä»¤vçš„æ¶ˆæ¯ã€‚\nWe have not specified how a lieutenant determines in step (3) that he will receive no more messages. By induction on k, one easily shows that for each sequence of lieutenants j1, Â·Â·Â·, jk with k\u0026lt;=m, a lieutenant can receive at most one message of the form v:0:j1:Â·Â·Â·:jk in step (2). If we require that Lieutenant jk either send such a message or else send a message reporting that he will not send such a message, then it is easy to decide when all messages have been received. (By assumption A3, a lieutenant can determine if a traitorous lieutenant jk sends neither of those two messages.) Alternatively, time-out can be used to determine when no more messages will arrive. The use of time-out is discussed in Section 6.\næˆ‘ä»¬æ²¡æœ‰è¯´æ˜ä¸­å°‰å¦‚ä½•åœ¨æ­¥éª¤(3)ä¸­ç¡®å®šä»–ä¸ä¼šå†æ”¶åˆ°ä¿¡æ¯ã€‚é€šè¿‡å¯¹kçš„å½’çº³ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç°ï¼Œå¯¹äºæ¯ä¸€ä¸ªk\u0026lt;=mçš„ä¸­å°‰åºåˆ—j1, \u0026mdash;, jkï¼Œä¸€ä¸ªä¸­å°‰åœ¨æ­¥éª¤(2)ä¸­æœ€å¤šå¯ä»¥æ”¶åˆ°ä¸€æ¡å½¢å¼ä¸ºv:0:j1:\u0026mdash;:jkçš„ä¿¡æ¯ã€‚å¦‚æœæˆ‘ä»¬è¦æ±‚ä¸­å°‰jkè¦ä¹ˆå‘é€è¿™æ ·çš„ä¿¡æ¯ï¼Œè¦ä¹ˆå‘é€ä¸€ä¸ªæŠ¥å‘Šä»–ä¸ä¼šå‘é€è¿™æ ·çš„ä¿¡æ¯çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“å†³å®šä½•æ—¶æ‰€æœ‰ä¿¡æ¯éƒ½è¢«æ”¶åˆ°äº†ã€‚(æ ¹æ®å‡è®¾A3ï¼Œä¸­å°‰å¯ä»¥åˆ¤æ–­å‡ºå›å¾’ä¸­å°‰jkæ˜¯å¦ä¸å‘é€è¿™ä¸¤æ¡ä¿¡æ¯)ã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨è¶…æ—¶æ¥å†³å®šä½•æ—¶ä¸å†æœ‰ä¿¡æ¯åˆ°è¾¾ã€‚ç¬¬6èŠ‚å°†è®¨è®ºè¶…æ—¶çš„ä½¿ç”¨ã€‚\nNote that in step (2), Lieutenant i ignores any messages that do not have the proper form of a value followed by a string of signatures. If packets of identical messages are used to avoid having to copy messages, this means that he throws away any packet that does not consist of a sufficient number of identical, properly signed messages.(There should be(n-k-2)(n-k-3)Â·Â·Â·(n-m-2)copies of the message if it has been signed by k lieutenants.)\nè¯·æ³¨æ„ï¼Œåœ¨æ­¥éª¤(2)ä¸­ï¼Œä¸­å°‰iå¿½ç•¥äº†ä»»ä½•æ²¡æœ‰æ­£ç¡®å½¢å¼çš„ä¿¡æ¯ï¼Œå³ä¸€ä¸ªå€¼åé¢æœ‰ä¸€ä¸²ç­¾åçš„ä¿¡æ¯ã€‚å¦‚æœä½¿ç”¨ç›¸åŒçš„ä¿¡æ¯åŒ…æ¥é¿å…å¤åˆ¶ä¿¡æ¯ï¼Œè¿™æ„å‘³ç€ä»–æ‰”æ‰ä»»ä½•ä¸åŒ…å«è¶³å¤Ÿæ•°é‡çš„ç›¸åŒçš„ã€æ­£ç¡®ç­¾åçš„ä¿¡æ¯åŒ…ã€‚ï¼ˆå¦‚æœä¿¡æ¯å·²ç»è¢«kä¸ªä¸­å°‰ç­¾åï¼Œåº”è¯¥æœ‰(n-k-2)(n-k-3)\u0026mdash;(n-m-2)ä»½ã€‚ï¼‰\nFigure 5 illustrates Algorithm SM(1) for the case of three generals when the commander is a traitor. The commander sends an \u0026ldquo;attack\u0026rdquo; order to one lieutenant and a \u0026ldquo;retreat\u0026rdquo; order to the other. Both lieutenants receive the two orders in step (2), so after step (2) V1 = V2 = {\u0026ldquo;attack\u0026rdquo;, \u0026ldquo;retreat\u0026rdquo;}, and they both obey the order choice( {\u0026ldquo;attack\u0026rdquo;, \u0026ldquo;retreat\u0026rdquo;} ). Observe that here, unlike the situation in Figure 2, the lieutenants know the commander is a traitor because his signature appears on two different orders, and A4 states that only he could have generated those signatures.\nIn Algorithm SM(m), a lieutenant signs his name to acknowledge his receipt of an order. If he is the mth lieutenant to add his signature to the order, then that signature is not relayed to anyone else by its recipient, so it is superfluous. (More precisely, assumption A2 makes it unnecessary.) In particular, the lieutenants need not sign their messages in SM(1).\nå›¾5è¯´æ˜äº†å½“æŒ‡æŒ¥å®˜æ˜¯å›å¾’æ—¶ä¸‰ä¸ªå°†å†›çš„æƒ…å†µä¸‹çš„ç®—æ³•SM(1)ã€‚æŒ‡æŒ¥å®˜å‘ä¸€åä¸­å°‰å‘å‡ºäº† \u0026ldquo;æ”»å‡» \u0026ldquo;å‘½ä»¤ï¼Œå‘å¦ä¸€åä¸­å°‰å‘å‡ºäº† \u0026ldquo;æ’¤é€€ \u0026ldquo;å‘½ä»¤ã€‚ä¸¤ä¸ªä¸­å°‰åœ¨æ­¥éª¤ï¼ˆ2ï¼‰ä¸­éƒ½æ”¶åˆ°äº†è¿™ä¸¤ä¸ªå‘½ä»¤ï¼Œæ‰€ä»¥åœ¨æ­¥éª¤ï¼ˆ2ï¼‰ä¹‹åï¼ŒV1=V2={\u0026ldquo;è¿›æ”»\u0026rdquo;ï¼Œ\u0026ldquo;æ’¤é€€\u0026rdquo;}ï¼Œä»–ä»¬éƒ½æœä»å‘½ä»¤é€‰æ‹©ï¼ˆ{\u0026ldquo;è¿›æ”»\u0026rdquo;ï¼Œ\u0026ldquo;æ’¤é€€\u0026rdquo;}ï¼‰ã€‚è¯·æ³¨æ„ï¼Œè¿™é‡Œä¸å›¾2çš„æƒ…å†µä¸åŒï¼Œä¸­å°‰ä»¬çŸ¥é“æŒ‡æŒ¥å®˜æ˜¯ä¸ªå›å¾’ï¼Œå› ä¸ºä»–çš„ç­¾åå‡ºç°åœ¨ä¸¤ä¸ªä¸åŒçš„å‘½ä»¤ä¸Šï¼Œè€Œä¸”A4è¯´åªæœ‰ä»–æ‰èƒ½äº§ç”Ÿè¿™äº›ç­¾åã€‚\nåœ¨ç®—æ³•SM(m)ä¸­ï¼Œä¸€åä¸­å°‰ç­¾ç½²äº†ä»–çš„åå­—ï¼Œä»¥ç¡®è®¤ä»–æ”¶åˆ°äº†ä¸€ä»½å‘½ä»¤ã€‚å¦‚æœä»–æ˜¯ç¬¬mä¸ªåœ¨å‘½ä»¤ä¸Šç­¾åçš„ä¸­å°‰ï¼Œé‚£ä¹ˆè¿™ä¸ªç­¾åå°±ä¸ä¼šè¢«å…¶æ¥æ”¶è€…è½¬è¾¾ç»™å…¶ä»–äººï¼Œæ‰€ä»¥å®ƒæ˜¯å¤šä½™çš„ã€‚(æ›´ç¡®åˆ‡åœ°è¯´ï¼Œå‡è®¾A2ä½¿å…¶æˆä¸ºä¸å¿…è¦çš„ã€‚)ç‰¹åˆ«æ˜¯ï¼Œä¸­å°‰ä»¬ä¸éœ€è¦åœ¨SM(1)ä¸­ç­¾ç½²ä»–ä»¬çš„ä¿¡æ¯ã€‚\nWe now prove the correctness of our algorithm.\nè¯æ˜ç®—æ³•\nTHEOREM 2. For any m, Algorithm SM(m) solves the Byzantine Generals Problem if there are at most m traitors.\nå®šç†2. å¯¹äºä»»ä½•mï¼Œå¦‚æœæœ‰æœ€å¤šmä¸ªå›å¾’ï¼Œç®—æ³•SM(m)å¯ä»¥è§£å†³æ‹œå åº­å°†å†›é—®é¢˜ã€‚\nPROOF. We first prove IC2. If the commander is loyal, then he sends his signed order v:0 to every lieutenant in step (1). Every loyal lieutenant will therefore receive the order v in step (2)(A). Moreover, since no traitorous lieutenant can forge any other message of the form v\u0026rsquo;:0, a loyal lieutenant can receive no additional order in step (2)(B). Hence, for each loyal Lieutenant i, the set Vi obtained in step (2) consists of the single order v, which he will obey in step (3) by property 1 of the choice function. This proves IC2.\nSince IC1 follows from IC2 if the commander is loyal, to prove IC1 we need only consider the case in which the commander is a traitor. Two loyal lieutenants i and j obey the same order in step (3) if the sets of orders Vi and Vj that they receive in step (2) are the same. Therefore, to prove IC1 it suffices to prove that, if i puts an order v into Vi in step (2), thenj must put the same order v into V1in step (2). To do this, we must show that j receives a properly signed message containing that order. If i receives the order v in step (2)(A), then he sends it to j in step (2)(A)(ii); so j receives it (by A1). If i adds the order to Vi in step (2)(B), then he must receive a first message of the form v:0 :j1:Â·Â·Â·:jk. If j is one of the jr, then by A4 he must already have received the order v. If not, we consider two cases:\nk \u0026lt; m. In this case, i sends the message v:0:j1: \u0026hellip; :jk:i to j; soj must receive the order v. k = m. Since the commander is a traitor, at most m - 1 of the lieutenants are traitors. Hence, at least one of the lieutenants j1, \u0026hellip;. , jm is loyal. This loyal lieutenant must have sent j the value v when he first received it, so j must therefore receive that value. è¯æ˜ã€‚æˆ‘ä»¬é¦–å…ˆè¯æ˜IC2ã€‚å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆä»–åœ¨æ­¥éª¤(1)ä¸­å‘æ¯ä¸ªä¸­å°‰å‘é€äº†ä»–ç­¾ç½²çš„å‘½ä»¤v:0ã€‚å› æ­¤ï¼Œæ¯ä¸ªå¿ è¯šçš„ä¸­å°‰éƒ½ä¼šåœ¨æ­¥éª¤ï¼ˆ2ï¼‰ï¼ˆAï¼‰ä¸­æ”¶åˆ°å‘½ä»¤vã€‚æ­¤å¤–ï¼Œç”±äºæ²¡æœ‰ä¸€ä¸ªå›å¾’ä¸­å°‰å¯ä»¥ä¼ªé€ ä»»ä½•å…¶ä»–å½¢å¼çš„v\u0026rsquo;:0çš„ä¿¡æ¯ï¼Œå¿ è¯šçš„ä¸­å°‰åœ¨æ­¥éª¤(2)(B)ä¸­æ— æ³•æ”¶åˆ°ä»»ä½•é¢å¤–çš„å‘½ä»¤ã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸ªå¿ è¯šçš„ä¸­å°‰iæ¥è¯´ï¼Œåœ¨æ­¥éª¤(2)ä¸­å¾—åˆ°çš„é›†åˆViåŒ…æ‹¬å•ä¸€çš„å‘½ä»¤vï¼Œæ ¹æ®é€‰æ‹©å‡½æ•°çš„å±æ€§1ï¼Œä»–å°†åœ¨æ­¥éª¤(3)ä¸­æœä»è¿™ä¸ªå‘½ä»¤ã€‚è¿™å°±è¯æ˜äº†IC2ã€‚\nç”±äºå¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œåˆ™IC1ç”±IC2å¾—å‡ºï¼Œä¸ºäº†è¯æ˜IC1ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘æŒ‡æŒ¥å®˜æ˜¯å›å¾’çš„æƒ…å†µã€‚å¦‚æœä¸¤ä¸ªå¿ è¯šçš„ä¸­å°‰iå’Œjåœ¨æ­¥éª¤(3)ä¸­æ¥å—çš„å‘½ä»¤é›†Viå’ŒVjæ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆä»–ä»¬åœ¨æ­¥éª¤(2)ä¸­å°±ä¼šæœä»åŒä¸€ä¸ªå‘½ä»¤ã€‚å› æ­¤ï¼Œè¦è¯æ˜IC1ï¼Œåªéœ€è¯æ˜ï¼Œå¦‚æœiåœ¨æ­¥éª¤(2)ä¸­å°†ä¸€ä¸ªå‘½ä»¤væ”¾å…¥Viä¸­ï¼Œé‚£ä¹ˆjåœ¨æ­¥éª¤(2)ä¸­å¿…é¡»å°†åŒæ ·çš„å‘½ä»¤væ”¾å…¥V1ä¸­ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»è¯æ˜jæ”¶åˆ°ä¸€ä¸ªåŒ…å«è¯¥å‘½ä»¤çš„æ­£ç¡®ç­¾åä¿¡æ¯ã€‚å¦‚æœiåœ¨æ­¥éª¤(2)(A)ä¸­æ”¶åˆ°äº†å‘½ä»¤vï¼Œé‚£ä¹ˆä»–å°±æŠŠå®ƒå‘é€ç»™äº†j, åœ¨æ­¥éª¤(2)(A)(ii)ä¸­ï¼›æ‰€ä»¥jæ”¶åˆ°äº†å®ƒï¼ˆé€šè¿‡A1ï¼‰ã€‚å¦‚æœiåœ¨æ­¥éª¤(2)(B)ä¸­å°†è®¢å•æ·»åŠ åˆ°Viä¸­ï¼Œé‚£ä¹ˆä»–å¿…é¡»æ”¶åˆ°å½¢å¼ä¸ºv:0 :j1:\u0026mdash;:jkçš„ç¬¬ä¸€ä¸ªä¿¡æ¯ã€‚å¦‚æœjæ˜¯jrä¹‹ä¸€ï¼Œé‚£ä¹ˆæ ¹æ®A4ï¼Œä»–ä¸€å®šå·²ç»æ”¶åˆ°äº†è®¢å•vã€‚ å¦‚æœä¸æ˜¯ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸¤ç§æƒ…å†µ:\n1.åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œiå‘jå‘é€äº†v:0:j1:\u0026hellip;:jk:içš„ä¿¡æ¯ï¼›æ‰€ä»¥jå¿…é¡»æ¥å—å‘½ä»¤vã€‚\n2.k=mã€‚ç”±äºæŒ‡æŒ¥å®˜æ˜¯å›å¾’ï¼Œæ‰€ä»¥æœ€å¤šåªæœ‰m-1åä¸­å°‰æ˜¯å›å¾’ã€‚å› æ­¤ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªä¸­å°‰j1, \u0026hellip;. , jmæ˜¯å¿ è¯šçš„ã€‚è¿™ä¸ªå¿ è¯šçš„ä¸­å°‰åœ¨ç¬¬ä¸€æ¬¡æ”¶åˆ°ä»·å€¼vçš„æ—¶å€™ï¼Œä¸€å®šç»™jå‘é€äº†è¿™ä¸ªå‘½ä»¤ï¼Œå› æ­¤jä¸€å®šä¼šæ”¶åˆ°è¿™ä¸ªå‘½ä»¤ã€‚\n5. MISSING COMMUNICATION PATHS Thus far, we have assumed that a general can send messages directly to every other general. We now remove this assumption. Instead, we suppose that physical barriers place some restrictions on who can send messages to whom. We consider the generals to form the nodes of a simple, finite undirected graph G, where an arc between two nodes indicates that those two generals can send messages directly to one another. We now extend Algorithms OM(m) and SM(m), which assumed G to be completely connected, to more general graphs.\nTo extend our oral message algorithm OM(m), we need the following definition, where two generals are said to be neighbors if they are joined by an arc.\nåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å‡è®¾ä¸€ä¸ªå°†å†›å¯ä»¥ç›´æ¥å‘å…¶ä»–æ¯ä¸ªå°†å†›å‘é€ä¿¡æ¯ã€‚ç°åœ¨æˆ‘ä»¬å–æ¶ˆè¿™ä¸€å‡è®¾ã€‚ç›¸åï¼Œæˆ‘ä»¬å‡è®¾ç‰©ç†å±éšœå¯¹è°èƒ½å‘è°å‘é€ä¿¡æ¯æœ‰ä¸€äº›é™åˆ¶ã€‚æˆ‘ä»¬è®¤ä¸ºå°†å†›ä»¬æ„æˆäº†ä¸€ä¸ªç®€å•çš„ã€æœ‰é™çš„æ— å‘å›¾Gçš„èŠ‚ç‚¹ï¼Œå…¶ä¸­ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å¼§è¡¨ç¤ºè¿™ä¸¤ä¸ªå°†å†›å¯ä»¥ç›´æ¥å‘å¯¹æ–¹å‘é€æ¶ˆæ¯ã€‚ç°åœ¨æˆ‘ä»¬å°†å‡è®¾Gæ˜¯å®Œå…¨è¿æ¥çš„ç®—æ³•OM(m)å’ŒSM(m)æ‰©å±•åˆ°æ›´ä¸€èˆ¬çš„å›¾ã€‚\nä¸ºäº†æ‰©å±•æˆ‘ä»¬çš„å£å¤´ä¿¡æ¯ç®—æ³•OM(m)ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹å®šä¹‰ï¼Œå¦‚æœä¸¤ä¸ªå°†å†›è¢«ä¸€æ¡å¼§è¿æ¥ï¼Œå°±è¯´å®ƒä»¬æ˜¯é‚»å±…ã€‚\nDefinition 1.\n(a) A set of nodes (il, \u0026hellip;, ip} is said to be a regular set of neighbors of a node if\n(i) each ij is a neighbor of i, and (ii) for any general k different from i, there exist paths yj,kfrom ijto k not passing through i such that any two different paths Yi,khave no node in common other than k.\nå®šä¹‰1.\n(a) ä¸€ç»„èŠ‚ç‚¹ï¼ˆilï¼Œ\u0026hellip;ï¼Œip}è¢«ç§°ä¸ºæ˜¯ä¸€ä¸ªèŠ‚ç‚¹çš„å¸¸è§„é‚»å±…é›†ï¼Œå¦‚æœ\n(i) æ¯ä¸ªijéƒ½æ˜¯içš„é‚»å±…ï¼Œå¹¶ä¸”\n(ii) å¯¹äºä»»ä½•ä¸åŒäºiçš„kï¼Œå­˜åœ¨ä»ijåˆ°kçš„ä¸ç»è¿‡içš„è·¯å¾„yj,kï¼Œä½¿å¾—ä»»ä½•ä¸¤ä¸ªä¸åŒçš„è·¯å¾„Yi,ké™¤äº†kä¹‹å¤–æ²¡æœ‰å…±åŒçš„èŠ‚ç‚¹ã€‚\n(b) The graph G is said to be p-regular if every node has a regular set of neighbors consisting of p distinct nodes.\n(b) å¦‚æœæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªç”±pä¸ªä¸åŒèŠ‚ç‚¹ç»„æˆçš„è§„åˆ™çš„é‚»å±…é›†ï¼Œåˆ™ç§°å›¾Gä¸ºp-è§„åˆ™ã€‚\nFigure 6 shows an example of a simple 3-regular graph. Figure 7 shows an example of a graph that is not 3-regular because the central node has no regular set of neighbors containing three nodes.\nå›¾6æ˜¯ä¸€ä¸ªç®€å•çš„3-è§„åˆ™å›¾çš„ä¾‹å­ã€‚å›¾7æ˜¾ç¤ºäº†ä¸€ä¸ªé3è§„åˆ™å›¾çš„ä¾‹å­ï¼Œå› ä¸ºä¸­å¿ƒèŠ‚ç‚¹æ²¡æœ‰åŒ…å«ä¸‰ä¸ªèŠ‚ç‚¹çš„è§„åˆ™é‚»å±…é›†ã€‚\nWe extend OM(m) to an algorithm that solves the Byzantine Generals Problem in the presence of m traitors if the graph G of generals is 3m-regular. (Note that a 3m-regular graph must contain at least 3m + 1 nodes.} For all positive integers m and p, we define the algorithm OM(m, p) as follows when the graph G of generals is p-regular. (OM(m,p) is not defined if G is not p-regular.) The definition uses induction on m.\næˆ‘ä»¬å°†OM(m)æ‰©å±•ä¸ºä¸€ç§ç®—æ³•ï¼Œå¦‚æœå›¾Gæ˜¯3mè§„åˆ™çš„ï¼Œé‚£ä¹ˆåœ¨æœ‰mä¸ªå›å¾’çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è§£å†³æ‹œå åº­å°†å†›é—®é¢˜ã€‚(è¯·æ³¨æ„ï¼Œä¸€ä¸ª3mè§„åˆ™çš„å›¾å¿…é¡»è‡³å°‘åŒ…å«3m+1ä¸ªèŠ‚ç‚¹)ã€‚å¯¹äºæ‰€æœ‰æ­£æ•´æ•°må’Œpï¼Œå½“å°†å†›å›¾Gæ˜¯p-regularæ—¶ï¼Œæˆ‘ä»¬å®šä¹‰ç®—æ³•OM(m, p)å¦‚ä¸‹ã€‚(å¦‚æœGä¸æ˜¯p-regularï¼ŒOM(m,p)å°±æ²¡æœ‰å®šä¹‰) ã€‚è¯¥å®šä¹‰ä½¿ç”¨äº†å¯¹mçš„å½’çº³æ³•ã€‚\nAlgorithm OM(m,p).\n(0) Choose a regular set N of neighbors of the commander consisting ofp lieutenants.\n(1) The commander sends his value to every lieutenant in N.\n(2) For each i in N, let vi be the value Lieutenant i receives from the commander, or else RETREAT if he receives no value. Lieutenant i sends vi to every other lieutenant k as follows:\n(A) If m = 1, then by sending the value along the path yi,k whose existence is guaranteed by part (a)(ii) of Definition 1.\n(B) If rn \u0026gt; 1, then by acting as the commander in the algorithm OM(m - 1, p - 1), with the graph of generals obtained by removing the original commander from G.\n(3) For each k, and each i in N with i ~ k, let vi be the value Lieutenant k received from Lieutenant i in step (2), or RETREAT if he received no value. Lieutenant k uses the value majority(vi\u0026hellip;\u0026hellip; vi,), where N = {il\u0026hellip;.. ip}.\n(0) é€‰æ‹©ä¸€ä¸ªç”±pä¸ªä¸­å°‰ç»„æˆçš„æŒ‡æŒ¥å®˜çš„å¸¸è§„é‚»å±…é›†Nã€‚\n(1) æŒ‡æŒ¥å®˜å‘Nä¸­çš„æ¯ä¸ªä¸­å°‰å‘é€ä»–çš„å‘½ä»¤ã€‚\n(2) å¯¹äºNä¸­çš„æ¯ä¸€ä¸ªiï¼Œè®©viæˆä¸ºiä¸­å°‰ä»æŒ‡æŒ¥å®˜é‚£é‡Œæ”¶åˆ°çš„å‘½ä»¤ï¼Œå¦‚æœä»–æ²¡æœ‰æ”¶åˆ°ä»»ä½•ä»·å€¼ï¼Œåˆ™RETREATã€‚ä¸­å°‰iå°†viå‘é€ç»™å…¶ä»–æ¯ä¸ªä¸­å°‰kï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\n(A) å¦‚æœm=1ï¼Œé‚£ä¹ˆé€šè¿‡æ²¿è·¯å¾„yi,kå‘é€å‘½ä»¤ï¼Œå…¶å­˜åœ¨ç”±å®šä¹‰1çš„(a)(ii)éƒ¨åˆ†ä¿è¯ã€‚\n(B) å¦‚æœm\u0026gt;1ï¼Œé‚£ä¹ˆé€šè¿‡åœ¨ç®—æ³•OM(m - 1, p - 1)ä¸­å……å½“æŒ‡æŒ¥å®˜ï¼Œé€šè¿‡ä»Gä¸­åˆ é™¤åŸæŒ‡æŒ¥å®˜å¾—åˆ°å°†å†›å›¾ã€‚\n(3) å¯¹äºæ¯ä¸ªkï¼Œä»¥åŠNä¸­çš„æ¯ä¸ªiï¼Œi ~ kï¼Œè®©viä¸ºkä¸­å°‰åœ¨æ­¥éª¤(2)ä¸­ä»iä¸­å°‰é‚£é‡Œæ”¶åˆ°çš„å‘½ä»¤ï¼Œå¦‚æœä»–æ²¡æœ‰æ”¶åˆ°å‘½ä»¤ï¼Œåˆ™RETREATã€‚ä¸­å°‰kä½¿ç”¨ä»·å€¼ majority(vi\u0026hellip;\u0026hellip;vi)å…¶ä¸­N = {i1\u0026hellip;.. ip}ã€‚\nNote that removing a single node from a p-regular graph leaves a (p - 1) regular graph. Hence, one can apply the algorithm OM(m - 1, p - 1) in step (2)(B).\nè¯·æ³¨æ„ï¼Œä»ä¸€ä¸ªp-regularå›¾ä¸­ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¼šç•™ä¸‹ä¸€ä¸ªï¼ˆp - 1ï¼‰regularå›¾ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­¥éª¤(2)(B)ä¸­åº”ç”¨ç®—æ³•OM(m - 1, p - 1)ã€‚\nWe now prove that OM(m, 3m) solves the Byzantine Generals Problem if there are at most m traitors. The proof is similar to the proof for the algorithm OM(m) and will just be sketched. It begins with the following extension of Lemma 1.\næˆ‘ä»¬ç°åœ¨è¯æ˜OM(m, 3m)è§£å†³äº†æ‹œå åº­å°†å†›é—®é¢˜ï¼Œå¦‚æœæœ‰æœ€å¤šmä¸ªå›å¾’çš„è¯ã€‚è¯¥è¯æ˜ä¸OM(m)ç®—æ³•çš„è¯æ˜ç±»ä¼¼ï¼Œå°†åªæ˜¯ç•¥åŠ è¯´æ˜ã€‚å®ƒä»ä»¥ä¸‹å¯¹ç»“è®º1çš„æ‰©å±•å¼€å§‹ã€‚\nLEMMA 2. For any m \u0026gt; 0 and any p \u0026gt; 2k + m, Algorithm OM (m, p) satisfies IC2 if there are at most k traitors.\nLEMMA 2. å¯¹äºä»»ä½•m\u0026gt;0å’Œä»»ä½•p\u0026gt;2k+mï¼Œå¦‚æœæœ€å¤šæœ‰kä¸ªå›å¾’ï¼Œé‚£ä¹ˆç®—æ³•OMï¼ˆmï¼Œpï¼‰æ»¡è¶³IC2ã€‚\nPROOF. For m=1, observe that a lieutenant obtains the value majority(v1, \u0026hellip;, vp), where each vi is a value sent to him by the commander along a path disjoint from the path used to send the other values to him. Since there are at most k traitors and p = 2k + 1, more than half of those paths are composed entirely of loyal lieutenants. Hence, if the commander is loyal, then a majority of the values vi will equal the value he sent, which implies that IC2 is satisfied.\nNow assume the lemma for m - 1, m \u0026gt; 1. If the commander is loyal, then each of the p lieutenants in N gets the correct value. Since p \u0026gt; 2k, a majority of them are loyal, and by the induction hypothesis each of them sends the correct value to every loyal lieutenant. Hence, each loyal lieutenant gets a majority of correct values, thereby obtaining the correct value in step (3).\nè¯æ˜ã€‚å¯¹äºm=1ï¼Œè§‚å¯Ÿä¸€ä¸‹ï¼Œä¸€ä¸ªä¸­å°‰è·å¾—çš„å€¼æ˜¯ majority(v1, \u0026hellip;, vp)ï¼Œå…¶ä¸­æ¯ä¸ªviæ˜¯ç”±æŒ‡æŒ¥å®˜æ²¿ç€ä¸ç”¨æ¥å‘é€å…¶ä»–å€¼çš„è·¯å¾„ä¸ç›¸äº¤çš„è·¯å¾„å‘é€ç»™ä»–çš„ä¸€ä¸ªå€¼ã€‚ç”±äºæœ€å¤šåªæœ‰kä¸ªå›å¾’ï¼Œp=2k+1ï¼Œè¿™äº›è·¯å¾„ä¸­æœ‰ä¸€åŠä»¥ä¸Šå®Œå…¨ç”±å¿ è¯šçš„ä¸­å°‰ç»„æˆã€‚å› æ­¤ï¼Œå¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆå¤§å¤šæ•°çš„å€¼å°†ç­‰äºä»–å‘é€çš„å€¼ï¼Œè¿™æ„å‘³ç€IC2è¢«æ»¡è¶³ã€‚\nç°åœ¨å‡è®¾m-1ï¼Œm\u0026gt;1çš„å®šç†ã€‚å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆNä¸­çš„pä¸ªä¸­å°‰éƒ½ä¼šå¾—åˆ°æ­£ç¡®çš„ä»·å€¼ã€‚ç”±äºp\u0026gt;2kï¼Œä»–ä»¬ä¸­çš„å¤§å¤šæ•°äººéƒ½æ˜¯å¿ è¯šçš„ï¼Œæ ¹æ®å½’çº³å‡è®¾ï¼Œä»–ä»¬ä¸­çš„æ¯ä¸€ä¸ªäººéƒ½å‘æ¯ä¸ªå¿ è¯šçš„ä¸­å°‰å‘é€äº†æ­£ç¡®çš„ä»·å€¼ã€‚å› æ­¤ï¼Œæ¯ä¸ªå¿ è¯šçš„ä¸­å°‰éƒ½å¾—åˆ°äº†å¤§å¤šæ•°çš„æ­£ç¡®å€¼ï¼Œä»è€Œå¾—åˆ°äº†æ­¥éª¤ï¼ˆ3ï¼‰ä¸­çš„æ­£ç¡®å€¼ã€‚\nThe correctness of Algorithm OM(m, 3m) is an immediate consequence of the following result.\nç®—æ³•OM(m, 3m)çš„æ­£ç¡®æ€§æ˜¯ä»¥ä¸‹ç»“æœçš„ç›´æ¥ç»“æœã€‚\nTHEOREM 3. For any m \u0026gt; 0 and any p \u0026gt; 3m, Algorithm OM(m, p) solves the Byzantine Generals Problem if there are at most m traitors.\nPROOF. By Lemma 2, letting k = m, we see that OM(m, p) satisfies IC2. If the commander is loyal, then IC1 follows from IC2, so we need only prove IC1 under the assumption that the commander is a traitor. To do this, we prove that every loyal lieutenant gets the same set of values vi in step (3). If m = 1, then this follows because all the lieutenants, including those in N, are loyal and the paths yi,k do not pass through the commander. For m \u0026gt; 1, a simple induction argument can be applied, since p-1\u0026gt;=3m implies that p-1\u0026gt;=3(m - 1).\nå®šç†3. å¯¹äºä»»ä½•m\u0026gt;0å’Œä»»ä½•p\u0026gt;3mï¼Œå¦‚æœæœ‰æœ€å¤šmä¸ªå›å¾’ï¼Œç®—æ³•OM(m, p)å°±èƒ½è§£å†³æ‹œå åº­å°†å†›é—®é¢˜ã€‚\nè¯æ˜ã€‚æ ¹æ®å®šç†2ï¼Œè®©k=mï¼Œæˆ‘ä»¬çœ‹åˆ°OM(m, p)æ»¡è¶³IC2ã€‚å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆIC1ç”±IC2å¾—å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨æŒ‡æŒ¥å®˜æ˜¯å›å¾’çš„å‡è®¾ä¸‹è¯æ˜IC1ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¦è¯æ˜æ¯ä¸ªå¿ è¯šçš„ä¸­å°‰åœ¨æ­¥éª¤ï¼ˆ3ï¼‰ä¸­å¾—åˆ°ç›¸åŒçš„ä»·å€¼é›†ã€‚å¦‚æœm=1ï¼Œé‚£ä¹ˆè¿™å°±æ„å‘³ç€ï¼Œæ‰€æœ‰çš„ä¸­å°‰ï¼ŒåŒ…æ‹¬Nä¸­çš„ä¸­å°‰ï¼Œéƒ½æ˜¯å¿ è¯šçš„ï¼Œè€Œä¸”è·¯å¾„yi,kä¸ç»è¿‡å¸ä»¤å®˜ã€‚å¯¹äºm\u0026gt;1ï¼Œå¯ä»¥åº”ç”¨ä¸€ä¸ªç®€å•çš„å½’çº³è®ºè¯ï¼Œå› ä¸ºp-1\u0026gt;=3mæ„å‘³ç€p-1\u0026gt;=3ï¼ˆm - 1ï¼‰ã€‚\nOur extension of Algorithm OM(m) requires that the graph G be 3m-regular, which is a rather strong connectivity hypothesis. 3 In fact, if there are only 3m + 1 generals (the minimum number required), then 3m-regularity means complete connectivity, and Algorithm OM(m, 3m) reduces to Algorithm OM(m). In contrast, Algorithm SM(m) is easily extended to allow the weakest possible connectivity hypothesis. Let us first consider how much connectivity is needed for the Byzantine Generals Problem to be solvable. IC2 requires that a loyal lieutenant obey a loyal commander. This is clearly impossible if the commander cannot communicate with the lieutenant. In particular, if every message from the commander to the lieutenant must be relayed by traitors, then there is no way to guarantee that the lieutenant gets the commander\u0026rsquo;s order. Similarly, IC1 cannot be guaranteed if there are two lieutenants who can only communicate with one another via traitorous intermediaries.\nThe weakest connectivity hypothesis for which the Byzantine Generals Problem is solvable is that the subgraph formed by the loyal generals be connected. We show that under this hypothesis, the algorithm SM(n - 2) is a solution, where n is the number of generals\u0026ndash;regardless of the number of traitors. Of course, we must modify the algorithm so that generals only send messages to where they can be sent. More precisely, in step (1), the commander sends his signed order only to his neighboring lieutenants; and in step (2)(B), Lieutenant i only sends the message to every neighboring lieutenant not among the jr.\næˆ‘ä»¬å¯¹ç®—æ³•OM(m)çš„æ‰©å±•è¦æ±‚å›¾Gæ˜¯3m-è§„åˆ™çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“å¼ºçš„è¿æ¥æ€§å‡è®¾ã€‚3 äº‹å®ä¸Šï¼Œå¦‚æœåªæœ‰3m+1ä¸ªå°†å†›ï¼ˆæ‰€éœ€çš„æœ€å°æ•°é‡ï¼‰ï¼Œé‚£ä¹ˆ3m-è§„åˆ™æ€§å°±æ„å‘³ç€å®Œå…¨è¿é€šæ€§ï¼Œè€Œç®—æ³•OM(m, 3m)å°±ç®€åŒ–ä¸ºç®—æ³•OM(m)ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œç®—æ³•SM(m)å¾ˆå®¹æ˜“æ‰©å±•åˆ°å…è®¸æœ€å¼±çš„è¿æ¥æ€§å‡è®¾ã€‚è®©æˆ‘ä»¬é¦–å…ˆè€ƒè™‘æ‹œå åº­å°†å†›é—®é¢˜éœ€è¦å¤šå°‘è¿é€šæ€§æ‰èƒ½è¢«è§£å†³ã€‚IC2è¦æ±‚ä¸€ä¸ªå¿ è¯šçš„ä¸­å°‰æœä»ä¸€ä¸ªå¿ è¯šçš„æŒ‡æŒ¥å®˜ã€‚å¦‚æœæŒ‡æŒ¥å®˜ä¸èƒ½ä¸ä¸­å°‰æ²Ÿé€šï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœä»æŒ‡æŒ¥å®˜åˆ°ä¸­å°‰çš„æ¯æ¡ä¿¡æ¯éƒ½å¿…é¡»ç”±å›å¾’è½¬è¾¾ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰åŠæ³•ä¿è¯ä¸­å°‰å¾—åˆ°æŒ‡æŒ¥å®˜çš„å‘½ä»¤ã€‚åŒæ ·ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªä¸­å°‰åªèƒ½é€šè¿‡å›å¾’çš„ä¸­é—´äººç›¸äº’æ²Ÿé€šï¼Œé‚£ä¹ˆIC1ä¹Ÿæ— æ³•ä¿è¯ã€‚\næ‹œå åº­å°†å†›é—®é¢˜å¯è§£çš„æœ€å¼±è¿æ¥æ€§å‡è®¾æ˜¯ï¼Œç”±å¿ è¯šçš„å°†å†›ä»¬å½¢æˆçš„å­å›¾æ˜¯è¿æ¥çš„ã€‚æˆ‘ä»¬è¡¨æ˜ï¼Œåœ¨è¿™ä¸ªå‡è®¾ä¸‹ï¼Œç®—æ³•SM(n - 2)æ˜¯ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­næ˜¯å°†å†›çš„æ•°é‡\u0026ndash;æ— è®ºå›å¾’çš„æ•°é‡å¦‚ä½•ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¿…é¡»ä¿®æ”¹ç®—æ³•ï¼Œä½¿å°†å†›ä»¬åªæŠŠä¿¡æ¯å‘é€åˆ°å¯ä»¥å‘é€çš„åœ°æ–¹ã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œåœ¨æ­¥éª¤(1)ä¸­ï¼ŒæŒ‡æŒ¥å®˜åªå°†ä»–ç­¾ç½²çš„å‘½ä»¤å‘é€ç»™ä»–é‚»è¿‘çš„ä¸­å°‰ï¼›è€Œåœ¨æ­¥éª¤(2)(B)ä¸­ï¼Œä¸­å°‰iåªå°†ä¿¡æ¯å‘é€ç»™æ¯ä¸€ä¸ªä¸åœ¨jrçš„é‚»è¿‘ä¸­å°‰ã€‚\nWe prove the following more general result, where the diameter of a graph is the smallest number d such that any two nodes are connected by a path containing at most d arcs.\næˆ‘ä»¬è¯æ˜ä»¥ä¸‹æ›´ä¸€èˆ¬çš„ç»“æœï¼Œå›¾çš„ç›´å¾„æ˜¯æœ€å°çš„æ•°å­—dï¼Œå³ä»»ä½•ä¸¤ä¸ªèŠ‚ç‚¹éƒ½ç”±æœ€å¤šåŒ…å«dä¸ªå¼§çš„è·¯å¾„è¿æ¥ã€‚\nTHEOREM 4. For any m and d, if there are at most m traitors and the subgraph of loyal generals has diameter d, then Algorithm SM(m + d - 1) (with the above modification) solves the Byzantine Generals Problem.\nå®šç†4. å¯¹äºä»»ä½•må’Œdï¼Œå¦‚æœæœ€å¤šå­˜åœ¨mä¸ªå›å¾’ï¼Œå¹¶ä¸”å¿ è¯šå°†å†›çš„å­å›¾çš„ç›´å¾„ä¸ºdï¼Œé‚£ä¹ˆç®—æ³•SM(m + d - 1)ï¼ˆç»è¿‡ä¸Šè¿°ä¿®æ”¹ï¼‰å¯ä»¥è§£å†³æ‹œå åº­å°†å†›é—®é¢˜ã€‚\nPROOF. The proof is quite similar to that of Theorem 2 and is just sketched here. To prove IC2, observe that by hypothesis there is a path from the loyal commander to a lieutenant i going through d - 1 or fewer loyal lieutenants. Those lieutenants will correctly relay the order until it reaches i. As before, assumption A4 prevents a traitor from forging a different order.\nTo prove IC1, we assume the commander is a traitor and must show that any order received by a loyal lieutenant i is also received by a loyal lieutenant j. Suppose i receives an order v:0:j1:Â·Â·Â·:jk not signed by j. If k \u0026lt; m, then i will send it to every neighbor who has not already received that order, and it will be relayed to j within d - 1 more steps. If k \u0026gt; m, then one of the first m signers must be loyal and must have sent it to all of his neighbors, whereupon it will be relayed by loyal generals and will reach j within d - 1 steps.\nè¯æ˜ã€‚è¯¥è¯æ˜ä¸å®šç†2éå¸¸ç›¸ä¼¼ï¼Œåœ¨æ­¤ä»…ä½œç®€è¦è¯´æ˜ã€‚ä¸ºäº†è¯æ˜IC2ï¼Œè¯·æ³¨æ„ï¼Œæ ¹æ®å‡è®¾ï¼Œæœ‰ä¸€æ¡ä»å¿ è¯šçš„æŒ‡æŒ¥å®˜åˆ°ä¸­å°‰içš„è·¯å¾„è¦ç»è¿‡d-1æˆ–æ›´å°‘çš„å¿ è¯šä¸­å°‰ã€‚è¿™äº›ä¸­å°‰å°†æ­£ç¡®åœ°è½¬è¾¾å‘½ä»¤ï¼Œç›´åˆ°å®ƒåˆ°è¾¾iã€‚å¦‚å‰æ‰€è¿°ï¼Œå‡è®¾A4é˜²æ­¢å›å¾’ä¼ªé€ ä¸åŒçš„å‘½ä»¤ã€‚\nä¸ºäº†è¯æ˜IC1ï¼Œæˆ‘ä»¬å‡è®¾æŒ‡æŒ¥å®˜æ˜¯ä¸ªå›å¾’ï¼Œå¹¶ä¸”å¿…é¡»è¯æ˜å¿ å¿ƒçš„ä¸­å°‰iæ”¶åˆ°çš„ä»»ä½•å‘½ä»¤ä¹Ÿä¼šè¢«å¿ å¿ƒçš„ä¸­å°‰jæ”¶åˆ°ã€‚å‡è®¾iæ”¶åˆ°ä¸€ä¸ªæ²¡æœ‰jç­¾åçš„å‘½ä»¤v:0:j1:\u0026ndash;:jkã€‚å¦‚æœk\u0026gt;mï¼Œé‚£ä¹ˆå‰mä¸ªç­¾åè€…ä¸­çš„ä¸€ä¸ªä¸€å®šæ˜¯å¿ è¯šçš„ï¼Œè€Œä¸”ä¸€å®šæ˜¯æŠŠå®ƒå‘é€ç»™äº†ä»–çš„æ‰€æœ‰é‚»å±…ï¼Œè¿™æ—¶å®ƒå°†è¢«å¿ è¯šçš„å°†å†›ä»¬è½¬å‘ï¼Œå¹¶åœ¨d-1æ­¥å†…åˆ°è¾¾jã€‚\nCOROLLARY. If the graph of loyal generals is connected, then SM(n - 2) (as modified above) solves the Byzantine Generals Problem for n generals.\næ¨è®ºã€‚å¦‚æœå¿ è¯šå°†å†›çš„å›¾æ˜¯è¿æ¥çš„ï¼Œé‚£ä¹ˆSM(n - 2)(å¦‚ä¸Šæ–‡æ‰€ä¿®æ”¹)è§£å†³äº†nä¸ªå°†å†›çš„æ‹œå åº­å°†å†›é—®é¢˜ã€‚\nPROOF. Let d be the diameter of the graph of loyal generals. Since the diameter of a connected graph is less than the number of nodes, there must be more than d loyal generals and fewer than n - d traitors. The result follows from the theorem by letting m=n - d - 1.\nè¯æ˜ã€‚è®¾dä¸ºå¿ è¯šå°†å†›å›¾çš„ç›´å¾„ã€‚ç”±äºè¿é€šå›¾çš„ç›´å¾„å°äºèŠ‚ç‚¹æ•°ï¼Œæ‰€ä»¥å¿ è¯šçš„å°†å†›ä¸€å®šå¤šäºdï¼Œè€Œå›å¾’ä¸€å®šå°‘äºn-dã€‚ç”±å®šç†å¯çŸ¥ï¼Œç»“æœæ˜¯è®©m=n - d - 1ã€‚\nTheorem 4 assumes that the subgraph of loyal generals is connected. Its proof is easily extended to show that even if this is not the case, if there are at most m traitors, then the algorithm SM(m + d - 1) has the following two properties:\nAny two loyal generals connected by a path of length at most d passing through only loyal generals will obey the same order. If the commander is loyal, then any loyal lieutenant connected to him by a path of length at most m + d passing only through loyal generals will obey his order. å®šç†4 å‡è®¾å¿ è¯šå°†å†›çš„å­å›¾æ˜¯è¿æ¥çš„ã€‚å®ƒçš„è¯æ˜å¾ˆå®¹æ˜“æ‰©å±•åˆ°è¡¨æ˜ï¼Œå³ä½¿ä¸æ˜¯è¿™æ ·ï¼Œå¦‚æœæœ‰æœ€å¤šmä¸ªå›å¾’ï¼Œé‚£ä¹ˆç®—æ³•SM(m + d - 1)æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹æ€§ã€‚\nä»»ä½•ä¸¤ä¸ªå¿ è¯šçš„å°†å†›è¢«ä¸€æ¡æœ€å¤šé€šè¿‡å¿ è¯šå°†å†›çš„é•¿åº¦ä¸ºdçš„è·¯å¾„æ‰€è¿æ¥ï¼Œéƒ½å°†æœä»ç›¸åŒçš„å‘½ä»¤ã€‚ å¦‚æœæŒ‡æŒ¥å®˜æ˜¯å¿ è¯šçš„ï¼Œé‚£ä¹ˆä»»ä½•ä¸ä»–ç›¸è¿çš„å¿ è¯šçš„ä¸­å°‰ï¼Œé€šè¿‡ä¸€æ¡é•¿åº¦æœ€å¤šä¸ºm+dçš„è·¯å¾„ï¼Œåªç»è¿‡å¿ è¯šçš„å°†å†›ï¼Œéƒ½ä¼šæœä»ä»–çš„å‘½ä»¤ã€‚ ","date":"2022-07-11T00:00:00Z","permalink":"https://MyLoveES.github.io/p/%E6%8B%9C%E5%8D%A0%E5%BA%AD%E5%B0%86%E5%86%9B-%E8%AE%BA%E6%96%87%E7%BF%BB%E8%AF%91/","title":"æ‹œå åº­å°†å†› - è®ºæ–‡ç¿»è¯‘"},{"content":"(æ²¡æœ‰æŸ¥åˆ°æ ¹æœ¬åŸå› )\nèƒŒæ™¯ æœåŠ¡è¿è¡Œä¸­ï¼Œå‘ç°æœåŠ¡å™¨é¢‘ç¹ä¸å®šæ—¶é‡å¯ã€‚å‘ç°æ˜¯kernel crashé€ æˆçš„ã€‚\næŸ¥çœ‹ /var/crash/ ä¸‹çš„logï¼Œå‘ç°\nBUG: unable to handle kernel paging request at xxxxxxx\nåˆ†ævmcore ç¯å¢ƒ crashå·¥å…· å´©æºƒè½¬å‚¨æ–‡ä»¶(vmcore) å‘ç”Ÿå´©æºƒçš„å†…æ ¸æ˜ åƒæ–‡ä»¶(vmlinux)ï¼ŒåŒ…å«è°ƒè¯•å†…æ ¸æ‰€éœ€è°ƒè¯•ä¿¡æ¯ éœ€è¦å®‰è£…ï¼škernel-debuginfo kernel-debuginfo-common\n1 2 3 4 yum install crash wget http://debuginfo.centos.org/7/x86_64/kernel-debuginfo-common-x86_64-`uname -r`.rpm wget http://debuginfo.centos.org/7/x86_64/kernel-debuginfo-`uname -r`.rpm rpm -ivh *.rpm å®‰è£…å®Œæˆåï¼Œåœ¨/lib/debug/lib/modulesæ‰¾åˆ°vmlinuxå†…æ ¸æ˜ åƒæ–‡ä»¶\nvmcore-dmesg.txt vmcore 1 crash /lib/debug/lib/modules/3.10.0-957.el7.x86_64/vmlinux /var/crash/127.0.0.1-2020-04-04-14\\:10\\:45/vmcore æ‰§è¡Œ bt\næ‰§è¡Œ sym\nnvidia-smi æŸ¥çœ‹æ˜¾å¡ä¿¡æ¯ nvidia-smi gpu fan æ˜¾ç¤º error\nnvidia-smi -q\n","date":"2022-07-10T00:00:00Z","permalink":"https://MyLoveES.github.io/p/linux-nvidia-%E9%80%A0%E6%88%90-kernel-crash/","title":"Linux - NVIDIA é€ æˆ kernel crash"},{"content":"","date":"2022-05-06T00:00:00Z","permalink":"https://MyLoveES.github.io/p/callback-or-messagequeue/","title":"Callback Or MessageQueue"},{"content":" 1 pandoc --pdf-engine=xelatex --highlight-style zenburn --toc -V geometry:margin=1in -V urlcolor=NavyBlue -V CJKmainfont=\u0026#34;STKaitiSC-Regular\u0026#34; ${input} ${output} ","date":"2022-05-06T00:00:00Z","permalink":"https://MyLoveES.github.io/p/pandoc-mardown-to-pdf/","title":"Pandoc mardown to pdf"},{"content":"ssh-keygen -t rsa ","date":"2022-05-06T00:00:00Z","permalink":"https://MyLoveES.github.io/p/ssh-key-%E7%94%9F%E6%88%90/","title":"SSH key ç”Ÿæˆ"},{"content":"åªåˆ—å‡ºäº†æˆ‘å¸¸ç”¨çš„æ“ä½œ\nsurround æ“ä½œ å¿«æ·é”® æ•ˆæœ æ’å…¥ ysiw' abc -\u0026gt; \u0026lsquo;abc\u0026rsquo; ysiwt abc -\u0026gt; abc ys3w) print a,b -\u0026gt; print (a,b) ys$) print a,b -\u0026gt; print (a,b) vwwS\u0026quot; print a,b -\u0026gt; print \u0026ldquo;a,b\u0026rdquo; æ›¿æ¢ cs\u0026quot;' \u0026ldquo;abc\u0026rdquo; -\u0026gt; \u0026lsquo;abc\u0026rsquo; csw' abc def! -\u0026gt; abc \u0026lsquo;def\u0026rsquo;! csW' abc def! -\u0026gt; abc \u0026lsquo;def!\u0026rsquo; cs)] (abc) -\u0026gt; [abc] cs){ (abc) -\u0026gt; { abc } åˆ é™¤ ds' \u0026lsquo;abc\u0026rsquo; -\u0026gt; abc ds( (abc)def -\u0026gt; abcdef dst abc -\u0026gt; abc commentary æ“ä½œ å¿«æ·é”® æ•ˆæœ æ³¨é‡Š gcc abc -\u0026gt; //abc gcap abc -\u0026gt; //abc å–æ¶ˆæ³¨é‡Š gcu //abc -\u0026gt; abc argtextobj æ“ä½œ å¿«æ·é”® æ•ˆæœ åˆ é™¤ daa function(arg1, arg2) -\u0026gt; function(arg1) æ›´æ”¹ cia function(arg1, arg2) -\u0026gt; function(arg1, ) cia function(arg1, arg2, arg3) -\u0026gt; function(arg1, arg2, arg3) cia function(arg1, func(a1, a2)) -\u0026gt; function(arg1, ) exchange æ“ä½œ å¿«æ·é”® æ•ˆæœ æ›¿æ¢ cx{motion} abcdef123 -\u0026gt; abc123def æ›¿æ¢line cxx abc -\u0026gt; 123 visual mode X cx æ¸…é™¤ç¼“å­˜ cxc textobj-entire æ“ä½œ å¿«æ·é”® æ•ˆæœ åˆ é™¤ dae/die easymotion æ“ä½œ å¿«æ·é”® æ•ˆæœ æœç´¢ f æœç´¢ æœç´¢ s æœç´¢ replace with register æ“ä½œ å¿«æ·é”® æ•ˆæœ ç²˜è´´ gr{motion} abcdef -\u0026gt; abcabc NERDTree æ“ä½œ å¿«æ·é”® æ•ˆæœ Treeæ‰“å¼€å…³é—­ ctrl+n å…‰æ ‡åœ¨ç›®å½•æ ‘ä¸æ–‡ä»¶é—´åˆ‡æ¢ ctrl+w+w åˆ‡æ¢åˆ°å‰ä¸€ä¸ªtab g+T åˆ‡æ¢åˆ°åä¸€ä¸ªtab g+t åœ¨æ–° Tab ä¸­æ‰“å¼€é€‰ä¸­æ–‡ä»¶/ä¹¦ç­¾ï¼Œå¹¶è·³åˆ°æ–° Tab t å…³é—­å½“å‰çš„ tab :tabc å…³é—­æ‰€æœ‰å…¶ä»–çš„ tab :tabo paragraph-motion æ“ä½œ å¿«æ·é”® æ•ˆæœ shift + {/} æ®µè½ç§»åŠ¨ å³ä½¿ç©ºæ ¼è¡Œä¹Ÿç®— ","date":"2022-04-16T00:00:00Z","permalink":"https://MyLoveES.github.io/p/vim-%E6%8F%92%E4%BB%B6/","title":"Vim æ’ä»¶"},{"content":".vimrc 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 if filereadable(expand(\u0026#34;~/.vimrc.bundles\u0026#34;)) source ~/.vimrc.bundles endif syntax enable \u0026#34;set background=light \u0026#34;colorscheme solarized let mapleader=\u0026#34;,\u0026#34; \u0026#34;\u0026#34;\u0026#34; Plugins -------------------------------- \u0026#34; ys, cs, ds, S \u0026#34; set surround \u0026#34; gcc, gc + motion, v_gc \u0026#34; set commentary \u0026#34; argument text objects: aa, ia \u0026#34; set argtextobj \u0026#34; cx{motion} to select, again to exchange \u0026#34; set exchange \u0026#34; entire buffer text object: ae \u0026#34; set textobj-entire \u0026#34; easymotion \u0026lt;Leader\u0026gt; s / f \u0026#34; set easymotion \u0026#34; å¯„å­˜å™¨æ›¿æ¢ \u0026#34; set ReplaceWithRegister \u0026#34; æ–‡ä»¶æ ‘å±•ç¤º \u0026#34; set NERDTree \u0026#34; å¤åˆ¶æ—¶é«˜äº®å†…å®¹ \u0026#34; set highlightedyank \u0026#34; ç©ºæ ¼è¡Œä¹Ÿèƒ½å¤Ÿè·³è½¬ \u0026#34; set vim-paragraph-motion \u0026#34; autocmd VimEnter * NERDTree \u0026#34;\u0026#34;\u0026#34; Common settings ------------------------- \u0026#34; æ˜¾ç¤ºå½“å‰mode set showmode \u0026#34; å…‰æ ‡ç§»åŠ¨æ—¶ä¿ç•™5è¡Œ set so=5 \u0026#34; å®æ—¶æŸ¥æ‰¾ set incsearch \u0026#34; æ˜¾ç¤ºè¡Œå· \u0026#34; set nu \u0026#34; å¿½ç•¥å¤§å°å†™ set ignorecase \u0026#34; å…è®¸å…‰æ ‡åˆ°è¡Œæœ« set virtualedit=onemore \u0026#34; æœç´¢å†…å®¹é«˜äº®æ˜¾ç¤º \u0026#34; set hlsearch set tabstop=4 set shiftwidth=4 set expandtab \u0026#34;\u0026#34;\u0026#34; Plugin settings ------------------------- let g:argtextobj_pairs=\u0026#34;[:],(:),\u0026lt;:\u0026gt;\u0026#34; let g:highlightedyank_highlight_duration = \u0026#34;1000\u0026#34; autocmd StdinReadPre * let s:std_in=1 autocmd VimEnter * if argc() == 1 \u0026amp;\u0026amp; isdirectory(argv()[0]) \u0026amp;\u0026amp; !exists(\u0026#34;s:std_in\u0026#34;) | exe \u0026#39;NERDTree\u0026#39; argv()[0] | wincmd p | ene | endif autocmd bufenter * if (winnr(\u0026#34;$\u0026#34;) == 1 \u0026amp;\u0026amp; exists(\u0026#34;b:NERDTree\u0026#34;) \u0026amp;\u0026amp; b:NERDTree.isTabTree()) | q | endif \u0026#34;\u0026#34;\u0026#34; My Mappings ----------------------------- map \u0026lt;leader\u0026gt;f \u0026lt;Plug\u0026gt;(easymotion-sn) map \u0026lt;leader\u0026gt;e \u0026lt;Plug\u0026gt;(easymotion-fn) map \u0026lt;C-n\u0026gt; :NERDTreeToggle\u0026lt;CR\u0026gt; .vimrc.bundles 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 set nocompatible \u0026#34; be iMproved, required filetype off \u0026#34; required \u0026#34; set the runtime path to include Vundle and initialize set rtp+=~/.vim/bundle/Vundle.vim call vundle#begin() \u0026#34; alternatively, pass a path where Vundle should install plugins \u0026#34;call vundle#begin(\u0026#39;~/some/path/here\u0026#39;) \u0026#34; let Vundle manage Vundle, required Plugin \u0026#39;VundleVim/Vundle.vim\u0026#39; Plugin \u0026#39;tpope/vim-surround\u0026#39; Plugin \u0026#39;tpope/vim-commentary\u0026#39; Plugin \u0026#39;vim-scripts/argtextobj.vim\u0026#39; Plugin \u0026#39;tommcdo/vim-exchange\u0026#39; Plugin \u0026#39;kana/vim-textobj-user\u0026#39; Plugin \u0026#39;kana/vim-textobj-entire\u0026#39; Plugin \u0026#39;easymotion/vim-easymotion\u0026#39; Plugin \u0026#39;vim-scripts/ReplaceWithRegister\u0026#39; Plugin \u0026#39;preservim/nerdtree\u0026#39; Plugin \u0026#39;machakann/vim-highlightedyank\u0026#39; Plugin \u0026#39;dbakker/vim-paragraph-motion\u0026#39; call vundle#end() \u0026#34; required filetype plugin indent on \u0026#34; required \u0026#34; Brief help \u0026#34; :PluginList - lists configured plugins \u0026#34; :PluginInstall - installs plugins; append `!` to update or just :PluginUpdate \u0026#34; :PluginSearch foo - searches for foo; append `!` to refresh local cache \u0026#34; :PluginClean - confirms removal of unused plugins; append `!` to auto-approve removal .ideavimrc 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 \u0026#34;\u0026#34; Source your .vimrc source ~/.vimrc \u0026#34;\u0026#34; -- Suggested options -- \u0026#34; Show a few lines of context around the cursor. Note that this makes the \u0026#34; text scroll if you mouse-click near the start or end of the window. set scrolloff=5 \u0026#34; Do incremental searching. set incsearch \u0026#34; Don\u0026#39;t use Ex mode, use Q for formatting. map Q gq \u0026#34;\u0026#34; -- Map IDE actions to IdeaVim -- https://jb.gg/abva4t \u0026#34;\u0026#34; Map \\r to the Reformat Code action \u0026#34;map \\r \u0026lt;Action\u0026gt;(ReformatCode) \u0026#34;\u0026#34; Map \u0026lt;leader\u0026gt;d to start debug \u0026#34;map \u0026lt;leader\u0026gt;d \u0026lt;Action\u0026gt;(Debug) \u0026#34;\u0026#34; Map \\b to toggle the breakpoint on the current line \u0026#34;map \\b \u0026lt;Action\u0026gt;(ToggleLineBreakpoint) let mapleader=\u0026#39;,\u0026#39; \u0026#34; Find more examples here: https://jb.gg/share-ideavimrc \u0026#34;\u0026#34;\u0026#34; Plugins -------------------------------- \u0026#34; ys, cs, ds, S set surround \u0026#34; gcc, gc + motion, v_gc set commentary \u0026#34; argument text objects: aa, ia set argtextobj \u0026#34; cx{motion} to select, again to exchange set exchange \u0026#34; entire buffer text object: ae set textobj-entire \u0026#34; easymotion \u0026lt;Leader\u0026gt; s / f set easymotion \u0026#34; å¯„å­˜å™¨æ›¿æ¢ set ReplaceWithRegister \u0026#34; æ–‡ä»¶æ ‘å±•ç¤º set NERDTree \u0026#34; å¤åˆ¶æ—¶é«˜äº®å†…å®¹ set highlightedyank \u0026#34; ç©ºæ ¼è¡Œä¹Ÿèƒ½å¤Ÿè·³è½¬ set vim-paragraph-motion \u0026#34;\u0026#34;\u0026#34; Common settings ------------------------- \u0026#34; æ˜¾ç¤ºå½“å‰mode set showmode \u0026#34; å…‰æ ‡ç§»åŠ¨æ—¶ä¿ç•™5è¡Œ set so=5 \u0026#34; å®æ—¶æŸ¥æ‰¾ set incsearch \u0026#34; æ˜¾ç¤ºè¡Œå· set nu \u0026#34; å¿½ç•¥å¤§å°å†™ set ignorecase \u0026#34; å…è®¸å…‰æ ‡åˆ°è¡Œæœ« set virtualedit=onemore \u0026#34; æœç´¢å†…å®¹é«˜äº®æ˜¾ç¤º set hlsearch \u0026#34;\u0026#34;\u0026#34; Idea specific settings ------------------ \u0026#34; å¤šè¡Œåˆå¹¶ J set ideajoin \u0026#34; iconå±•ç¤º set ideastatusicon=gray \u0026#34; åœ¨normal modeé»˜è®¤eng set keep-english-in-normal-and-restore-in-insert \u0026#34;\u0026#34;\u0026#34; Plugin settings ------------------------- let g:argtextobj_pairs=\u0026#34;[:],(:),\u0026lt;:\u0026gt;\u0026#34; let g:highlightedyank_highlight_duration = \u0026#34;1000\u0026#34; \u0026#34;\u0026#34;\u0026#34; My Mappings ----------------------------- map \u0026lt;leader\u0026gt;f \u0026lt;Plug\u0026gt;(easymotion-s) map \u0026lt;leader\u0026gt;e \u0026lt;Plug\u0026gt;(easymotion-f) map \u0026lt;leader\u0026gt;d \u0026lt;Action\u0026gt;(Debug) map \u0026lt;leader\u0026gt;r \u0026lt;Action\u0026gt;(RenameElement) map \u0026lt;leader\u0026gt;c \u0026lt;Action\u0026gt;(Stop) map \u0026lt;leader\u0026gt;z \u0026lt;Action\u0026gt;(ToggleDistractionFreeMode) map \u0026lt;leader\u0026gt;s \u0026lt;Action\u0026gt;(SelectInProjectView) map \u0026lt;leader\u0026gt;a \u0026lt;Action\u0026gt;(Annotate) map \u0026lt;leader\u0026gt;h \u0026lt;Action\u0026gt;(Vcs.ShowTabbedFileHistory) map \u0026lt;S-Space\u0026gt; \u0026lt;Action\u0026gt;(GotoNextError) map \u0026lt;leader\u0026gt;= \u0026lt;Action\u0026gt;(ReformatCode) nnoremap \u0026lt;Tab\u0026gt; \u0026gt;\u0026gt;_ nnoremap \u0026lt;S-Tab\u0026gt; \u0026lt;\u0026lt;_ inoremap \u0026lt;S-Tab\u0026gt; \u0026lt;C-D\u0026gt; vnoremap \u0026lt;Tab\u0026gt; \u0026gt;gv vnoremap \u0026lt;S-Tab\u0026gt; \u0026lt;gv set ideastrictmode ","date":"2022-04-16T00:00:00Z","permalink":"https://MyLoveES.github.io/p/vim-%E9%85%8D%E7%BD%AE/","title":"Vim é…ç½®"},{"content":"Name ack - grep-like text finder ç±»grepçš„æ–‡æœ¬æœç´¢\nSYNOPSIS ack [options] PATTERN [FILE\u0026hellip;] // æŸ¥æ–‡æœ¬ ack -f [options] [DIRECTORY\u0026hellip;] // æœæ–‡ä»¶ DESCRIPTION ack è¢«è®¾è®¡ä¸ºç¨‹åºå‘˜çš„ grep çš„æ›¿ä»£å“ã€‚\nack åœ¨è¾“å…¥æ–‡ä»¶æˆ–ç›®å½•ä¸­æœç´¢ä¸ç»™å®šæ¨¡å¼åŒ¹é…çš„è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ ack æ‰“å°åŒ¹é…çš„è¡Œã€‚å¦‚æœæ²¡æœ‰ç»™å‡º FILE æˆ– DIRECTORYï¼Œåˆ™å°†æœç´¢å½“å‰ç›®å½•ã€‚\nAck è¿˜å¯ä»¥åˆ—å‡ºå°†è¦æœç´¢çš„æ–‡ä»¶ï¼Œè€Œæ— éœ€å®é™…æœç´¢å®ƒä»¬ï¼Œä»¥è®©æ‚¨åˆ©ç”¨ ack çš„æ–‡ä»¶ç±»å‹è¿‡æ»¤åŠŸèƒ½ã€‚\nFILE SELECTION å¦‚æœæ²¡æœ‰æŒ‡å®šæ–‡ä»¶è¿›è¡Œæœç´¢ï¼Œæ— è®ºæ˜¯åœ¨å‘½ä»¤è¡Œä¸Šè¿˜æ˜¯ä½¿ç”¨ -x é€‰é¡¹é€šè¿‡ç®¡é“è¾“å…¥ï¼Œack éƒ½ä¼šæ·±å…¥åˆ°å­ç›®å½•ä¸­é€‰æ‹©æ–‡ä»¶è¿›è¡Œæœç´¢ã€‚\n-x Read the list of files to search from STDIN.\nack å¯¹å®ƒæœç´¢çš„æ–‡ä»¶å¾ˆæ™ºèƒ½ã€‚å®ƒåŸºäºæ–‡ä»¶çš„æ‰©å±•åä»¥åŠåœ¨æŸäº›æƒ…å†µä¸‹æ–‡ä»¶çš„å†…å®¹äº†è§£æŸäº›æ–‡ä»¶ç±»å‹ã€‚å¯ä»¥ä½¿ç”¨ \u0026ndash;type é€‰é¡¹è¿›è¡Œè¿™äº›é€‰æ‹©ã€‚\nexample: ack \u0026ndash;type=python\nåœ¨æ²¡æœ‰æ–‡ä»¶é€‰æ‹©çš„æƒ…å†µä¸‹ï¼Œack æœç´¢æ²¡æœ‰è¢« \u0026ndash;ignore-dir å’Œ \u0026ndash;ignore-file é€‰é¡¹æ˜ç¡®æ’é™¤çš„å¸¸è§„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶è¦ä¹ˆå­˜åœ¨äº ackrc æ–‡ä»¶ä¸­ï¼Œè¦ä¹ˆå­˜åœ¨äºå‘½ä»¤è¡Œä¸­ã€‚\nack çš„é»˜è®¤é€‰é¡¹å¿½ç•¥æŸäº›æ–‡ä»¶å’Œç›®å½•ã€‚è¿™äº›åŒ…æ‹¬ï¼š\nå¤‡ä»½æ–‡ä»¶ï¼šåŒ¹é… #*# æˆ–ä»¥ ~ ç»“å°¾çš„æ–‡ä»¶ã€‚ Coredumpsï¼šä¸æ ¸å¿ƒåŒ¹é…çš„æ–‡ä»¶ã€‚\\d+ ç‰ˆæœ¬æ§åˆ¶ç›®å½•ï¼Œå¦‚ .svn å’Œ .gitã€‚ ä½¿ç”¨ \u0026ndash;dump é€‰é¡¹è¿è¡Œ ack ä»¥æŸ¥çœ‹è®¾ç½®äº†å“ªäº›è®¾ç½®ã€‚\nä½†æ˜¯ï¼Œack æ€»æ˜¯æœç´¢å‘½ä»¤è¡Œä¸­ç»™å‡ºçš„æ–‡ä»¶ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹ã€‚å¦‚æœä½ å‘Šè¯‰ ack åœ¨ coredump ä¸­æœç´¢ï¼Œå®ƒä¼šåœ¨ coredump ä¸­æœç´¢ã€‚\nDIRECTORY SELECTION Acké€šè¿‡æŒ‡å®šçš„èµ·å§‹ç›®å½•çš„ç›®å½•æ ‘é€’å½’ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šç›®å½•ï¼Œåˆ™ä½¿ç”¨å½“å‰å·¥ä½œç›®å½•ã€‚ä½†æ˜¯ï¼Œå®ƒå°†å¿½ç•¥è®¸å¤šç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä½¿ç”¨çš„å½±å­ç›®å½•ï¼Œä»¥åŠPerl MakeMakerç³»ç»Ÿä½¿ç”¨çš„æ„å»ºç›®å½•ã€‚ä½ å¯ä»¥ä½¿ç”¨â€”â€”[no]ignore-diré€‰é¡¹ä»è¿™ä¸ªåˆ—è¡¨ä¸­æ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªç›®å½•ã€‚è¯¥é€‰é¡¹å¯ä»¥é‡å¤æ·»åŠ /åˆ é™¤å¿½ç•¥åˆ—è¡¨ä¸­çš„å¤šä¸ªç›®å½•ã€‚\næœ‰å…³æœªæœç´¢çš„ç›®å½•çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·è¿è¡Œ ack \u0026ndash;dumpã€‚\nMATCHING IN A RANGE OF LINES \u0026ndash;range-start å’Œ \u0026ndash;range-end é€‰é¡¹å…è®¸æ‚¨æŒ‡å®šè¦åœ¨æ¯ä¸ªæ–‡ä»¶ä¸­æœç´¢çš„è¡ŒèŒƒå›´ã€‚\nå‡è®¾æ‚¨æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼Œç§°ä¸º testfileï¼š\n1 2 3 4 5 6 7 8 9 # This function calls print on \u0026#34;foo\u0026#34;. sub foo { print \u0026#39;foo\u0026#39;; } my $print = 1; sub bar { print \u0026#39;bar\u0026#39;; } my $task = \u0026#39;print\u0026#39;; è°ƒç”¨ ack print ä¼šç»™æˆ‘ä»¬äº”ä¸ªåŒ¹é…é¡¹ï¼š\n1 2 3 4 5 6 $ ack print testfile # This function calls print on \u0026#34;foo\u0026#34;. print \u0026#39;foo\u0026#39;; my $print = 1; print \u0026#39;bar\u0026#39;; my $task = \u0026#39;print\u0026#39;;\\ å¦‚æœæˆ‘ä»¬åªæƒ³åœ¨å­ç¨‹åºä¸­æœç´¢ print æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥æŒ‡å®šè¦ ack æœç´¢çš„è¡Œçš„èŒƒå›´ã€‚èŒƒå›´ä»¥åŒ¹é…æ¨¡å¼ ^sub \\w+ çš„è¡Œå¼€å§‹ï¼Œå¹¶ä»¥åŒ¹é… ^} çš„è¡Œç»“æŸã€‚\n1 2 3 $ ack --range-start=\u0026#39;^sub \\w+\u0026#39; --range-end=\u0026#39;^}\u0026#39; print testfile print \u0026#39;foo\u0026#39;; print \u0026#39;bar\u0026#39;; è¯·æ³¨æ„ï¼Œ ack æœç´¢äº†ä¸¤ä¸ªèŒƒå›´çš„è¡Œã€‚ä¸‹é¢çš„æ¸…å•æ˜¾ç¤ºäº†å“ªäº›è¡Œåœ¨èŒƒå›´å†…ï¼Œå“ªäº›è¡Œä¸åœ¨èŒƒå›´å†…ã€‚\n1 2 3 4 5 6 7 8 9 Out # This function calls print on \u0026#34;foo\u0026#34;. In sub foo { In print \u0026#39;foo\u0026#39;; In } Out my $print = 1; In sub bar { In print \u0026#39;bar\u0026#39;; In } Out my $task = \u0026#39;print\u0026#39;; ä¸å¿…åŒæ—¶æŒ‡å®š \u0026ndash;range-start å’Œ \u0026ndash;range-endã€‚ å¦‚æœçœç•¥\u0026ndash;range-startï¼Œåˆ™èŒƒå›´ä»æ–‡ä»¶ä¸­çš„ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œå³åŒ¹é…\u0026ndash;range-endçš„ç¬¬ä¸€è¡Œã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœçœç•¥ \u0026ndash;range-endï¼Œåˆ™èŒƒå›´ä»åŒ¹é… \u0026ndash;range-start çš„ç¬¬ä¸€è¡Œåˆ°æ–‡ä»¶æœ«å°¾ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³æœç´¢æ‰€æœ‰ HTML æ–‡ä»¶ç›´åˆ° çš„ç¬¬ä¸€ä¸ªå®ä¾‹ï¼Œä½ å¯ä»¥è¿™æ ·åš\n1 ack foo --range-end=\u0026#39;\u0026lt;body\u0026gt;\u0026#39; æˆ–è€…æœç´¢ Perl çš„ __DATA__ æˆ– __END__ æ ‡è®°ï¼Œä½ å¯ä»¥è¿™æ ·åš\n1 ack pattern --range-end=\u0026#39;^__(END|DATA)__\u0026#39; èŒƒå›´å¯ä»¥åœ¨åŒä¸€è¡Œå¼€å§‹å’Œåœæ­¢ã€‚ä¾‹å¦‚:\n1 --range-start=\u0026#39;\u0026lt;title\u0026gt;\u0026#39; --range-end=\u0026#39;\u0026lt;/title\u0026gt;\u0026#39; å°†åŒ¹é…è¯¥è¡Œä½œä¸ºèŒƒå›´çš„å¼€å§‹å’Œç»“æŸï¼Œå½¢æˆå•è¡ŒèŒƒå›´ã€‚\n1 \u0026lt;title\u0026gt;Page title\u0026lt;/title\u0026gt; è¯·æ³¨æ„ï¼Œ\u0026ndash;range-start å’Œ \u0026ndash;range-end ä¸­çš„æ¨¡å¼ä¸å— -iã€-w å’Œ -Q ç­‰é€‰é¡¹çš„å½±å“ï¼Œè¿™äº›é€‰é¡¹ä¼šä¿®æ”¹è¢«åŒ¹é…çš„ä¸»æ¨¡å¼çš„è¡Œä¸ºã€‚\nåŒæ ·ï¼ŒèŒƒå›´ä»…å½±å“æŸ¥æ‰¾åŒ¹é…é¡¹çš„ä½ç½®ã€‚ ack ä¸­çš„å…¶ä»–æ‰€æœ‰å†…å®¹éƒ½ä»¥ç›¸åŒçš„æ–¹å¼å·¥ä½œã€‚å¯¹èŒƒå›´ä½¿ç”¨ -c é€‰é¡¹å°†è®¡ç®—å‡ºç°åœ¨è¿™äº›èŒƒå›´å†…çš„æ‰€æœ‰åŒ¹é…é¡¹ã€‚ -l æ˜¾ç¤ºåœ¨æŸä¸ªèŒƒå›´å†…åŒ¹é…çš„æ–‡ä»¶ï¼Œ-L é€‰é¡¹æ˜¾ç¤ºåœ¨æŸä¸ªèŒƒå›´å†…æ²¡æœ‰åŒ¹é…çš„æ–‡ä»¶ã€‚\nç”¨äºå¦å®šåŒ¹é…çš„ -v é€‰é¡¹ä¹Ÿé€‚ç”¨äºè¯¥èŒƒå›´å†…ã€‚è¦åœ¨ HTML æ–‡ä»¶çš„â€œâ€éƒ¨åˆ†ä¸­æŸ¥çœ‹ä¸â€œgoogleâ€ä¸åŒ¹é…çš„è¡Œï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š\n1 ack google -v --html --range-start=\u0026#39;\u0026lt;head\u0026#39; --range-end=\u0026#39;\u0026lt;/head\u0026gt;\u0026#39; æŒ‡å®šè¦æœç´¢çš„èŒƒå›´ä¸ä¼šå½±å“åŒ¹é…é¡¹çš„æ˜¾ç¤ºæ–¹å¼ã€‚åŒ¹é…çš„ä¸Šä¸‹æ–‡ä»ç„¶æ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸Šä¸‹æ–‡é€‰é¡¹çš„å·¥ä½œæ–¹å¼ç›¸åŒï¼Œå³ä½¿ä¸Šä¸‹æ–‡è¡Œè¶…å‡ºèŒƒå›´ï¼Œä¹Ÿä¼šæ˜¾ç¤ºåŒ¹é…çš„ä¸Šä¸‹æ–‡è¡Œã€‚åŒæ ·ï¼Œ \u0026ndash;passthru å°†æ˜¾ç¤ºæ–‡ä»¶ä¸­çš„æ‰€æœ‰è¡Œï¼Œä½†ä»…æ˜¾ç¤ºèŒƒå›´å†…çš„è¡Œçš„åŒ¹é…é¡¹ã€‚\nOPTIONS `### \u0026ndash;ackrc æŒ‡å®šè¦åœ¨æ‰€æœ‰å…¶ä»–æ–‡ä»¶ä¹‹ååŠ è½½çš„ ackrc æ–‡ä»¶ï¼›è¯·å‚é˜… \u0026ldquo;ACKRC LOCATION SEMANTICS\u0026rdquo;.\n-A NUM, \u0026ndash;after-context=NUM åœ¨åŒ¹é…è¡Œä¹‹åæ‰“å° NUM è¡Œã€‚\n-B NUM, \u0026ndash;before-context=NUM åœ¨åŒ¹é…è¡Œä¹‹å‰æ‰“å° NUM è¡Œã€‚\n\u0026ndash;[no]break æ‰“å°æ¥è‡ªä¸åŒæ–‡ä»¶çš„ç»“æœä¹‹é—´çš„ä¸­æ–­ã€‚äº¤äº’ä½¿ç”¨æ—¶é»˜è®¤å¼€å¯ã€‚\n-C [NUM], \u0026ndash;context[=NUM] åœ¨åŒ¹é…è¡Œå‘¨å›´æ‰“å° NUM è¡Œï¼ˆé»˜è®¤ 2ï¼‰ä¸Šä¸‹æ–‡ã€‚æ‚¨å¯ä»¥æŒ‡å®šé›¶è¡Œä¸Šä¸‹æ–‡æ¥è¦†ç›– ackrc ä¸­æŒ‡å®šçš„å¦ä¸€ä¸ªä¸Šä¸‹æ–‡ã€‚\n-c, \u0026ndash;count æŠ‘åˆ¶æ­£å¸¸è¾“å‡ºï¼› è€Œæ˜¯æ‰“å°æ¯ä¸ªè¾“å…¥æ–‡ä»¶çš„åŒ¹é…è¡Œæ•°ã€‚ å¦‚æœ -l ç”Ÿæ•ˆï¼Œå®ƒåªä¼šæ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶çš„è¡Œæ•°åŒ¹é…çš„è¡Œæ•°ã€‚ å¦‚æœæ²¡æœ‰ -lï¼ŒæŸäº›è¡Œæ•°å¯èƒ½ä¸ºé›¶ã€‚ å¦‚æœç»“åˆ -h (\u0026ndash;no-filename) ack åªè¾“å‡ºä¸€ä¸ªæ€»æ•°ã€‚\n\u0026ndash;[no]color, \u0026ndash;[no]colour \u0026ndash;color çªå‡ºæ˜¾ç¤ºåŒ¹é…çš„æ–‡æœ¬ã€‚ \u0026ndash;nocolor æŠ‘åˆ¶é¢œè‰²ã€‚ é™¤éè¾“å‡ºè¢«é‡å®šå‘ï¼Œå¦åˆ™é»˜è®¤æƒ…å†µä¸‹è¿™æ˜¯æ‰“å¼€çš„ã€‚ åœ¨ Windows ä¸Šï¼Œæ­¤é€‰é¡¹é»˜è®¤å…³é—­ï¼Œé™¤éå®‰è£…äº† Win32::Console::ANSI æ¨¡å—æˆ–ä½¿ç”¨äº† ACK_PAGER_COLOR ç¯å¢ƒå˜é‡ã€‚\n\u0026ndash;color-filename=color è®¾ç½®ç”¨äºæ–‡ä»¶åçš„é¢œè‰²ã€‚\n\u0026ndash;color-match=color è®¾ç½®ç”¨äºåŒ¹é…çš„é¢œè‰²ã€‚\n\u0026ndash;color-colno=color è®¾ç½®ç”¨äºåˆ—å·çš„é¢œè‰²ã€‚\n\u0026ndash;color-lineno=color è®¾ç½®ç”¨äºè¡Œå·çš„é¢œè‰²ã€‚\n\u0026ndash;[no]column æ˜¾ç¤ºç¬¬ä¸€ä¸ªåŒ¹é…çš„åˆ—å·ã€‚è¿™å¯¹äºå¯ä»¥å°†å…‰æ ‡æ”¾åœ¨ç»™å®šä½ç½®çš„ç¼–è¾‘å™¨å¾ˆæœ‰å¸®åŠ©ã€‚\n\u0026ndash;create-ackrc å°†é»˜è®¤ ack é€‰é¡¹è½¬å‚¨åˆ°æ ‡å‡†è¾“å‡ºã€‚å½“æ‚¨æƒ³è¦è‡ªå®šä¹‰é»˜è®¤å€¼æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚\n\u0026ndash;dump å°†åŠ è½½çš„é€‰é¡¹åˆ—è¡¨åŠå…¶æ¥æºå†™å…¥æ ‡å‡†è¾“å‡ºã€‚æ–¹ä¾¿è°ƒè¯•ã€‚\n\u0026ndash;[no]env \u0026ndash;noenv ç¦ç”¨æ‰€æœ‰ç¯å¢ƒå¤„ç†ã€‚ä¸è¯»å– .ackrc å¹¶å¿½ç•¥æ‰€æœ‰ç¯å¢ƒå˜é‡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œack ä¼šè€ƒè™‘ç¯å¢ƒä¸­çš„ .ackrc å’Œè®¾ç½®ã€‚\n\u0026ndash;flush \u0026ndash;flush ç«‹å³åˆ·æ–°è¾“å‡ºã€‚é»˜è®¤æƒ…å†µä¸‹è¿™æ˜¯å…³é—­çš„ï¼Œé™¤é ack ä»¥äº¤äº’æ–¹å¼è¿è¡Œï¼ˆå½“è¾“å‡ºåˆ°ç®¡é“æˆ–æ–‡ä»¶æ—¶ï¼‰ã€‚\n-f æ‰“å°å°†è¦æœç´¢çš„æ–‡ä»¶ï¼Œè€Œä¸å®é™…è¿›è¡Œä»»ä½•æœç´¢ã€‚ä¸å¾—æŒ‡å®š PATTERNï¼Œå¦åˆ™å°†è¢«è§†ä¸ºæœç´¢è·¯å¾„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 --ackrc Specifies an ackrc file to load after all others; see \u0026#34;ACKRC LOCATION SEMANTICS\u0026#34;. -A NUM, --after-context=NUM Print NUM lines of trailing context after matching lines. -B NUM, --before-context=NUM Print NUM lines of leading context before matching lines. --[no]break Print a break between results from different files. On by default when used interactively. -C [NUM], --context[=NUM] Print NUM lines (default 2) of context around matching lines. You can specify zero lines of context to override another context specified in an ackrc. -c, --count Suppress normal output; instead print a count of matching lines for each input file. If -l is in effect, it will only show the number of lines for each file that has lines matching. Without -l, some line counts may be zeroes. If combined with -h (--no-filename) ack outputs only one total count. --[no]color, --[no]colour --color highlights the matching text. --nocolor suppresses the color. This is on by default unless the output is redirected. On Windows, this option is off by default unless the Win32::Console::ANSI module is installed or the \u0026#34;ACK_PAGER_COLOR\u0026#34; environment variable is used. --color-filename=color Sets the color to be used for filenames. --color-match=color Sets the color to be used for matches. --color-colno=color Sets the color to be used for column numbers. --color-lineno=color Sets the color to be used for line numbers. --[no]column Show the column number of the first match. This is helpful for editors that can place your cursor at a given position. --create-ackrc Dumps the default ack options to standard output. This is useful for when you want to customize the defaults. --dump Writes the list of options loaded and where they came from to standard output. Handy for debugging. --[no]env --noenv disables all environment processing. No .ackrc is read and all environment variables are ignored. By default, ack considers .ackrc and settings in the environment. --flush --flush flushes output immediately. This is off by default unless ack is running interactively (when output goes to a pipe or file). -f Only print the files that would be searched, without actually doing any searching. PATTERN must not be specified, or it will be taken as a path to search. --files-from=FILE The list of files to be searched is specified in FILE. The list of files are separated by newlines. If FILE is \u0026#34;-\u0026#34;, the list is loaded from standard input. Note that the list of files is not filtered in any way. If you add \u0026#34;--type=html\u0026#34; in addition to \u0026#34;--files-from\u0026#34;, the \u0026#34;--type\u0026#34; will be ignored. --[no]filter Forces ack to act as if it were receiving input via a pipe. --[no]follow Follow or don\u0026#39;t follow symlinks, other than whatever starting files or directories were specified on the command line. This is off by default. -g PATTERN Print searchable files where the relative path + filename matches PATTERN. Note that ack -g foo is exactly the same as ack -f | ack foo This means that just as ack will not search, for example, .jpg files, \u0026#34;-g\u0026#34; will not list .jpg files either. ack is not intended to be a general-purpose file finder. Note also that if you have \u0026#34;-i\u0026#34; in your .ackrc that the filenames to be matched will be case-insensitive as well. This option can be combined with --color to make it easier to spot the match. --[no]group --group groups matches by file name. This is the default when used interactively. --nogroup prints one result per line, like grep. This is the default when output is redirected. -H, --with-filename Print the filename for each match. This is the default unless searching a single explicitly specified file. -h, --no-filename Suppress the prefixing of filenames on output when multiple files are searched. --[no]heading Print a filename heading above each file\u0026#39;s results. This is the default when used interactively. --help Print a short help statement. --help-types Print all known types. --help-colors Print a chart of various color combinations. --help-rgb-colors Like --help-colors but with more precise RGB colors. -i, --ignore-case Ignore case distinctions in PATTERN. Overrides --smart-case and -I. -I, --no-ignore-case Turns on case distinctions in PATTERN. Overrides --smart-case and -i. --ignore-ack-defaults Tells ack to completely ignore the default definitions provided with ack. This is useful in combination with --create-ackrc if you really want to customize ack. --[no]ignore-dir=DIRNAME, --[no]ignore-directory=DIRNAME Ignore directory (as CVS, .svn, etc are ignored). May be used multiple times to ignore multiple directories. For example, mason users may wish to include --ignore-dir=data. The --noignore-dir option allows users to search directories which would normally be ignored (perhaps to research the contents of .svn/props directories). The DIRNAME must always be a simple directory name. Nested directories like foo/bar are NOT supported. You would need to specify --ignore-dir=foo and then no files from any foo directory are taken into account by ack unless given explicitly on the command line. --ignore-file=FILTER:ARGS Ignore files matching FILTER:ARGS. The filters are specified identically to file type filters as seen in \u0026#34;Defining your own types\u0026#34;. -k, --known-types Limit selected files to those with types that ack knows about. -l, --files-with-matches Only print the filenames of matching files, instead of the matching text. -L, --files-without-matches Only print the filenames of files that do NOT match. --match PATTERN Specify the PATTERN explicitly. This is helpful if you don\u0026#39;t want to put the regex as your first argument, e.g. when executing multiple searches over the same set of files. # search for foo and bar in given files ack file1 t/file* --match foo ack file1 t/file* --match bar -m=NUM, --max-count=NUM Print only NUM matches out of each file. If you want to stop ack after printing the first match of any kind, use the -1 options. --man Print this manual page. -n, --no-recurse No descending into subdirectories. -o Show only the part of each line matching PATTERN (turns off text highlighting). This is exactly the same as \u0026#34;--output=$\u0026amp;\u0026#34;. --output=expr Output the evaluation of expr for each line (turns off text highlighting). If PATTERN matches more than once then a line is output for each non-overlapping match. expr may contain the strings \u0026#34;\\n\u0026#34;, \u0026#34;\\r\u0026#34; and \u0026#34;\\t\u0026#34;, which will be expanded to their corresponding characters line feed, carriage return and tab, respectively. expr may also contain the following Perl special variables: $1 through $9 The subpattern from the corresponding set of capturing parentheses. If your pattern is \u0026#34;(.+) and (.+)\u0026#34;, and the string is \u0026#34;this and that\u0026#39;, then $1 is \u0026#34;this\u0026#34; and $2 is \u0026#34;that\u0026#34;. $_ The contents of the line in the file. $. The number of the line in the file. $\u0026amp;, \u0026#34;$`\u0026#34; and \u0026#34;$\u0026#39;\u0026#34; $\u0026amp; is the the string matched by the pattern, \u0026#34;$`\u0026#34; is what precedes the match, and \u0026#34;$\u0026#39;\u0026#34; is what follows it. If the pattern is \u0026#34;gra(ph|nd)\u0026#34; and the string is \u0026#34;lexicographic\u0026#34;, then $\u0026amp; is \u0026#34;graph\u0026#34;, \u0026#34;$`\u0026#34; is \u0026#34;lexico\u0026#34; and \u0026#34;$\u0026#39;\u0026#34; is \u0026#34;ic\u0026#34;. Use of these variables in your output will slow down the pattern matching.rocess Scheduling In Linux $+ The match made by the last parentheses that matched in the pattern. For example, if your pattern is \u0026#34;Version: (.+)|Revision: (.+)\u0026#34;, then $+ will contain whichever set of parentheses matched. $f $f is available, in \u0026#34;--output\u0026#34; only, to insert the filename. This is a stand- in for the discovered $filename usage in old \u0026#34;ack2 --output\u0026#34;, which is disallowed with \u0026#34;ack3\u0026#34; improved security. The intended usage is to provide the grep or compile-error syntax needed for editor/IDE go-to-line integration, e.g. \u0026#34;--output=$f:$.:$_\u0026#34; or \u0026#34;--output=$f\\t$.\\t$\u0026amp;\u0026#34; --pager=program, --nopager --pager directs ack\u0026#39;s output through program. This can also be specified via the \u0026#34;ACK_PAGER\u0026#34; and \u0026#34;ACK_PAGER_COLOR\u0026#34; environment variables. Using --pager does not suppress grouping and coloring like piping output on the command-line does. --nopager cancels any setting in ~/.ackrc, \u0026#34;ACK_PAGER\u0026#34; or \u0026#34;ACK_PAGER_COLOR\u0026#34;. No output will be sent through a pager. --passthru Prints all lines, whether or not they match the expression. Highlighting will still work, though, so it can be used to highlight matches while still seeing the entire file, as in: # Watch a log file, and highlight a certain IP address. $ tail -f ~/access.log | ack --passthru 123.45.67.89 --print0 Only works in conjunction with -f, -g, -l or -c, options that only list filenames. The filenames are output separated with a null byte instead of the usual newline. This is helpful when dealing with filenames that contain whitespace, e.g. # Remove all files of type HTML. ack -f --html --print0 | xargs -0 rm -f -p[N], --proximate[=N] Groups together match lines that are within N lines of each other. This is useful for visually picking out matches that appear close to other matches. For example, if you got these results without the \u0026#34;--proximate\u0026#34; option, 15: First match 18: Second match 19: Third match 37: Fourth match they would look like this with \u0026#34;--proximate=1\u0026#34; 15: First match 18: Second match 19: Third match 37: Fourth match and this with \u0026#34;--proximate=3\u0026#34;. 15: First match 18: Second match 19: Third match 37: Fourth match If N is omitted, N is set to 1. -P Negates the effect of the --proximate option. Shortcut for --proximate=0. -Q, --literal Quote all metacharacters in PATTERN, it is treated as a literal. -r, -R, --recurse Recurse into sub-directories. This is the default and just here for compatibility with grep. You can also use it for turning --no-recurse off. --range-start=PATTERN, --range-end=PATTERN Specifies patterns that mark the start and end of a range. See \u0026#34;MATCHING IN A RANGE OF LINES\u0026#34; for details. -s Suppress error messages about nonexistent or unreadable files. This is taken from fgrep. -S, --[no]smart-case, --no-smart-case Ignore case in the search strings if PATTERN contains no uppercase characters. This is similar to \u0026#34;smartcase\u0026#34; in the vim text editor. The options overrides -i and -I. -S is a synonym for --smart-case. -i always overrides this option. --sort-files Sorts the found files lexicographically. Use this if you want your file listings to be deterministic between runs of ack. --show-types Outputs the filetypes that ack associates with each file. Works with -f and -g options. -t TYPE, --type=TYPE, --TYPE Specify the types of files to include in the search. TYPE is a filetype, like perl or xml. --type=perl can also be specified as --perl, although this is deprecated. Type inclusions can be repeated and are ORed together. See ack --help-types for a list of valid types. -T TYPE, --type=noTYPE, --noTYPE Specifies the type of files to exclude from the search. --type=noperl can be done as --noperl, although this is deprecated. If a file is of both type \u0026#34;foo\u0026#34; and \u0026#34;bar\u0026#34;, specifying both --type=foo and --type=nobar will exclude the file, because an exclusion takes precedence over an inclusion. --type-add TYPE:FILTER:ARGS Files with the given ARGS applied to the given FILTER are recognized as being of (the existing) type TYPE. See also \u0026#34;Defining your own types\u0026#34;. --type-set TYPE:FILTER:ARGS Files with the given ARGS applied to the given FILTER are recognized as being of type TYPE. This replaces an existing definition for type TYPE. See also \u0026#34;Defining your own types\u0026#34;. --type-del TYPE The filters associated with TYPE are removed from Ack, and are no longer considered for searches. --[no]underline Turns on underlining of matches, where \u0026#34;underlining\u0026#34; is printing a line of carets under the match. $ ack -u foo peanuts.txt 17: Come kick the football you fool ^^^ ^^^ 623: Price per square foot ^^^ This is useful if you\u0026#39;re dumping the results of an ack run into a text file or printer that doesn\u0026#39;t support ANSI color codes. The setting of underline does not affect highlighting of matches. -v, --invert-match Invert match: select non-matching lines. --version Display version and copyright information. -w, --word-regexp Force PATTERN to match only whole words. -x An abbreviation for --files-from=-. The list of files to search are read from standard input, with one line per file. Note that the list of files is not filtered in any way. If you add \u0026#34;--type=html\u0026#34; in addition to \u0026#34;-x\u0026#34;, the \u0026#34;--type\u0026#34; will be ignored. -1 Stops after reporting first match of any kind. This is different from --max-count=1 or -m1, where only one match per file is shown. Also, -1 works with -f and -g, where -m does not. --thpppt Display the all-important Bill The Cat logo. Note that the exact spelling of --thpppppt is not important. It\u0026#39;s checked against a regular expression. --bar Check with the admiral for traps. --cathy Chocolate, Chocolate, Chocolate! ACKRC LOCATION SEMANTICS Ack å¯ä»¥ä»è®¸å¤šæ¥æºåŠ è½½å…¶é…ç½®ã€‚ ä»¥ä¸‹åˆ—è¡¨æŒ‡å®šäº† Ack æŸ¥æ‰¾é…ç½®æ–‡ä»¶çš„æ¥æºï¼› æ‰¾åˆ°çš„æ¯ä¸€ä¸ªéƒ½æŒ‰æ­¤å¤„æŒ‡å®šçš„é¡ºåºåŠ è½½ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªéƒ½è¦†ç›–åœ¨å®ƒä¹‹å‰çš„ä»»ä½•æºä¸­è®¾ç½®çš„é€‰é¡¹ã€‚ ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœæˆ‘åœ¨æˆ‘çš„ç”¨æˆ· ackrc ä¸­è®¾ç½®äº† \u0026ndash;sort-filesï¼Œåœ¨å‘½ä»¤è¡Œä¸­è®¾ç½®äº† \u0026ndash;nosort-filesï¼Œåˆ™å‘½ä»¤è¡Œä¼˜å…ˆï¼‰ã€‚\né»˜è®¤å€¼ä» App::Ack::ConfigDefaults åŠ è½½ã€‚è¿™å¯ä»¥ä½¿ç”¨ \u0026ndash;ignore-ack-defaults çœç•¥ã€‚\nGlobal ackrc\nç„¶åä»å…¨å±€ ackrc åŠ è½½é€‰é¡¹ã€‚å®ƒä½äºç±» Unix ç³»ç»Ÿä¸Šçš„ /etc/ackrc ä¸­ã€‚ åœ¨ Windows XP åŠæ›´æ—©ç‰ˆæœ¬ä¸‹ï¼Œå…¨å±€ ackrc ä½äº C:\\Documents and Settings\\All Users\\Application Data\\ackrc åœ¨ Windows Vista/7 ä¸‹ï¼Œå…¨å±€ ackrc ä½äº C:\\ProgramData\\ackrc\n\u0026ndash;noenv é€‰é¡¹å¯é˜²æ­¢åŠ è½½æ‰€æœ‰ ackrc æ–‡ä»¶ã€‚\nUser ackrc ç„¶åä»ç”¨æˆ·çš„ ackrc åŠ è½½é€‰é¡¹ã€‚ å®ƒä½äºç±» Unix ç³»ç»Ÿä¸Šçš„ $HOME/.ackrc ä¸­ã€‚ åœ¨ Windows XP å’Œæ›´æ—©ç‰ˆæœ¬ä¸‹ï¼Œç”¨æˆ·çš„ ackrc ä½äº C:\\Documents and Settings$USER\\Application Data\\ackrcã€‚ åœ¨ Windows Vista/7 ä¸‹ï¼Œç”¨æˆ·çš„ ackrc ä½äº C:\\Users$USER\\AppData\\Roaming\\ackrcã€‚\nå¦‚æœè¦åŠ è½½ä¸åŒçš„ç”¨æˆ·çº§ ackrcï¼Œå¯ä»¥ä½¿ç”¨ $ACKRC ç¯å¢ƒå˜é‡æŒ‡å®šã€‚\n\u0026ndash;noenv é€‰é¡¹å¯é˜²æ­¢åŠ è½½æ‰€æœ‰ ackrc æ–‡ä»¶ã€‚\nProject ackrc\nç„¶åä»é¡¹ç›® ackrc åŠ è½½é€‰é¡¹ã€‚ é¡¹ç›®ackrcæ˜¯ç¬¬ä¸€ä¸ªåä¸º.ackrcæˆ–_ackrcçš„ackrcæ–‡ä»¶ï¼Œå…ˆåœ¨å½“å‰ç›®å½•æœç´¢ï¼Œç„¶åæ˜¯çˆ¶ç›®å½•ï¼Œç„¶åæ˜¯ç¥–çˆ¶ç›®å½•ï¼Œç­‰ç­‰ã€‚è¿™ä¸ªå¯ä»¥ç”¨\u0026ndash;noenvçœç•¥ã€‚\n\u0026ndash;ackrc \u0026ndash;ackrc é€‰é¡¹å¯ä»¥åŒ…å«åœ¨å‘½ä»¤è¡Œä¸­ä»¥æŒ‡å®šå¯ä»¥è¦†ç›–æ‰€æœ‰å…¶ä»–æ–‡ä»¶çš„ ackrc æ–‡ä»¶ã€‚å³ä½¿å­˜åœ¨ \u0026ndash;noenv ä¹Ÿä¼šå‚è€ƒå®ƒã€‚\nCommand line ç„¶åä»å‘½ä»¤è¡ŒåŠ è½½é€‰é¡¹ã€‚\né™„å½•A - ack dump 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 Defaults ======== --ignore-directory=is:.bzr --ignore-directory=is:.cabal-sandbox --ignore-directory=is:.cdv --ignore-directory=is:.git --ignore-directory=is:.hg --ignore-directory=is:.metadata --ignore-directory=is:.pc --ignore-directory=is:.pytest_cache --ignore-directory=is:.svn --ignore-directory=is:CMakeFiles --ignore-directory=is:CVS --ignore-directory=is:RCS --ignore-directory=is:SCCS --ignore-directory=is:_MTN --ignore-directory=is:__MACOSX --ignore-directory=is:__pycache__ --ignore-directory=is:_build --ignore-directory=is:_darcs --ignore-directory=is:_sgbak --ignore-directory=is:autom4te.cache --ignore-directory=is:blib --ignore-directory=is:cover_db --ignore-directory=is:node_modules --ignore-directory=is:~.dep --ignore-directory=is:~.dot --ignore-directory=is:~.nib --ignore-directory=is:~.plst --ignore-file=ext:bak --ignore-file=ext:gif,jpg,jpeg,png --ignore-file=ext:gz,tar,tgz,zip --ignore-file=ext:mo --ignore-file=ext:pdf --ignore-file=ext:pyc,pyd,pyo --ignore-file=ext:so --ignore-file=is:.DS_Store --ignore-file=is:.git --ignore-file=match:/[.-]min[.]js$/ --ignore-file=match:/[.]css[.]map$/ --ignore-file=match:/[.]css[.]min$/ --ignore-file=match:/[.]js[.]map$/ --ignore-file=match:/[.]js[.]min$/ --ignore-file=match:/[.]min[.]css$/ --ignore-file=match:/[._].*[.]swp$/ --ignore-file=match:/^#.+#$/ --ignore-file=match:/core[.]\\d+$/ --ignore-file=match:/~$/ --type-add=actionscript:ext:as,mxml --type-add=ada:ext:ada,adb,ads --type-add=asm:ext:asm,s --type-add=asp:ext:asp --type-add=aspx:ext:master,ascx,asmx,aspx,svc --type-add=batch:ext:bat,cmd --type-add=bazel:ext:bazelrc --type-add=bazel:ext:bzl --type-add=bazel:is:BUILD --type-add=bazel:is:WORKSPACE --type-add=cc:ext:c,h,xs --type-add=cfmx:ext:cfc,cfm,cfml --type-add=clojure:ext:clj,cljs,edn,cljc --type-add=cmake:ext:cmake --type-add=cmake:is:CMakeLists.txt --type-add=coffeescript:ext:coffee --type-add=cpp:ext:cpp,cc,cxx,m,hpp,hh,h,hxx --type-add=csharp:ext:cs --type-add=css:ext:css --type-add=dart:ext:dart --type-add=delphi:ext:pas,int,dfm,nfm,dof,dpk,dproj,groupproj,bdsgroup,bdsproj --type-add=elisp:ext:el --type-add=elixir:ext:ex,exs --type-add=elm:ext:elm --type-add=erlang:ext:erl,hrl --type-add=fortran:ext:f,f77,f90,f95,f03,for,ftn,fpp --type-add=go:ext:go --type-add=groovy:ext:groovy,gtmpl,gpp,grunit,gradle --type-add=gsp:ext:gsp --type-add=haskell:ext:hs,lhs --type-add=hh:ext:h --type-add=hpp:ext:hpp,hh,h,hxx --type-add=html:ext:htm,html,xhtml --type-add=jade:ext:jade --type-add=java:ext:java,properties --type-add=js:ext:js --type-add=json:ext:json --type-add=jsp:ext:jsp,jspx,jspf,jhtm,jhtml --type-add=kotlin:ext:kt,kts --type-add=less:ext:less --type-add=lisp:ext:lisp,lsp --type-add=lua:ext:lua --type-add=lua:firstlinematch:/^#!.*\\blua(jit)?/ --type-add=make:ext:mak --type-add=make:ext:mk --type-add=make:is:GNUmakefile --type-add=make:is:Makefile --type-add=make:is:Makefile.Debug --type-add=make:is:Makefile.Release --type-add=make:is:makefile --type-add=markdown:ext:md,markdown --type-add=matlab:ext:m --type-add=objc:ext:m,h --type-add=objcpp:ext:mm,h --type-add=ocaml:ext:ml,mli,mll,mly --type-add=perl:ext:pl,pm,pod,t,psgi --type-add=perl:firstlinematch:/^#!.*\\bperl/ --type-add=perltest:ext:t --type-add=php:ext:php,phpt,php3,php4,php5,phtml --type-add=php:firstlinematch:/^#!.*\\bphp/ --type-add=plone:ext:pt,cpt,metadata,cpy,py --type-add=pod:ext:pod --type-add=purescript:ext:purs --type-add=python:ext:py --type-add=python:firstlinematch:/^#!.*\\bpython/ --type-add=rake:is:Rakefile --type-add=rr:ext:R --type-add=rst:ext:rst --type-add=ruby:ext:rb,rhtml,rjs,rxml,erb,rake,spec --type-add=ruby:firstlinematch:/^#!.*\\bruby/ --type-add=ruby:is:Rakefile --type-add=rust:ext:rs --type-add=sass:ext:sass,scss --type-add=scala:ext:scala --type-add=scheme:ext:scm,ss --type-add=shell:ext:sh,bash,csh,tcsh,ksh,zsh,fish --type-add=shell:firstlinematch:/^#!.*\\b(?:ba|t?c|k|z|fi)?sh\\b/ --type-add=smalltalk:ext:st --type-add=smarty:ext:tpl --type-add=sql:ext:sql,ctl --type-add=stylus:ext:styl --type-add=svg:ext:svg --type-add=swift:ext:swift --type-add=swift:firstlinematch:/^#!.*\\bswift/ --type-add=tcl:ext:tcl,itcl,itk --type-add=tex:ext:tex,cls,sty --type-add=toml:ext:toml --type-add=ts:ext:ts,tsx --type-add=ttml:ext:tt,tt2,ttml --type-add=vb:ext:bas,cls,frm,ctl,vb,resx --type-add=verilog:ext:v,vh,sv --type-add=vhdl:ext:vhd,vhdl --type-add=vim:ext:vim --type-add=xml:ext:xml,dtd,xsd,xsl,xslt,ent,wsdl --type-add=xml:firstlinematch:/\u0026lt;[?]xml/ --type-add=yaml:ext:yaml,yml ","date":"2022-04-14T00:00:00Z","permalink":"https://MyLoveES.github.io/p/ack-command/","title":"Ack command"},{"content":"\nè°ƒåº¦ Scheduling è°ƒåº¦æ˜¯è¿›è¡Œèµ„æºåˆ†é…çš„ä¸€ç§è¡Œä¸ºã€‚åœ¨å•çº¿ç¨‹ã€å¤šçº¿ç¨‹ä¹‹é—´è¿›è¡Œè°ƒåº¦ä»»åŠ¡ã€‚\nç›®æ ‡ Target æœ€å¤§ååé‡(å•ä½æ—¶é—´å†…å®Œæˆçš„ä»»åŠ¡é‡) æœ€å°çš„ç­‰å¾…æ—¶é—´(è¿›ç¨‹å‡†å¤‡å°±ç»ªåˆ°å¼€å§‹æ‰§è¡Œç»è¿‡çš„æ—¶é—´) æœ€å°çš„å“åº”æ—¶é—´(è¿›ç¨‹å‡†å¤‡å°±ç»ªåˆ°æ‰§è¡Œå®Œæˆç»è¿‡çš„æ—¶é—´) æœ€å¤§çš„å…¬å¹³æ€§(ä¸ºæ¯ä¸ªè¿›ç¨‹å…¬å¹³åœ°åˆ†é…èµ„æº) Linux ä¸­çš„ä¸¤ç§è¿›ç¨‹ç±»å‹ å®æ—¶è¿›ç¨‹ å¸¸è§„è¿›ç¨‹ å®æ—¶è¿›ç¨‹ å®æ—¶è¿›ç¨‹éœ€è¦æœä»ä¸ªå“åº”æ—¶é—´çš„é™åˆ¶ï¼Œè€Œä¸å»è€ƒè™‘ç³»ç»Ÿè´Ÿè½½ã€‚æ¢å¥è¯è¯´ï¼Œå®æ—¶è¿›ç¨‹æ˜¯ç´§æ€¥çš„ï¼Œä»»ä½•æƒ…å†µä¸‹éƒ½ä¸èƒ½å»¶è¿Ÿã€‚\nä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼ŒLinuxä¸­çš„è´Ÿè½½å‡è¡¡è¿›ç¨‹ï¼Œè´Ÿè´£è·¨CPUå†…æ ¸åˆ†é…è¿›ç¨‹ã€‚\nå¸¸è§„è¿›ç¨‹ ä¼ ç»Ÿè¿›ç¨‹æ²¡æœ‰ä¸¥æ ¼çš„å“åº”æ—¶é—´çš„é™åˆ¶ï¼Œå¦‚æœç³»ç»Ÿå¿™ç¢Œï¼Œå“åº”ä¼šå‡ºç°å»¶è¿Ÿã€‚\næ¯”å¦‚æµè§ˆå™¨çš„è¿›ç¨‹ï¼Œå¿™ç¢Œæ—¶åŠ è½½é¡µé¢ä¼šå‡ºç°å»¶è¿Ÿã€‚\næ¯ç§è¿›ç¨‹éƒ½æœ‰ä¸åŒçš„è°ƒåº¦ç®—æ³•ï¼Œåªè¦æœ‰å‡†å¤‡è¿è¡Œçš„å®æ—¶è¿›ç¨‹ï¼Œå®ƒä»¬å°±ä¼šè¿è¡Œå¹¶ä½¿å¸¸è§„è¿›ç¨‹ç­‰å¾…ã€‚\nå®æ—¶è°ƒåº¦ å®æ—¶è°ƒåº¦æœ‰ä¸¤ç§è°ƒåº¦ç­–ç•¥ï¼ŒSCHED_RR å’Œ SCHED_FIFOã€‚\nè¯¥ç­–ç•¥ä¼šå½±å“è¿›ç¨‹å°†è·å¾—å¤šå°‘è¿è¡Œæ—¶é—´ä»¥åŠè¿è¡Œé˜Ÿåˆ—çš„è¿è¡Œæ–¹å¼ã€‚\nå‡†å¤‡è¿è¡Œçš„è¿›ç¨‹å­˜å‚¨åœ¨ä¸€ä¸ªåä¸º runqueue çš„é˜Ÿåˆ—ä¸­ã€‚è°ƒåº¦ç¨‹åºæ­£åœ¨æ ¹æ®ç­–ç•¥ä»è¯¥è¿è¡Œé˜Ÿåˆ—ä¸­é€‰æ‹©è¦è¿è¡Œçš„è¿›ç¨‹ã€‚\nSCHED_FIFO åœ¨æ­¤ç­–ç•¥ä¸­ï¼Œè°ƒåº¦ç¨‹åºå°†æ ¹æ®åˆ°è¾¾æ—¶é—´ï¼ˆFIFO = å…ˆè¿›å…ˆå‡ºï¼‰é€‰æ‹©ä¸€ä¸ªè¿›ç¨‹ã€‚\nå…·æœ‰ SCHED_FIFO è°ƒåº¦ç­–ç•¥çš„è¿›ç¨‹å¯ä»¥åœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸‹â€œæ”¾å¼ƒâ€CPUï¼š\nè¿›ç¨‹æ­£åœ¨ç­‰å¾…ï¼Œä¾‹å¦‚ç­‰å¾… IO æ“ä½œã€‚ å½“è¿›ç¨‹å›åˆ°â€œå°±ç»ªâ€çŠ¶æ€æ—¶ï¼Œå®ƒå°†å›åˆ°è¿è¡Œé˜Ÿåˆ—çš„æœ«å°¾ã€‚ è¿›ç¨‹é€šè¿‡ç³»ç»Ÿè°ƒç”¨ sched_yield è®©å‡º CPUã€‚ è¯¥è¿‡ç¨‹å°†ç«‹å³è¿”å›åˆ°è¿è¡Œé˜Ÿåˆ—çš„æœ«å°¾ã€‚ SCHED_RR RR = Round Robin\nåœ¨æ­¤è°ƒåº¦ç­–ç•¥ä¸­ï¼Œè¿è¡Œé˜Ÿåˆ—ä¸­çš„æ¯ä¸ªè¿›ç¨‹éƒ½è·å¾—ä¸€ä¸ªæ—¶é—´ç‰‡ï¼ˆå•ä½é‡ï¼‰å¹¶ä»¥å¾ªç¯æ–¹å¼è½®æµæ‰§è¡Œï¼ˆåŸºäºä¼˜å…ˆçº§ï¼‰ã€‚ ä¸ºäº†è®©æˆ‘ä»¬å¯¹å¾ªç¯æœ‰æ›´å¥½çš„ç†è§£ï¼Œè®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬çš„è¿è¡Œé˜Ÿåˆ—ä¸­æœ‰ 3 ä¸ªè¿›ç¨‹ A B Cï¼Œå®ƒä»¬éƒ½å…·æœ‰ SCHED_RR çš„ç­–ç•¥ã€‚\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½å¾—åˆ°ä¸€ä¸ªæ—¶é—´ç‰‡å¹¶è½®æµæ‰§è¡Œã€‚å½“æ‰€æœ‰è¿›ç¨‹è¿è¡Œ 1 æ¬¡æ—¶ï¼Œå®ƒä»¬ä¼šé‡å¤ç›¸åŒçš„æ‰§è¡Œé¡ºåºã€‚\nå®æ—¶è°ƒåº¦æ€»ç»“ å®æ—¶è¿›ç¨‹å¯ä»¥åœ¨ä¸¤ç§ä¸åŒçš„ç­–ç•¥ SCHED_FIFO å’Œ SCHED_RR ä¸­å®ç°è°ƒåº¦ã€‚è¯¥ç­–ç•¥ä¼šå½±å“è¿è¡Œé˜Ÿåˆ—çš„å·¥ä½œæ–¹å¼ä»¥åŠæ¯ä¸ªè¿›ç¨‹æ‰§è¡Œçš„æ—¶é—´ã€‚\nå¸¸è§„è°ƒåº¦ CFS â€” Completely Fair Scheduler æ˜¯ Linux 2.6.23 ç‰ˆæœ¬ä»¥æ¥å¸¸è§„è¿›ç¨‹çš„è°ƒåº¦ç®—æ³•ã€‚\nCFS ä¸»è¦å…³æ³¨ä¸€ä¸ªæŒ‡æ ‡â€”â€”å®ƒå¸Œæœ›å°½å¯èƒ½å…¬å¹³ï¼Œè¿™æ„å‘³ç€ä»–è®©æ¯ä¸ªè¿›ç¨‹éƒ½è·å¾— CPU çš„å¹³å‡æ—¶é—´ç‰‡ã€‚\nè¯·æ³¨æ„ï¼Œå…·æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹å¯èƒ½ä»ä¼šè·å¾—æ›´å¤§çš„æ—¶é—´ç‰‡ã€‚ ä¸ºäº†è®©æˆ‘ä»¬äº†è§£ CFS çš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å¿…é¡»ç†Ÿæ‚‰ä¸€ä¸ªæ–°æœ¯è¯­â€”â€”è™šæ‹Ÿè¿è¡Œæ—¶ï¼ˆvruntimeï¼‰ã€‚\nVirtual Runtime è¿›ç¨‹çš„è™šæ‹Ÿè¿è¡Œæ—¶é—´æ˜¯å®é™…æ‰§è¡Œæ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œä¸åŒ…æ‹¬ä»»ä½•å½¢å¼çš„ç­‰å¾…ã€‚\nCFS åŠ›æ±‚å°½å¯èƒ½å…¬å¹³ã€‚ ä¸ºæ­¤ï¼ŒCFS å°†ä»¥å‡†å¤‡è¿è¡Œçš„æœ€çŸ­è™šæ‹Ÿæ—¶é—´å®‰æ’è¿›ç¨‹ã€‚\nCFS ç»´æŠ¤ä¿æŒæœ€å¤§å’Œæœ€å°è™šæ‹Ÿè¿è¡Œæ—¶é—´çš„å˜é‡ï¼ŒåŸå› æˆ‘ä»¬å¾ˆå¿«å°±ä¼šæ˜ç™½ã€‚\nCFS â€” å®Œå…¨å…¬å¹³çš„è°ƒåº¦å™¨ åœ¨è®¨è®ºç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹è¿™ä¸ªç®—æ³•ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆæ•°æ®ç»“æ„ã€‚\nCFS ä½¿ç”¨çº¢é»‘æ ‘ï¼Œå®ƒæ˜¯ä¸€ç§å¹³è¡¡çš„äºŒå‰æœç´¢æ ‘â€”â€”è¿™æ„å‘³ç€æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾åœ¨ O(logN) ä¸­æ‰§è¡Œï¼Œå…¶ä¸­ N æ˜¯è¿›ç¨‹æ•°ã€‚\nè¿™æ£µæ ‘ä¸­çš„å…³é”®æ˜¯è¿›ç¨‹çš„è™šæ‹Ÿè¿è¡Œæ—¶ã€‚\næ–°è¿›ç¨‹æˆ–ä»ç­‰å¾…ä¸­æ¢å¤åˆ°å°±ç»ªçŠ¶æ€çš„è¿›ç¨‹æ’å…¥åˆ°æ ‘ä¸­ï¼Œé”®ä¸º vruntime=min_vruntimeã€‚è¿™å¯¹äºé˜²æ­¢æ ‘ä¸­æ—§è¿›ç¨‹çš„é¥¥é¥¿éå¸¸é‡è¦ã€‚\nç»§ç»­ä»‹ç»ç®—æ³•ï¼Œé¦–å…ˆï¼Œç®—æ³•ä¸ºè‡ªå·±è®¾ç½®äº†ä¸€ä¸ªæ—¶é—´é™åˆ¶ â€”â€” sched_latencyã€‚ åœ¨è¿™ä¸ªæ—¶é—´é™åˆ¶å†…ï¼Œå®ƒå°†å°è¯•æ‰§è¡Œæ‰€æœ‰å‡†å¤‡å¥½çš„è¿›ç¨‹ â€”â€” Nã€‚\nè¿™æ„å‘³ç€æ¯ä¸ªè¿›ç¨‹å°†è·å¾—æ—¶é—´é™åˆ¶é™¤ä»¥è¿›ç¨‹æ•°çš„æ—¶é—´ç‰‡ â€”â€” Qáµ¢ = sched_latency/Nã€‚\nå½“ä¸€ä¸ªè¿›ç¨‹å®Œæˆå…¶æ—¶é—´ç‰‡ (Qáµ¢) æ—¶ï¼Œç®—æ³•ä¼šé€‰æ‹©æ ‘ä¸­è™šæ‹Ÿè¿è¡Œæ—¶é—´æœ€å°‘çš„è¿›ç¨‹æ¥æ‰§è¡Œä¸‹ä¸€ä¸ªã€‚\nè®©æˆ‘ä»¬è§£å†³ä¸€ä¸ªæˆ‘è¿„ä»Šä¸ºæ­¢æè¿°ç®—æ³•çš„æ–¹å¼å¯èƒ½å­˜åœ¨é—®é¢˜çš„æƒ…å†µã€‚\nå‡è®¾ç®—æ³•é€‰æ‹©äº† 48msï¼ˆæ¯«ç§’ï¼‰çš„æ—¶é—´é™åˆ¶ï¼Œæˆ‘ä»¬æœ‰ 6 ä¸ªè¿›ç¨‹â€”â€”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ 8ms çš„æ—¶é—´è½®æµæ‰§è¡Œã€‚\nä½†æ˜¯å½“ç³»ç»Ÿä¸­çš„è¿›ç¨‹è¿‡è½½æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å‡è®¾æ—¶é—´é™åˆ¶ä»ç„¶æ˜¯ 48 æ¯«ç§’ï¼Œä½†ç°åœ¨æˆ‘ä»¬æœ‰ 32 ä¸ªè¿›ç¨‹ï¼Œç°åœ¨æ¯ä¸ªè¿›ç¨‹æœ‰ 1.5 æ¯«ç§’çš„æ‰§è¡Œæ—¶é—´â€”â€”è¿™å°†å¯¼è‡´æˆ‘ä»¬çš„ç³»ç»Ÿä¸¥é‡å‡é€Ÿã€‚\nWhy? Whatâ€™s the difference? ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ ä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯ä¸€ä¸ªå­˜å‚¨è¿›ç¨‹æˆ–çº¿ç¨‹çŠ¶æ€çš„è¿‡ç¨‹ï¼Œä»¥ä¾¿å®ƒå¯ä»¥åœ¨ä»¥åæ¢å¤å¹¶æ¢å¤æ‰§è¡Œã€‚\næ¯æ¬¡è¿›ç¨‹å®Œæˆå…¶æ‰§è¡Œæ—¶é—´å¹¶å®‰æ’æ–°è¿›ç¨‹æ—¶ï¼Œéƒ½ä¼šå‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¿™ä¹Ÿéœ€è¦æ—¶é—´ã€‚\nå‡è®¾ä¸Šä¸‹æ–‡åˆ‡æ¢èŠ±è´¹äº†æˆ‘ä»¬ 1 æ¯«ç§’ï¼Œåœ¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰ 6 æ¯«ç§’ï¼Œæˆ‘ä»¬å¯ä»¥å…è®¸è¿™æ ·åšï¼Œæˆ‘ä»¬åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢ä¸Šæµªè´¹äº† 1 æ¯«ç§’ï¼Œåœ¨å®é™…æ‰§è¡Œè¿›ç¨‹ä¸Šæµªè´¹äº† 5 æ¯«ç§’ã€‚ä½†æ˜¯åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªæœ‰ 0.5ms æ¥æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹â€”â€”æˆ‘ä»¬æµªè´¹äº†å¤§éƒ¨åˆ†æ—¶é—´ç‰‡æ¥è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¿™å°±æ˜¯å®ƒæ ¹æœ¬æ— æ³•å·¥ä½œçš„åŸå› ã€‚\nä¸ºäº†å…‹æœè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªæ–°å˜é‡ï¼Œå®ƒå°†ç¡®å®šå…è®¸çš„æ—¶é—´ç‰‡æœ‰å¤šå°â€”â€”min_granularityã€‚\nå‡è®¾ min_granularity=6ms å¹¶å›åˆ°æˆ‘ä»¬çš„ç¤ºä¾‹ã€‚ æˆ‘ä»¬çš„æ—¶é—´é™åˆ¶æ˜¯ 48ï¼Œæˆ‘ä»¬æœ‰ 32 ä¸ªè¿›ç¨‹ã€‚ æ ¹æ®æˆ‘ä»¬ä¹‹å‰çš„è®¡ç®—ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½ä¼šå¾—åˆ° 1.5msï¼Œä½†ç°åœ¨æ ¹æœ¬ä¸å…è®¸ï¼Œå› ä¸º min_granularity æŒ‡å®šäº†æ¯ä¸ªè¿›ç¨‹åº”è¯¥å¾—åˆ°çš„æœ€å°æ—¶é—´ç‰‡ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ Qáµ¢ \u0026lt; min_granularity æˆ‘ä»¬å°† min_granularity ä½œä¸ºæˆ‘ä»¬çš„ Qáµ¢ å¹¶æ ¹æ®å®ƒæ›´æ”¹æ—¶é—´é™åˆ¶ã€‚\nåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼ŒQáµ¢ å°†ç­‰äº 6msï¼Œå› ä¸º 1.5ms \u0026lt; 6msï¼Œè¿™æ„å‘³ç€æ–°çš„æ—¶é—´é™åˆ¶å°†æ˜¯ Qáµ¢ â‹… N = 6ms â‹… 32 = 192msã€‚\ndiff between cfs and rr åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œå¯èƒ½ä¸æ¸…æ¥š CFS å’Œ RR ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Œå› ä¸ºå®ƒä»¬éƒ½å®šä¹‰äº†ä¸€äº›æ—¶é—´ç‰‡å¹¶ä½¿è¿›ç¨‹ä»¥æŸç§é¡ºåºæ‰§è¡Œã€‚\nä¸ºäº†æ€»ç»“å’Œæ›´å¥½åœ°ç†è§£è¿™äº›ç®—æ³•ä¹‹é—´çš„å·®å¼‚ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç®€çŸ­çš„è¡¨æ ¼ Ref Process Scheduling In Linux\n","date":"2022-04-11T00:00:00Z","permalink":"https://MyLoveES.github.io/p/process-scheduling-in-linux/","title":"Process Scheduling In Linux"},{"content":"å…¼äºŒè€…ä¹‹é•¿\nSeda èƒŒæ™¯ SEDAä¸»è¦æ±‡èšäº†ä¸¤ç±»æ¨¡å‹ï¼šä½¿ç”¨åŸºäºçº¿ç¨‹çš„å¹¶å‘æ¨¡å‹æ¥ç®€åŒ–ç¼–ç¨‹ï¼Œä½¿ç”¨åŸºäºäº‹ä»¶çš„æ¨¡å‹æ¥å®ç°å¹¿æ³›çš„å¹¶å‘ã€‚\nç›´è§‚åœ°è¯´ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡çš„è¡Œä¸ºåƒä¸€ä¸ªç®€å•çš„ç®¡é“ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯goodçš„ã€‚ç®¡é“çš„æ‰¿è½½é‡æ˜¯ç”±ç½‘ç»œçš„è·¯å¾„å’ŒæœåŠ¡è‡ªèº«çš„å¤„ç†é˜¶æ®µå†³å®šçš„ã€‚éšç€æä¾›è´Ÿè½½çš„å¢åŠ ï¼Œäº¤ä»˜çš„ååé‡æŒ‰æ¯”ä¾‹å¢åŠ ï¼Œç›´åˆ°ç®¡é“æ»¡ï¼Œååé‡é¥±å’Œ;é™„åŠ è´Ÿè½½ä¸åº”è¯¥é™ä½ååé‡ã€‚åŒæ ·ï¼Œåœ¨è½»è´Ÿè·ä¸‹ï¼ŒæœåŠ¡çš„å“åº”æ—¶é—´å¤§è‡´æ˜¯æ’å®šçš„ï¼Œå› ä¸ºå®ƒå—ç®¡é“æ·±åº¦çš„å½±å“ã€‚å½“è´Ÿè½½æ¥è¿‘é¥±å’Œæ—¶ï¼Œæ’é˜Ÿå»¶è¿Ÿå ä¸»å¯¼åœ°ä½ã€‚åœ¨è®¸å¤šæœåŠ¡çš„å…¸å‹çš„é—­ç¯åœºæ™¯ä¸­ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯åœ¨äº¤ä»˜ä¸‹ä¸€ä¸ªè¯·æ±‚ä¹‹å‰ç­‰å¾…ä¸€ä¸ªå“åº”ï¼Œå“åº”æ—¶é—´åº”è¯¥éšå®¢æˆ·ç«¯æ•°é‡çº¿æ€§å¢åŠ ã€‚\nä¸€ä¸ªgoodçš„æœåŠ¡çš„å…³é”®ç‰¹æ€§æ˜¯å¹³ç¨³çš„é™çº§:å½“æä¾›çš„è´Ÿè½½è¶…è¿‡å®¹é‡æ—¶ï¼ŒæœåŠ¡ä¿æŒé«˜ååé‡ï¼Œå¹¶ä»¥çº¿æ€§çš„å“åº”æ—¶é—´æƒ©ç½šå½±å“æ‰€æœ‰çš„å®¢æˆ·ç«¯ï¼Œæˆ–è€…è‡³å°‘æ ¹æ®æŸäº›ç‰¹å®šç­–ç•¥è¿›è¡Œé¢„æµ‹ã€‚è¯·æ³¨æ„ï¼Œå…¸å‹çš„Webä½“éªŒå´æ˜¯ç›¸åçš„ï¼Œéšç€è´Ÿè½½çš„å¢åŠ ï¼Œååé‡ä¸‹é™ï¼Œå“åº”æ—¶é—´æ€¥å‰§å¢åŠ ï¼Œé€ æˆæœåŠ¡å´©æºƒçš„å°è±¡ã€‚\nThread-based ç‰¹ç‚¹æ˜¯ç¼–ç¨‹å®¹æ˜“ï¼Œæ¯ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹å½¼æ­¤ç‹¬ç«‹å¤„ç†ã€‚ä½†æ˜¯å’Œçº¿ç¨‹ç›¸å…³çš„å¼€é”€åœ¨çº¿ç¨‹æ•°é‡å¾ˆå¤§çš„æ—¶å€™å¯èƒ½ä¼šé€ æˆæ€§èƒ½çš„ä¸¥é‡ä¸‹é™ï¼Œä¾‹å¦‚ç¼“å­˜æˆ–è€…TLBçš„æœªå‘½ä¸­ã€è°ƒåº¦å¼€é”€æˆ–è€…é”çš„ç«äº‰ã€‚è€Œä¸”ï¼Œç°åœ¨çš„æ“ä½œç³»ç»Ÿï¼ˆæˆ–è€…è¿™é‡Œå¯ä»¥æŒ‡ä»£ä¸ºç¼–ç¨‹è¯­è¨€ï¼‰åœ¨åŠªåŠ›ä»¥ä¸€ç§å¯¹åº”ç”¨ç¨‹åºé€æ˜çš„æ–¹å¼ï¼Œè™šæ‹ŸåŒ–ç¡¬ä»¶èµ„æºã€‚åœ¨è¿™ç§èƒŒæ™¯ä¸‹ï¼Œåº”ç”¨ç¨‹åºå¾ˆå°‘æœ‰æœºä¼šèƒ½å¤Ÿå‚ä¸ç³»ç»ŸèŒƒå›´å†…çš„èµ„æºç®¡ç†ã€å†³ç­–ï¼Œæˆ–è€…äº†è§£åˆ°å½“å‰ç³»ç»Ÿçš„èµ„æºå¯ç”¨æƒ…å†µï¼Œæ¥é€‚åº”ã€è°ƒæ•´è‡ªå·±çš„è°ƒåº¦åˆ†é…ã€‚æ“ä½œç³»ç»Ÿèµ„æºçš„è™šæ‹ŸåŒ–ï¼Œå®é™…ä¸Šæ˜¯éšè—äº†èµ„æºæœ‰é™å’Œèµ„æºå…±äº«çš„äº‹å®ã€‚\nBounded thread pools(Without a Queue) åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰ä¸€ç§è§£å†³æ–¹æ¡ˆ - æœ‰é™çš„çº¿ç¨‹æ± å¤§å°ã€‚åœ¨è¶…å‡ºå›ºå®šé™åˆ¶çš„æ—¶å€™ï¼Œæ–°é“¾æ¥ä¸ä¼šè¢«æ¥å—ã€‚é€šè¿‡é™åˆ¶æœ€å¤§å¹¶å‘é‡çš„æ–¹å¼ï¼Œæ¥ä¿è¯ç³»ç»Ÿç»´æŒåœ¨é«˜æ€§èƒ½çš„çŠ¶æ€ä¸‹ã€‚ä½†æ˜¯è¿™ç§æƒ…å†µä¼šé€ æˆå®¢æˆ·ç«¯ç­‰å¾…æ—¶é—´ä»»æ„é•¿ï¼ˆä¸å¯æ§ã€‚ç†æƒ³æƒ…å†µä¸‹æ˜¯ç­‰å¾…æ—¶é—´æˆçº¿æ€§å¢é•¿ï¼‰ã€‚\nåŒæ—¶ï¼Œè¿™ç§æƒ…å†µä¸‹å¾ˆéš¾è¯†åˆ«ä¸€ä¸ªæµä¸­çš„ç“¶é¢ˆåœ¨å“ªé‡Œï¼Œå› ä¸ºä»å®è§‚å±‚é¢ä¸Šåªèƒ½çœ‹åˆ°â€œæ± â€è¢«ç”¨å®Œäº†ã€‚å› æ­¤ï¼Œéœ€è¦å¯¹äºèµ„æºçš„çºµå‘åˆ‡åˆ†ã€‚\nEvent-driven çº¿ç¨‹é©±åŠ¨çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä»…ç”±å°‘é‡çº¿ç¨‹æ„æˆï¼Œçº¿ç¨‹ä»¬å¾ªç¯å¤„ç†é˜Ÿåˆ—ä¸­çš„äº‹ä»¶ã€‚äº‹ä»¶é©±åŠ¨å°†é•¿é“¾è·¯çš„ä»»åŠ¡å¤„ç†ï¼Œè½¬æ¢æˆFSMï¼ŒçŠ¶æ€è½¬æ¢é€šè¿‡äº‹ä»¶è§¦å‘ï¼Œä¸å†ä¾èµ–äºçº¿ç¨‹ä¸Šä¸‹æ–‡ã€‚\näº‹ä»¶é©±åŠ¨åœ¨è´Ÿè½½æ–¹é¢å¥å£®ï¼Œå½“è´Ÿè½½é€æ¸é€¼è¿‘å¹¶è¶…è¿‡æœ€å¤§è´Ÿè½½é‡çš„æ—¶å€™ï¼Œååé‡å‡ ä¹ä¸ä¼šä¸‹é™ï¼Œå¹¶ä¸”åç»­è¯·æ±‚ä¼šå †ç§¯åœ¨é˜Ÿåˆ—ä¸­ï¼Œå»¶è¿Ÿçº¿æ€§å¢åŠ ã€‚\nä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåº”å°½é‡é¿å…äº‹ä»¶å¤„ç†è¿‡ç¨‹çš„é˜»å¡å‘ç”Ÿï¼ˆå…¶å®åœ¨å•çº¿ç¨‹æƒ…å†µä¸‹äº¦å¦‚æ­¤ï¼‰\nStructured event queues(common now) é’ˆå¯¹äº‹ä»¶é©±åŠ¨ï¼Œäººä»¬æå‡ºæ”¹è¿›æ–¹æ¡ˆï¼ˆæ„Ÿè§‰å¯ä»¥ç†è§£ä¸ºå»ä¸­å¿ƒåŒ–ï¼‰ã€‚ä½¿ç”¨ä¸€ç»„äº‹ä»¶é˜Ÿåˆ—ä»¥å®Œæˆæ¨¡å—åŒ–ï¼Œç®€åŒ–è®¾è®¡ã€‚ ä¾‹å¦‚ï¼šè§£è€¦ä¸¤ä¸ªç»„ä»¶çš„æ‰§è¡Œï¼Œä»è€Œæé«˜äº†æ¨¡å—åŒ–å’Œé²æ£’æ€§ã€‚èšåˆå¤šä¸ªç±»ä¼¼äº‹ä»¶çš„æ‰§è¡Œï¼Œå¢å¼ºå±€éƒ¨æ€§ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚\nThe Staged Event-Driven Architecture: é«˜å¹¶å‘ \u0026amp; è´Ÿè½½è°ƒèŠ‚ ç›®æ ‡ é˜²æ­¢è¿‡è½½é€ æˆçš„æ€§èƒ½ä¸‹é™ äº‹ä»¶é©±åŠ¨ï¼Œçµæ´»æ‰©å±• æ¨¡å—åŒ– èµ„æºè°ƒåº¦æ§åˆ¶å™¨ é˜Ÿåˆ—åˆ†æï¼ˆæ ¹æ®ä¼˜å…ˆçº§ã€è´Ÿè½½æ’åºï¼‰ Stages as robust building blocks Stage: self-contained\nEvent Handler: äº‹ä»¶å¤„ç†ç¨‹åº/é€»è¾‘\nEvent Queue: äº‹ä»¶é˜Ÿåˆ—\nThread pool: çº¿ç¨‹æ± \nController: æ§åˆ¶è°ƒåº¦å’Œèµ„æºåˆ†é…\nå–å‡ºä¸€æ‰¹äº‹ä»¶ -\u0026gt; å¤„ç† -\u0026gt; æ”¾å…¥ä¸‹ä¸€é˜¶æ®µçš„é˜Ÿåˆ—ã€‚å…¶ä¸­ï¼Œå–å‡ºçš„æ‰¹é‡å¤§å°å’Œå¤„ç†çš„çº¿ç¨‹æ± å¤§å°é€šè¿‡controllerè¿›è¡Œæ§åˆ¶ã€‚\né˜¶æ®µçº¿ç¨‹çš„æ“ä½œæ–¹å¼æ˜¯å°†ä¸€æ‰¹äº‹ä»¶ä»ä¼ å…¥çš„äº‹ä»¶é˜Ÿåˆ—ä¸­å–å‡ºï¼Œå¹¶è°ƒç”¨åº”ç”¨ç¨‹åºæä¾›çš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚äº‹ä»¶å¤„ç†ç¨‹åºå¤„ç†æ¯ä¸€æ‰¹äº‹ä»¶ï¼Œå¹¶é€šè¿‡å°†å®ƒä»¬æ’é˜Ÿåˆ°å…¶ä»–é˜¶æ®µçš„äº‹ä»¶é˜Ÿåˆ—ä¸­æ¥è°ƒåº¦é›¶ä¸ªæˆ–å¤šä¸ªäº‹ä»¶ã€‚\nçº¿ç¨‹æ˜¯SEDAä¸­çš„åŸºæœ¬å¹¶å‘æœºåˆ¶ï¼Œä½†æ˜¯å®ƒä»¬çš„ä½¿ç”¨è¢«é™åˆ¶åœ¨æ¯ä¸ªé˜¶æ®µçš„å°‘é‡çº¿ç¨‹ï¼Œè€Œä¸æ˜¯ç³»ç»Ÿä¸­çš„æ¯ä¸ªä»»åŠ¡ä¸€ä¸ªçº¿ç¨‹ã€‚æ­¤å¤–ï¼Œä½¿ç”¨åŠ¨æ€æ§åˆ¶å¯ä»¥æ ¹æ®éœ€è¦è‡ªåŠ¨è°ƒæ•´åˆ†é…ç»™æ¯ä¸ªé˜¶æ®µçš„çº¿ç¨‹æ•°é‡ã€‚æ ¹æ®çº¿ç¨‹ç³»ç»Ÿå’Œè°ƒåº¦å™¨çš„ç‰¹ç‚¹ï¼Œè¿™ç§è®¾è®¡å…è®¸é˜¶æ®µæŒ‰é¡ºåºæˆ–å¹¶è¡Œè¿è¡Œï¼Œæˆ–ä¸¤è€…çš„ç»“åˆã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å‡è®¾SMPç¯å¢ƒä¸­æœ‰ä¼˜å…ˆçš„ã€osæ”¯æŒçš„çº¿ç¨‹ï¼Œå°½ç®¡è¿™ç§é€‰æ‹©ä¸æ˜¯SEDAè®¾è®¡çš„åŸºç¡€ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥è®¾è®¡ä¸€ä¸ªçº¿ç¨‹ç³»ç»Ÿï¼Œå®ƒå¯ä»¥è¯†åˆ«åº”ç”¨ç¨‹åºçš„é˜¶æ®µç»“æ„ï¼Œå¹¶ç›¸åº”åœ°è°ƒåº¦çº¿ç¨‹ã€‚\næ¯ä¸ªé˜¶æ®µçš„æ ¸å¿ƒé€»è¾‘éƒ½ç”±äº‹ä»¶å¤„ç†ç¨‹åºæä¾›ï¼Œäº‹ä»¶å¤„ç†ç¨‹åºçš„è¾“å…¥æ˜¯ä¸€æ‰¹å¤šä¸ªäº‹ä»¶ã€‚äº‹ä»¶å¤„ç†ç¨‹åºä¸èƒ½ç›´æ¥æ§åˆ¶é˜Ÿåˆ—æ“ä½œæˆ–çº¿ç¨‹ã€‚é€šè¿‡å°†æ ¸å¿ƒåº”ç”¨ç¨‹åºé€»è¾‘ä¸çº¿ç¨‹ç®¡ç†å’Œè°ƒåº¦åˆ†ç¦»ï¼Œé˜¶æ®µèƒ½å¤Ÿæ§åˆ¶äº‹ä»¶å¤„ç†ç¨‹åºçš„æ‰§è¡Œï¼Œä»¥å®ç°å„ç§èµ„æºç®¡ç†ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œä¼ é€’ç»™äº‹ä»¶å¤„ç†ç¨‹åºçš„äº‹ä»¶çš„æ•°é‡å’Œé¡ºåºå¯ä»¥ç”±è¿è¡Œæ—¶ç¯å¢ƒåœ¨å¤–éƒ¨æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œåº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥é€šè¿‡è¿‡æ»¤æˆ–é‡æ–°æ’åºä¼ é€’ç»™å®ƒçš„äº‹ä»¶æ‰¹å¤„ç†æ¥å®ç°è‡ªå·±çš„è°ƒåº¦ç­–ç•¥ã€‚\nDetails é˜Ÿåˆ—æ»¡äº†æ€ä¹ˆåŠ èƒŒå‹\næŠ¥é”™\né™çº§\nä¸¤ä¸ªstageä¹‹é—´åº”è¯¥é€šè¿‡é˜Ÿåˆ—é€šä¿¡ï¼Œè¿˜æ˜¯ç›´æ¥ä½¿ç”¨å­ç¨‹åºè°ƒç”¨ é€šè¿‡é˜Ÿåˆ—çš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥æä¾›ä¸¤ä¸ªstageä¹‹é—´çš„éš”ç¦»ï¼Œæ¨¡å—åŒ–å’Œè´Ÿè½½ç®¡ç†ã€‚ä»£ä»·æ˜¯å¢åŠ å»¶è¿Ÿã€‚\nDynamic resource controllers ç›®çš„ï¼šæ§åˆ¶å™¨æ ¹æ®è§‚å¯Ÿåˆ°çš„ï¼Œæ¯ä¸ªStageçš„æ€§èƒ½å’Œéœ€æ±‚è‡ªåŠ¨è°ƒæ•´Stageçš„èµ„æºä½¿ç”¨æƒ…å†µã€‚æ§åˆ¶å™¨è§‚å¯Ÿé˜¶æ®µçš„è¿è¡Œä»–æ­£ï¼Œè°ƒæ•´åˆ†é…å’Œè°ƒåº¦å‚æ•°ä»¥æ»¡è¶³æ€§èƒ½ç›®æ ‡ã€‚æ§åˆ¶å™¨æ—¢å¯ä»¥äº†è§£æŸä¸ªç‰¹å®šé˜¶æ®µçš„å±€éƒ¨æƒ…å†µï¼Œä¹Ÿå¯ä»¥åŸºäºå…¨å±€çŠ¶æ€ååŒå·¥ä½œã€‚ æ–‡ç« æä¾›äº†å‡ ç§æ§åˆ¶å™¨çš„å®ç°å½¢å¼\nçº¿ç¨‹æ± æ•°é‡æ§åˆ¶å™¨ã€‚ä¿è¯æœ‰è¶³å¤Ÿçš„çº¿ç¨‹å¤„ç†Stageï¼Œé˜²æ­¢è¿‡å¤šæˆ–è€…è¿‡å°‘åˆ†é…ã€‚å‘¨æœŸæ€§é‡‡æ ·è¾“å…¥é˜Ÿåˆ—ï¼Œå½“é˜Ÿåˆ—é•¿åº¦è¶…è¿‡æŸä¸ªé˜ˆå€¼çš„æ—¶å€™æ·»åŠ çº¿ç¨‹ï¼›å½“çº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡é˜ˆå€¼çš„æ—¶å€™ï¼Œå»æ‰çº¿ç¨‹ã€‚ æ‰¹å¤„ç†æ§åˆ¶å™¨ï¼Œå®ƒè°ƒæ•´æ¯ä¸ªé˜¶æ®µ(æ‰¹å¤„ç†å› å­)ä¸­äº‹ä»¶å¤„ç†ç¨‹åºçš„æ¯æ¬¡è°ƒç”¨æ‰€å¤„ç†çš„äº‹ä»¶æ•°é‡ã€‚æ¯”å¦‚ï¼Œå¦‚æœæŸäº›ä»»åŠ¡å¯ä»¥è¿›è¡Œç»„åˆã€èšåˆçš„æƒ…å†µä¸‹ï¼Œå¤§æ‰¹é‡çš„äº‹ä»¶è¯»å…¥å¯ä»¥æé«˜å¤„ç†æ•ˆç‡ã€‚ä¸è¿‡è¿™ä¸ªå°±éœ€è¦æ ¹æ®å®é™…æƒ…å†µçœ‹äº†ï¼Œè§ä»è§æ™ºã€‚æ§åˆ¶å™¨å°è¯•å¯»æ‰¾é«˜ååçš„æ‰¹é‡å› å­ã€‚å®ƒå¯ä»¥è§‚å¯Ÿstageçš„è¾“å‡ºé€Ÿç‡ï¼Œé€æ­¥å‡å°‘æ‰¹é‡å› å­ï¼Œç›´åˆ°é€Ÿç‡å‡ºç°ä¸‹é™ï¼ˆç„¶åç¨å¾®å¢å¤šï¼‰ã€‚åœ¨è¾“å‡ºé€Ÿåº¦çªç„¶ä¸‹é™æ—¶ï¼Œå¯ä»¥å°†batch sizeæå‡åˆ°æœ€å¤§å€¼ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œæ§åˆ¶å™¨è¿˜å¯ä»¥æ ¹æ®ä¼˜å…ˆçº§è°ƒæ•´çº¿ç¨‹æ± å¤§å°ï¼Œæˆ–è€…ç»™ä¸€ä¸ªå…¨å±€é˜ˆå€¼ã€‚è¿˜å¯ä»¥æ ¹æ®Stageçš„è¿›åº¦è°ƒæ•´ã€‚\nCompare with Procedure-oriented Procedure-oriented ä¼˜ç‚¹ï¼š\næ¶æ„ç®€å•æ˜äº†ï¼Œæ˜“äºå®ç° å„ç¯èŠ‚åœ¨åœ¨åŒä¸€çº¿ç¨‹/è¿›ç¨‹å†…å®Œæˆï¼Œæ˜“äºè¿½è¸ª å®æ—¶æ€§å¼ºï¼Œä»»åŠ¡ä»ä¸€è€Œç»ˆ ç¼ºç‚¹ï¼š\nç»„ä»¶ç»“è€¦ä¸å¥½ï¼Œè¾¹ç•Œä¸æ¸…æ™° ç”±äºèµ„æºç«äº‰ã€é”ç­‰å¾…ç­‰åŸå› ï¼Œä¼šå‘ç”Ÿæ€§èƒ½ä¸‹é™ Seda ä¼˜ç‚¹(å…¶å®ä¹Ÿæ˜¯äº‹ä»¶é©±åŠ¨çš„ä¼˜ç‚¹)ï¼š\nè§£è€¦ï¼šStageä¹‹é—´é€šè¿‡äº‹ä»¶é€šä¿¡ å¼‚æ­¥ï¼šå„ä¸ªç¯èŠ‚é€šè¿‡äº‹ä»¶å…³è”ï¼Œæ‰€ä»¥æœåŠ¡é—´ä¸ä¼šblockã€‚å¸¦æ¥æ‰§è¡Œçš„å¯è°ƒåº¦æ€§ï¼Œèµ„æºåˆ†é…çš„åŠ¨æ€æ€§ çµæ´»ï¼šå¯¹Stageæ–½åŠ è‡ªå®šä¹‰æ“ä½œï¼ˆå¦‚ç›‘æ§ã€æ—¥å¿—ã€é™æµã€é™çº§ã€ç†”æ–­ç­‰ï¼‰ç›¸å½“å®¹æ˜“ ç‹¬ç«‹ï¼šæœåŠ¡é—´çš„ååä¹Ÿè¢«æ‹†è§£äº†ï¼Œå„ä¸ªæœåŠ¡å¯ä»¥ä¸“æ³¨äºè‡ªå·±çš„å®ç°ï¼ŒæŒ‰ç…§è‡ªå·±çš„å¤„ç†é€Ÿåº¦å¤„ç† ç¼“å†²ï¼šä¿æŒåå ç¼ºç‚¹ï¼š\nå¯¹äºä¸€ä¸ªä»»åŠ¡ï¼Œå¯èƒ½ä¼šå¢åŠ å»¶æ—¶ï¼ˆå‡ºå…¥é˜Ÿåˆ—ï¼‰ å¼€å‘ä¸ä¾¿ ","date":"2022-03-23T19:00:00Z","permalink":"https://MyLoveES.github.io/p/seda-the-staged-event-driven-architecture/","title":"Seda - The Staged Event-Driven Architecture"},{"content":"Why Events Are A Bad Idea è®ºç‚¹ï¼šçº¿ç¨‹å¯ä»¥å®ç°äº‹ä»¶çš„æ‰€æœ‰ä¼˜ç‚¹ï¼ŒåŒ…æ‹¬æ”¯æŒé«˜å¹¶å‘æ€§ã€ä½å¼€é”€å’Œç®€å•çš„å¹¶å‘æ¨¡å‹ã€‚æ­¤å¤–ï¼Œçº¿ç¨‹å…è®¸æ›´ç®€å•å’Œæ›´è‡ªç„¶çš„ç¼–ç¨‹é£æ ¼ã€‚ åŸæ–‡ Specifically, we believe that threads can achieve all of the strengths of events, including support for high concurrency, low overhead, and a simple concurrency model. Moreover, we argue that threads allow a simpler and more natural programming style.\nè¿‡å»çš„ä¸€æ®µæ—¶é—´ï¼ˆè®ºæ–‡å‘è¡¨å‰ï¼‰ï¼Œäººä»¬è®¤ä¸ºEvent-orientedæ˜¯é«˜å¹¶å‘ç¨‹åºä¸­å®ç°é«˜æ€§èƒ½çš„æœ€ä½³æ–¹æ³•ã€‚ ä¸»è¦åŸå› æœ‰ï¼š\nç”±äºåä½œå¤šä»»åŠ¡å¤„ç†ï¼ŒåŒæ­¥çš„æˆæœ¬å¾ˆä½; ç®¡ç†çŠ¶æ€çš„å¼€é”€æ›´ä½(æ²¡æœ‰æ ˆ); åŸºäºåº”ç”¨çº§çš„ä¿¡æ¯ï¼Œæ›´å¥½çš„è°ƒåº¦å’Œå±€éƒ¨æ€§; æ›´çµæ´»çš„æ§åˆ¶æµ(ä¸ä»…ä»…æ˜¯è°ƒç”¨/è¿”å›); ä½†æ˜¯ä½œè€…è®¤ä¸ºï¼š\nçº¿ç¨‹ä¸ºé«˜å¹¶å‘æœåŠ¡å™¨æä¾›äº†ä¸€ä¸ªæ›´è‡ªç„¶çš„æŠ½è±¡; å¯¹ç¼–è¯‘å™¨å’Œçº¿ç¨‹è¿è¡Œæ—¶ç³»ç»Ÿçš„å°æ”¹è¿›å¯ä»¥æ¶ˆé™¤ä½¿ç”¨äº‹ä»¶çš„å†å²åŸå› ; çº¿ç¨‹æ›´æ˜“äºæ¥å—åŸºäºç¼–è¯‘å™¨çš„å¢å¼º; åŸæ–‡ 1 2 3 4 5 6 7 â€¢ Inexpensive synchronization due to cooperative multitasking; â€¢ Lower overhead for managing state (no stacks); â€¢ Better scheduling and locality, based on application-level information; and â€¢ More flexible control flow (not just call/return). We believe that (1) threads provide a more natural abstraction for high-concurrency servers, and that (2) small improvements to compilers and thread runtime systems can eliminate the historical reasons to use events. Additionally, threads are more amenable to compiler-based enhancements; we believe the right paradigm for highly concurrent applications is a thread package with better compiler support. Duality Revisited event handlers monitors events accepted by a handler functions exported by a module SendMessage / AwaitReply procedure call, or fork/join SendReply return from procedure waiting for messages waiting on condition variables First, Lauer and Needham ignore the cooperative scheduling used by events for synchronization. Second, most event systems use shared memory and global data structures, which are described as atypical for Lauer and Needhamâ€™s message- passing systems. â€œProblemsâ€ with Threads Performance Criticism: è®¸å¤šå°è¯•ä½¿ç”¨çº¿ç¨‹å®ç°çš„é«˜å¹¶å‘æ¨¡å‹å¹¶ä¸æ˜¯å¾ˆæ£’\nå¼€é”€çš„ä¸»è¦æ¥æºæ˜¯ï¼Œå­˜åœ¨å’Œçº¿ç¨‹æ•°ç›¸å…³çš„O(n)çš„æ“ä½œçš„å­˜åœ¨ï¼›å¹¶ä¸”ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å¤§ï¼ˆç”±äºéœ€è¦ä¿å­˜å¯„å­˜å™¨å’Œå…¶ä»–çŠ¶æ€ï¼Œä»¥åŠkernel crossingsï¼‰ã€‚ä½†è¿™äº›æ˜¯çº¿ç¨‹å·¥å…·åŒ…å®ç°çš„é—®é¢˜ï¼Œè€Œéçº¿ç¨‹è‡ªèº«çš„é—®é¢˜ã€‚ // TODO: ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¹¶ä¸”ä¸ºä»€ä¹ˆå¼€é”€å¤§\nControl flow Criticism: çº¿ç¨‹æ˜¯æœ‰é™åˆ¶æ€§çš„æ§åˆ¶æµã€‚å®ƒé¼“åŠ±ç¨‹åºå‘˜å¯¹æ§åˆ¶æµè¿›è¡Œè¿‡äºçº¿æ€§çš„æ€è€ƒï¼Œå¯èƒ½ä¼šæ’é™¤ä½¿ç”¨æ›´æœ‰æ•ˆçš„æ§åˆ¶æµæ¨¡å¼ã€‚\nå¤æ‚çš„æ§åˆ¶æµæ¨¡å¼åœ¨å®è·µä¸­æ˜¯å¾ˆå°‘è§çš„ï¼Œå¹¶ä¸”åœ¨ä¸åŒç±»å‹çš„ç³»ç»Ÿä¸­éƒ½éœ€è¦å¾—åˆ°å¤„ç†ã€‚\nSynchronization Criticism: çº¿ç¨‹åŒæ­¥æœºåˆ¶å¾ˆé‡ // TODO: ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥ï¼Ÿæˆ‘çš„ç†è§£åº”è¯¥æ˜¯è¯´ï¼ŒåŠ é”ä¿è¯åŒæ­¥\näº‹ä»¶ç³»ç»Ÿè®¤ä¸ºåˆä½œå¤šä»»åŠ¡æ¨¡å¼\u0026quot;å…è´¹\u0026quot;åœ°ä¸ºå®ƒä»¬æä¾›äº†åŒæ­¥æœºåˆ¶ï¼Œè¿è¡Œæ—¶ç³»ç»Ÿæ— éœ€å¤„ç†äº’æ–¥ã€ç­‰å¾…é˜Ÿåˆ—ç­‰ç­‰ã€‚ä½†æ˜¯ä»…ä»…æ˜¯åœ¨å•å¤„ç†å™¨ä¸Šå®ç°ï¼Œè€Œç°åœ¨å¤§å¤šæ˜¯å¤šå¤„ç†å™¨ã€‚\nState Management Criticism: çº¿ç¨‹å †æ ˆä¸æ˜¯ç®¡ç†å®æ—¶çŠ¶æ€çš„ä¸€ç§æœ‰æ•ˆæ–¹å¼ã€‚çº¿ç¨‹ç³»ç»Ÿé€šå¸¸é¢ä¸´ç€å †æ ˆæº¢å‡ºçš„é£é™©å’Œåœ¨å¤§å †æ ˆä¸Šæµªè´¹è™šæ‹Ÿåœ°å€ç©ºé—´ä¹‹é—´çš„æƒè¡¡\nä½œè€…æ‰‹åŠ¨è§£å†³\nScheduling Criticism: çº¿ç¨‹æä¾›çš„è™šæ‹Ÿå¤„ç†å™¨æ¨¡å‹ä½¿è¿è¡Œæ—¶ç³»ç»Ÿè¿‡äºæ³›åŒ–ï¼Œä½¿å…¶æ— æ³•åšå‡ºæœ€ä½³è°ƒåº¦å†³ç­– // TODO: å•¥æ„æ€ï¼Ÿ\näº‹ä»¶ç³»ç»Ÿèƒ½å¤Ÿåœ¨åº”ç”¨å±‚é¢ä¸Šè°ƒåº¦äº‹ä»¶çš„äº¤ä»˜ã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æ‰§è¡Œæœ€çŸ­çš„å‰©ä½™å®Œæˆæ—¶é—´è°ƒåº¦ï¼Œæœ‰åˆ©äºæŸäº›è¯·æ±‚æµï¼Œæˆ–æ‰§è¡Œå…¶ä»–ä¼˜åŒ–ã€‚ä¹Ÿæœ‰ä¸€äº›è¯æ®è¡¨æ˜ï¼Œé€šè¿‡è¿ç»­è¿è¡Œå‡ ä¸ªç›¸åŒç±»å‹çš„äº‹ä»¶ï¼Œäº‹ä»¶å…è®¸æ›´å¥½çš„ä»£ç å®šä½[9]ã€‚ç„¶è€Œï¼ŒLauer-NeedhamäºŒå…ƒæ€§è¡¨æ˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†åŒæ ·çš„è°ƒåº¦æŠ€å·§åº”ç”¨äºåˆä½œè°ƒåº¦çš„çº¿ç¨‹ã€‚\nConclusion ä¸Šè¿°è®ºç‚¹è¡¨æ˜ï¼Œåœ¨é«˜å¹¶å‘æ€§æ–¹é¢ï¼Œçº¿ç¨‹çš„æ€§èƒ½è‡³å°‘ä¸äº‹ä»¶ä¸€æ ·å¥½ï¼Œè€Œä¸”äº‹ä»¶åœ¨è´¨é‡ä¸Šæ²¡æœ‰å®è´¨æ€§çš„ä¼˜åŠ¿ã€‚\nå¯æ‰©å±•çš„ç”¨æˆ·çº§çº¿ç¨‹çš„ç¼ºå¤±ä¸ºäº‹ä»¶é£æ ¼æä¾›äº†æœ€å¤§çš„æ¨åŠ¨åŠ›ï¼Œä½†æˆ‘ä»¬å·²ç»è¡¨æ˜ï¼Œè¿™ä¸€ç¼ºé™·æ˜¯ç°æœ‰å®ç°çš„ä¸€ä¸ªä¼ªå‘½é¢˜ï¼Œè€Œä¸æ˜¯çº¿ç¨‹æŠ½è±¡çš„ä¸€ä¸ªåŸºæœ¬å±æ€§ã€‚\nï¼ˆä½œè€…è®¤ä¸ºï¼Œä¸Šé¢åˆ—ä¸¾çš„é—®é¢˜éƒ½ä¸æ˜¯çº¿ç¨‹æœ¬èº«çš„é”…ï¼éƒ½æ˜¯å®ç°æ–¹å¼é€ æˆçš„ï¼EventDrivenå’ŒThreadsèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼ï¼‰\nThe Case for Threads å¯¹äºé«˜å¹¶å‘æœåŠ¡å™¨ï¼Œçº¿ç¨‹æ˜¯æ›´åˆç†çš„æŠ½è±¡ã€‚åŸå› æœ‰äºŒï¼š\nå¹¶å‘è¯·æ±‚ä¹‹é—´ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å½¼æ­¤ç‹¬ç«‹çš„ã€‚ å¤„ç†è¯·æ±‚çš„ä»£ç æ˜¯é¡ºåºçš„ã€‚ Control flow åŸºäºäº‹ä»¶çš„ç³»ç»Ÿï¼Œå¾€å¾€ä¼šæ··æ·†åº”ç”¨ç¨‹åºçš„äº‹ä»¶æµï¼Œå› ä¸ºä¸åŒç¯èŠ‚ä¹‹é—´å®é™…æ˜¯é€šè¿‡â€œäº‹ä»¶â€è¿æ¥çš„ã€‚Coderéœ€è¦è®°ä½å¹¶ä¸”åŒ¹é…eventå’Œç¯èŠ‚ï¼Œå¹¶ä¸”ä¸ä¾¿äºè°ƒè¯•ã€‚\nè€Œçº¿ç¨‹æ¨¡å‹è¡¨è¾¾æ§åˆ¶æµçš„æ–¹å¼æ›´è‡ªç„¶ï¼ˆçº¿æ€§å¤„ç†ï¼‰äº†ï¼Œå¹¶ä¸”çº¿ç¨‹å †æ ˆå°è£…äº†è¶³å¤Ÿçš„ä¿¡æ¯æ¥è¿›è¡Œè°ƒè¯•ã€‚\nException Handling and State Lifetime åœ¨çº¿ç¨‹ç³»ç»Ÿä¸­ï¼Œåœ¨å¼‚å¸¸å’Œæ­£å¸¸ç»ˆæ­¢åæ¸…ç†ä»»åŠ¡çŠ¶æ€æ›´ç®€å•ï¼Œå› ä¸ºçº¿ç¨‹å †æ ˆè‡ªç„¶ä¼šè·Ÿè¸ªè¯¥ä»»åŠ¡çš„æ´»åŠ¨çŠ¶æ€ã€‚\nåœ¨äº‹ä»¶ç³»ç»Ÿä¸­ï¼Œä»»åŠ¡çŠ¶æ€é€šå¸¸æ˜¯å †åˆ†é…çš„ã€‚åœ¨æ­£ç¡®çš„æ—¶é—´é‡Šæ”¾è¿™ä¸ªçŠ¶æ€æ˜¯éå¸¸å›°éš¾çš„ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºæ§åˆ¶æµä¸­çš„åˆ†æ”¯(ç‰¹åˆ«æ˜¯åœ¨é”™è¯¯æ¡ä»¶ä¸‹)å¯èƒ½ä¼šå¯¼è‡´é”™è¿‡é‡Šæ”¾æ­¥éª¤ã€‚ // ?\nCompiler Support for Threads ç¼–è¯‘å™¨å’Œç³»ç»Ÿç´§å¯†ç»“åˆ, å®ç°æ›´å¥½çš„å®‰å…¨æ€§å’Œæ€§èƒ½!\nåŠ¨æ€å †æ ˆå¢é•¿ è¿è¡Œæ—¶è°ƒæ•´å †æ ˆå¤§å°ï¼Œé¿å…å›ºå®šå¤§å°å †å¸¦æ¥çš„æº¢å‡ºé£é™©å’Œå†…å­˜æµªè´¹ã€‚é€šè¿‡ç¼–è¯‘å™¨åˆ†ææ¥å¾—åˆ°æ‰€éœ€å †æ ˆç©ºé—´çš„ä¸Šé™åŠå¢é•¿ç‚¹ã€‚\nå®æ—¶çŠ¶æ€ç®¡ç† æ¸…é™¤ä¸å¿…è¦çš„çŠ¶æ€(state)ï¼Œæ£€æµ‹é˜»å¡è°ƒç”¨ä¸­æŒæœ‰å¤§é‡å®ä¾‹çš„æƒ…å†µç­‰ç­‰ã€‚\nåŒæ­¥ ç¼–è¯‘å™¨è­¦å‘Šæ•°æ®ç«äº‰å¤„æ¥å‡å°‘é”™è¯¯çš„å‘ç”Ÿã€‚\nConclusion çº¿ç¨‹æ¨¡å‹èƒ½å¤Ÿè¾¾åˆ°å’Œäº‹ä»¶é©±åŠ¨å‡ ä¹ä¸€æ ·çš„æ€§èƒ½æ•ˆæœï¼Œå¹¶ä¸”æ¨¡å‹æ›´ç®€å•ï¼Œæ›´æ˜“äºç¼–è¯‘å™¨åˆ†æï¼Œå› æ­¤ Threads æ˜¯ä¸€ä¸ªæ›´å¥½çš„ç¼–ç¨‹æ¨¡å‹ã€‚\nRef ref: Why events are a bad idea\n","date":"2022-03-23T18:00:00Z","permalink":"https://MyLoveES.github.io/p/why-events-are-a-bad-idea/","title":"Why events are a bad idea"},{"content":"// å‘ç°æœ¬æ–‡å¾ˆå¤šæ¦‚å¿µåœ¨ç°åœ¨å·²ç»ä¸é€‚ç”¨äº†ï¼Œä¸åšå‚è€ƒ\nThreads è¯ç”Ÿäºæ“ä½œç³»ç»Ÿçš„å‘å±• æ¼”å˜ä¸ºç”¨æˆ·çº§åˆ«çš„å·¥å…· ä½œä¸ºå„ç§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥æ˜¯çº¿ç¨‹ç¨‹åºå‘˜ï¼Ÿ ä»€ä¹ˆæ˜¯çº¿ç¨‹ ç”¨äºç®¡ç†å¹¶å‘çš„é€šç”¨è§£å†³æ–¹æ¡ˆ æ‰§è¡Œæµå½¼æ­¤ç‹¬ç«‹ å…±äº«çŠ¶æ€ æŠ¢å å¼è°ƒåº¦ åŒæ­¥ï¼ˆä¾‹å¦‚é”ã€æ¡ä»¶ï¼‰ é—®é¢˜ çº¿ç¨‹ç¼–ç¨‹å¾ˆéš¾ç”¨\nä¸ºå•¥è¿™ä¹ˆéš¾ç”¨ å¿…é¡»å¯¹å…±äº«èµ„æºåŠ é”æ¥æ§åˆ¶è®¿é—® ç”±é”äº§ç”Ÿçš„æ­»é”é—®é¢˜ éš¾ä»¥ debug. ä¾èµ–æ•°æ®å’Œæ—¶é—´ éš¾ä»¥æŠ½è±¡ modules å›è°ƒåœ¨åŠ é”çš„åœºæ™¯ä¸‹å¾ˆéš¾ç”¨ å¾ˆéš¾å–å¾—å¥½çš„æ€§èƒ½ï¼š ç®€å•çš„é”(ä¾‹å¦‚ç›‘è§†å™¨)äº§ç”Ÿä½å¹¶å‘æ€§ ç»†ç²’åº¦é”å¢åŠ äº†å¤æ‚åº¦ï¼Œé™ä½äº†æ€§èƒ½ æ“ä½œç³»ç»Ÿé™åˆ¶æ€§èƒ½(è°ƒåº¦ã€ä¸Šä¸‹æ–‡åˆ‡æ¢) å¯¹çº¿ç¨‹æ”¯æŒçš„ä¸å¥½ çº¿ç¨‹ä»£ç éš¾ä»¥ç§»æ¤ æ ‡å‡†åº“éçº¿ç¨‹å®‰å…¨çš„ å†…æ ¸è°ƒç”¨ï¼Œçª—å£ç³»ç»Ÿä¸æ˜¯å¤šçº¿ç¨‹ è°ƒè¯•å·¥å…·åŒ®ä¹ é€šå¸¸ä¸éœ€è¦å¹¶å‘ æ›¿ä»£å“ Events\nä¸»å¼  å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œäº‹ä»¶æ›´å¥½ åªæœ‰åœ¨çœŸæ­£éœ€è¦CPUå¹¶å‘çš„æ—¶å€™ï¼Œçº¿ç¨‹æ‰éœ€è¦ Event-Driven Programming 1ä¸ªæ‰§è¡Œæµ:æ— CPUå¹¶å‘ã€‚ æ³¨å†Œäº‹ä»¶å›è°ƒ äº‹ä»¶å¾ªç¯ç­‰å¾…äº‹ä»¶ï¼Œè°ƒç”¨å¤„ç†ç¨‹åº ä¸æŠ¢å äº‹ä»¶å¤„ç†ç¨‹åº handleré€šå¸¸ç”Ÿå‘½å‘¨æœŸå¾ˆçŸ­ éš¾ç”¨çš„åœ°æ–¹ é•¿æ—¶é—´è¿è¡Œçš„ç¯èŠ‚ä½¿åº”ç”¨ç¨‹åºæ— å“åº” fork å­è¿›ç¨‹ï¼Œç”¨äº‹ä»¶åœ¨å®Œæˆæ—¶å”¤é†’ æ‹†åˆ†handlers åœ¨å¤„ç†ç¨‹åºä¸­å®šæœŸè°ƒç”¨äº‹ä»¶å¾ªç¯ï¼ˆé‡å…¥æ€§å¢åŠ äº†å¤æ‚æ€§ï¼‰ã€‚ ä¸èƒ½è·¨äº‹ä»¶ç»´æŒæœ¬åœ°çŠ¶æ€ï¼ˆå¤„ç†ç¨‹åºå¿…é¡»returnï¼‰ æ²¡æœ‰CPUå¹¶å‘ï¼ˆä¸é€‚åˆç§‘å­¦åº”ç”¨ï¼‰ äº‹ä»¶é©±åŠ¨çš„I/Oå¹¶ä¸æ€»æ˜¯å¾—åˆ°å¾ˆå¥½çš„æ”¯æŒï¼ˆä¾‹å¦‚å·®åŠ²çš„å†™ç¼“å†²ï¼‰ Events vs. Threads äº‹ä»¶å°½å¯èƒ½é¿å…å¹¶å‘ï¼Œçº¿ç¨‹ç›¸åï¼š äº‹ä»¶æ˜“äºä¸Šæ‰‹ï¼šæ— å¹¶å‘ã€æ— æŠ¢å ã€æ— åŒæ­¥ã€æ— æ­»é”ã€‚ ä»…åœ¨ä¸å¯»å¸¸çš„æƒ…å†µä¸‹ä½¿ç”¨å¤æ‚çš„æŠ€æœ¯ã€‚ ä½¿ç”¨çº¿ç¨‹ï¼Œå³ä½¿æ˜¯æœ€ç®€å•çš„åº”ç”¨ç¨‹åºä¹Ÿé¢ä¸´ç€å¾ˆå¤§çš„å¤æ‚æ€§ã€‚ ä½¿ç”¨äº‹ä»¶æ›´å®¹æ˜“è°ƒè¯• æ—¶åºä¾èµ–åªä¸äº‹ä»¶ç›¸å…³ï¼Œä¸äº‹ä»¶å†…éƒ¨è°ƒåº¦æ— å…³ æ›´å®¹æ˜“è¿½è¸ªçš„é—®é¢˜ï¼šæŒ‰é’®å“åº”ç¼“æ…¢ vs æŸåçš„å†…å­˜ å•CPUä¸Šäº‹ä»¶é©±åŠ¨æ›´å¿« æ²¡æœ‰é”çš„å¼€é”€ æ²¡æœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢ äº‹ä»¶çš„å¯ä»¥æ‰§è¡Œæ›´å¼º çº¿ç¨‹æä¾›çœŸæ­£çš„å¹¶å‘ å¯ä»¥ä½¿ç”¨é•¿æ—¶é—´è¿è¡Œçš„æœ‰çŠ¶æ€å¤„ç†ç¨‹åºè€Œä¸ä¼šå†»ç»“ å¯æ‰©å±•çš„å¤šcpuæ€§èƒ½ åº”è¯¥ç”¨çº¿ç¨‹å—ï¼šNOï¼ å°½å¯èƒ½é¿å…çº¿ç¨‹:\nå¯¹äºguiã€åˆ†å¸ƒå¼ç³»ç»Ÿã€ä½ç«¯æœåŠ¡å™¨ï¼Œåº”è¯¥ä½¿ç”¨äº‹ä»¶ï¼Œè€Œä¸æ˜¯çº¿ç¨‹ åªä½¿ç”¨çœŸæ­£éœ€è¦CPUå¹¶å‘çš„çº¿ç¨‹ åœ¨éœ€è¦çº¿ç¨‹çš„åœ°æ–¹ï¼Œåœ¨çº¿ç¨‹åº”ç”¨ç¨‹åºå†…æ ¸ä¸­éš”ç¦»ä½¿ç”¨:ä¿æŒå¤§å¤šæ•°ä»£ç æ˜¯å•çº¿ç¨‹çš„ Conclusions å¹¶å‘ä»æ ¹æœ¬ä¸Šæ¥è¯´å¾ˆéš¾;å°½å¯èƒ½çš„é¿å…ã€‚ çº¿ç¨‹æ¯”äº‹ä»¶æ›´å¼ºå¤§ï¼Œä½†å¾ˆå°‘éœ€è¦è¿™ç§èƒ½åŠ› çº¿ç¨‹æ¯”äº‹ä»¶æ›´éš¾ç¼–ç¨‹;ä»…ä¾›ä¸“å®¶ ä½¿ç”¨äº‹ä»¶ä½œä¸ºä¸»è¦çš„å¼€å‘å·¥å…·(guiå’Œåˆ†å¸ƒå¼ç³»ç»Ÿ) åªå¯¹æ€§èƒ½å…³é”®çš„å†…æ ¸ä½¿ç”¨çº¿ç¨‹ Ref ref: Why Threads Are a Bad Idea\n","date":"2022-03-22T00:00:00Z","permalink":"https://MyLoveES.github.io/p/why-threads-are-a-bad-idea-for-most-purposes/","title":"Why threads are a bad idea (for most purposes)"},{"content":"\nèƒŒæ™¯ ä¸šåŠ¡ä¸­ç¢°åˆ°ä¸€ä¸ªåœºæ™¯ï¼ŒæœåŠ¡éœ€è¦å¤„ç†ä¸€ä¸ªJobï¼Œåˆ†ä¸ºå‡ ä¸ªé˜¶æ®µï¼šPre Do Afterã€‚å®ç°ä¸šåŠ¡é€»è¾‘æœ‰ä¸¤ç§æ¯”è¾ƒå¸¸è§çš„æ¨¡å¼:\nçº¿ç¨‹æ±  äº‹ä»¶é©±åŠ¨ é‚£è¿™ä¸¤ç§æ¨¡å¼å­°ä¼˜å­°åŠ£ï¼Ÿçœ‹çœ‹å‰äººçš„è§è§£ï¼š\nEventDriven-oriented or Procedure-oriented Who are they Event Driven ç›¸å¯¹è¾ƒå°çš„è¿›ç¨‹æ•°é‡ï¼Œè¿›ç¨‹ä¹‹é—´è¿›è¡Œæ˜¾å¼æ¶ˆæ¯é€šä¿¡ã€‚é’ˆå¯¹äºäº‹ä»¶é©±åŠ¨ï¼Œæœ‰å¤šç§å®ç°å½¢å¼ï¼Œä¾‹å¦‚è§‚å¯Ÿè€…æ¨¡å¼æˆ–è€…å‘å¸ƒè®¢é˜…æ¨¡å¼ç­‰ã€‚\n1 2 3 1. Small number of (relatively static) big processes 2. Explicit set of message channels 3. Limited amount of direct sharing of data in memory è§‚å¯Ÿè€…æ¨¡å¼\nå‘å¸ƒè®¢é˜…æ¨¡å¼ å®ƒçš„ç‰¹ç‚¹æ˜¯äº‹ä»¶çš„äº§ç”Ÿè€…å¹¶ä¸å…³å¿ƒå…·ä½“çš„å¤„ç†é€»è¾‘ï¼Œæ¯ä¸ªç¯èŠ‚çš„workerséƒ½èƒ½å¤Ÿä¸“æ³¨äºè‡ªå·±çš„å·¥ä½œ\n1 2 3 4 5 6 äº‹ä»¶é©±åŠ¨çš„ä¼˜ç‚¹ï¼š 1. è§£è€¦ï¼šäº‹ä»¶å‘å¸ƒè€…ã€è®¢é˜…è€…è§£è€¦ï¼Œå…¶ä¸­ä¸€ä¸ªç¯èŠ‚çš„å˜åŒ–ï¼Œä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒçš„è¿›è¡Œ 2. å¼‚æ­¥ï¼šå„ä¸ªç¯èŠ‚é€šè¿‡äº‹ä»¶å…³è”ï¼Œæ‰€ä»¥æœåŠ¡é—´ä¸ä¼šblockã€‚å¸¦æ¥æ‰§è¡Œçš„å¯è°ƒåº¦æ€§ï¼Œèµ„æºåˆ†é…çš„åŠ¨æ€æ€§ 3. çµæ´»ï¼šåœ¨æœåŠ¡é—´å¢åŠ ä¸€äº›é€‚é…å™¨ï¼ˆå¦‚æ—¥å¿—ã€è®¤è¯ã€ç‰ˆæœ¬ã€é™æµã€é™çº§ã€ç†”æ–­ç­‰ï¼‰ç›¸å½“å®¹æ˜“ 4. ç‹¬ç«‹ï¼šæœåŠ¡é—´çš„ååä¹Ÿè¢«è§£å¼€äº†ï¼Œå„ä¸ªæœåŠ¡å¯ä»¥ä¸“æ³¨äºè‡ªå·±çš„å®ç°ï¼ŒæŒ‰ç…§è‡ªå·±çš„å¤„ç†é€Ÿåº¦å¤„ç† 5. ç¼“å†²ï¼šåˆ©ç”¨ Broker æˆ–é˜Ÿåˆ—çš„æ–¹å¼è¿˜å¯ä»¥è¾¾åˆ°æŠŠæŠ–åŠ¨çš„ååé‡å˜æˆå‡åŒ€çš„ååé‡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œå‰Šå³°â€ï¼Œè¿™å¯¹åç«¯ç³»ç»Ÿæ˜¯ä¸ªä¸é”™çš„ä¿æŠ¤ Procedure-oriented å¤§é‡å¿«é€Ÿå˜åŒ–çš„å°è¿›ç¨‹å’ŒåŸºäºå…±äº«æ•°æ®çš„è¿›ç¨‹åŒæ­¥æœºåˆ¶\nå®ƒçš„ç‰¹ç‚¹æ˜¯ä¸€æ¬¡è¯·æ±‚ä»ä¸€è€Œç»ˆï¼Œç”±å•ä¸€çš„çº¿ç¨‹ï¼ˆè¿›ç¨‹ï¼‰æ‰§è¡Œ\n1 2 3 4 1. Large number of very small processes 2. Rapid creation and deletion of processes 3. Communication by means of direct sharing of data in memory 1 2 3 4 é¢å‘è¿‡ç¨‹çš„ä¼˜ç‚¹ï¼š 1. æ¶æ„ç®€å•æ˜äº†ï¼Œæ˜“äºå®ç° 2. å„ç¯èŠ‚åœ¨åœ¨åŒä¸€çº¿ç¨‹/è¿›ç¨‹å†…å®Œæˆï¼Œæ˜“äºè¿½è¸ª(debug) 3. å®æ—¶æ€§å¼ºï¼Œä»»åŠ¡ä»ä¸€è€Œç»ˆ The Duality Mapping 1 2 3 4 5 6 7 8 \u0026lt;On the Duality of Operating System Structures\u0026gt; 1. The two models are duals of each other. That is, a program or subsystem constructed strictly according to the primitives defined by one model can be mapped directly into a dual program or subsystem which fits the other model. 2. The dual programs or subsystems are logically identical to each other. They can also be made textually very similar, differing only in non-essential details. 3. The performance of a program or subsystem from one model, as reflected by its queue lengths, waiting times, service rates, etc. is identical to that of its dual system, given identical scheduling strategies. Furthermore, the primitive operations provided by the operating system of one model can be made as efficient as their duals of the other model. 1. ä¸¤ç±»æ¨¡å‹äº’ä¸ºå¯¹å¶ï¼Œä¸¤è€…å¯ä»¥äº’ç›¸è½¬æ¢ã€‚ 2. é€»è¾‘ä¸Šä¸¤è€…å½¼æ­¤ç›¸ä¼¼ï¼Œç”šè‡³å¯ä»¥åœ¨æ–‡æœ¬ä¸Šè¡¨ç°å¾—éå¸¸ç›¸ä¼¼ï¼Œé™¤äº†éå¿…è¦çš„ç»†èŠ‚ä¸Šã€‚ 3. åœ¨ç›¸åŒçš„è°ƒåº¦ç­–ç•¥ä¸‹ï¼Œä¸¤ç±»æ¨¡å‹çš„æ€§èƒ½å¯ä»¥ä¸€æ ·é«˜ï¼ˆæ ¹æ®é˜Ÿåˆ—é•¿åº¦ã€ç­‰å¾…æ—¶é—´ã€å¤„ç†é€Ÿåº¦ç­‰æ–¹é¢è§‚æµ‹ï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸€ä¸ªæ¨¡å‹æä¾›çš„åŸºæœ¬æ“ä½œå¯ä»¥ä½¿å…¶æ•ˆç‡å’Œå¦ä¸€ä¸ªæ¨¡å‹ä¸€æ ·é«˜ã€‚ Event Driven: simpler concurrency model åŸæ–‡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Messages and message identifiers. A message is a data structure meant for sending information from one process to another; it typically contains a small, fixed area for data which is passed by value and space for a pointer to larger data structures which must be passed by reference. A message identifier is a handle by which a particular message can be identified. Message channels and message ports. A message channel is an abstract structure which identifies the destination of a message. A message port is queue capable of holding messages of a certain class or type which might be received by a particular process. Each message channel must be bound to a particular message port before is can be used. A message port, however, may have more than one message channel bound to it. Four message transmission operations: 1. SendMessage[messageChannel, messageBody] returns [messageId] This operation simply queues a new message on the port bound to the the messageChannel named as parameter. The messageld returned is used as parameter to the following operation. 2. AwaitReply(messageId] returns [messageBody] The operation causes the process to wait for a reply to a specific message previously sent via SendMessage. 3. WaitForMessage[set of messagePort] returns [messageBody, messageld, messagePort] This operation allows a process to wait for a new (unsolicited) message on any one of the message ports named in the \u0026#39;parameter. The message which is first on the queue is returned, along with a message identifier for future reference and an indication of the port from which that message came. 4. SendReply[messageId, messageBody] This operation sends a reply to the particular message identified by the message identifier. SKIP FIGURE In this process, the kind of service requested is a function of which port the requesting message arrives on. It may or may not involve making requests of still other processes and/or sending a reply back to the requestor. It may also result in some circumstance, such as the exhaustion of a resource, which prevents further requests from being considered. These remain queued on their port until later, when the process is willing to listen on that port again. Note that if a whole system is built according to this style, then the sole means of interaction among the components of that system is by means of the message facility. Each process can operate in its own address space without interference from the others. Because of the serial way in which requests are handled, there is never any need to protect the state information of a process from multiple, simultaneous access and updating. ä¸€äº›æ¦‚å¿µçš„å®šä¹‰ï¼š Messages: æ•°æ®ç»“æ„ï¼Œç”¨äºè¿›ç¨‹ä¹‹é—´ä¼ é€’ä¿¡æ¯ã€‚\nMessage identifiers: æ¶ˆæ¯ id\nMessage channels: æ¶ˆæ¯ç›®çš„åœ°\nMessage ports: æ¥æ”¶ç«¯å£\nSendMessage [messageChannel, messageBody] returns [messageId]\nAwaitReply [messageId] returns [messageBody] WaitForMessage [set of messagePort] returns [messageBody, messageld, messagePort] SendReply [messageId, messageBody]\nè¿è¡Œå…¬å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 begin m: messageBody; i: messageld; p: portid; s: set of portid; ... -local data and state information for this process initialize; do forever; [m, i, p] \u0026lt;- WaitForMessage[s]; case p of port1 =\u0026gt;...; -algorithm for port1 port2 =\u0026gt;... if resourceExhausted then s \u0026lt;- s - port2; SendReply[i, reply]; ...; -algorithm for port2 portk =\u0026gt;... s \u0026lt;- s + port2 ...; -algorithm for portk endcase; endloop; end. Procedure-oriented: simpler \u0026amp; natural programming style åŸæ–‡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 1. Procedures. A procedure is a piece of Mesa text containing algorithms, local data, parameters, and results. It always operates in the scope of a Mesa module and may access any global data declared in that module (as well as in any containing procedures). 2. Procedure call facilities, synchronous and asynchronous. The synchronous procedure call mechanism is just the ordinary Mesa procedure call statement, which may return results. This is very much like procedure or function calls in Algol, Pascal, etc. The asynchronous procedure call mechanism is represented by the FORK and JOIN statements, which are defmed as follows: 1) processld \u0026lt;- FORK procedureName[parameterList] - This statement starts the procedure executing as a new process with its own parameters. The procedure operates in the context of its declaration, just as if it had been called synchronously, but the process has its own call stack and state. The calling process continues executing from the statement following the FORK. The process identifier returned from FORK is used in the next statement 2) [resultList] \u0026lt;- JOIN processld - This statement causes the process executing it to synchronize itself with the termination of the process named by the process identifier. The results are retrieved from that process and returned to the calling process as if they had been returned from an ordinary procedure call. The JOlNed process is then destroyed and execution continues in the JOlNing process from the statement following the JOIN. 3. Modules and monitors. A module is the primitive Mesa unit of compilation and consists of a collection of procedures and data. The scope rules of the language determine which of these. procedures and data are accessible or callable from outside the module. A monitor is a special kind of Mesa module which has associated with it a lock to prevent more than one process from executing inside of it at any one time. It is based on and very similar to the monitor mechanism described by Hoare[6]. 4. Module instantiation. Modules (including monitor modules) may be instantiated in Mesa by means of the NEW and START statements. These cause a new context to be created for holding the module data, provide the binding from external procedure references within the module to procedures declared in other modules, and activate the initialization code of the module. 5. Condition variables. Condition variables are part of Hoare\u0026#39;s monitor mechanism an provide more flexible synchronization among events than mutual exclusion facility of the monitor lock or the process termination facility of the JOIN statement. In our model, a condition variable, must be contained within a monitor, has associated with it a queue of processes, and has two operations defined on it: 1) WAIT conditionVariable - This causes the process executing it to release the monitor lock, suspend execution, and join the queue associated with that condition variable. 2) SIGNAL condition Variable -- This causes a process which has previously WAITed on the condition variable to resume execution from its next statement when it is able to reclaim the monitor lock. Note that because the FORK and JOIN operations apply to procedures which are already declared and bound to the right context, these operations take the same order of magnitude of time to execute as do simple procedure calls and returns. Thus processes are very lightweight, and can be created and destroyed very frequently. Module and monitor instantiation, on the other hand, is more cumbersome and is usually done statically before the system is started. Note that this canonical model has no module deletion facility. SKIP FIGURE The attribute ENTRY is used to distinguish procedures which are called from outside the monitor, thus seizing the monitor lock, from those which are declared purely internal to the monitor. Any of the procedures in this module may, of course, call procedures declared in other modules for other system services before returning. Within the monitor, condition variables are used to control waiting for circumstances such as the availability of resources. These are used in this standard resource manager ,tp control the access of a process the procedure representing a particular kind of service. If a whole system is built in this style, then the sole means of interaction among its components is procedural. Processes move from one context to another by means of the procedure call facility across module boundaries, and they use asynchronous calls to stimulate concurrent activity. They depend upon monitor locks and condition variables to keep out of the way of each other. Thus no process can be associated with a single address space unless that space be the whole system. ä¸€äº›æ¦‚å¿µçš„å®šä¹‰ Procedure\nProcedure call facilities, synchronous and asynchronous\n\u0026ndash; (asynchronous):\n\u0026mdash;- processld \u0026lt;- FORK procedureName[parameterList]\n\u0026mdash;- [resultList] \u0026lt;- JOIN processld\nModules: consists of a collection of procedures and data\nMonitors: ç›‘æ§é”é˜²æ­¢å¤šè¿›ç¨‹åœ¨å…¶ä¸­æ‰§è¡Œ\nModule instantiation: å®ä¾‹åŒ–\nCondition variables:\n\u0026ndash; WAIT condition Variable\n\u0026ndash; SIGNAL condition Variable\nè¿è¡Œå…¬å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 ResourceManager: MONITOR = C: CONDITION; resourceExhausted: BOOLEAN; ... -global data and state information for this process proc1: ENTRY PROCEDURE[...] = ...; -algorithm for prod proc2: ENTRY PROCEDURE[...] RETURNS[...] = BEGIN IF resourceExhausted THEN WAIT c; â€¢â€¢â€¢; RETURN[results]; â€¢â€¢â€¢; END; -algorithm for proc2 procL: ENTRY PROCEDURE[...] = BEGIN resourceExhausted \u0026lt;- FALSE; SIGNAL C; ...; END; -algorithm for procL endloop; endloop; initialize; END The Duality Mapping Processes, CreateProcess Monitors, NEW/START Message Channels External Procedure identifiers Message Ports ENTRY procedure identifier SendMessage; AwaitReply (immediate) simple procedure call SendMessage; AwaitReply (delayed) fork;join SendReply RETURN (from procedure) main loop of standard resource manager, WaitForMessage statement, case statement monitor lock, ENTRY attribute arms of the case statement ENTRY procedure declaration selective waiting for messages condition variables, WAIT, SIGNAL ç•ªå¤– åœ¨ä¹‹åçš„å¦ä¸€ç¯‡æ–‡ç« ï¼ŒWhy Events Are A Bad Idea é‡Œé¢ï¼Œä½œè€…çš„è§£é‡Šæ€§å¯¹æ¯”\nevent handlers monitors events accepted by a handler functions exported by a module SendMessageã€AwaitReply procedure call, or fork/join SendReply return from procedure waiting for messages waiting on condition variables æ€§èƒ½ ç¨‹åºæœ¬èº«æ‰§è¡Œæ—¶é—´ è°ƒç”¨ç³»ç»Ÿæ“ä½œå¼€é”€ï¼ˆå¯ä»¥ç†è§£ä¸ºè°ƒç”¨ç¬¬ä¸‰æ–¹å¼€é”€ï¼Ÿï¼‰ é˜Ÿåˆ—ç­‰å¾…æ—¶é—´ï¼ˆåæ˜ çš„æ˜¯é˜»å¡ã€èµ„æºç«äº‰ã€è°ƒåº¦ç­–ç•¥ï¼‰ äºŒå…ƒæ€§å˜æ¢ä½¿æ„æˆç³»ç»Ÿçš„ç¨‹åºä¸»ä½“ä¸å—å½±å“ã€‚å› æ­¤ï¼Œæ‰€æœ‰çš„ç®—æ³•å°†ä»¥ç›¸åŒçš„é€Ÿåº¦è®¡ç®—ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªæ•°æ®ç»“æ„ä¸­å­˜å‚¨ç›¸åŒæ•°é‡çš„ä¿¡æ¯ã€‚åœ¨æ¯ä¸ªç³»ç»Ÿä¸­æ‰§è¡Œçš„ä»£ç æ•°é‡ç›¸åŒã€‚å°†æ‰§è¡Œç›¸åŒæ•°é‡çš„åŠ æ³•ã€ä¹˜æ³•ã€æ¯”è¾ƒå’Œå­—ç¬¦ä¸²æ“ä½œã€‚å› æ­¤ï¼Œå¦‚æœåŸºæœ¬çš„å¤„ç†å™¨ç‰¹æ€§æ²¡æœ‰æ”¹å˜ï¼Œé‚£ä¹ˆè¿™äº›ç‰¹æ€§å°†éœ€è¦ç›¸åŒæ•°é‡çš„è®¡ç®—èƒ½åŠ›ï¼Œå¹¶ä¸”ç³»ç»Ÿæ€§èƒ½çš„è¿™ä¸ªç»„ä»¶å°†ä¿æŒä¸å˜ã€‚åŒæ ·ï¼Œå¯¹äºç³»ç»Ÿè°ƒç”¨å¼€é”€å’Œé˜Ÿåˆ—é˜»å¡ç­‰å¾…ï¼Œä¸¤è€…ä¼šä»˜å‡ºåŒæ ·çš„ä»£ä»·ã€‚\nåŸæ–‡ 1 2 3 4 5 6 7 8 The duality transformation leaves the main bodies of the programs comprising the system untouched. Thus the algorithms will all compute at the same speed, and the same amount of information will be stored in each data structure. The same amount of client code will be executed in each of the dual systems. The same number of additions, multiplications, comparisons, -and string operations will be performed. Therefore if basic processor characteristics are unchanged, then these will take precisely the same amount of computing power, and this component of the system performance will remain unchanged. The other component affecting the speed of execution of a single program is the time it takes to execute each of the primitive system operations it calls. We assert without proof that the facilities of each of our two canonical models can be made to execute as efficiently as the corresponding facilities of the other model. I.e., Sending a message, with its inherent need to allocate a message block and manipulate a queue and its possibility of forcing a context (process) switch, is a computation of the same complexity as that of calling or FOR King to an ENTRY procedure, which involves the same need to allocate, queue, and force a context switch. Leaving a monitor, with the possibility of having to unqueue a waiting process and re-enter it, is an operation of the same complexity as that of waiting for new messages. Process switching can be made equally fast in either system, and for similar machine architectures this means saving the same amount of state information. The same is true for the scheduling and dispatching of processes at the \u0026#39;microscopic\u0026#39; level. 14 ON THE DUALITY OF OPERATING SYSTEM STRUCTURES Virtual memory and paging or swapping can even be used with equal effectiveness in either model. But, who is better ? ref: Why Threads Are a Bad Idea ref: Why events are a bad idea\nRef ref: On the Duality of Operating System Structures\n","date":"2022-03-21T00:00:00Z","permalink":"https://MyLoveES.github.io/p/%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8-or-%E9%9D%A2%E5%90%91%E8%BF%87%E7%A8%8B/","title":"äº‹ä»¶é©±åŠ¨ or é¢å‘è¿‡ç¨‹"},{"content":"","date":"2022-03-10T00:00:00Z","permalink":"https://MyLoveES.github.io/p/%E7%BC%93%E5%AD%98%E7%AE%97%E6%B3%95-window-tinylfu/","title":"ç¼“å­˜ç®—æ³• - Window-TinyLFU"},{"content":"\nWhat \u0026amp; Why Single entry point for all clients (é¢å‘å®¢æˆ·ç«¯çš„å•ä¸€å…¥å£) Common in microservice architectures ï¼ˆå¾®æœåŠ¡éœ€è¦ä¸šåŠ¡èšåˆï¼‰ Client insulation from services ï¼ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡éš”ç¦»ï¼‰ protocol ï¼ˆåè®®è½¬æ¢ï¼‰ Securityï¼ˆå®‰å…¨ï¼‰ surgical routingï¼ˆè·¯ç”±ï¼‰ Load Shedding ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰ Rate Limitï¼ˆé™æµï¼‰ Cacheï¼ˆç¼“å­˜ï¼‰ Fuseï¼ˆç†”æ–­ï¼‰ Retryï¼ˆé‡è¯•ï¼‰ Authï¼ˆè®¤è¯ã€é‰´æƒï¼‰ Logï¼ˆæ—¥å¿—æ”¶é›†ï¼‰ Monitorï¼ˆç›‘æ§ï¼‰ Tracing Analysisï¼ˆé“¾è·¯è¿½è¸ªï¼‰ Aspects to be considered Develepmentï¼ˆProgramming Languageï¼‰ Community activity Performance Stability Update SOME GATEWAY(By programming language) Nginx+Luaï¼šOpen Restyã€Kongã€Orangeã€Abtesting Gatewayç­‰ï¼› Javaï¼šZuul/Zuul 2ã€Spring Cloud Gatewayã€Kaazing KWGã€graviteeã€Dromara soulç­‰ï¼› Goï¼šJanusã€fagongziã€Grpc-Gatewayï¼› .NETï¼šOcelotï¼› Node.jsï¼šExpress Gatewayã€MicroGatewayã€‚ ä½¿ç”¨èŒƒå›´ã€æˆç†Ÿåº¦ã€æ´»è·ƒåº¦ç­‰ï¼Œä¸»æµæœ‰ï¼šKongã€Zuul/Zuul 2ã€Spring Cloud Gatewayã€apisix\nNginx Nginx æ›´åå‘äºä½œä¸ºæµé‡ç½‘å…³ã€‚æˆç†Ÿï¼Œæ€§èƒ½å¥½ï¼Œç¨³å®šã€‚ ä½†è‡´å‘½å¼±ç‚¹æ˜¯ï¼Œä¸ä¾¿äºè‡ªå®šä¹‰å¼€å‘ï¼ˆæœ‰ä¸€éƒ¨åˆ†æ˜¯å¼€å‘è¯­è¨€çš„åŸå› ï¼‰ï¼Œéœ€è¦ +Lua (ä¾‹å¦‚ä¸‹é¢çš„ OpenResty / Kong / Apisix)ã€‚\n1 Nginx åœ¨å¯åŠ¨åï¼Œä¼šæœ‰ä¸€ä¸ª Master è¿›ç¨‹å’Œå¤šä¸ª Worker è¿›ç¨‹ï¼ŒMaster è¿›ç¨‹å’Œ Worker è¿›ç¨‹ä¹‹é—´æ˜¯é€šè¿‡è¿›ç¨‹é—´é€šä¿¡è¿›è¡Œäº¤äº’çš„ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚Worker å·¥ä½œè¿›ç¨‹çš„é˜»å¡ç‚¹æ˜¯åœ¨åƒ select()ã€epoll_wait() ç­‰è¿™æ ·çš„ I/O å¤šè·¯å¤ç”¨å‡½æ•°è°ƒç”¨å¤„ï¼Œä»¥ç­‰å¾…å‘ç”Ÿæ•°æ®å¯è¯» / å†™äº‹ä»¶ã€‚Nginx é‡‡ç”¨äº†å¼‚æ­¥éé˜»å¡çš„æ–¹å¼æ¥å¤„ç†è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒNginx æ˜¯å¯ä»¥åŒæ—¶å¤„ç†æˆåƒä¸Šä¸‡ä¸ªè¯·æ±‚çš„ã€‚ OpenRestyï¼ˆNginx + Luaï¼‰ OpenResty nginx + LuaåŠ¨æ€æ‰©å±•ã€‚ç›®å‰å·²ç»æœ‰åŸºäºOpen Restyäº§ç”Ÿçš„gatewayï¼Œä¾‹å¦‚ Kongï¼ŒAPISIXç­‰ã€‚\n1 è¿˜å¯ä»¥å°† Lua åµŒå…¥åˆ° Nginx ä¸­ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨ Lua æ¥ç¼–å†™è„šæœ¬ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨ Lua ç¼–å†™åº”ç”¨è„šæœ¬ï¼Œéƒ¨ç½²åˆ° Nginx ä¸­è¿è¡Œï¼Œå³ Nginx å˜æˆäº†ä¸€ä¸ª Web å®¹å™¨ï¼›è¿™æ ·å¼€å‘äººå‘˜å°±å¯ä»¥ä½¿ç”¨ Lua è¯­è¨€å¼€å‘é«˜æ€§èƒ½Webåº”ç”¨äº†ã€‚åœ¨å¼€å‘çš„æ—¶å€™ä½¿ç”¨ OpenResty æ¥æ­å»ºå¼€å‘ç¯å¢ƒï¼ŒOpenResty å°† Nginx æ ¸å¿ƒã€LuaJITã€è®¸å¤šæœ‰ç”¨çš„ Lua åº“å’Œ Nginx ç¬¬ä¸‰æ–¹æ¨¡å—æ‰“åŒ…åœ¨ä¸€èµ·ï¼›è¿™æ ·åªéœ€è¦å®‰è£… OpenRestyï¼Œä¸éœ€è¦äº†è§£ Nginx æ ¸å¿ƒå’Œå†™å¤æ‚çš„ C/C++ æ¨¡å—å°±å¯ä»¥ï¼Œåªéœ€è¦ä½¿ç”¨ Lua è¯­è¨€è¿›è¡Œ Web åº”ç”¨å¼€å‘äº†ã€‚ APISIXï¼ˆNginx + etcdï¼‰ Develepmentï¼ˆProgramming Languageï¼‰: N Community activity: Y Performance: Y Stability: ï¼Ÿ Update: Y APISIXçš„æ€§èƒ½æ›´å¥½ï¼ŒåŠŸèƒ½ä¹Ÿæ›´åŠ ä¸°å¯Œã€‚ ä½†APISIXå¾ˆå¹´è½»ï¼Œæˆ–è®¸éœ€è¦æ›´å¤šçš„â€œæ£€éªŒâ€ï¼Œå¼€å‘è¯­è¨€çš„å·®åˆ«ä¹Ÿä¼šå¢åŠ é—®é¢˜æ’æŸ¥ã€å¤„ç†çš„ä»£ä»·ã€‚\n(å¯ä»¥å°è¯•)\nKongï¼ˆNginx + postgresï¼‰ Develepmentï¼ˆProgramming Languageï¼‰: Y Community activity: Y Performance: N (compared with apisix) Stability: Y Update: Y Kongå’ŒAPISIXç›¸æ¯”è¾ƒè€Œè¨€ï¼Œä»æ€§èƒ½ã€åŠŸèƒ½ä¸°å¯Œåº¦æ–¹é¢ éƒ½å¤„äºä¸‹é£ï¼ˆæ¯•ç«ŸAPISIXæ›´æ–°ï¼‰ã€‚è€Œä¸”å¼€å‘è¯­è¨€çš„åŠ£åŠ¿åŒæ ·å…·æœ‰ã€‚\nZuul (Java) Zuul-åŠ¨æ€è·¯ç”±ã€ç›‘æ§ã€å¼¹æ€§å’Œå®‰å…¨ã€‚åŸºäºServletï¼Œå±äºä¸Šä¸€ä»£äº§å“ï¼ŒåŒæ­¥I/Oã€å¤šçº¿ç¨‹ã€‚æ€§èƒ½ä¸å¥½ï¼Œé’ˆå¯¹äºZuulçš„æ›¿ä»£æ–¹æ¡ˆå·²ç»æœ‰ Zuul2 ä»¥åŠ Spring Gateway ä¸¤ç±»ã€‚å› æ­¤Zuulä¸äºˆè€ƒè™‘ã€‚\nPreDecorationFilter\nSendForwardFilter\nRibbonRoutingFilter\nSimpleHostRoutingFilter\nSendResponseFilter\nSendErrorFilter\nPROBLEMS? Large coupled filters Filter model/API is clunky\nZuul2 (Java) Develepmentï¼ˆProgramming Languageï¼‰: N Community activity: Y Performance: Y Stability: ï¼Ÿ Update: Y æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€è¿æ¥æ± ã€çŠ¶æ€åˆ†ç±»ã€é‡è¯•ã€è¯·æ±‚å‡­è¯ã€HTTP/2ã€TLSã€ä»£ç†åè®®ã€GZipã€WebSocket\nåŸºäº Nettyï¼ŒZuul 2.xæœ€å¤§çš„æ”¹è¿›å°±æ˜¯åŸºäºNetty Serverå®ç°äº†å¼‚æ­¥I/Oæ¥æ¥å…¥è¯·æ±‚ï¼ŒåŒæ—¶åŸºäºNetty Clientå®ç°äº†åˆ°åç«¯ä¸šåŠ¡æœåŠ¡APIçš„è¯·æ±‚ã€‚è¿™æ ·å°±å¯ä»¥å®ç°æ›´é«˜çš„æ€§èƒ½ã€æ›´ä½çš„å»¶è¿Ÿã€‚æ­¤å¤–ä¹Ÿè°ƒæ•´äº†Filterç±»å‹ï¼Œå°†åŸæ¥çš„ä¸‰ä¸ªæ ¸å¿ƒFilteræ˜¾å¼å‘½åä¸ºInbound Filterã€Endpoint Filterå’ŒOutbound Filterï¼Œå¦‚å›¾7-8æ‰€ç¤ºã€‚\nMajor rewrite\nNot backwards compatible with Zuul 1\nNon-blocking/Netty\nNot released yet\nHTTP/2 and Websockets in the future\nReinvents many things from Spring\nSpring Cloud Gateway (Java) Develepmentï¼ˆProgramming Languageï¼‰: Y Community activity: Y Performance: Y Stability: Y Update: Y Java 8ã€Spring 5.0ã€Spring Boot 2.0ã€Reactor -\u0026gt; Spring family\nSpring Cloudç´§å¯†é…åˆ ç›®å‰ä½¿ç”¨äº†nacosä½œä¸ºé…ç½®ä¸­å¿ƒï¼Œå¯ä»¥å’Œ gateway æ­é…ã€‚\nJava 8/Spring 5/Boot 2 WebFlux/Reactor HTTP/2 and Websockets Finchley Release Train\nSpring Cloud Gatewayé‡Œæ˜ç¡®åœ°åŒºåˆ†äº†Routerå’ŒFilterï¼Œå†…ç½®äº†éå¸¸å¤šçš„å¼€ç®±å³ç”¨åŠŸèƒ½ï¼Œå¹¶ä¸”éƒ½å¯ä»¥é€šè¿‡Spring Booté…ç½®æˆ–æ‰‹å·¥ç¼–ç é“¾å¼è°ƒç”¨æ¥ä½¿ç”¨ã€‚\nå†…ç½®äº†10ç§Routerï¼Œç›´æ¥é…ç½®å°±å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°æ ¹æ®Headerã€Pathã€Hostæˆ–Queryæ¥åšè·¯ç”±ã€‚\næ ¸å¿ƒç‰¹æ€§ï¼š é€šè¿‡è¯·æ±‚å‚æ•°åŒ¹é…è·¯ç”±ï¼› é€šè¿‡æ–­è¨€å’Œè¿‡æ»¤å™¨å®ç°è·¯ç”±ï¼› ä¸Hystrixç†”æ–­é›†æˆï¼› ä¸Spring Cloud DiscoveryClienté›†æˆï¼› éå¸¸æ–¹ä¾¿åœ°å®ç°æ–­è¨€å’Œè¿‡æ»¤å™¨ï¼› è¯·æ±‚é™æµï¼› è·¯å¾„é‡å†™ã€‚ Compare Zuul vs Zuul2 (Difference between sync and async): Zuul2 Win! Zuul(block) disadvantages Zuul 1 was built on the Servlet framework Blocking and mltithreaded, means they process requests by using one thread per connection. I/O oprations are done by choosing a worker threade from athread pool to execute the I/O, and the request thread is blocked until the worker thread completes, and the worker thread notifies the request thread when its work is complete. 1 This works well with modern multi-core AWS instances handling 100â€™s of concurrent connections each. But when things go wrong, like backend latency increases or device retries due to errors, the count of active connections and threads increases. When this happens, nodes get into trouble and can go into a death spiral where backed up threads spike server loads and overwhelm the cluster. To offset these risks, we built in throttling mechanisms and libraries (e.g., Hystrix) to help keep our blocking systems stable during these events. Zuul2(async) advantages Zuul2 async. One thread per CPU core handling all requests and responses. The lifecycle of the request and response is handled through events and callbacks. 1 Because there is not a thread for each request, the cost of connections is cheap. This is the cost of a file descriptor, and the addition of a listener. Whereas the cost of a connection in the blocking model is a thread and with heavy memory and system overhead. There are some efficiency gains because data stays on the same CPU, making better use of CPU level caches and requiring fewer context switches. The fallout of backend latency and â€œretry stormsâ€ (customers and devices retrying requests when problems occur) is also less stressful on the system because connections and increased events in the queue are far less expensive than piling up threads. Zuul2(async) disadvantages \u0026amp; Zuul(block) advantages 1 2 3 The advantages of async systems sound glorious, but the above benefits come at a cost to operations. Blocking systems are easy to grok and debug. A thread is always doing a single operation so the threadâ€™s stack is an accurate snapshot of the progress of a request or spawned task; and a thread dump can be read to follow a request spanning multiple threads by following locks. An exception thrown just pops up the stack. A â€œcatch-allâ€ exception handler can cleanup everything that isnâ€™t explicitly caught. Async, by contrast, is callback based and driven by an event loop. The event loopâ€™s stack trace is meaningless when trying to follow a request. It is difficult to follow a request as events and callbacks are processed, and the tools to help with debugging this are sorely lacking in this area. Edge cases, unhandled exceptions, and incorrectly handled state changes create dangling resources resulting in ByteBuf leaks, file descriptor leaks, lost responses, etc. These types of issues have proven to be quite difficult to debug because it is difficult to know which event wasnâ€™t handled properly or cleaned up appropriately. Kong vs APISIX Spring Cloud Gateway vs Zuul2 vs OpenResty vs Kong ç½‘å…³ é™æµ é‰´æƒ ç›‘æ§ æ˜“ç”¨æ€§ å¯ç»´æŠ¤æ€§ æˆç†Ÿåº¦ Spring Cloud Gateway IPã€ç”¨æˆ·ã€é›†ç¾¤é™æµï¼Œæä¾›ç›¸åº”æ¥å£æ‰©å±• æ™®é€šé‰´æƒã€OAuth2.0 Gateway Metrics Filter ç®€å• Springå…¨å®¶æ¡¶æˆå‘˜ã€æ‰©å±•æ€§å¼ºã€æ˜“é…ç½®ã€æ˜“ç»´æŠ¤ æˆç†Ÿ Zuul2 é…ç½®æ–‡ä»¶ï¼Œé…ç½®é›†ç¾¤ã€å•æœåŠ¡å™¨é™æµã€Filteræ‰©å±• Filterå®ç° Filterå®ç° - - - OpenResty Lua Lua éœ€è¦å¼€å‘ ç®€å•æ˜“ç”¨ï¼Œä½†éœ€è¦Luaå¼€å‘ å¯ç»´æŠ¤æ€§å·® æˆç†Ÿ Kong æ ¹æ®æ—¶é—´ã€ç”¨æˆ·é™æµã€‚å¯åœ¨æºç åŸºç¡€ä¸Šå¼€å‘http://coding.idealworld.group/2021/05/26/reflections-of-middle-platform-api-gateway-selection/ æ™®é€šé‰´æƒã€OAuth2.0ã€Key Authã€HMAC ä¸ŠæŠ¥datadogï¼Œè®°å½•è¯·æ±‚æ•°é‡ã€æ•°æ®é‡ã€åº”ç­”æ•°æ®é‡ã€æ¥æ”¶å‘é€æ—¶é—´é—´éš”ã€çŠ¶æ€ç æ•°é‡ã€Kongå†…è€—æ—¶ ç®€å•æ˜“ç”¨ï¼ŒAPIè½¬å‘é€šè¿‡ç®¡ç†æ¥å£é…ç½®ã€‚éœ€è¦Luaå¼€å‘ ç»´æŠ¤éœ€è¦Lua æˆç†Ÿ Finally Kong nginx + luaï¼Œå¼€å‘ä¸å‹å¥½ ä»…æ”¯æŒPostgreSQLï¼Œå¢åŠ è¿ç»´æˆæœ¬ï¼Œå•ç‚¹æ•°æ®åº“ åœ¨ä¸ä¿®æ”¹æºç çš„æƒ…å†µä¸‹ï¼Œæ— æ³•è‡ªå®šä¹‰Nginxé…ç½®æ–‡ä»¶ï¼Œé‡å¯åé‡æ–°åˆå§‹åŒ–æ‰€æœ‰å˜æ›´çš„Nginxé…ç½®æ–‡ä»¶ Apisix nginx + luaï¼Œå¼€å‘ä¸å‹å¥½ å¾…æ£€éªŒ Zuul æ€§èƒ½å·®ï¼Œå·²æœ‰æ›¿ä»£å“ Zuul2 æ€§èƒ½å¥½ï¼Œä½† Sprintg Cloud æ²¡æœ‰å…¼å®¹è®¡åˆ’ï¼Œä¸ç›®å‰ä½¿ç”¨çš„æŠ€æœ¯æ ˆç»“åˆçš„ä¸æ˜¯å¾ˆå¥½ è¿˜ä¸å¤ªç¨³å®š Spring Cloud Gateway æ€§èƒ½æ¯”è¾ƒå¥½ï¼ˆnot bestï¼‰ ç»“è®º ç»¼åˆæ¯”è¾ƒä¸‹æ¥ï¼ŒSpring Cloud Gateway æ€§èƒ½å¥½ï¼Œä¹Ÿæ¯”è¾ƒæˆç†Ÿç¨³å®šï¼Œå¹¶ä¸”æ˜¯Springå…¨å®¶æ¡¶æˆå‘˜ï¼Œå’Œå½“å‰é¡¹ç›®æ˜¯ç”¨çš„æŠ€æœ¯æ ˆæ›´åŒ¹é…ã€‚)\nRef ref: The author of spring cloud gateway\u0026rsquo;s PPT\nref: What is api gateway\nref: Netflix blog: Zuul2\nref: Netflix blog: Optimizing the Netflix API\nref: Microservice Architecture\nref: ç™¾äº¿æµé‡å¾®æœåŠ¡ç½‘å…³çš„è®¾è®¡ä¸å®ç°\nref: ä¸­å°åæ€ï¼šäº‘åŸç”Ÿä¸‹APIç½‘å…³çš„é€‰æ‹©\nref: API ç½‘å…³ Apache APISIX å’Œ Kong çš„é€‰å‹å¯¹æ¯”\nref: APIç½‘å…³æ¶æ„ä¸æŠ€æœ¯é€‰å‹\nref: APIç½‘å…³ä»‹ç»åŠé€‰å‹(kong)\nref: APIç½‘å…³é€‰å‹è°ƒç ”\nref: å¾®æœåŠ¡ä¸‹çš„ç½‘å…³å¦‚ä½•é€‰æ‹©(æåˆ°äº†soul)\nref: API ç½‘å…³æ€§èƒ½æ¯”è¾ƒï¼šNGINX vs. ZUUL vs. Spring Cloud Gateway vs. Linkerd\nref: API ç½‘å…³é€‰å‹åŠåŒ…å« BFF çš„æ¶æ„è®¾è®¡\nref: 5ã€å¾®æœåŠ¡ç½‘å…³\nref: å¦‚ä½•è¯„ä»· spring cloud gateway? å¯¹æ¯” zuul2.0 ä¸»è¦çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆ?\nref: å¦‚ä½•é€‰æ‹©å’Œè®¾è®¡å¾®æœåŠ¡ç½‘å…³\nref: æœ‰äº† NGINX å’Œ Kongï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ Apache APISIX\nref: æµ…è°ˆ k8s ingress controller é€‰å‹\n","date":"2022-03-10T00:00:00Z","permalink":"https://MyLoveES.github.io/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B/","title":"ç½‘å…³é€‰å‹"},{"content":"1.Â æµ·é€‰ Nginxï¼ŒOpenrestyã€Apisixã€Kongã€Zuulã€Zuul2ã€Spring Cloud Gateway Nginxï¼ˆæ·˜æ±°ï¼‰ï¼šåŠŸèƒ½ä¸å¤Ÿä¸°å¯Œï¼Œä¸”å¼€å‘ä¸ä¾¿ï¼ˆéœ€æ±‚è‡ªå®šä¹‰ç»„ä»¶å¼€å‘æ—¶, éœ€è¦+Luaï¼‰ã€‚åº”ä½œä¸ºæµé‡ç½‘å…³ï¼Œè€ŒéAPIç½‘å…³ã€‚ OpenRestyï¼ˆæ·˜æ±°ï¼‰ï¼šNginx + Luaã€‚æ˜¯ä¸€ç§ä»Nginxæ‰©å±•å„ç§åŠŸèƒ½ã€æ’ä»¶çš„æ€è·¯ï¼ŒKongã€Apisixçš†åŸºäºæ­¤ï¼Œæˆ‘ä»¬æ²¡å¿…è¦ä»å®ƒå¼€å§‹æ‰‹åŠ¨å®ç°ã€‚ Kongï¼ˆæ·˜æ±°ï¼‰ï¼šOpenResty + Luaï¼ŒåŒæ ·å­˜åœ¨å¼€å‘ä¸ä¾¿çš„é—®é¢˜ã€‚å­˜å‚¨é‡‡ç”¨postgresqlã€‚å¯¹æ¯”æ¥çœ‹ï¼Œapisixå…¶å®æ˜¯æ›´ä¼˜é€‰ï¼ˆå›½äº§å‹å¥½ï¼Œæ€§èƒ½æ›´å¥½ï¼ŒåŠŸèƒ½ä¹Ÿæ›´ä¸°å¯Œï¼‰ã€‚ Zuulï¼ˆæ·˜æ±°ï¼‰ï¼šä¸Šä¸€ä»£äº§å“ï¼ŒåŸºäºBIOï¼Œæ€§èƒ½ä¸å¥½ã€‚å·²æœ‰æ›¿ä»£äº§ç‰© - Zuul2ã€Spring Cloud Gatewayã€‚ 2. å†³èµ›åœˆï¼šSpring Cloud Gatewayã€Zuul2ã€APISIX æˆ‘ä»¬çš„éœ€æ±‚ï¼š\nä¸å½“å‰æŠ€æœ¯æ ˆçš„é€‚é…ï¼ˆSpring Cloudã€Nacos ç­‰ï¼‰ åè®®è½¬æ¢ï¼ˆhttp â†’ rpc ç­‰ï¼‰ è·¯ç”± é™æµ è´Ÿè½½å‡è¡¡ ç†”æ–­ ç›‘æ§ auth å®‰å…¨ æœåŠ¡å‘ç° æ’ä»¶å¼€å‘ åŠ¨æ€è·¯ç”± æ€§èƒ½ï¼šApisix \u0026gt; Zuul2 â‰ˆ Spring Cloud Gateway 3. ç»“è®º é¦–å…ˆä»æˆç†Ÿåº¦æ¥çœ‹ï¼ŒZuul2çš„èµ„æ–™è¾ƒå°‘ï¼Œå¾ˆå¤šè¿˜æ˜¯åœç•™åœ¨Zuul1é˜¶æ®µã€‚åœ¨Zuul2å’ŒSpring Cloud GatewayåŒå±Javaå¼€å‘çš„æƒ…å†µä¸‹ï¼Œæ›´å€¾å‘äºSpringã€‚å› æ­¤ä¹‹åçš„æ¯”è¾ƒä¸»è¦å‘ç”Ÿåœ¨Spring Cloud Gatewayå’ŒAPISIXä¹‹é—´ã€‚\næ¯”è¾ƒæ¥çœ‹ï¼Œapisixä¼˜åŠ¿æ˜¯æ€§èƒ½æ›´å¥½ï¼ŒåŠŸèƒ½æ›´ä¸°å¯Œã€‚åŠ£åŠ¿æ˜¯å¼€å‘è¯­è¨€ä¸åŒ¹é…ï¼Œä¹‹åå¼€å‘ç»´æŠ¤å­¦ä¹ æˆæœ¬æ¯”è¾ƒé«˜ã€‚è€Œä¸”å¯¹äºnacosç›®å‰ä¹Ÿåªæ˜¯å®éªŒæ€§ï¼Œå¹¶ä¸å®Œå…¨æˆç†Ÿç¨³å®šã€‚é™¤æ­¤ä¹‹å¤–ï¼Œéœ€è¦etcdæ”¯æŒã€‚\nSpring Cloud Gatewayè™½æ€§èƒ½ç¨åŠ£ï¼Œä½†æŠ€æœ¯æ ˆåŒ¹é…ï¼ŒåæœŸå¼€å‘éš¾åº¦è¾ƒå°ã€‚å¹¶ä¸”ä¸å½“å‰ä½¿ç”¨çš„åŸºç¡€è®¾æ–½æ›´å¥‘åˆï¼Œèƒ½å¤Ÿçœå´ç»´æŠ¤æ–°çš„åŸºç¡€è®¾æ–½ç»„ä»¶çš„æˆæœ¬ã€‚å› æ­¤æœ€ç»ˆé€‰æ‹©Spring Cloud Gatewayä½œä¸ºAPIç½‘å…³ã€‚\nSpring Cloud Gateway(Java) https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 1.Â Spring å…¨å®¶æ¡¶æˆå‘˜ï¼šâœ“ 2. http \u0026gt; rpc: x 3. è·¯ç”± æä¾› Route Predicate: åŒ…å« Timeã€Cookieã€Headerã€Hostã€Methodã€Pathã€Queryã€RemoteAddrã€XForwarded Remote Addr https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-request-predicates-factories Filtersï¼šrequestã€responseã€oauth2ã€cache request https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gatewayfilter-factories 4. é™æµÂ redis - ä»¤ç‰Œæ¡¶ https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-requestratelimiter-gatewayfilter-factoryÂ 5. è´Ÿè½½å‡è¡¡ weight route: https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-weight-route-predicate-factory 6. ç†”æ–­(By status code / ) circuit breaker: https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#spring-cloud-circuitbreaker-filter-factory å¯ä»¥å°†é”™è¯¯ä¿¡æ¯å›è°ƒ 7. ç›‘æ§ Prometheus https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-gateway-metrics-filter 8. auth / security / æ’ä»¶å¼€å‘ ç­‰é€šè¿‡å„ç±»Filterå¯ä»¥å®ç° 11. æœåŠ¡å‘ç°ï¼šnacos / eureka 13. åŠ¨æ€è·¯ç”±ï¼šå¯é€šè¿‡ç›‘å¬nacos \u0026amp; ä»£ç æ›´æ–° Zuul2(Java) https://github.com/Netflix/zuul/wiki/Getting-Started-2.0\nsample: https://github.com/dashprateek/zuul2-sample\nhttps://github.com/csh0711/zuul-2-sample\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 1.SpringCloud ä¸å…¼å®¹Zuul2 2.http è½¬ rpc: x 3.è·¯ç”±: âœ“ 4.é™æµ: âœ“ https://github.com/Netflix/zuul/wiki/Core-Features#origin-concurrency-protection æ•´ä½“é™æµï¼šmax-requestsÂ Per serverï¼šMaxConnectionsPerHost If an origin exceeds overall concurrency or per-host concurrency, Zuul will return a 503 to the client. 5.è´Ÿè½½å‡è¡¡: âœ“ roundrobin(è½®è¯¢) https://github.com/Netflix/ribbon/wiki/Working-with-load-balancers#roundrobinrule AvailabilityFilteringRule(å¯ç”¨æ€§è¿‡æ»¤) https://github.com/Netflix/ribbon/wiki/Working-with-load-balancers#availabilityfilteringrule WeightedResponseTimeRule(æ ¹æ®å“åº”æ—¶é—´åŠ æƒé‡) https://github.com/Netflix/ribbon/wiki/Working-with-load-balancers#weightedresponsetimerule 6. ç†”æ–­ï¼ˆè‡ªå®šä¹‰ï¼‰: âœ“ https://www.javadoc.io/doc/org.springframework.cloud/spring-cloud-netflix-zuul/2.0.3.RELEASE/org/springframework/cloud/netflix/zuul/filters/route/FallbackProvider.html https://www.baeldung.com/spring-zuul-fallback-route 7.ç›‘æ§: prometheusã€StatsdÂ https://zuul-ci.org/docs/zuul/latest/monitoring.html 8.authã€å®‰å…¨: âœ“ 11. æœåŠ¡å‘ç°: âœ“ é™æ€é…ç½® /Â eureka 12.æ’ä»¶å¼€å‘: Java 13.æ•°æ®å­˜å‚¨: JPA / redis APISIX(OpenResty + Lua) https://apisix.apache.org/docs/apisix/getting-started\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 1.Nginx + Lua: x 2.æ”¯æŒrpc:Â âœ“ grpc:Â https://apisix.apache.org/zh/docs/apisix/plugins/grpc-transcode dubbo:Â https://apisix.apache.org/zh/docs/apisix/plugins/dubbo-proxy 3.è·¯ç”±:Â âœ“ 4.é™æµ: âœ“ limit-req:Â é™åˆ¶è¯·æ±‚é€Ÿåº¦çš„æ’ä»¶ï¼Œä½¿ç”¨çš„æ˜¯æ¼æ¡¶ç®—æ³•ã€‚https://apisix.apache.org/zh/docs/apisix/plugins/limit-req limit-conn:Â é™åˆ¶å¹¶å‘è¯·æ±‚ï¼ˆæˆ–å¹¶å‘è¿æ¥ï¼‰æ’ä»¶ã€‚https://apisix.apache.org/zh/docs/apisix/plugins/limit-conn limit-count:Â åœ¨æŒ‡å®šçš„æ—¶é—´èŒƒå›´å†…ï¼Œé™åˆ¶æ€»çš„è¯·æ±‚ä¸ªæ•°ã€‚å¹¶ä¸”åœ¨ HTTP å“åº”å¤´ä¸­è¿”å›å‰©ä½™å¯ä»¥è¯·æ±‚çš„ä¸ªæ•°ã€‚https://apisix.apache.org/zh/docs/apisix/plugins/limit-count 5.è´Ÿè½½å‡è¡¡: âœ“ ç­–ç•¥ï¼šchash(ä¸€è‡´æ€§hash)ï¼Œroundrobin(è½®è¯¢)ï¼Œpriorityï¼Œleast_conn(æœ€å°‘è¿æ¥æ•°)ï¼Œewma(æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡æ³•) https://github.com/apache/apisix/tree/master/apisix/balancer 6.ç†”æ–­ï¼ˆbackoffï¼‰:âœ“Â https://apisix.apache.org/zh/docs/apisix/plugins/api-breaker/ 7.ç›‘æ§: âœ“ prometheus:Â https://apisix.apache.org/zh/docs/apisix/plugins/prometheus/ zipkin:Â https://apisix.apache.org/zh/docs/apisix/plugins/zipkin skywalking:Â https://apisix.apache.org/zh/docs/apisix/plugins/skywalking node-status:Â https://apisix.apache.org/zh/docs/apisix/plugins/node-status datadog:Â https://apisix.apache.org/zh/docs/apisix/plugins/datadog 8.auth: âœ“ key-auth(k-v):Â https://apisix.apache.org/zh/docs/apisix/plugins/key-auth jwt-auth:Â https://apisix.apache.org/zh/docs/apisix/plugins/jwt-auth basic-auth:Â https://apisix.apache.org/zh/docs/apisix/plugins/basic-auth authz-keycloak:Â https://apisix.apache.org/zh/docs/apisix/plugins/authz-keycloak wolf-rbac: https://apisix.apache.org/zh/docs/apisix/plugins/wolf-rbac openid-connect:Â https://apisix.apache.org/zh/docs/apisix/plugins/openid-connect hmac-auth:Â https://apisix.apache.org/zh/docs/apisix/plugins/hmac-auth authz-casbin:Â https://apisix.apache.org/zh/docs/apisix/plugins/authz-casbin ldap-auth:Â https://apisix.apache.org/zh/docs/apisix/plugins/ldap-auth opa:Â https://apisix.apache.org/zh/docs/apisix/plugins/opa forward-auth:Â https://apisix.apache.org/zh/docs/apisix/plugins/forward-auth 9.å®‰å…¨: âœ“ cors:Â https://apisix.apache.org/zh/docs/apisix/plugins/cors uri-blocker: æŒ‡å®šblock_rulesï¼Œæ‹¦æˆªè¯·æ±‚Â https://apisix.apache.org/zh/docs/apisix/plugins/uri-blocker ip-restriction: ip é»‘ç™½åå•Â https://apisix.apache.org/zh/docs/apisix/plugins/ip-restriction ua-restriction: User-Agent é»‘ç™½åå•Â https://apisix.apache.org/zh/docs/apisix/plugins/ua-restriction referer-restriction: referer é»‘ç™½åå•Â https://apisix.apache.org/zh/docs/apisix/plugins/referer-restriction consumer-restriction: è‡ªå®šä¹‰Â https://apisix.apache.org/zh/docs/apisix/plugins/consumer-restriction 10.log:Â âœ“ http / skywalking / tcp / kafka / rocketmq / udp /Â Syslog / log-rotate / error-log-logger / sls-logger / google-cloud / splunk-hec 11.æœåŠ¡å‘ç°:Â âœ“ DNS consul_kv nacos(å®éªŒæ€§) eureka 12.æ’ä»¶å¼€å‘:Â âœ“ lua:Â https://apisix.apache.org/zh/docs/apisix/plugin-develop external plugin:Â java:Â https://apisix.apache.org/zh/docs/apisix/external-plugin go: https://apisix.apache.org/docs/go-plugin-runner/getting-started/ python:Â https://apisix.apache.org/docs/python-plugin-runner/getting-started/ 13.æ•°æ®å­˜å‚¨/åŠ¨æ€è·¯ç”±ï¼šetcd ç•ªå¤– å¯¹dubboé›†æˆ APISIX https://apisix.apache.org/zh/docs/apisix/plugins/dubbo-proxy/\nhttps://apisix.apache.org/zh/blog/2022/01/13/how-to-proxy-dubbo-in-apache-apisix/ dubbo-proxy æ’ä»¶å…è®¸å°† HTTP è¯·æ±‚ä»£ç†åˆ° dubboï¼Œä½†æ˜¯æœ‰æ‰€é™åˆ¶ï¼šå‚æ•°å’Œè¿”å›å€¼éƒ½å¿…é¡»è¦æ˜¯ Map\u0026lt;String, Object\u0026gt;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 curl http://127.0.0.1:9080/apisix/admin/upstreams/1 -H \u0026#39;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1\u0026#39; -X PUT -d \u0026#39; { \u0026#34;nodes\u0026#34;: { \u0026#34;127.0.0.1:20880\u0026#34;: 1 }, \u0026#34;type\u0026#34;: \u0026#34;roundrobin\u0026#34; }\u0026#39; curl http://127.0.0.1:9080/apisix/admin/routes/1 -H \u0026#39;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1\u0026#39; -X PUT -d \u0026#39; { \u0026#34;uris\u0026#34;: [ \u0026#34;/hello\u0026#34; ], \u0026#34;plugins\u0026#34;: { \u0026#34;dubbo-proxy\u0026#34;: { \u0026#34;service_name\u0026#34;: \u0026#34;org.apache.dubbo.sample.tengine.DemoService\u0026#34;, \u0026#34;service_version\u0026#34;: \u0026#34;0.0.0\u0026#34;, \u0026#34;method\u0026#34;: \u0026#34;tengineDubbo\u0026#34; } }, \u0026#34;upstream_id\u0026#34;: 1 }\u0026#39; å¦‚æœè¦æ»¡è¶³å¤æ‚åœºæ™¯ï¼Œéœ€è¦åœ¨æœåŠ¡ä¸­é¢å¤–å¢åŠ ä¸€ä¸ªHTTP TO DUBBOçš„serviceè¿›è¡Œå¤„ç†ã€‚é€šè¿‡ HTTP Request Body æè¿°è¦è°ƒç”¨çš„ Service å’Œ Method ä»¥åŠå¯¹åº”å‚æ•°ï¼Œå†åˆ©ç”¨ Java çš„åå°„æœºåˆ¶å®ç°ç›®æ ‡æ–¹æ³•çš„è°ƒç”¨ã€‚æœ€åå°†è¿”å›å€¼åºåˆ—åŒ–ä¸º JSONï¼Œå¹¶å†™å…¥åˆ° HTTP Response Body ä¸­.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 public class DubboInvocationParameter { private String type; private String value; } public class DubboInvocation { private String service; private String method; private DubboInvocationParameter[] parameters; } public interface HTTP2DubboService { Map\u0026lt;String, Object\u0026gt; invoke(Map\u0026lt;String, Object\u0026gt; context) throws Exception; } @Component public class HTTP2DubboServiceImpl implements HTTP2DubboService { @Autowired private ApplicationContext appContext; @Override public Map\u0026lt;String, Object\u0026gt; invoke(Map\u0026lt;String, Object\u0026gt; context) throws Exception { DubboInvocation invocation = JSONObject.parseObject((byte[]) context.get(\u0026#34;body\u0026#34;), DubboInvocation.class); Object[] args = new Object[invocation.getParameters().size()]; for (int i = 0; i \u0026lt; args.length; i++) { DubboInvocationParameter parameter = invocation.getParameters().get(i); args[i] = JSONObject.parseObject(parameter.getValue(), Class.forName(parameter.getType())); } Object svc = appContext.getBean(Class.forName(invocation.getService())); Object result = svc.getClass().getMethod(invocation.getMethod()).invoke(args); Map\u0026lt;String, Object\u0026gt; httpResponse = new HashMap\u0026lt;\u0026gt;(); httpResponse.put(\u0026#34;status\u0026#34;, 200); httpResponse.put(\u0026#34;body\u0026#34;, JSONObject.toJSONString(result)); return httpResponse; } } Spring Cloud Gateway https://www.cnblogs.com/zlt2000/p/13201326.html\nç”±äºSpringCloudGatewayä¸æ”¯æŒHttpåˆ°RPCåè®®çš„è½¬æ¢ï¼Œå› æ­¤éœ€è¦å¼•å…¥\u0026quot;web\u0026quot;å±‚æ¥ä½œhttpâ†’rpcã€‚æœ‰ä¸¤ç§å®ç°æ–¹å¼\né€šè¿‡webå±‚æ¥è½¬æ¢http â†’ rpc é€šè¿‡dubbo restæ‰¿æ¥http è‡ªå®šä¹‰authï¼ˆæ’ä»¶å¼€å‘ï¼‰ apisix: https://apisix.apache.org/zh/blog/2021/09/07/how-to-use-apisix-auth/ spring cloud gateway: preFilter\n","date":"2022-03-10T00:00:00Z","permalink":"https://MyLoveES.github.io/p/%E7%BD%91%E5%85%B3%E9%80%89%E5%9E%8B%E7%BB%86%E8%8A%82/","title":"ç½‘å…³é€‰å‹ç»†èŠ‚"},{"content":"èƒŒæ™¯ æœåŠ¡è¿è¡Œä¸èµ·æ¥ï¼Œps auxæŸ¥çœ‹stateå§‹ç»ˆå¤„åœ¨ Dl+ çŠ¶æ€\næŸ¥çœ‹dmesgæˆ–è€…cat /var/log/messagesï¼Œå‘ç° trap invalid opcode å’Œ segfault at. æŸ¥è¿‡åï¼Œå¯èƒ½æ˜¯æŒ‡ä»¤é›†é—®é¢˜ã€‚\nè§£é‡Š ip:c14490 sp:7f975324f790 error:0 in xxxx[400000+53a3d000]\nå…¶ä¸­ï¼Œ\nip: æŒ‡ä»¤(å†…å­˜)æŒ‡é’ˆ sp: å †æ ˆæŒ‡é’ˆåœ°å€ï¼ˆæ ˆé¡¶æŒ‡é’ˆï¼‰ [xxxx+yyyy] : è™šæ‹Ÿå†…å­˜èµ·å§‹åœ°å€ã€å¤§å° error number: 4 -\u0026gt; 100 bit2: å€¼ä¸º1è¡¨ç¤ºæ˜¯ç”¨æˆ·æ€ç¨‹åºå†…å­˜è®¿é—®è¶Šç•Œï¼Œå€¼ä¸º0è¡¨ç¤ºæ˜¯å†…æ ¸æ€ç¨‹åºå†…å­˜è®¿é—®è¶Šç•Œ\nbit1: å€¼ä¸º1è¡¨ç¤ºæ˜¯å†™æ“ä½œå¯¼è‡´å†…å­˜è®¿é—®è¶Šç•Œï¼Œå€¼ä¸º0è¡¨ç¤ºæ˜¯è¯»æ“ä½œå¯¼è‡´å†…å­˜è®¿é—®è¶Šç•Œ\nbit0: å€¼ä¸º1è¡¨ç¤ºæ²¡æœ‰è¶³å¤Ÿçš„æƒé™è®¿é—®éæ³•åœ°å€çš„å†…å®¹ï¼Œå€¼ä¸º0è¡¨ç¤ºè®¿é—®çš„éæ³•åœ°å€æ ¹æœ¬æ²¡æœ‰å¯¹åº”çš„é¡µé¢ï¼Œä¹Ÿå°±æ˜¯æ— æ•ˆåœ°å€\nå‡ºé”™åœ°å€ï¼š 0xc14490 - 0x400000 = 0x814490\nåæ±‡ç¼–ï¼Œæ‰§è¡Œ(å¾ˆä¸å¹¸ï¼Œæˆ‘åç¼–è¯‘å¤±è´¥äº†)\n1 objdump -D xxxx \u0026gt; obj æ£€ç´¢ 0814490 å°è¯•åœ¨è€CPUä¸Šé‡æ–°ç¼–è¯‘ï¼Œè¿è¡Œæ— é”™ã€‚\nref: https://blog.csdn.net/wangtingting_100/article/details/83749504\nref: https://stackoverflow.com/questions/2549214/interpreting-segfault-messages\nref: https://utcc.utoronto.ca/~cks/space/blog/linux/KernelSegfaultMessageMeaning\nè´´ä¸€ä¸‹ starkoverflow ä¸Šçš„æ“ä½œ If this were a program, not a shared library Run addr2line -e yourSegfaultingProgram c14490 (and repeat for the other instruction pointer valUes given) to see where the error is happening. Better, get a debug-instrumented build, and reproduce the problem under a debugger such as gdb.\nSince it\u0026rsquo;s a shared library You\u0026rsquo;re hosed, unfortunately; it\u0026rsquo;s not possible to know where the libraries were placed in memory by the dynamic linker after-the-fact. Reproduce the problem under gdb.\nWhat the error means Here\u0026rsquo;s the breakdown of the fields:\naddress (after the at) - the location in memory the code is trying to access (it\u0026rsquo;s likely that c14490 are offsets from a pointer we expect to be set to a valid value but which is instead pointing to 0) ip - instruction pointer, ie. where the code which is trying to do this lives (æŒ‡ä»¤æŒ‡é’ˆï¼Œå³å°è¯•æ‰§è¡Œæ­¤æ“ä½œçš„ä»£ç æ‰€åœ¨çš„ä½ç½®) sp - stack pointer (å †æ ˆæŒ‡é’ˆ) error - An error code for page faults; see below for what this means on x86 link. 1 2 3 4 5 6 7 8 9 10 11 /* * Page fault error code bits: * * bit 0 == 0: no page found 1: protection fault * bit 1 == 0: read access 1: write access * bit 2 == 0: kernel-mode access 1: user-mode access * bit 3 == 1: use of reserved bit detected * bit 4 == 1: fault was an instruction fetch * bit 5 == 1: protection keys block access * bit 15 == 1: SGX MMU page-fault */ è´´å¦ä¸€ä¸ªblogï¼Œæ›´è¯¦å°½çš„è§£é‡Š What the Linux kernel\u0026rsquo;s messages about segfaulting programs mean on 64-bit x86 For quite a while the Linux kernel has had an option to log a kernel message about every faulting user program, and it probably defaults to on in your Linux distribution. I\u0026rsquo;ve seen these messages fly by for years, but for reasons beyond the scope of this entry I\u0026rsquo;ve recently wanted to understand what they mean in some moderate amount of detail.\nå¾ˆé•¿ä¸€æ®µæ—¶é—´ä»¥æ¥ï¼ŒLinux å†…æ ¸éƒ½æœ‰ä¸€ä¸ªé€‰é¡¹æ¥è®°å½•æœ‰å…³æ¯ä¸ªé”™è¯¯ç”¨æˆ·ç¨‹åºçš„å†…æ ¸æ¶ˆæ¯ï¼Œå¹¶ä¸”å®ƒå¯èƒ½åœ¨æ‚¨çš„ Linux å‘è¡Œç‰ˆä¸­é»˜è®¤ä¸ºå¼€å¯ã€‚å¤šå¹´æ¥ï¼Œæˆ‘ä¸€ç›´çœ‹åˆ°è¿™äº›æ¶ˆæ¯é£æ¥é£å»ï¼Œä½†ç”±äºè¶…å‡ºæœ¬æ–‡èŒƒå›´çš„åŸå› ï¼Œæˆ‘æœ€è¿‘æƒ³ä»¥é€‚åº¦çš„ç»†èŠ‚äº†è§£å®ƒä»¬çš„å«ä¹‰ã€‚\nI\u0026rsquo;ll start with a straightforward and typical example, one that I see every time I build and test Go (as this is a test case that is supposed to crash):\næˆ‘å°†ä»ä¸€ä¸ªç®€å•è€Œå…¸å‹çš„ç¤ºä¾‹å¼€å§‹ï¼Œæˆ‘æ¯æ¬¡æ„å»ºå’Œæµ‹è¯• Go æ—¶éƒ½ä¼šçœ‹åˆ°è¿™ä¸ªç¤ºä¾‹ï¼ˆå› ä¸ºè¿™æ˜¯ä¸€ä¸ªåº”è¯¥å´©æºƒçš„æµ‹è¯•ç”¨ä¾‹ï¼‰ï¼š\n1 testp[19288]: segfault at 0 ip 0000000000401271 sp 00007fff2ce4d210 error 4 in testp[400000+98000] The meaning of this is:\n\u0026rsquo;testp[19288]\u0026rsquo; is the faulting program and its PID \u0026lsquo;segfault at 0\u0026rsquo; tells us the memory address (in hex) that caused the segfault when the program tried to access it. Here the address is 0, so we have a null dereference of some sort.(å‘Šè¯‰æˆ‘ä»¬å½“ç¨‹åºè¯•å›¾è®¿é—®å®ƒæ—¶å¯¼è‡´æ®µé”™è¯¯çš„å†…å­˜åœ°å€ï¼ˆåå…­è¿›åˆ¶ï¼‰ã€‚è¿™é‡Œçš„åœ°å€æ˜¯ 0ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰æŸç§ç±»å‹çš„ç©ºè§£å¼•ç”¨ã€‚) \u0026lsquo;ip 0000000000401271\u0026rsquo; is the value of the instruction pointer at the time of the fault. This should be the instruction that attempted to do the invalid memory access. In 64-bit x86, this will be register %rip (useful for inspecting things in GDB and elsewhere).(æ˜¯æ•…éšœæ—¶æŒ‡ä»¤æŒ‡é’ˆçš„å€¼ã€‚è¿™åº”è¯¥æ˜¯è¯•å›¾è¿›è¡Œæ— æ•ˆå†…å­˜è®¿é—®çš„æŒ‡ä»¤ã€‚åœ¨ 64 ä½ x86 ä¸­ï¼Œè¿™å°†æ˜¯å¯„å­˜å™¨ %ripï¼ˆç”¨äºæ£€æŸ¥ GDB å’Œå…¶ä»–åœ°æ–¹çš„å†…å®¹ï¼‰) \u0026lsquo;sp 00007fff2ce4d210\u0026rsquo; is the value of the stack pointer. In 64-bit x86, this will be %rsp.(æ˜¯å †æ ˆæŒ‡é’ˆçš„å€¼ã€‚åœ¨ 64 ä½ x86 ä¸­ï¼Œè¿™å°†æ˜¯ %rspã€‚)(æ˜¯æ¥è‡ªtraps.herror 4çš„åå…­è¿›åˆ¶é¡µé¢é”™è¯¯ä»£ç ä½ ï¼Œå’Œå¾€å¸¸ä¸€æ ·ï¼Œå‡ ä¹æ€»æ˜¯è‡³å°‘ä¸º 4ï¼ˆè¿™æ„å‘³ç€â€œç”¨æˆ·æ¨¡å¼è®¿é—®â€ï¼‰ã€‚å€¼ 4 è¡¨ç¤ºè¯»å–æœªæ˜ å°„åŒºåŸŸï¼Œä¾‹å¦‚åœ°å€ 0ï¼Œè€Œå€¼ 6 (4+2) è¡¨ç¤ºå†™å…¥æœªæ˜ å°„åŒºåŸŸ) \u0026rsquo;error 4\u0026rsquo; is the page fault error code bits from traps.h in hex, as usual, and will almost always be at least 4 (which means \u0026lsquo;user-mode access\u0026rsquo;). A value of 4 means it was a read of an unmapped area, such as address 0, while a value of 6 (4+2) means it was a write of an unmapped area. \u0026lsquo;in testp[400000+98000]\u0026rsquo; tells us the specific virtual memory area that the instruction pointer is in, specifying which file it is (here it\u0026rsquo;s the executable), the starting address that VMA is mapped at (0x400000), and the size of the mapping (0x98000).(å‘Šè¯‰æˆ‘ä»¬æŒ‡ä»¤æŒ‡é’ˆæ‰€åœ¨çš„ç‰¹å®šè™šæ‹Ÿå†…å­˜åŒºåŸŸï¼ŒæŒ‡å®šå®ƒæ˜¯å“ªä¸ªæ–‡ä»¶ï¼ˆè¿™é‡Œæ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼‰ï¼ŒVMA æ˜ å°„çš„èµ·å§‹åœ°å€ï¼ˆ0x400000ï¼‰ï¼Œä»¥åŠæ˜ å°„çš„å¤§å°ï¼ˆ0x98000ï¼‰) With a faulting address of 0 and an error code of 4, we know this particular segfault is a read of a null pointer.\né”™è¯¯åœ°å€ä¸º 0ï¼Œé”™è¯¯ä»£ç ä¸º 4ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªç‰¹å®šçš„æ®µé”™è¯¯æ˜¯å¯¹ç©ºæŒ‡é’ˆçš„è¯»å–ã€‚\nHere\u0026rsquo;s two more error messages:\n1 bash[12235]: segfault at 1054808 ip 000000000041d989 sp 00007ffec1f1cbd8 error 6 in bash[400000+f4000] \u0026lsquo;Error 6\u0026rsquo; means a write to an unmapped user address, here 0x1054808. â€œé”™è¯¯ 6â€è¡¨ç¤ºå†™å…¥æœªæ˜ å°„çš„ç”¨æˆ·åœ°å€ï¼Œæ­¤å¤„ä¸º 0x1054808ã€‚\n1 bash[11909]: segfault at 0 ip 00007f83c03db746 sp 00007ffccbeda010 error 4 in libc-2.23.so[7f83c0350000+1c0000] Error 4 and address 0 is a null pointer read but this time it\u0026rsquo;s in some libc function, not in bash\u0026rsquo;s own code, since it\u0026rsquo;s reported as \u0026lsquo;in libc-2.23.so[\u0026hellip;]\u0026rsquo;. Since I looked at the core dump, I can tell you that this was in strlen().\né”™è¯¯ 4 å’Œåœ°å€ 0 æ˜¯è¯»å–çš„ç©ºæŒ‡é’ˆï¼Œä½†è¿™æ¬¡æ˜¯åœ¨æŸä¸ª libc å‡½æ•°ä¸­ï¼Œè€Œä¸æ˜¯åœ¨ bash è‡ªå·±çš„ä»£ç ä¸­ï¼Œå› ä¸ºå®ƒè¢«æŠ¥å‘Šä¸ºâ€œåœ¨ libc-2.23.so[\u0026hellip;]â€ä¸­ã€‚ç”±äºæˆ‘æŸ¥çœ‹äº†æ ¸å¿ƒè½¬å‚¨ï¼Œæˆ‘å¯ä»¥å‘Šè¯‰ä½ è¿™æ˜¯åœ¨strlen().\nOn 64-bit x86 Linux, you\u0026rsquo;ll get a somewhat different message if the problem is actually with the instruction being executed, not the address it\u0026rsquo;s referencing. For example: åœ¨ 64 ä½ x86 Linux ä¸Šï¼Œå¦‚æœé—®é¢˜å®é™…ä¸Šå‡ºåœ¨æ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤ä¸Šï¼Œè€Œä¸æ˜¯å®ƒæ‰€å¼•ç”¨çš„åœ°å€ä¸Šï¼Œé‚£ä¹ˆæ‚¨å°†æ”¶åˆ°ä¸€æ¡ç¨å¾®ä¸åŒçš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼š\n1 bash[2848] trap invalid opcode ip:48db90 sp:7ffddc8879e8 error:0 in bash[400000+f4000] There are a number of such trap types set up in traps.c. Two notable additional ones are \u0026lsquo;divide error\u0026rsquo;, which you get if you do an integer division by zero, and \u0026lsquo;general protection\u0026rsquo;, which you can get for certain extremely wild pointers (one case I know of is when your 64-bit x86 address is not in \u0026lsquo;canonical form\u0026rsquo;). Although these fields are formatted slightly differently, most of them mean the same thing as in segfaults. The exception is \u0026rsquo;error:0\u0026rsquo;, which is not a page fault error code. I don\u0026rsquo;t understand the relevant kernel code enough to know what it means, but if I\u0026rsquo;m reading between the lines correctly in entry_64.txt, then it\u0026rsquo;s either 0 (the usual case) or an error code from the CPU. Here is one possible list of exceptions that get error codes. åœ¨traps.cä¸­è®¾ç½®äº†è®¸å¤šæ­¤ç±»é™·é˜±ç±»å‹ã€‚ä¸¤ä¸ªå€¼å¾—æ³¨æ„çš„é™„åŠ é”™è¯¯æ˜¯â€œé™¤æ³•é”™è¯¯â€ï¼Œå¦‚æœä½ å°†æ•´æ•°é™¤ä»¥é›¶ï¼Œä½ ä¼šå¾—åˆ°å®ƒï¼Œä»¥åŠâ€œä¸€èˆ¬ä¿æŠ¤â€ï¼Œä½ å¯ä»¥å¾—åˆ°æŸäº›éå¸¸ç‹‚é‡çš„æŒ‡é’ˆï¼ˆæˆ‘çŸ¥é“çš„ä¸€ç§æƒ…å†µæ˜¯å½“ä½ çš„ 64 ä½ x86åœ°å€ä¸æ˜¯â€œè§„èŒƒå½¢å¼â€ï¼‰ã€‚å°½ç®¡è¿™äº›å­—æ®µçš„æ ¼å¼ç•¥æœ‰ä¸åŒï¼Œä½†å®ƒä»¬ä¸­çš„å¤§å¤šæ•°ä¸æ®µé”™è¯¯ä¸­çš„å«ä¹‰ç›¸åŒã€‚ä¾‹å¤–æ˜¯â€œ error:0â€ï¼Œå®ƒä¸æ˜¯é¡µé¢é”™è¯¯é”™è¯¯ä»£ç ã€‚æˆ‘å¯¹ç›¸å…³å†…æ ¸ä»£ç çš„ç†è§£ä¸è¶³ä»¥çŸ¥é“å®ƒçš„å«ä¹‰ï¼Œä½†æ˜¯å¦‚æœæˆ‘åœ¨entry_64.txtä¸­çš„è¡Œä¹‹é—´æ­£ç¡®è¯»å–ï¼Œé‚£ä¹ˆå®ƒè¦ä¹ˆæ˜¯ 0ï¼ˆé€šå¸¸æƒ…å†µï¼‰ï¼Œè¦ä¹ˆæ˜¯æ¥è‡ª CPU çš„é”™è¯¯ä»£ç ã€‚è¿™é‡Œæ˜¯è·å–é”™è¯¯ä»£ç çš„ä¸€ä¸ªå¯èƒ½çš„å¼‚å¸¸åˆ—è¡¨ã€‚\nSometimes these messages can be a little bit unusual and surprising. Here is a silly sample program and the error it produces when run. The code: æœ‰æ—¶è¿™äº›æ¶ˆæ¯å¯èƒ½æœ‰ç‚¹ä¸å¯»å¸¸å’Œä»¤äººæƒŠè®¶ã€‚è¿™æ˜¯ä¸€ä¸ªæ„šè ¢çš„ç¤ºä¾‹ç¨‹åºä»¥åŠå®ƒåœ¨è¿è¡Œæ—¶äº§ç”Ÿçš„é”™è¯¯ã€‚ä»£ç ï¼š\n1 2 3 4 5 6 #include \u0026lt;stdio.h\u0026gt; int main(int argc, char **argv) { int (*p)(); p = 0x0; return printf(\u0026#34;%d\\n\u0026#34;, (*p)()); } If compiled (without optimization is best) and run, this generates the kernel message: å¦‚æœç¼–è¯‘ï¼ˆæœ€å¥½æ²¡æœ‰ä¼˜åŒ–ï¼‰å¹¶è¿è¡Œï¼Œè¿™ä¼šç”Ÿæˆå†…æ ¸æ¶ˆæ¯ï¼š\n1 a.out[3714]: segfault at 0 ip (null) sp 00007ffe872aa418 error 14 in a.out[400000+1000] The \u0026lsquo;(null)\u0026rsquo; bit turns out to be expected; it\u0026rsquo;s what the general kernel printf() function generates when asked to print something as a pointer and it\u0026rsquo;s null (as seen here). In our case the instruction pointer is 0 (null) because we\u0026rsquo;ve made a subroutine call through a null pointer and thus we\u0026rsquo;re trying to execute code at address 0. I don\u0026rsquo;t know why the \u0026lsquo;in \u0026hellip;\u0026rsquo; portion says that we\u0026rsquo;re in the executable (although in this case the call actually was there).\nThe error code of 14 is in hex, which means that as bits it\u0026rsquo;s 010100. This is a user mode read of an unmapped area (our usual \u0026lsquo;4\u0026rsquo; case), but it\u0026rsquo;s an instruction fetch, not a normal data read or write. Any error 14s are a sign of some form of mangled function call or a return to a mangled address because the stack has been mashed.\n\u0026rsquo; (null)\u0026rsquo; ä½æ˜¯é¢„æœŸçš„ï¼›è¿™æ˜¯ä¸€èˆ¬å†…æ ¸ printf() å‡½æ•°åœ¨è¢«è¦æ±‚å°†æŸäº›å†…å®¹ä½œä¸ºæŒ‡é’ˆæ‰“å°å¹¶ä¸”å®ƒä¸º null æ—¶ç”Ÿæˆçš„å†…å®¹ï¼ˆå¦‚æ­¤å¤„æ‰€ç¤ºï¼‰ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ŒæŒ‡ä»¤æŒ‡é’ˆä¸º 0ï¼ˆç©ºï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬é€šè¿‡ç©ºæŒ‡é’ˆè¿›è¡Œäº†å­ç¨‹åºè°ƒç”¨ï¼Œå› æ­¤æˆ‘ä»¬è¯•å›¾åœ¨åœ°å€ 0 å¤„æ‰§è¡Œä»£ç ã€‚æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆâ€œin \u0026hellip;â€éƒ¨åˆ†è¡¨ç¤ºæˆ‘ä»¬åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼ˆå°½ç®¡åœ¨è¿™ç§æƒ…å†µä¸‹è°ƒç”¨å®é™…ä¸Šåœ¨é‚£é‡Œï¼‰ã€‚\né”™è¯¯ä»£ç  14 æ˜¯åå…­è¿›åˆ¶çš„ï¼Œè¿™æ„å‘³ç€å®ƒçš„ä½æ˜¯ 010100ã€‚è¿™æ˜¯å¯¹æœªæ˜ å°„åŒºåŸŸçš„ç”¨æˆ·æ¨¡å¼è¯»å–ï¼ˆæˆ‘ä»¬é€šå¸¸çš„â€œ4â€æƒ…å†µï¼‰ï¼Œä½†å®ƒæ˜¯æŒ‡ä»¤è·å–ï¼Œè€Œä¸æ˜¯æ­£å¸¸çš„æ•°æ®è¯»å–æˆ–å†™å…¥ã€‚ä»»ä½•é”™è¯¯ 14s éƒ½æ˜¯æŸç§å½¢å¼çš„å‡½æ•°è°ƒç”¨é”™è¯¯æˆ–è¿”å›åˆ°é”™è¯¯åœ°å€çš„æ ‡å¿—ï¼Œå› ä¸ºå †æ ˆå·²è¢«æ··åˆã€‚\n(These bits turn out to come straight from the CPU\u0026rsquo;s page fault IDT.) .\nFor 64-bit x86 Linux kernels (and possibly for 32-bit x86 ones as well), the code you want to look at is show_signal_msg in fault.c, which prints the general \u0026lsquo;segfault at ..\u0026rsquo; message, do_trap and do_general_protection in traps.c, which print the \u0026rsquo;trap \u0026hellip;\u0026rsquo; messages, and print_vma_addr in memory.c, which prints the \u0026lsquo;in \u0026hellip;\u0026rsquo; portion for all of these messages.\nSidebar: The various error code bits as numbers +1 protection fault in a mapped area (eg writing to a read-only mapping) æ˜ å°„åŒºåŸŸä¸­çš„ä¿æŠ¤æ•…éšœï¼ˆä¾‹å¦‚å†™å…¥åªè¯»æ˜ å°„ï¼‰ +2 write (instead of a read) +4 user mode access (instead of kernel mode access) +8 use of reserved bits in the page table entry detected (the kernel will panic if this happens) use of reserved bits in the page table entry detected (the kernel will panic if this happens) +16 (+0x10) fault was an instruction fetch, not data read or write +32 (+0x20) \u0026lsquo;protection keys block access\u0026rsquo; (don\u0026rsquo;t ask me) Hex 0x14 is 0x10 + 4; (hex) 6 is 4 + 2. Error code 7 (0x7) is 4 + 2 + 1, a user-mode write to a read-only mapping, and is what you get if you attempt to write to a string constant in C:\n1 2 3 4 char *ex = \u0026#34;example\u0026#34;; int main(int argc, char **argv) { *ex = \u0026#39;E\u0026#39;; } Compile and run this and you will get:\n1 a.out[8832]: segfault at 400540 ip 0000000000400499 sp 00007ffce6831490 error 7 in a.out[400000+1000] It appears that the program code always gets loaded at 0x400000 for ordinary programs, although I believe that shared libraries can have their location randomized.\nPS: Per a comment in the kernel source, all accesses to addresses above the end of user space will be labeled as \u0026lsquo;protection fault in a mapped area\u0026rsquo; whether or not there are actual page table entries there. The kernel does this so you can\u0026rsquo;t work out where its memory pages are by looking at the error code.\n(I believe that user space normally ends around 0x07fffffffffff, per mm.txt, although see the comments about TASK_SIZE_MAX in processor.h and also page_64_types.h.) .\n","date":"2022-03-07T00:00:00Z","permalink":"https://MyLoveES.github.io/p/linux-avx512-%E9%80%A0%E6%88%90%E7%A8%8B%E5%BA%8F-crash/","title":"Linux - AVX512 é€ æˆç¨‹åº crash"},{"content":"è‡ªå®šä¹‰å¼‚å¸¸ ç®€åŒ– / è‡ªå®šä¹‰æ‰“å°ç»“æœ 1 2 3 4 5 6 @Override public synchronized Throwable fillInStackTrace() { return this; } com.demo.test.xxxx.custom.exception.SimpleException: è‡ªå®šä¹‰å¼‚å¸¸ ","date":"2022-02-23T17:52:13Z","permalink":"https://MyLoveES.github.io/p/customized-java-exception/","title":"Customized Java Exception"},{"content":"Docker Image nmtan/chevereto\nEnvironment variables The most essentials environments variables are listed below\nCHEVERETO_DB_HOST - Hostname of the Database machine that you wish to connect, default to db CHEVERETO_DB_PORT - The port of the Database machine to connect to, default to 3306 CHEVERETO_DB_USERNAME - Username to authenticate to MySQL database, default to chevereto CHEVERETO_DB_PASSWORD - Password of the user when connect to MySQL database, default to chevereto CHEVERETO_DB_NAME - Name of the database in MySQL server, default to chevereto CHEVERETO_DB_PREFIX - Table prefix (you can use this to run multiple instance of Chevereto using the same Database), default to chv_ For other environment variables, please consult the file settings.php and the section \u0026ldquo;Advanced configuration\u0026rdquo; below.\nPersistent storage Chevereto stores images uploaded by users in /var/www/html/images directory within the container.\nYou can mount a data volume at this location to ensure that you don\u0026rsquo;t lose your images if you relaunch/remove container.\nMax image size By default, PHP allow a maximum file upload to be 2MB. You can change such behaviour by updating the php.ini in your container, either by bind-mount the file, or build a new image with the updated file, that way you can reuse the image on demand.\nNote that by default, Chevereto set a file upload limit of 10MB, so after you modify your php.ini, you should also update this settings in Chevereto settings page (available at CHEVERETO_URL/dashboard/settings/image-upload)\nThe customized php.ini should set the values of upload_max_filesize, post_max_size and potentially memory_limit, as showed in the discussion from Chevereto Forum. Further details on these parameters are available from PHP documentation\nAn example of this is available in the examples/bigger-files directory\nStandalone 1 2 3 4 5 6 7 8 9 10 docker run -it --name chevereto -d \\ --link mysql:mysql \\ -p 80:80 \\ -v \u0026#34;$PWD/images\u0026#34;:/var/www/html/images \\ -e \u0026#34;CHEVERETO_DB_HOST=db\u0026#34; \\ -e \u0026#34;CHEVERETO_DB_USERNAME=chevereto\u0026#34; \\ -e \u0026#34;CHEVERETO_DB_PASSWORD=chevereto\u0026#34; \\ -e \u0026#34;CHEVERETO_DB_NAME=chevereto\u0026#34; \\ -e \u0026#34;CHEVERETO_DB_PREFIX=chv_\u0026#34; \\ nmtan/chevereto docker-compose 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 version: \u0026#39;3\u0026#39; services: db: image: mariadb container_name: chevereto_mariadb volumes: - ./database:/var/lib/mysql:rw restart: always environment: MYSQL_ROOT_PASSWORD: chevereto_root MYSQL_DATABASE: chevereto MYSQL_USER: chevereto MYSQL_PASSWORD: chevereto networks: - docker_default - docker_public chevereto: depends_on: - db image: nmtan/chevereto restart: always container_name: chevereto environment: CHEVERETO_DB_HOST: db CHEVERETO_DB_USERNAME: chevereto CHEVERETO_DB_PASSWORD: chevereto CHEVERETO_DB_NAME: chevereto CHEVERETO_DB_PREFIX: chv_ volumes: - ./images:/var/www/html/images:rw - ./php.ini:/usr/local/etc/php/php.ini:rw ports: - 8081:80 networks: - docker_default - docker_public networks: docker_default: external: true docker_public: external: true Nginx (ä½¿ç”¨äº†bitwardençš„nginx) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 upstream chevereto { server chevereto:80; } server { listen 8080 default_server; listen [::]:8080 default_server; server_name chevereto.weasley.cn; proxy_set_header X-Forwarded-For $remote_addr; location / { proxy_set_header Host $host; proxy_pass http://chevereto; client_max_body_size 256m; } } php.ini 1 2 3 4 5 [PHP] max_execution_time = 60; memory_limit = 256M; upload_max_filesize = 256M; post_max_size = 256M; ","date":"2022-02-15T00:00:00Z","permalink":"https://MyLoveES.github.io/p/install-and-deploy-chevereto-linux/","title":"Install and deploy Chevereto - Linux"},{"content":"äº‘æœåŠ¡å™¨å®‰è£… bitwarden å®˜æ–¹æ–‡æ¡£ Install and Deploy - Linux åˆ›å»ºbitwardenæœ¬åœ°ç”¨æˆ·å’Œç›®å½•ï¼ˆSKIPï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 1. Create a bitwarden user: sudo adduser bitwarden 2. Set password for bitwarden user (strong password): sudo passwd bitwarden 3. Create a docker group (if it doesnâ€™t already exist): sudo groupadd docker 4. Add the bitwarden user to the docker group: sudo usermod -aG docker bitwarden 5. Create a bitwarden directory: sudo mkdir /opt/bitwarden 6. Set permissions for the /opt/bitwarden directory: sudo chmod -R 700 /opt/bitwarden 7. Set the bitwarden user ownership of the /opt/bitwarden directory: sudo chown -R bitwarden:bitwarden /opt/bitwarden å®‰è£… 1. Download the Bitwarden installation script (bitwarden.sh) to your machine: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 curl -Lso bitwarden.sh https://go.btwrdn.co/bw-sh \u0026amp;\u0026amp; chmod 700 bitwarden.sh å…¨æ–‡ï¼š #!/usr/bin/env bash set -e cat \u0026lt;\u0026lt; \u0026#34;EOF\u0026#34; _ _ _ _ | |__ (_) |___ ____ _ _ __ __| | ___ _ __ | \u0026#39;_ \\| | __\\ \\ /\\ / / _` | \u0026#39;__/ _` |/ _ \\ \u0026#39;_ \\ | |_) | | |_ \\ V V / (_| | | | (_| | __/ | | | |_.__/|_|\\__| \\_/\\_/ \\__,_|_| \\__,_|\\___|_| |_| EOF cat \u0026lt;\u0026lt; EOF Open source password management solutions Copyright 2015-$(date +\u0026#39;%Y\u0026#39;), 8bit Solutions LLC https://bitwarden.com, https://github.com/bitwarden =================================================== EOF # Setup DIR=\u0026#34;$( cd \u0026#34;$( dirname \u0026#34;${BASH_SOURCE[0]}\u0026#34; )\u0026#34; \u0026amp;\u0026amp; pwd )\u0026#34; SCRIPT_NAME=$(basename \u0026#34;$0\u0026#34;) SCRIPT_PATH=\u0026#34;$DIR/$SCRIPT_NAME\u0026#34; OUTPUT=\u0026#34;$DIR/bwdata\u0026#34; if [ $# -eq 2 ] then OUTPUT=$2 fi SCRIPTS_DIR=\u0026#34;$OUTPUT/scripts\u0026#34; GITHUB_BASE_URL=\u0026#34;https://raw.githubusercontent.com/bitwarden/server/master\u0026#34; # Please do not create pull requests modifying the version numbers. COREVERSION=\u0026#34;1.45.2\u0026#34; WEBVERSION=\u0026#34;2.25.0\u0026#34; KEYCONNECTORVERSION=\u0026#34;1.0.0\u0026#34; echo \u0026#34;bitwarden.sh version $COREVERSION\u0026#34; docker --version docker-compose --version echo \u0026#34;\u0026#34; # Functions function downloadSelf() { if curl -s -w \u0026#34;http_code %{http_code}\u0026#34; -o $SCRIPT_PATH.1 $GITHUB_BASE_URL/scripts/bitwarden.sh | grep -q \u0026#34;^http_code 20[0-9]\u0026#34; then mv $SCRIPT_PATH.1 $SCRIPT_PATH chmod u+x $SCRIPT_PATH else rm -f $SCRIPT_PATH.1 fi } function downloadRunFile() { if [ ! -d \u0026#34;$SCRIPTS_DIR\u0026#34; ] then mkdir $SCRIPTS_DIR fi curl -s -o $SCRIPTS_DIR/run.sh $GITHUB_BASE_URL/scripts/run.sh chmod u+x $SCRIPTS_DIR/run.sh rm -f $SCRIPTS_DIR/install.sh } function checkOutputDirExists() { if [ ! -d \u0026#34;$OUTPUT\u0026#34; ] then echo \u0026#34;Cannot find a Bitwarden installation at $OUTPUT.\u0026#34; exit 1 fi } function checkOutputDirNotExists() { if [ -d \u0026#34;$OUTPUT/docker\u0026#34; ] then echo \u0026#34;Looks like Bitwarden is already installed at $OUTPUT.\u0026#34; exit 1 fi } function listCommands() { cat \u0026lt;\u0026lt; EOT Available commands: install start restart stop update updatedb updaterun updateself updateconf renewcert rebuild help See more at https://bitwarden.com/help/article/install-on-premise/#script-commands-reference EOT } # Commands case $1 in \u0026#34;install\u0026#34;) checkOutputDirNotExists mkdir -p $OUTPUT downloadRunFile $SCRIPTS_DIR/run.sh install $OUTPUT $COREVERSION $WEBVERSION $KEYCONNECTORVERSION ;; \u0026#34;start\u0026#34; | \u0026#34;restart\u0026#34;) checkOutputDirExists $SCRIPTS_DIR/run.sh restart $OUTPUT $COREVERSION $WEBVERSION $KEYCONNECTORVERSION ;; \u0026#34;update\u0026#34;) checkOutputDirExists downloadRunFile $SCRIPTS_DIR/run.sh update $OUTPUT $COREVERSION $WEBVERSION $KEYCONNECTORVERSION ;; \u0026#34;rebuild\u0026#34;) checkOutputDirExists $SCRIPTS_DIR/run.sh rebuild $OUTPUT $COREVERSION $WEBVERSION $KEYCONNECTORVERSION ;; \u0026#34;updateconf\u0026#34;) checkOutputDirExists $SCRIPTS_DIR/run.sh updateconf $OUTPUT $COREVERSION $WEBVERSION $KEYCONNECTORVERSION ;; \u0026#34;updatedb\u0026#34;) checkOutputDirExists $SCRIPTS_DIR/run.sh updatedb $OUTPUT $COREVERSION $WEBVERSION $KEYCONNECTORVERSION ;; \u0026#34;stop\u0026#34;) checkOutputDirExists $SCRIPTS_DIR/run.sh stop $OUTPUT $COREVERSION $WEBVERSION $KEYCONNECTORVERSION ;; \u0026#34;renewcert\u0026#34;) checkOutputDirExists $SCRIPTS_DIR/run.sh renewcert $OUTPUT $COREVERSION $WEBVERSION $KEYCONNECTORVERSION ;; \u0026#34;updaterun\u0026#34;) checkOutputDirExists downloadRunFile ;; \u0026#34;updateself\u0026#34;) downloadSelf \u0026amp;\u0026amp; echo \u0026#34;Updated self.\u0026#34; \u0026amp;\u0026amp; exit ;; \u0026#34;help\u0026#34;) listCommands ;; *) echo \u0026#34;No command found.\u0026#34; echo listCommands esac 2. Run the installer script. A ./bwdata directory will be created relative to the location of bitwarden.sh. 1 ./bitwarden.sh install 3. Complete the prompts in the installer Enter the domain name for your Bitwarden instance:\nTypically, this value should be the configured DNS record.\nDo you want to use Let\u0026rsquo;s Encrypt to generate a free SSL certificate? (y/n):\nSpecify y to generate a trusted SSL certificate using Let\u0026rsquo;s Encrypt. You will be prompted to enter an email address for expiration reminders from Let\u0026rsquo;s Encrypt. For more information, see Certificate Options. Alternatively, specify n and use the Do you have a SSL certificate to use? option.\nEnter your installation id:\nRetrieve an installation id using a valid email at https://bitwarden.com/host. For more information, see What are my installation id and installation key used for?.\nEnter your installation key:\nRetrieve an installation key using a valid email at https://bitwarden.com/host. For more information, see What are my installation id and installation key used for?.\nDo you have a SSL certificate to use? (y/n):\nIf you already have your own SSL certificate, specify y and place the necessary files in the ./bwdata/ssl/your.domain directory. You will be asked whether it is a trusted SSL certificate (y/n). For more information, see Certificate Options.\nAlternatively, specify n and use the self-signed SSL certificate? option, which is only recommended for testing purposes.\nDo you want to generate a self-signed SSL certificate? (y/n):\nSpecify y to have Bitwarden generate a self-signed certificate for you. This option is only recommended for testing. For more information, see Certificate Options.\nIf you specify n, your instance will not use an SSL certificate and you will be required to front your installation with a HTTPS proxy, or else Bitwarden applications will not function properly.\n4. Post-Install Configuration Environment Variables 1 2 3 4 5 6 7 8 9 ... globalSettings__mail__smtp__host=\u0026lt;placeholder\u0026gt; globalSettings__mail__smtp__port=\u0026lt;placeholder\u0026gt; globalSettings__mail__smtp__ssl=\u0026lt;placeholder\u0026gt; globalSettings__mail__smtp__username=\u0026lt;placeholder\u0026gt; globalSettings__mail__smtp__password=\u0026lt;placeholder\u0026gt; ... adminSettings__admins= ... Replacing globalSettings__mail__smtp...= placeholdesr will configure the SMTP Mail Server that will be used to send verification emails to new users and invitations to Organizations. Adding an email address to adminSettings__admins= will provision access to the Admin Portal.\nAfter editing global.override.env, run the following command to apply your changes:\n1 ./bitwarden.sh restart 5. Installation File The Bitwarden installation script uses settings in ./bwdata/config.yml to generate the necessary assets for installation. Some installation scenarios (e.g. installations behind a proxy with alternate ports) may require adjustments to config.yml that were not provided during standard installation.\nEdit config.yml as necessary and apply your changes by running:\n1 ./bitwarden.sh rebuild Start Bitwarden Once you\u0026rsquo;ve completed all previous steps, start your Bitwarden instance:\n1 ./bitwarden.sh start The first time you start Bitwarden it may take some time as it downloads all of the images from Docker Hub.\nVerify that all containers are running correctly:\n1 docker ps Congratulations! Bitwarden is now up and running at https://your.domain.com. Visit the web vault in your web browser to confirm that it\u0026rsquo;s working.\nYou may now register a new account and log in. You will need to have configured smtp environment variables (see Environment Variables) in order to verify the email for your new account.\nScript Commands Reference The Bitwarden installation script (bitwarden.sh or bitwarden.ps1) has the following commands available:\nPowerShell users will run the commands with a prefixed - (switch). For example .\\bitwarden.ps1 -start.\nCommand Description install Start the installer. start Start all containers. restart Restart all containers (same as start). stop Stop all containers. update Update all containers and the database. updatedb Update/initialize the database. updateself Update this main script. updateconf Update all containers without restarting the running instance. renewcert Renew certificates. rebuild Rebuild generated installation assets from config.yml. help List all commands. ","date":"2022-01-28T00:00:00Z","permalink":"https://MyLoveES.github.io/p/install-and-deploy-bitwarden-linux/","title":"Install and deploy bitwarden - Linux"},{"content":"è„±ç¦»çº¿ç¨‹æ± ï¼Œè¿™äº›æ“ä½œçš„æ›¿ä»£æ–¹æ¡ˆ çº¿ç¨‹æ±  - ä¼˜ çº¿ç¨‹æ±  - ç¼º æ–¹æ¡ˆ 1. éé˜»å¡ 2. é™æµ 3. éš”ç¦» 4. ä»»åŠ¡çŠ¶æ€ç›‘æ§ã€å¹²é¢„ ","date":"2021-11-25T18:40:00Z","permalink":"https://MyLoveES.github.io/p/code-without-theadpool/","title":"Code without TheadPool"},{"content":"æ ¹æ®ä¼˜å…ˆçº§æ¶ˆè´¹MQæ¶ˆæ¯ èƒŒæ™¯ MQä½œä¸ºå¤„ç†ä»»åŠ¡çš„æ¶ˆæ¯ä¸­é—´ä»¶ã€‚ç”±äºä»»åŠ¡æ¥è‡ªäºä¸åŒçš„åœºæ™¯ï¼Œå¸¦æœ‰ä¸åŒçš„ä¼˜å…ˆçº§å±æ€§ï¼Œå› æ­¤æ¶ˆè´¹è€…éœ€è¦æ ¹æ®å‘€ä¼˜å…ˆçº§å¯¹ä»»åŠ¡è¿›è¡Œå¤„ç†ã€‚\næ–¹æ¡ˆ å¸¦æœ‰ä¼˜å…ˆçº§çš„MQï¼šä»¥ RabbitMQ ä¸ºä¾‹ 1. ä¸ºä»€ä¹ˆ Kafka/Pulsar ä¸å¸¦æœ‰ä¼˜å…ˆçº§æ¦‚å¿µ 2. ä¸¤è€…çš„å·®åˆ« Topic ä¼˜å…ˆçº§é¡ºåºæ¶ˆè´¹ 1. é€šè¿‡å•ä¸€ä»»åŠ¡é˜Ÿåˆ—é™æµï¼ˆå½“å‰å®ç°æ–¹æ¡ˆï¼‰ 2. ä¸ºæ¯ä¸ªTopicåˆ†é…é˜Ÿåˆ—ï¼Œå®¹é‡æ•´ä½“è°ƒæ§ ","date":"2021-11-20T18:38:00Z","permalink":"https://MyLoveES.github.io/p/mq-consume-messages-with-priority/","title":"MQ - Consume messages with Priority"},{"content":"Podmanç®€ä»‹ podman\nå’ŒDockerçš„åŒºåˆ« å®‰è£… ä½¿ç”¨ ä½¿ç”¨ Nvidia-driver ","date":"2021-10-13T18:14:13Z","permalink":"https://MyLoveES.github.io/p/docker-substitute-podman/","title":"Docker Substitute Podman"},{"content":"å¦‚ä½•åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å±‚æ¬¡ç»“æ„ å¸¸è§åœºæ™¯ å…¬å¸ï¼šå…¬å¸ - éƒ¨é—¨ - å­éƒ¨é—¨ äººå‘˜ï¼šé¢†å¯¼ - å‘˜å·¥ æ–‡ä»¶ï¼šæ ¹ç›®å½• - æ–‡ä»¶å¤¹ - æ–‡ä»¶ å…³ç³»ï¼šgroup - child å®ä¾‹ {% asset_img CASE.png CASE %}\nè½¬æˆæ ‘å‹ {% asset_img CASE_TREE.png CASE_TREE %}\nå›å¤´çœ‹ ä¹‹å‰æåˆ°çš„å‡ ç§æ–¹æ¡ˆï¼ˆAdjacency_List, Path_Enumerations, Closure_Tableï¼‰éƒ½èƒ½å¤Ÿä¸€å®šç¨‹åº¦åœ°æ»¡è¶³éœ€æ±‚ï¼Œä½†æ˜¯å„è‡ªå…·æœ‰ä¸å¯é¿å…çš„å¼Šç«¯ã€‚\nAdjacency_List: å±‚çº§æŸ¥è¯¢ -\u0026gt; âˆ\nPath_Enumerations: æ·±åº¦é™åˆ¶\nClosure_Table: ç©ºé—´æ¶ˆè€—å¤§ï¼Œå±‚çº§åˆ æ”¹ -\u0026gt; âˆ\nNested Sets æ ¹æ®æ ‘çš„æ·±åº¦éå†å¯¹èŠ‚ç‚¹ç¼–å·ï¼Œè®°å½•é¦–ã€æœ«æ¬¡è®¿é—®åˆ°è¯¥èŠ‚ç‚¹çš„æ•°å­—ã€‚é€šè¿‡æ¯”è¾ƒæ•°å­—æˆ–çš„å±‚çº§ç»“æ„å…³ç³»ã€‚\n{% asset_img Nested_Sets_1.png Nested_Sets_1 %}\n{% asset_img Nested_Sets_2.png Nested_Sets_2 %}\nid name left right 1 DIR_A 1 30 2 DIR_B 2 11 3 DIR_C 12 13 4 file_x 24 25 5 file_y 26 27 6 file_z 28 29 7 DIR_E 3 6 8 file_o 7 8 9 file_p 9 10 10 DIR_D 14 19 11 file_m 20 21 12 file_n 22 23 13 file_l 4 5 14 file_j 15 16 15 file_k 17 18 å„ç§æƒ…å†µçš„å¤„ç†ä»£ä»· å¢ {% asset_img ADD.jpg ADD %}\nä»£ä»·ï¼š-\u0026gt; O(n)ï¼Œæ›´æ–°ä¼šå½±å“åˆ°å…¶ä»–å­æ ‘\nè¾“å…¥ï¼šname. parent_id æ‰§è¡Œï¼š\n1 2 3 4 5 6 parent = $(select * from table where id = $id); insert into table(name, left, right) values($name, $parent.right, $parent.right + 1); update table set left = left + 2 where left \u0026gt;= $parent.right; update table set right = right + 2 where right \u0026gt;= $parent.right; åˆ  {% asset_img DEL.jpg DEL %}\nä»£ä»·ï¼š-\u0026gt; O(n)ï¼Œå…ˆåˆ é™¤èŠ‚ç‚¹ä»¥åŠå­æ ‘ï¼Œå¹¶å¯¹å…¶ä»–å­æ ‘è¿›è¡Œä¿®æ”¹\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 2 3 4 5 6 7 current = $(select * from table where id = $id); delete from table where left \u0026gt;= $current.left and right \u0026lt;= $current.right; d = current.right - current.right + 1; update table set left = left - $d where left \u0026gt; $current.right; update table set right = right - $d where right \u0026gt; $current.right; æ”¹ ä»£ä»·ï¼š-\u0026gt; O(1)\nid, other info\næ‰§è¡Œï¼š\n1 update table set info where id = $id; æŸ¥ æŸ¥è‡ªå·± ä»£ä»·ï¼š-\u0026gt; O(1)\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 select * from table where id = $id æŸ¥ä¸‹ä¸€çº§ {% asset_img SEARCH_NEXT.jpg SEARCH_NEXT %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼šid æ‰§è¡Œï¼š\n1 2 3 4 5 6 7 select distinct Child.Node, Child.Left, Child.Right from table as child, table as parent where parent.left \u0026lt; child.left and parent.right \u0026gt; child.right -- associate Child Nodes with ancestors group by child.node, child.left, child.right having max(parent.left) = $parent.left -- Subset for those with the given Parent Node as the nearest ancestor è¿™ç±»æŸ¥è¯¢å¯ä»¥é€šè¿‡å¢åŠ ä¸€åˆ—æ¥ç®€åŒ–ã€‚ä¾‹å¦‚ï¼Œå¢åŠ depthåˆ—è®°å½•å½“å‰èŠ‚ç‚¹æ·±åº¦ï¼Œæˆ–è€…parent_idåˆ—è®°å½•çˆ¶èŠ‚ç‚¹ï¼ˆå’ŒAdjacency Listæ··ç”¨ï¼‰,ä½†å¢åŠ äº†ç»´æŠ¤æˆæœ¬ æŸ¥æ‰€æœ‰å­é›† {% asset_img SEARCH_ALL.jpg SEARCH_ALL %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼špath\næ‰§è¡Œï¼š\n1 2 3 4 5 select * from table where left \u0026gt; $parent.left and right \u0026lt; $parent.right order by left asc; ç§»åŠ¨ {% asset_img MOVE1.jpg MOVE1 %} {% asset_img MOVE2.jpg MOVE2 %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼šid, new_parent_id æ‰§è¡Œï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 # å…ˆæ‰§è¡Œ DELï¼Œå†æ‰§è¡Œ ADD current = $( select * from table where id = $id ); # æŸ¥è¯¢çˆ¶èŠ‚ç‚¹ old_parent = $( select * from table where left \u0026lt; $current.left and right \u0026gt; $current.right order by left desc limit 1 ); -- æŸ¥è¯¢ç§»åŠ¨èŠ‚ç‚¹ä»¥åŠå­èŠ‚ç‚¹çš„æ€»æ•° node_count = $( select count(*) from table where left \u0026gt;= $current.left and right \u0026lt;= $current.right ); update table set left = left - node_count*2, where left \u0026gt; $current.right; update table set right = right - node_count*2 where right \u0026gt; $current.right; # æ›´æ–°å­èŠ‚ç‚¹ update table set left = left + ($new_parent.right - $current.left), right = right + ($new_parent.right - $current.left) where left \u0026gt;= $current.left and right \u0026lt;= $current.right $current.left = $new_parent.right; $current.right = $new_parent.right + 1; update table set left = left + node_count*2, where left \u0026gt; $current.right; update table set right = right + node_count*2 where right \u0026gt; $current.right; æ€»ç»“ å¯ä»¥å’Œé‚»æ¥è¡¨åŒæ—¶ä½¿ç”¨ ä¼˜ç‚¹ : æ¶ˆé™¤é€’å½’æ“ä½œ,å®ç°æ— é™åˆ†ç»„ ç¼ºç‚¹ : å¢ åˆ  æ”¹å½±å“èŒƒå›´å¤§ é€‚ç”¨ : å¼ºè¦æ±‚æ— é™å±‚çº§æ·±åº¦\næ¯”è¾ƒ T å¢ åˆ  æ”¹ æŸ¥è‡ªå·± æŸ¥ä¸‹ä¸€çº§ æŸ¥æ‰€æœ‰å­é›† ç§»åŠ¨ é€‚ç”¨ Adjacency List O(1) âˆ O(1) O(1) O(n) O(n) O(1) ä¸æ¶‰åŠâ€œæ‰€æœ‰å­é›†â€æ“ä½œï¼Œä¸¥æ ¼æŒ‰ç…§å±‚çº§ä¸€å±‚å±‚åœ°æŸ¥è¯¢ Closure Table O(n) O(n) O(1) O(1) O(n) O(n) O(n) æœ‰å›ºå®šçš„å±‚çº§æ·±åº¦ï¼Œå¹¶ä¸”å±‚çº§ä¸å¤š Path O(1) O(n) O(n) O(1) O(n) O(n) O(n) å¯¹å±‚çº§æ·±åº¦æœ‰ä¸€å®šé™åˆ¶ï¼Œå¹¶ä¸”éœ€æ±‚å¯¹æ‰€æœ‰å­é›†è¿›è¡Œæ“ä½œ Netsted Sets O(n) O(n) O(1) O(1) O(n) O(n) O(n) å¼ºè¦æ±‚æ— é™å±‚çº§æ·±åº¦ ","date":"2021-08-23T18:51:00Z","permalink":"https://MyLoveES.github.io/p/storing-hierarchical-data-by-nested-sets/","title":"Storing Hierarchical data by ã€Nested Setsã€‘"},{"content":"å¦‚ä½•åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å±‚æ¬¡ç»“æ„ å¸¸è§åœºæ™¯ å…¬å¸ï¼šå…¬å¸ - éƒ¨é—¨ - å­éƒ¨é—¨ äººå‘˜ï¼šé¢†å¯¼ - å‘˜å·¥ æ–‡ä»¶ï¼šæ ¹ç›®å½• - æ–‡ä»¶å¤¹ - æ–‡ä»¶ å…³ç³»ï¼šgroup - child å®ä¾‹ {% asset_img CASE.png CASE %}\nè½¬æˆæ ‘å‹ {% asset_img CASE_TREE.png CASE_TREE %}\nPath Enumerations æ¯æ¡è®°å½•å­˜æ•´ä¸ªtree pathç»è¿‡çš„nodeæšä¸¾\nid name path 1 DIR_A /DIR_A 2 DIR_B /DIR_A/DIR_B 3 DIR_C /DIR_A/DIR_C 4 file_x /DIR_A/file_x 5 file_y /DIR_A/file_y 6 file_z /DIR_A/file_z 7 DIR_D /DIR_A/DIR_B/DIR_D 8 file_o /DIR_A/DIR_B/file_o 9 file_p /DIR_A/DIR_B/file_p 10 DIR_E /DIR_A/DIR_C/DIR_E 11 file_m /DIR_A/DIR_C/file_m 12 file_n /DIR_A/DIR_C/file_n 13 file_l /DIR_A/DIR_B/DIR_D/file_l 14 file_j /DIR_A/DIR_C/DIR_E/file_j 15 file_k /DIR_A/DIR_C/DIR_E/file_k å„ç§æƒ…å†µçš„å¤„ç†ä»£ä»· å¢ ä»£ä»·ï¼š-\u0026gt; O(1)\nè¾“å…¥ï¼šname, path\næ‰§è¡Œï¼š\n1 insert into table(name, path) values($name, $path); id name path 13 file_l /DIR_A/DIR_B/DIR_D/file_l 14 file_j /DIR_A/DIR_C/DIR_E/file_j 15 file_k /DIR_A/DIR_C/DIR_E/file_k 16(add) file_ADD /DIR_A/DIR_C/DIR_E/file_ADD åˆ  {% asset_img DEL.jpg DEL %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼špath\næ‰§è¡Œï¼š\n1 delete from table where path like CONCAT($path, \u0026#39;%\u0026#39;) ; æ”¹ {% asset_img UPDATE.jpg UPDATE %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼špath, other info\næ‰§è¡Œï¼š\n1 2 3 4 5 6 7 8 9 pre: éœ€è¦åˆ†å‰²ã€æ‹¼æ¥æ‹¿åˆ°old_pathå’Œnew_path mysql 5.7: update table set info where path = $path update table set path = REPLACE( CONCAT(\u0026#39;^\u0026#39;, path), CONCAT(\u0026#39;^\u0026#39;, $old_path), $new_path) where path like CONCAT($old_path, \u0026#39;%\u0026#39;) æŸ¥ æŸ¥è‡ªå·± ä»£ä»·ï¼š-\u0026gt; O(1)\nè¾“å…¥ï¼špath\næ‰§è¡Œï¼š\n1 select * from table where path = $path æŸ¥ä¸‹ä¸€çº§ {% asset_img SEARCH_NEXT.jpg SEARCH_NEXT %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 select * from table where path regexp CONCAT(\u0026#39;^\u0026#39;, $path, \u0026#39;/.+\u0026#39;, \u0026#39;((?!/).)\u0026#39;) æŸ¥æ‰€æœ‰å­é›† {% asset_img SEARCH_ALL.jpg SEARCH_ALL %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼špath\næ‰§è¡Œï¼š\n1 select * from table where path like CONCAT($path, \u0026#39;/%\u0026#39;) ç§»åŠ¨ {% asset_img MOVE.jpg MOVE %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼špath, new_path\næ‰§è¡Œï¼š\n1 2 3 pre: old_pathå’Œnew_path UPDATE # æ‰§è¡Œä¸Šé¢çš„æ”¹æ“ä½œ æ€»ç»“ å¯ä»¥å’Œé‚»æ¥è¡¨åŒæ—¶ä½¿ç”¨\nä¼˜ç‚¹ : å¢åŠ ã€æŸ¥è¯¢ã€ä¿®æ”¹æ–¹ä¾¿\nç¼ºç‚¹ : éœ€è¦å¤§é‡ç”¨åˆ°æ­£åˆ™ã€æ¨¡ç³ŠåŒ¹é…ï¼›éœ€è¦æ§åˆ¶å±‚çº§æ·±åº¦(è‡´å‘½)\né€‚ç”¨ : å¯¹å±‚çº§æ·±åº¦æœ‰ä¸€å®šé™åˆ¶ï¼Œå¹¶ä¸”éœ€æ±‚å¯¹æ‰€æœ‰å­é›†è¿›è¡Œæ“ä½œçš„åœºæ™¯\n","date":"2021-08-23T18:51:00Z","permalink":"https://MyLoveES.github.io/p/storing-hierarchical-data-by-path-enumerations/","title":"Storing Hierarchical data by ã€Path Enumerationsã€‘"},{"content":"å¦‚ä½•åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å±‚æ¬¡ç»“æ„ å¸¸è§åœºæ™¯ å…¬å¸ï¼šå…¬å¸ - éƒ¨é—¨ - å­éƒ¨é—¨ äººå‘˜ï¼šé¢†å¯¼ - å‘˜å·¥ æ–‡ä»¶ï¼šæ ¹ç›®å½• - æ–‡ä»¶å¤¹ - æ–‡ä»¶ å…³ç³»ï¼šgroup - child å®ä¾‹ {% asset_img CASE.png CASE %}\nè½¬æˆæ ‘å‹ {% asset_img CASE_CUSTOM.png CASE_CUSTOM %}\n{% asset_img CASE_TREE.png CASE_TREE %}\nClosure Table ç»´æŠ¤ä¸€ä¸ªè¡¨ï¼Œæ‰€æœ‰çš„tree pathä½œä¸ºè®°å½•è¿›è¡Œä¿å­˜ã€‚\nid name 1 DIR_A 2 DIR_B 3 DIR_C 4 file_x 5 file_y 6 file_z 7 DIR_E 8 file_o 9 file_p 10 DIR_D 11 file_m 12 file_n 13 file_l 14 file_j 15 file_k current_id ancestor_id distance 2 1 1 7 1 2 7 2 1 13 1 3 13 2 2 13 7 1 \u0026hellip; \u0026hellip; \u0026hellip; å„ç§æƒ…å†µçš„å¤„ç†ä»£ä»· å¢ {% asset_img ADD.jpg ADD %}\nä»£ä»·ï¼š-\u0026gt; O(n) å¦‚æœå±‚çº§éå¸¸æ·±ï¼Œä»£ä»· -\u0026gt; âˆ\nè¾“å…¥ï¼šname, parent_id\næ‰§è¡Œï¼šæ·»åŠ åˆ° DIR_D ä¸‹\n1 2 3 4 5 6 7 8 9 insert into node(name) values($name); # æŸ¥æ‰€æœ‰çˆ¶èŠ‚ç‚¹ï¼Œå»ºç«‹å…³ç³» ids[] = {$parent_id} ids[] += select id from node where current_id=$parent_id; distance = ids.length; for (ancestor_id : ids) { insert into relation(current_id, ancestor_id, distance) values ($id, $ancestor_id, $distance); distance--; } id name 13 file_l 14 file_j 15 file_k 16(add) file_ADD current_id ancestor_id distance 16 1 4 16 3 3 16 10 2 16 13 1 åˆ  {% asset_img DEL.jpg DEL %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 2 3 4 ids[] = {$id} ids += $(select id from relation where ancestor_id = ${id}) delete from relation where ancestor_id in ${ids} or current_id in ${ids} delete from node where id in ${ids} æ”¹ ä»£ä»·ï¼š-\u0026gt; O(1)\nè¾“å…¥ï¼šid, other info\næ‰§è¡Œï¼š\n1 update node set info where id = $id æŸ¥ æŸ¥è‡ªå·± ä»£ä»·ï¼š-\u0026gt; O(1)\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 select * from node where id = $id æŸ¥ä¸‹ä¸€çº§ {% asset_img SEARCH_NEXT.jpg SEARCH_NEXT %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 2 3 select * from relation left join node on node.id = relation.current_id where relation.ancestor_id = $id and distance = 1 æŸ¥æ‰€æœ‰å­é›† {% asset_img SEARCH_ALL.jpg SEARCH_ALL %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 2 3 select * from relation left join node on node.id = relation.current_id where relation.ancestor_id = $id ç§»åŠ¨ {% asset_img MOVE.jpg MOVE %}\nä»£ä»·ï¼š-\u0026gt; O(n) è¾“å…¥ï¼šid, new_parent_id æ‰§è¡Œï¼š\n1 2 3 4 5 6 7 8 old_parent_id = select ancestor_id from relation where current_id = $id and distance = 1; DEL # æ‰§è¡Œä¸Šé¢çš„åˆ é™¤æ“ä½œ objects = ${object(id)} objects += $(select current_id, distance from relation where ancestor = $id) for (object : $objects) { INSERT # æ‰§è¡Œä¸Šé¢çš„æ’å…¥æ“ä½œ } æ€»ç»“ ä¼˜ç‚¹ : ä¿®æ”¹ã€æŸ¥è¯¢ç®€ä¾¿ï¼Œæ•ˆç‡é«˜ï¼›\nç¼ºç‚¹ : ç©ºé—´æ¢æ—¶é—´ï¼›è¿›è¡Œåˆ é™¤ã€ç§»åŠ¨ä»£ä»·è¾ƒå¤§ï¼›å±‚çº§æ·±åº¦å¾ˆå¤§çš„æ—¶å€™ç©ºé—´æ¶ˆè€—å·¨å¤§\né€‚ç”¨ : æœ‰å›ºå®šçš„å±‚çº§æ·±åº¦ï¼Œå¹¶ä¸”å±‚çº§ä¸å¤šçš„åœºæ™¯\n","date":"2021-08-23T18:50:00Z","permalink":"https://MyLoveES.github.io/p/storing-hierarchical-data-by-closure-table/","title":"Storing Hierarchical data by ã€Closure Tableã€‘"},{"content":"å¦‚ä½•åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å±‚æ¬¡ç»“æ„ å¸¸è§åœºæ™¯ å…¬å¸ï¼šå…¬å¸ - éƒ¨é—¨ - å­éƒ¨é—¨ äººå‘˜ï¼šé¢†å¯¼ - å‘˜å·¥ æ–‡ä»¶ï¼šæ ¹ç›®å½• - æ–‡ä»¶å¤¹ - æ–‡ä»¶ å…³ç³»ï¼šgroup - child å®ä¾‹ {% asset_img CASE.png CASE %}\nè½¬æˆæ ‘å‹ {% asset_img CASE_TREE.png CASE_TREE %}\nAdjacency List é‚»æ¥è¡¨ å­˜å‚¨å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¿¡æ¯ï¼ˆparent_idï¼‰ï¼Œé€šè¿‡ parent_id ç›¸å…³è”\nid name parent_id 1 DIR_A root 2 DIR_B 1 3 DIR_C 1 4 file_x 1 5 file_y 1 6 file_z 1 7 DIR_E 2 8 file_o 2 9 file_p 2 10 DIR_D 3 11 file_m 3 12 file_n 3 13 file_l 7 14 file_j 10 15 file_k 10 å„ç§æƒ…å†µçš„å¤„ç†ä»£ä»· 1 2 3 O(1)ï¼šæœ‰é™çš„æ“ä½œæ¬¡æ•°ï¼Œæœ‰é™çš„å½±å“èŒƒå›´ O(n)ï¼šæœ‰é™çš„æ“ä½œæ¬¡æ•°ï¼Œæ— é™çš„å½±å“èŒƒå›´ âˆï¼šæ— é™çš„æ“ä½œæ¬¡æ•° å¢ {% asset_img ADD.jpg ADD %}\nä»£ä»·ï¼š-\u0026gt; O(1)\nè¾“å…¥ï¼šname, parent_id\næ‰§è¡Œï¼š\n1 insert into table(name, parent_id) values($name, $parent_id); id name parent_id 13 file_l 7 14 file_j 10 15 file_k 10 16(add) file_ADD 1 åˆ  {% asset_img DEL.jpg DEL %}\néœ€è¦é€’å½’åˆ é™¤\nä»£ä»·ï¼š-\u0026gt; âˆ\nè¾“å…¥ï¼šid\né€’å½’æ‰§è¡Œï¼š\n1 2 3 4 5 ids[] = $id while (ids is not empty) { delete from table where id in $ids; ids = $(select id from table where parent_id in $ids); } å½“ç„¶ä¹Ÿå¯ä»¥åªåˆ é™¤ç›´æ¥ä¸‹çº§ï¼Œä½†ä¼šç•™ä¸‹â€œæ‚¬æµ®èŠ‚ç‚¹â€\næ”¹ ä»£ä»·ï¼š-\u0026gt; O(1)\nè¾“å…¥ï¼šid, other info\næ‰§è¡Œï¼š\n1 update table set info where id = $id æŸ¥ æŸ¥è‡ªå·± ä»£ä»·ï¼š-\u0026gt; O(1)\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 select * from table where id = $id æŸ¥ä¸‹ä¸€çº§ {% asset_img SEARCH_NEXT.jpg SEARCH_NEXT %}\nä»£ä»·ï¼š-\u0026gt; O(n)\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 select * from table where parent_id = $id æŸ¥æ‰€æœ‰å­é›† {% asset_img SEARCH_ALL.jpg SEARCH_ALL %}\nä»£ä»·ï¼š-\u0026gt; âˆ\nè¾“å…¥ï¼šid\næ‰§è¡Œï¼š\n1 2 3 4 5 6 ids[] = $id sub_ids[] = $id while (sub_ids is not empty) { sub_ids = $(select id from table where id in sub_ids); ids += sub_ids; } ç§»åŠ¨ {% asset_img MOVE.jpg MOVE %}\nä»£ä»·ï¼š-\u0026gt; O(1)\nè¾“å…¥ï¼šid, new_parent_id\næ‰§è¡Œï¼š\n1 update table set parent_id = $new_parent_id where id = $id; æ€»ç»“ ä¼˜ç‚¹ : è¿›è¡Œå¢åŠ ã€ä¿®æ”¹ã€ç§»åŠ¨æ—¶ä»£ä»·å¾ˆä½; æŸ¥è¯¢è‡ªå·±ã€ç›´æ¥ä¸‹çº§éå¸¸æ–¹ä¾¿\nç¼ºç‚¹ : å¦‚è‹¥éœ€è¦ä½¿ç”¨å±‚çº§ç»“æ„ï¼Œä¾‹å¦‚è·å–æ‰€æœ‰å­ç›®å½•ï¼Œæ‰€æœ‰ä¸‹çº§ï¼Œä»£ä»·è¶‹è¿‘âˆï¼ˆè‡´å‘½ï¼‰\né€‚ç”¨ : ä¸æ¶‰åŠâ€œæ‰€æœ‰å­é›†â€ï¼Œä¸¥æ ¼æŒ‰ç…§å±‚çº§ä¸€å±‚å±‚åœ°æŸ¥è¯¢\n","date":"2021-08-07T23:38:00Z","permalink":"https://MyLoveES.github.io/p/storing-hierarchical-data-by-adjacency-list/","title":"Storing Hierarchical data by ã€Adjacency Listã€‘"},{"content":"çº¿æ®µæ ‘ ä½•ä¸ºçº¿æ®µæ ‘ æ„é€ çº¿æ®µæ ‘ æŸ¥è¯¢çº¿æ®µæ ‘ æ›´æ–°çº¿æ®µæ ‘ LEETCODE PROBLEM ","date":"2021-07-20T15:44:10Z","permalink":"https://MyLoveES.github.io/p/algorithm-%E7%BA%BF%E6%AE%B5%E6%A0%91/","title":"Algorithm - çº¿æ®µæ ‘"},{"content":"1818. ç»å¯¹å·®å€¼å’Œ æ’åº \u0026amp; äºŒåˆ†æŸ¥æ‰¾ï¼Œæ‰¾åˆ°å·®è·æœ€å¤§çš„é‚£ä¸€é¡¹\næ”¹å˜å‰åçš„å·®å€¼ä¸ºï¼š |nums1[i] - nums2[i]| - |nums1[j] - nums2[i]|\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 class Solution { public int minAbsoluteSumDiff(int[] nums1, int[] nums2) { final int MOD = 1000000007; int n = nums1.length; int[] rec = new int[n]; System.arraycopy(nums1, 0, rec, 0, n); Arrays.sort(rec); int sum = 0, maxGap = 0; for (int i = 0; i \u0026lt; n; i++) { int gap = Math.abs(nums1[i] - nums2[i]); sum = (gap + sum) % MOD; int nearOne = getHigherPos(rec, nums2[i]); if (nearOne \u0026lt; n) { maxGap = Math.max(maxGap, gap - (rec[nearOne] - nums2[i])); } if (nearOne \u0026gt; 0) { maxGap = Math.max(maxGap, gap - (nums2[i] - rec[nearOne - 1])); } } return (sum - maxGap + MOD) % MOD; } private int getHigherPos(int[] arr, int target) { int low = 0, high = arr.length - 1; if (arr[high] \u0026lt; target) { return high + 1; } else { while (low \u0026lt; high) { int mid = (high - low) / 2 + low; if (arr[mid] \u0026gt; target) { high = mid; } else { low = mid + 1; } } } return low; } } ","date":"2021-07-15T22:04:20Z","permalink":"https://MyLoveES.github.io/p/leetcode_1818_minimum_absolute_sum_difference/","title":"Leetcode_1818_Minimum_Absolute_Sum_Difference"},{"content":"274. H-Index Given an array of integers citations where citations[i] is the number of citations a researcher received for their ith paper, return compute the researcher\u0026rsquo;s h-index.\nAccording to the definition of h-index on Wikipedia: A scientist has an index h if h of their n papers have at least h citations each, and the other n âˆ’ h papers have no more than h citations each.\nIf there are several possible values for h, the maximum one is taken as the h-index.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 class Solution { public int hIndex(int[] citations) { int pageCount = citations.length; int[] pageRef = new int[pageCount + 1]; for (int i = 0; i \u0026lt; pageCount; i++) { if (citations[i] \u0026gt; pageCount) { pageRef[pageCount]++; } else { pageRef[citations[i]]++; } } int totlePage = 0; for (int i = pageCount; i \u0026gt;= 0; i--) { totlePage += pageRef[i]; if (totlePage \u0026gt;= i) { return i; } } return 0; } } ","date":"2021-07-11T21:41:00Z","permalink":"https://MyLoveES.github.io/p/leetcode_274_h_index/","title":"Leetcode_274_H_Index"},{"content":"981. Time Based Key-Value Store Design a time-based key-value data structure that can store multiple values for the same key at different time stamps and retrieve the key\u0026rsquo;s value at a certain timestamp.\nImplement the TimeMap class:\nTimeMap() Initializes the object of the data structure. void set(String key, String value, int timestamp) Stores the key key with the value value at the given time timestamp. String get(String key, int timestamp) Returns a value such that set was called previously, with timestamp_prev \u0026lt;= timestamp. If there are multiple such values, it returns the value associated with the largest timestamp_prev. If there are no values, it returns \u0026ldquo;\u0026rdquo;. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 class TimeMap { HashMap\u0026lt;String, TreeMap\u0026lt;Integer, String\u0026gt;\u0026gt; map; /** Initialize your data structure here. */ public TimeMap() { map = new HashMap(); } public void set(String key, String value, int timestamp) { map.computeIfAbsent(key, k -\u0026gt; new TreeMap\u0026lt;\u0026gt;()).put(timestamp, value); } public String get(String key, int timestamp) { if (!map.containsKey(key)) { return \u0026#34;\u0026#34;; } Integer time = map.get(key).floorKey(timestamp); if (time == null) { return \u0026#34;\u0026#34;; } return map.get(key).get(time); } } ","date":"2021-07-10T17:30:10Z","permalink":"https://MyLoveES.github.io/p/leetcode_981_time_based_key_value_store.md/","title":"Leetcode_981_Time_Based_Key_Value_Store.md"},{"content":"451. Sort Characters By Frequency Given a string s, sort it in decreasing order based on the frequency of characters, and return the sorted string.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 class Solution { public String frequencySort(String s) { Map\u0026lt;Character, Integer\u0026gt; cm = new HashMap(); for (int i = 0; i \u0026lt; s.length(); i++) { char c = s.charAt(i); int count = cm.getOrDefault(c, 0) + 1; cm.put(c, count); } List\u0026lt;Character\u0026gt; keyList = new ArrayList(cm.keySet()); Collections.sort(keyList, (a,b) -\u0026gt; cm.get(b) - cm.get(a)); StringBuilder sb = new StringBuilder(); for (Character c : keyList) { int freq = cm.get(c); for (int i = 0; i \u0026lt; freq; i++) { sb.append(c); } } return sb.toString(); } } ","date":"2021-07-02T21:44:10Z","permalink":"https://MyLoveES.github.io/p/leetcode_645_set_mismatch/","title":"Leetcode_645_Set_Mismatch"},{"content":"451. Sort Characters By Frequency Given a string s, sort it in decreasing order based on the frequency of characters, and return the sorted string.\næ’åº 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 class Solution { public String frequencySort(String s) { Map\u0026lt;Character, Integer\u0026gt; cm = new HashMap\u0026lt;Character, Integer\u0026gt;(); int maxFreq = 0; for (int i = 0; i \u0026lt; s.length(); i++) { char c = s.charAt(i); int freq = cm.getOrDefault(c, 0) + 1; cm.put(c, freq); maxFreq = Math.max(freq, maxFreq); } List\u0026lt;Character\u0026gt; list = new ArrayList\u0026lt;Character\u0026gt;(cm.keySet()); Collections.sort(list, (a, b) -\u0026gt; cm.get(b) - cm.get(a)); StringBuilder s = new StringBuilder(); for (Character c : list) { int count = cm.get(c); for (int i = 0; i \u0026lt; count; i++) { s.append(c); } } return s.toString(); } } æ¡¶æ’åº 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 class Solution { public String frequencySort(String s) { Map\u0026lt;Character, Integer\u0026gt; cm = new HashMap\u0026lt;Character, Integer\u0026gt;(); int maxFreq = 0; for (int i = 0; i \u0026lt; s.length(); i++) { char c = s.charAt(i); int freq = cm.getOrDefault(c, 0) + 1; cm.put(c, freq); maxFreq = Math.max(freq, maxFreq); } StringBuffer[] buckets = new StringBuffer[maxFreq + 1]; for (int i = 0; i \u0026lt;= maxFreq; i++) { buckets[i] = new StringBuffer(); } for (Map.Entry\u0026lt;Character, Integer\u0026gt; entry : cm.entrySet()) { buckets[entry.getValue()].append(entry.getKey()); } StringBuilder sb = new StringBuilder(); for (int i = maxFreq; i \u0026gt; 0 ; i--) { String str = buckets[i].toString(); for (int j = 0; j \u0026lt; str.length(); j++) { for (int k = 0; k \u0026lt; i; k++) { sb.append(str.charAt(j)); } } } return sb.toString(); } } ","date":"2021-07-02T10:52:10Z","permalink":"https://MyLoveES.github.io/p/leetcode_451_sort_characters_by_frequency/","title":"Leetcode_451_Sort_Characters_By_Frequency"},{"content":"191. ä½1çš„ä¸ªæ•° æ–¹æ³•äºŒï¼šä½è¿ç®—ä¼˜åŒ– æ€è·¯åŠè§£æ³•\nè§‚å¯Ÿè¿™ä¸ªè¿ç®—ï¼šnÂ \u0026amp;Â (nâˆ’1)ï¼Œå…¶è¿ç®—ç»“æœæ°ä¸ºæŠŠ n çš„äºŒè¿›åˆ¶ä½ä¸­çš„æœ€ä½ä½çš„ 1 å˜ä¸º 0 ä¹‹åçš„ç»“æœã€‚ â€‹ ï¼Œè¿ç®—ç»“æœ 4 å³ä¸ºæŠŠ 6 çš„äºŒè¿›åˆ¶ä½ä¸­çš„æœ€ä½ä½çš„ 1 å˜ä¸º 0 ä¹‹åçš„ç»“æœã€‚\nè¿™æ ·æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªä½è¿ç®—çš„æ€§è´¨åŠ é€Ÿæˆ‘ä»¬çš„æ£€æŸ¥è¿‡ç¨‹ï¼Œåœ¨å®é™…ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸æ–­è®©å½“å‰çš„ n ä¸ n - 1 åšä¸è¿ç®—ï¼Œç›´åˆ° n å˜ä¸º 0 å³å¯ã€‚å› ä¸ºæ¯æ¬¡è¿ç®—ä¼šä½¿å¾— n çš„æœ€ä½ä½çš„ 1 è¢«ç¿»è½¬ï¼Œå› æ­¤è¿ç®—æ¬¡æ•°å°±ç­‰äº n çš„äºŒè¿›åˆ¶ä½ä¸­ 1 çš„ä¸ªæ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 public class Solution { // you need to treat n as an unsigned value public int hammingWeight(int n) { int r = 0; while (n != 0) { n \u0026amp;= n - 1; r++; } return r; } } ","date":"2021-06-25T23:28:10Z","permalink":"https://MyLoveES.github.io/p/leetcode_203_remove_linked_list_elements/","title":"Leetcode_203_Remove_Linked_List_Elements"},{"content":"å¤šé‡ èƒŒåŒ…é—®é¢˜ 1. å¤šé‡èƒŒåŒ… æœ‰Nç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡ä¸ºTçš„èƒŒåŒ…ï¼Œç¬¬iç§ç‰©å“æœ€å¤šæœ‰M[i]ä»¶å¯ç”¨ï¼Œä»·å€¼ä¸ºP[i]ï¼Œä½“ç§¯ä¸ºV[i]ï¼Œæ±‚è§£ï¼šé€‰å“ªäº›ç‰©å“æ”¾å…¥èƒŒåŒ…ï¼Œå¯ä»¥ä½¿å¾—è¿™äº›ç‰©å“çš„ä»·å€¼æœ€å¤§ï¼Œå¹¶ä¸”ä½“ç§¯æ€»å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ã€‚\nå¯¹æ¯”ä¸€ä¸‹å®Œå…¨èƒŒåŒ…ï¼Œå…¶å®åªæ˜¯å¤šäº†ä¸€ä¸ªé™åˆ¶æ¡ä»¶ï¼Œå®Œå…¨èƒŒåŒ…é—®é¢˜ä¸­ï¼Œç‰©å“å¯ä»¥é€‰æ‹©ä»»æ„å¤šä»¶ï¼Œåªè¦ä½ è£…å¾—ä¸‹ï¼Œè£…å¤šå°‘ä»¶éƒ½è¡Œã€‚ä½†å¤šé‡èƒŒåŒ…å°±ä¸ä¸€æ ·äº†ï¼Œæ¯ç§ç‰©å“éƒ½æœ‰æŒ‡å®šçš„æ•°é‡é™åˆ¶ï¼Œæ‰€ä»¥ä¸æ˜¯ä½ æƒ³è£…ï¼Œå°±èƒ½ä¸€ç›´è£…çš„ã€‚ä¸¾ä¸ªæ —å­ï¼Œæœ‰Aã€Bã€Cä¸‰ç§ç‰©å“ï¼Œç›¸åº”çš„æ•°é‡ã€ä»·æ ¼å’Œå ç”¨ç©ºé—´å¦‚ä¸‹å›¾ï¼š\n{% asset_img package_multi_init.png package_multi_init %}\n2. è§£å†³ åˆ†æ²» é€’æ¨å…¬å¼ï¼š\nks(i,t) = max{ks(i-1, t - V[i] * k) + P[i] * k}; ï¼ˆ0 \u0026lt;= k \u0026lt;= M[i] \u0026amp;\u0026amp; 0 \u0026lt;= k * V[i] \u0026lt;= tï¼‰\nå®Œå…¨èƒŒåŒ…é€’æ¨å…¬å¼ï¼š\nks(i,t) = max{ks(i-1, t - V[i] * k) + P[i] * k}; ï¼ˆ 0 \u0026lt;= k * V[i] \u0026lt;= tï¼‰\nå¯è§ä¸¤è€…ä¹‹é—´åªå·®äº†ä¸€ä¸ªé™åˆ¶æ¡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 public int solution(int [] m, int[] w, int[] v, int c) { return cal(m, w, v, w.length, c); } public int cal(int[] m int[] w, int[] v, int i, int j) { if (i \u0026lt; 0 || j \u0026lt;= 0) { return 0; } int result = 0; if (w[i] \u0026gt; j) { result = cal(w, v, i - 1, j); } else if (i \u0026lt; 0) { result = v[i] * Math.floor(j / w[i]); } else { for (int k = 0; k \u0026lt;= m[i] \u0026amp;\u0026amp; k * w[i] \u0026lt; j; k++) { int tmp = cal(w, v, i - 1, j - k * w[i]) + k * v[i]; result = Math.max(result, tmp); } } return result; } åŠ¨æ€è§„åˆ’ é€’å½’ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 public int solution(int[] m, int[] w, int[] v, int c) { int[][] result = new int[][]; return cal(m, w, v, result, w.length, c); } public int cal(int[] m, int[] w, int[] v, int[][] result, int i, int j) { if (result[i][j] != null) { return result[i][j]; } if (i \u0026lt; 0 || j \u0026lt;= 0) { return 0; } else { if (w[i] \u0026gt; j) { result[i][j] = cal(w, v, result, i - 1, j); } else { for (int k = 0; k \u0026lt;= m[i] \u0026amp;\u0026amp; k * w[i] \u0026lt;= j; k++) { int tmp = cal(w, v, result, i, j - k * w[i]); result[i][j] = Math.max(result[i][j], tmp); } } } } è¿­ä»£ 1 2 3 4 5 6 7 8 9 10 11 12 public int solution(int[] m, int[] w, int[] v, int c) { // åˆå§‹åŒ–ä¸º r = 0 / r[i][0] = 0 int[][] result = new int[][]; for (int i = 1; i \u0026lt; w.length; i++) { for (int j = 0; j \u0026lt;= c; j++) { for (int k = 0; k \u0026lt;= m[i] \u0026amp;\u0026amp; k * w[i] \u0026lt;= j; k++) { result[i][j] = Math.max(result[i][j], result[i - 1][j - k * w[i]] + k * v[i]); } } } return result[w.length][c]; } ç©ºé—´ä¼˜åŒ– 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 public int solution(int w[], int v[], int c) { // åˆå§‹åŒ–ä¸º r = 0 / r[0] = 0 int[] result = new int[]; for (int i = 0; i \u0026lt; w.length; i++) { if (m[i] * w[i] \u0026gt;= c) { for (int j = w[i]; j \u0026lt;= c; j++) { result[j] = Math.max(result[j], result[j - w[i]] + v[i]); } } else { for (int j = c; j \u0026gt;= w[i]; j--) { for (int k = 1; k \u0026lt;= m[i] \u0026amp;\u0026amp; k * w[i] \u0026lt;= j) { result[j] = Math.max(result[j], result[j - w[i] * k] + v[i] * k); } } } } return result[c]; } è¿™é‡Œæœ‰ä¸€ä¸ªè¾ƒå¤§çš„ä¸åŒç‚¹ï¼Œåœ¨ç¬¬äºŒå±‚å¾ªç¯ä¸­ï¼Œéœ€è¦åˆ†ä¸¤ç§æƒ…å†µè€ƒè™‘ï¼Œå¦‚æœ M[m] * V[m] \u0026gt;= T ï¼Œé‚£ä¹ˆç¬¬mä¸ªç‰©å“å°±å¯ä»¥å½“åšå®Œå…¨èƒŒåŒ…é—®é¢˜æ¥è€ƒè™‘ï¼Œè€Œå¦‚æœ M[m] * V[m] \u0026lt; Tï¼Œåˆ™æ¯æ¬¡é€‰æ‹©æ—¶ï¼Œéœ€è¦ä» newResults[n-V[m]*k] + P[m] * kï¼ˆ0 \u0026lt;= k \u0026lt;= M[m]ï¼‰ä¸­æ‰¾åˆ°æœ€å¤§å€¼ã€‚\n{% asset_img package_multi_space.png package_multi_space %}\nå¤šé‡èƒŒåŒ…é—®é¢˜åŒæ ·ä¹Ÿå¯ä»¥è½¬åŒ–æˆ01èƒŒåŒ…é—®é¢˜æ¥æ±‚è§£ï¼Œå› ä¸ºç¬¬iä»¶ç‰©å“æœ€å¤šé€‰ M[i] ä»¶ï¼Œäºæ˜¯å¯ä»¥æŠŠç¬¬iç§ç‰©å“è½¬åŒ–ä¸ºM[i]ä»¶ä½“ç§¯å’Œä»·å€¼ç›¸åŒçš„ç‰©å“ï¼Œç„¶åå†æ¥æ±‚è§£è¿™ä¸ª01èƒŒåŒ…é—®é¢˜ã€‚\nåŸæ–‡ä½œè€…ï¼šå¼—å…°å…‹çš„çŒ«\nåŸæ–‡é“¾æ¥ï¼šhttps://www.cnblogs.com/mfrank/p/10533701.html\n","date":"2021-06-18T14:39:13Z","permalink":"https://MyLoveES.github.io/p/algorithm-%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98_%E5%A4%9A%E9%87%8D%E8%83%8C%E5%8C%85/","title":"Algorithm-èƒŒåŒ…é—®é¢˜_å¤šé‡èƒŒåŒ…"},{"content":"å®Œå…¨ èƒŒåŒ…é—®é¢˜ 1. å®Œå…¨èƒŒåŒ… æœ‰Nç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡ä¸ºTçš„èƒŒåŒ…ï¼Œæ¯ç§ç‰©å“éƒ½å°±å¯ä»¥é€‰æ‹©ä»»æ„å¤šä¸ªï¼Œç¬¬iç§ç‰©å“çš„ä»·å€¼ä¸ºP[i]ï¼Œä½“ç§¯ä¸ºV[i]ï¼Œæ±‚è§£ï¼šé€‰å“ªäº›ç‰©å“æ”¾å…¥èƒŒåŒ…ï¼Œå¯å¡å› ä½¿å¾—è¿™äº›ç‰©å“çš„ä»·å€¼æœ€å¤§ï¼Œå¹¶ä¸”ä½“ç§¯æ€»å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ã€‚\nè·Ÿ01èƒŒåŒ…ä¸€æ ·ï¼Œå®Œå…¨èƒŒåŒ…ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆç»å…¸çš„åŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº01èƒŒåŒ…é—®é¢˜ä¸­ï¼Œæ¯ä»¶ç‰©å“æœ€å¤šé€‰æ‹©ä¸€ä»¶ï¼Œè€Œåœ¨å®Œå…¨èƒŒåŒ…é—®é¢˜ä¸­ï¼Œåªè¦èƒŒåŒ…è£…å¾—ä¸‹ï¼Œæ¯ä»¶ç‰©å“å¯ä»¥é€‰æ‹©ä»»æ„å¤šä»¶ã€‚ä»æ¯ä»¶ç‰©å“çš„è§’åº¦æ¥è¯´ï¼Œä¸ä¹‹ç›¸å…³çš„ç­–ç•¥å·²ç»ä¸å†æ˜¯é€‰æˆ–è€…ä¸é€‰äº†ï¼Œè€Œæ˜¯æœ‰å–0ä»¶ã€å–1ä»¶ã€å–2ä»¶\u0026hellip;ç›´åˆ°å–âŒŠT/ViâŒ‹ï¼ˆå‘ä¸‹å–æ•´ï¼‰ä»¶ã€‚\n2. åˆ†æ a. è´ªå¿ƒï¼Ÿ æ ¹æ®æ€§ä»·æ¯”æ’åºï¼Œæ€§ä»·æ¯”ä»é«˜åˆ°åº•å–ã€‚\nç»“è®ºï¼šä¸å¯è¡Œ\nåä¾‹ï¼šå¦‚æœä¸€ä¸ªèƒŒåŒ…çš„å®¹é‡ä¸º10ï¼Œæœ‰ä¸‰ä»¶ç‰©å“å¯ä¾›é€‰æ‹©ï¼Œåˆ†åˆ«æ˜¯\nç‰©å“ ä»·å€¼ ä½“ç§¯ A 5 5 B 8 7 æŒ‰ç…§æ€§ä»·æ¯”ï¼Œå¿…ç„¶å–ä¸€ä¸ªBã€‚ä½†æ˜¯å–ä¸¤ä¸ªAæ˜æ˜¾æ”¶ç›Šæ›´é«˜ã€‚å› æ­¤è´ªå¿ƒä¸å¯è¡Œã€‚ 3. è§£å†³ åˆ†æ²» å’Œä¹‹å‰ç›¸ä¼¼ï¼Œç›´æ¥é€’å½’å³å¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 public int solution(int[] w, int[] v, int c) { return cal(w, v, w.length, c); } public int cal(int w[], int v[], int i, int j) { if (i \u0026lt; 0 || j \u0026lt;= 0) { return 0; } int result = 0; if (w[i] \u0026gt; j) { result = cal(w, v, i - 1, j); } else if (i \u0026lt; 0) { result = v[i] * Math.floor(j / w[i]); } else { for (int k = 0; k * w[i] \u0026lt; j; k++) { int tmp = cal(w, v, i - 1, j - k * w[i]) + k * v[i]; result = Math.max(result, tmp); } } return result; } åŠ¨æ€è§„åˆ’ é€’å½’ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 public int solution(int w[], int v[], int c) { int[][] result = new int[][]; return cal(w, v, result, w.length, c); } public int cal(int w[], int v[], int[][] result, int i, int j) { if (result[i][j] != null) { return result[i][j]; } if (i \u0026lt; 0 || j \u0026lt;= 0) { return 0; } else { if (w[i] \u0026gt; j) { result[i][j] = cal(w, v, result, i - 1, j); } else { for (int k = 0; k * w[i] \u0026lt;= j; k++) { int tmp = cal(w, v, result, i, j - k * w[i]); result[i][j] = Math.max(result[i][j], tmp); } } } } è¿­ä»£ 1 2 3 4 5 6 7 8 9 10 11 12 public int solution(int w[], int v[], int c) { // åˆå§‹åŒ–ä¸º r = 0 / r[i][0] = 0 int[][] result = new int[][]; for (int i = 1; i \u0026lt; w.length; i++) { for (int j = 0; j \u0026lt;= c; j++) { for (int k = 0; k * w[i] \u0026lt;= j; k++) { result[i][j] = Math.max(result[i][j], result[i - 1][j - k * w[i]] + k * v[i]); } } } return result[w.length][c]; } ç©ºé—´ä¼˜åŒ– 1 2 3 4 5 6 7 8 9 10 public int solution(int w[], int v[], int c) { // åˆå§‹åŒ–ä¸º r = 0 / r[0] = 0 int[] result = new int[]; for (int i = 0; i \u0026lt; w.length; i++) { for (int j = w[i]; j \u0026lt;= c; j++) { result[j] = Math.max(result[j], result[j - w[i]] + v[i]); } } return result[c]; } åŸæ–‡ä½œè€…ï¼šå¼—å…°å…‹çš„çŒ«\nåŸæ–‡é“¾æ¥ï¼šhttps://www.cnblogs.com/mfrank/p/10533701.html\n","date":"2021-06-08T17:52:13Z","permalink":"https://MyLoveES.github.io/p/algorithm-%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98_%E5%AE%8C%E5%85%A8%E8%83%8C%E5%8C%85/","title":"Algorithm-èƒŒåŒ…é—®é¢˜_å®Œå…¨èƒŒåŒ…"},{"content":"0-1 èƒŒåŒ…é—®é¢˜ 1. åŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œæœ€å¥½å…·å¤‡ä¸¤ä¸ªå‰æï¼š æœ€ä¼˜åŒ–åŸç† æœ€ä¼˜åŒ–åŸç†æŒ‡çš„æœ€ä¼˜ç­–ç•¥å…·æœ‰è¿™æ ·çš„æ€§è´¨ï¼šä¸è®ºè¿‡å»çŠ¶æ€å’Œå†³ç­–å¦‚ä½•ï¼Œå¯¹å‰é¢çš„å†³ç­–æ‰€å½¢æˆçš„çŠ¶æ€è€Œè¨€ï¼Œä½™ä¸‹çš„è¯¸å†³ç­–å¿…é¡»æ„æˆæœ€ä¼˜ç­–ç•¥ã€‚ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªæœ€ä¼˜ç­–ç•¥çš„å­ç­–ç•¥ä¹Ÿæ˜¯å¿…é¡»æ˜¯æœ€ä¼˜çš„ï¼Œè€Œæ‰€æœ‰å­é—®é¢˜çš„å±€éƒ¨æœ€ä¼˜è§£å°†å¯¼è‡´æ•´ä¸ªé—®é¢˜çš„å…¨å±€æœ€ä¼˜ã€‚å¦‚æœä¸€ä¸ªé—®é¢˜èƒ½æ»¡è¶³æœ€ä¼˜åŒ–åŸç†ï¼Œå°±ç§°å…¶å…·æœ‰æœ€ä¼˜å­ç»“æ„æ€§è´¨ã€‚\næ— åæ•ˆæ€§ æ— åæ•ˆæ€§æŒ‡çš„æ˜¯æŸçŠ¶æ€ä¸‹å†³ç­–çš„æ”¶ç›Šï¼Œåªä¸çŠ¶æ€å’Œå†³ç­–ç›¸å…³ï¼Œä¸åˆ°è¾¾è¯¥çŠ¶æ€çš„æ–¹å¼æ— å…³ã€‚æŸä¸ªé˜¶æ®µçš„çŠ¶æ€ä¸€æ—¦ç¡®å®šï¼Œåˆ™æ­¤åè¿‡ç¨‹çš„æ¼”å˜ä¸å†å—æ­¤å‰å„ç§çŠ¶æ€åŠå†³ç­–çš„å½±å“ã€‚æ¢å¥è¯è¯´ï¼Œæœªæ¥ä¸è¿‡å»æ— å…³ï¼Œå½“å‰çŠ¶æ€æ˜¯æ­¤å‰å†å²çŠ¶æ€çš„å®Œæ•´æ€»ç»“ï¼Œæ­¤å‰å†å²å†³ç­–åªèƒ½é€šè¿‡å½±å“å½“å‰çš„çŠ¶æ€æ¥å½±å“æœªæ¥çš„æ¼”å˜ã€‚å†æ¢å¥è¯è¯´ï¼Œè¿‡å»åšçš„é€‰æ‹©ä¸ä¼šå½±å“ç°åœ¨èƒ½åšçš„æœ€ä¼˜é€‰æ‹©ï¼Œç°åœ¨èƒ½åšçš„æœ€ä¼˜é€‰æ‹©åªä¸å½“å‰çš„çŠ¶æ€æœ‰å…³ï¼Œä¸ç»è¿‡å¦‚ä½•å¤æ‚çš„å†³ç­–åˆ°è¾¾è¯¥çŠ¶æ€çš„æ–¹å¼æ— å…³ã€‚\n2. åˆ†æ ä½ åªæœ‰ä¸€ä¸ªå®¹é‡æœ‰é™çš„èƒŒåŒ…ï¼Œæ€»å®¹é‡ä¸ºcï¼Œæœ‰nä¸ªå¯å¾…é€‰æ‹©çš„ç‰©å“ï¼Œæ¯ä¸ªç‰©å“åªæœ‰ä¸€ä»¶ï¼Œå®ƒä»¬éƒ½æœ‰å„è‡ªçš„é‡é‡å’Œä»·å€¼ï¼Œä½ éœ€è¦ä»ä¸­é€‰æ‹©åˆé€‚çš„ç»„åˆæ¥ä½¿å¾—ä½ èƒŒåŒ…ä¸­çš„ç‰©å“æ€»ä»·å€¼æœ€å¤§ã€‚\næŠ½è±¡é—®é¢˜ï¼Œå¯ä»¥æè¿°ä¸ºï¼š\næœ‰ä¸€ä¸ªå®¹é‡ä¸ºcçš„èƒŒåŒ…ï¼Œæ€»å…±æœ‰nä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“çš„ä½“ç§¯ä¸ºwiï¼Œä»·å€¼ä¸ºviï¼Œæ±‚è¯¥èƒŒåŒ…èƒ½å®¹ä¸‹çš„æœ€å¤§ä»·å€¼ã€‚ï¼ˆæ¯ä¸ªç‰©å“åªå–ä¸€æ¬¡ï¼‰\nä½¿ç”¨xiæ¥æ ‡å¿—ç¬¬iä¸ªç‰©å“æ˜¯å¦æ”¾åˆ°èƒŒåŒ…é‡Œï¼Œåˆ™ï¼š\nx1w1 + x2w2 + x3w3 + \u0026hellip; + xnwn \u0026lt;= c Max(x1v1 + x2v2 + x3v3 + \u0026hellip; + xnvn) = result æ ¹æ®ä¸Šé¢æ‰€è¯´çš„ä¸¤ä¸ªå‰æï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªå…¬å¼ï¼š\nif wi \u0026gt; c, result[i, j] = result[i-1, j] else result[i, j] = max(result[i-1, j], result[i, j-w[i]] + v[i]) 3. è§£å†³ a. åˆ†æ²» 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public int solution(int[] w, int[] v, int c) { return cal(w, v, w.length, c); } /** * å½“èƒŒåŒ…å®¹é‡ä¸ºjæ—¶ï¼Œç¬¬iä»¶ç‰©å“çš„å†³ç­– */ public int cal(int[] w, int[] v, int i, int j) { // é¦–å…ˆå®šä¹‰è¿”å›æ—¶æœº if (i \u0026lt; 0 || j \u0026lt;= 0 ) { return 0; } int result = 0; if (w[i] \u0026gt; j) { result = cal(w, v, i - 1, j); } else { result = Math.max(cal(w, v, i - 1, j), cal(w, v, i - 1, j - w[i]) + v[i]); } } b. åŠ¨æ€è§„åˆ’ é€’å½’ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 public int solution(int[] w, int[] v, int c) { // åˆå§‹åŒ–ï¼šr = 0 / (å¿…é¡»æ°å¥½è£…æ»¡) r[i][0] = 0 int [][] r = new int [][]; return cal(w, v, w.length, c, r); } /** * å½“èƒŒåŒ…å®¹é‡ä¸ºjæ—¶ï¼Œç¬¬iä»¶ç‰©å“çš„å†³ç­– */ public int cal(int[] w, int[] v, int i, int j, int[][] r) { if (i \u0026lt; 0 || j \u0026lt;= 0) { return 0; } // é¦–å…ˆå®šä¹‰è¿”å›æ—¶æœº if (r[i][j] != null) { return r[i][j]; } int result = 0; // è£…ä¸ä¸‹ï¼Œåˆ™å­˜å‚¨ä¸è£…è¯¥ç‰©å“çš„æœ€å¤§å€¼ if (w[i] \u0026gt; j) { result = cal(w, v, i - 1, j); } else { // å¦åˆ™ï¼Œå­˜å‚¨è£…æˆ–ä¸è£…çš„æœ€å¤§å€¼ result = Math.max(cal(w, v, i - 1, j), cal(w, v, i - 1, j - w[i]) + v[i]); } r[i][j] = result; return result; } è¿­ä»£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 public int solution(int[] w, int[] v, int c) { // åˆå§‹åŒ–ï¼šr = 0 / (å¿…é¡»æ°å¥½è£…æ»¡) r[i][0] = 0 int [][] r = new int [][]; for (int i = 1; i \u0026lt; w.length; i++) { for (int j = 0; j \u0026lt; c; j++) { if (w[i] \u0026gt; j) { r[i][j] = r[i - 1][j]; } else { r[i][j] = Math.max(r[i - 1][j], r[i][j - w[i]] + v[i]); } } } return r[w.length][c]; } ç©ºé—´ä¼˜åŒ– result[j] = max(result[j], result[j - w[i]] + v[i]); ä¸è¿‡æ­¤å¤„è¦æ³¨æ„ï¼Œéœ€è¦ä»åå¾€å‰éå†ã€‚åŸå› æ˜¯ï¼Œå¦‚æœä»å‰å¾€åéå†çš„è¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŸå€¼è¢«æ”¹å˜ï¼Œåé¢å†å–ç”¨çš„æ—¶å€™ï¼Œå°±ä¼šå¯¼è‡´é”™è¯¯ã€‚\nä¾‹å¦‚ï¼Œå½“è®¡ç®— i=3 çš„æ—¶å€™ï¼Œr[5] = Math.max(r[5], r[5 - w[3]] + v[3])ã€‚å½“è¿›è¡Œåç»­è®¡ç®—çš„æ—¶å€™ï¼Œå¦‚æœå†ç”¨åˆ°r[5]ï¼Œé‚£å°±ä¸å†æ˜¯ä» i=2 è®¡ç®—è¿‡æ¥çš„åŸå€¼äº†ï¼Œå‘ç”Ÿé”™è¯¯ã€‚\n1 2 3 4 5 6 7 8 9 10 public int solution(int[] w, int[] v, int c) { // åˆå§‹åŒ–ï¼šr = 0 / (å¿…é¡»æ°å¥½è£…æ»¡) r[0] = 0 int[] r = new int[]; for (int i = 0; i \u0026lt; w.length; i++) { for (int j = c; j \u0026gt;= w[i]; j--) { r[j] = Math.max(r[j], r[j - w[i]] + v[i]); } } return r[r.length - 1]; } â€œæ°å¥½â€ è£…æ»¡ åŒºåˆ«åœ¨äºåˆå§‹å€¼ï¼ˆå¯¹äºä¸€ç»´äºŒç»´éƒ½æ˜¯ï¼‰ã€‚å¦‚æœéœ€è¦æ°å¥½è£…æ»¡ï¼Œé‚£ä¹ˆé™¤äº†j=0ä»¥å¤–ï¼Œåˆå§‹å€¼åº”è¯¥æ˜¯è´Ÿæ— ç©·å¤§ã€‚å¦‚æœä¸éœ€è¦æ°å¥½è£…æ»¡ï¼Œåˆå§‹å€¼éƒ½ä¸º0å³å¯ã€‚\nå› ä¸ºå¦‚æœè¦æ±‚æ°å¥½è£…æ»¡ï¼Œé‚£ä¹ˆåªæœ‰j=0çš„åˆå§‹çŠ¶æ€æ˜¯åˆæ³•çš„ã€‚ä»åˆ«çš„é€šé“å¾—å‡ºçš„ä¾ç„¶ä¼šæ˜¯è´Ÿæ— ç©·å¤§ã€‚\n{% asset_img package01.jpeg package01 %}\nåŸæ–‡ä½œè€…ï¼šå¼—å…°å…‹çš„çŒ«\nåŸæ–‡é“¾æ¥ï¼šhttps://www.cnblogs.com/mfrank/p/10533701.html\n","date":"2021-06-06T17:52:13Z","permalink":"https://MyLoveES.github.io/p/algorithm-%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98_0-1/","title":"Algorithm-èƒŒåŒ…é—®é¢˜_0-1"},{"content":"203. ç§»é™¤é“¾è¡¨å…ƒç´  1. des 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 ç»™ä½ ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ head å’Œä¸€ä¸ªæ•´æ•° val ï¼Œè¯·ä½ åˆ é™¤é“¾è¡¨ä¸­æ‰€æœ‰æ»¡è¶³ Node.val == val çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å› æ–°çš„å¤´èŠ‚ç‚¹ ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šhead = [1,2,6,3,4,5,6], val = 6 è¾“å‡ºï¼š[1,2,3,4,5] ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šhead = [], val = 1 è¾“å‡ºï¼š[] ç¤ºä¾‹ 3ï¼š è¾“å…¥ï¼šhead = [7,7,7,7], val = 7 è¾“å‡ºï¼š[] æç¤ºï¼š åˆ—è¡¨ä¸­çš„èŠ‚ç‚¹åœ¨èŒƒå›´ [0, 104] å†… 1 \u0026lt;= Node.val \u0026lt;= 50 0 \u0026lt;= k \u0026lt;= 50 2. code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 /** * Definition for singly-linked list. * public class ListNode { * int val; * ListNode next; * ListNode() {} * ListNode(int val) { this.val = val; } * ListNode(int val, ListNode next) { this.val = val; this.next = next; } * } */ class Solution { public ListNode removeElements(ListNode head, int val) { if (head == null) { return head; } while (head != null \u0026amp;\u0026amp; head.val = val) { head = head.next; } ListNode node = head; while (node != null) { if (node.next != null \u0026amp;\u0026amp; node.next.val = val) { node.next = node.next.next; } node = node.next; } return head; } } class Solution { public ListNode removeElements(ListNode head, int val) { if (head == null) { return head; } head.next = removeElements(head.next, val); return head.val == val ? head.next : head; } } ","date":"2021-06-06T17:02:13Z","permalink":"https://MyLoveES.github.io/p/leetcode_203_%E7%A7%BB%E9%99%A4%E9%93%BE%E8%A1%A8%E5%85%83%E7%B4%A0/","title":"LeetCode_203_ç§»é™¤é“¾è¡¨å…ƒç´ "},{"content":"Jayway JsonPath A Java DSL for reading JSON documents.\nGetting Started JsonPath is available at the Central Maven Repository. Maven users add this to your POM.\n1 2 3 4 5 \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.jayway.jsonpath\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;json-path\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.6.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; If you need help ask questions at Stack Overflow. Tag the question \u0026lsquo;jsonpath\u0026rsquo; and \u0026lsquo;java\u0026rsquo;.\nJsonPath expressions always refer to a JSON structure in the same way as XPath expression are used in combination with an XML document. The \u0026ldquo;root member object\u0026rdquo; in JsonPath is always referred to as $ regardless if it is an object or array.\nJsonPath expressions can use the dotâ€“notation\n$.store.book[0].title\nor the bracketâ€“notation\n$['store']['book'][0]['title']\n1 2 [ dot-notation ç‚¹è¯­æ³• ] [ bracketâ€“notation æ‹¬å·è¯­æ³• ] Operators Operator Description $ The root element to query. This starts all path expressions. @ The current node being processed by a filter predicate. * Wildcard. Available anywhere a name or numeric are required. .. Deep scan. Available anywhere a name is required. .\u0026lt;name\u0026gt; Dot-notated child ['\u0026lt;name\u0026gt;' (, '\u0026lt;name\u0026gt;')] Bracket-notated child or children [\u0026lt;number\u0026gt; (, \u0026lt;number\u0026gt;)] Array index or indexes [start:end] Array slice operator [?(\u0026lt;expression\u0026gt;)] Filter expression. Expression must evaluate to a boolean value. Functions Functions can be invoked at the tail end of a path - the input to a function is the output of the path expression. The function output is dictated by the function itself.\nå‡½æ•°å¯ä»¥åœ¨pathçš„å°¾ç«¯è°ƒç”¨ï¼Œå‡½æ•°çš„è¾“å…¥æ˜¯pathè¡¨è¾¾å¼çš„è¾“å‡ºï¼Œå‡½æ•°è¾“å‡ºç”±å‡½æ•°æœ¬èº«å†³å®šã€‚\nFunction Description Output type min() Provides the min value of an array of numbers Double max() Provides the max value of an array of numbers Double avg() Provides the average value of an array of numbers Double stddev() Provides the standard deviation value of an array of numbers ï¼ˆæ ‡å‡†å·®ï¼‰ Double length() Provides the length of an array Integer sum() Provides the sum value of an array of numbers Double keys() Provides the property keys (An alternative for terminal tilde ~) Set\u0026lt;E\u0026gt; concat(X) Provides a concatinated version of the path output with a new item like input append(X) add an item to the json path output array like input Filter Operators Filters are logical expressions used to filter arrays. A typical filter would be [?(@.age \u0026gt; 18)] where @ represents the current item being processed. More complex filters can be created with logical operators \u0026amp;\u0026amp; and ||. String literals must be enclosed by single or double quotes ([?(@.color == 'blue')] or [?(@.color == \u0026quot;blue\u0026quot;)]).\nOperator Description == left is equal to right (note that 1 is not equal to \u0026lsquo;1\u0026rsquo;) != left is not equal to right \u0026lt; left is less than right \u0026lt;= left is less or equal to right \u0026gt; left is greater than right \u0026gt;= left is greater than or equal to right =~ left matches regular expression [?(@.name =~ /foo.*?/i)] in left exists in right [?(@.size in [\u0026lsquo;S\u0026rsquo;, \u0026lsquo;M\u0026rsquo;])] nin left does not exists in right subsetof left is a subset of right [?(@.sizes subsetof [\u0026lsquo;S\u0026rsquo;, \u0026lsquo;M\u0026rsquo;, \u0026lsquo;L\u0026rsquo;])] anyof left has an intersection with right [?(@.sizes anyof [\u0026lsquo;M\u0026rsquo;, \u0026lsquo;L\u0026rsquo;])] noneof left has no intersection with right [?(@.sizes noneof [\u0026lsquo;M\u0026rsquo;, \u0026lsquo;L\u0026rsquo;])] size size of left (array or string) should match right empty left (array or string) should be empty 1 2 A has an intersection with B; A ä¸ B æœ‰äº¤é›† Path Examples Given the json\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 { \u0026#34;store\u0026#34;: { \u0026#34;book\u0026#34;: [ { \u0026#34;category\u0026#34;: \u0026#34;reference\u0026#34;, \u0026#34;author\u0026#34;: \u0026#34;Nigel Rees\u0026#34;, \u0026#34;title\u0026#34;: \u0026#34;Sayings of the Century\u0026#34;, \u0026#34;price\u0026#34;: 8.95 }, { \u0026#34;category\u0026#34;: \u0026#34;fiction\u0026#34;, \u0026#34;author\u0026#34;: \u0026#34;Evelyn Waugh\u0026#34;, \u0026#34;title\u0026#34;: \u0026#34;Sword of Honour\u0026#34;, \u0026#34;price\u0026#34;: 12.99 }, { \u0026#34;category\u0026#34;: \u0026#34;fiction\u0026#34;, \u0026#34;author\u0026#34;: \u0026#34;Herman Melville\u0026#34;, \u0026#34;title\u0026#34;: \u0026#34;Moby Dick\u0026#34;, \u0026#34;isbn\u0026#34;: \u0026#34;0-553-21311-3\u0026#34;, \u0026#34;price\u0026#34;: 8.99 }, { \u0026#34;category\u0026#34;: \u0026#34;fiction\u0026#34;, \u0026#34;author\u0026#34;: \u0026#34;J. R. R. Tolkien\u0026#34;, \u0026#34;title\u0026#34;: \u0026#34;The Lord of the Rings\u0026#34;, \u0026#34;isbn\u0026#34;: \u0026#34;0-395-19395-8\u0026#34;, \u0026#34;price\u0026#34;: 22.99 } ], \u0026#34;bicycle\u0026#34;: { \u0026#34;color\u0026#34;: \u0026#34;red\u0026#34;, \u0026#34;price\u0026#34;: 19.95 } }, \u0026#34;expensive\u0026#34;: 10 } JsonPath (click link to try) Result $.store.book[*].author The authors of all books $..author All authors $.store.* All things, both books and bicycles $.store..price The price of everything $..book[2] The third book $..book[-2] The second to last book $..book[0,1] The first two books $..book[:2] All books from index 0 (inclusive) until index 2 (exclusive) $..book[1:2] All books from index 1 (inclusive) until index 2 (exclusive) $..book[-2:] Last two books $..book[2:] Book number two from tail $..book[?(@.isbn)] All books with an ISBN number $.store.book[?(@.price \u0026lt; 10)] All books in store cheaper than 10 $..book[?(@.price \u0026lt;= $[\u0026rsquo;expensive\u0026rsquo;])] All books in store that are not \u0026ldquo;expensive\u0026rdquo; $..book[?(@.author =~ /.*REES/i)] All books matching regex (ignore case) $..* Give me every thing $..book.length() The number of books Reading a Document The simplest most straight forward way to use JsonPath is via the static read API.\nä½¿ç”¨ JsonPath æœ€ç®€å•æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯é€šè¿‡é™æ€è¯»å– APIã€‚\n1 2 3 String json = \u0026#34;...\u0026#34;; List\u0026lt;String\u0026gt; authors = JsonPath.read(json, \u0026#34;$.store.book[*].author\u0026#34;); If you only want to read once this is OK. In case you need to read an other path as well this is not the way to go since the document will be parsed every time you call JsonPath.read(\u0026hellip;). To avoid the problem you can parse the json first.\nå¦‚æœæ‚¨åªæƒ³é˜…è¯»ä¸€æ¬¡ï¼Œè¿™æ˜¯å¯ä»¥çš„ã€‚å¦‚æœæ‚¨è¿˜éœ€è¦è¯»å–å…¶ä»–è·¯å¾„ï¼Œè¿™ä¸æ˜¯å¯è¡Œçš„æ–¹æ³•ï¼Œå› ä¸ºæ¯æ¬¡è°ƒç”¨ JsonPath.read(\u0026hellip;) æ—¶éƒ½ä¼šè§£ææ–‡æ¡£ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥å…ˆè§£æjsonã€‚\n1 2 3 4 5 String json = \u0026#34;...\u0026#34;; Object document = Configuration.defaultConfiguration().jsonProvider().parse(json); String author0 = JsonPath.read(document, \u0026#34;$.store.book[0].author\u0026#34;); String author1 = JsonPath.read(document, \u0026#34;$.store.book[1].author\u0026#34;); JsonPath also provides a fluent API. This is also the most flexible one.\nJsonPath è¿˜æä¾›äº†æµç•…çš„ APIã€‚è¿™ä¹Ÿæ˜¯æœ€çµæ´»çš„ä¸€ç§ã€‚\n1 2 3 4 5 6 7 8 9 10 11 String json = \u0026#34;...\u0026#34;; ReadContext ctx = JsonPath.parse(json); List\u0026lt;String\u0026gt; authorsOfBooksWithISBN = ctx.read(\u0026#34;$.store.book[?(@.isbn)].author\u0026#34;); List\u0026lt;Map\u0026lt;String, Object\u0026gt;\u0026gt; expensiveBooks = JsonPath .using(configuration) .parse(json) .read(\u0026#34;$.store.book[?(@.price \u0026gt; 10)]\u0026#34;, List.class); What is Returned When? When using JsonPath in java its important to know what type you expect in your result. JsonPath will automatically try to cast the result to the type expected by the invoker.\nåœ¨ java ä¸­ä½¿ç”¨ JsonPath æ—¶ï¼Œé‡è¦çš„æ˜¯è¦çŸ¥é“æ‚¨åœ¨ç»“æœä¸­æœŸæœ›ä»€ä¹ˆç±»å‹ã€‚ JsonPath å°†è‡ªåŠ¨å°è¯•å°†ç»“æœè½¬æ¢ä¸ºè°ƒç”¨è€…æœŸæœ›çš„ç±»å‹ã€‚\n1 2 3 4 5 //Will throw an java.lang.ClassCastException List\u0026lt;String\u0026gt; list = JsonPath.parse(json).read(\u0026#34;$.store.book[0].author\u0026#34;) //Works fine String author = JsonPath.parse(json).read(\u0026#34;$.store.book[0].author\u0026#34;) When evaluating a path you need to understand the concept of when a path is definite. A path is indefinite if it contains:\nä½ éœ€è¦ç†è§£ä½•ä¸ºç»å¯¹ï¼Œä½•ä¸ºç›¸å¯¹\n.. - a deep scan operator ?(\u0026lt;expression\u0026gt;) - an expression [\u0026lt;number\u0026gt;, \u0026lt;number\u0026gt; (, \u0026lt;number\u0026gt;)] - multiple array indexes Indefinite paths always returns a list (as represented by current JsonProvider).\nç›¸å¯¹pathå¸¸å¸¸è¿”å›list\nBy default a simple object mapper is provided by the MappingProvider SPI. This allows you to specify the return type you want and the MappingProvider will try to perform the mapping. In the example below mapping between Long and Date is demonstrated.\nä½ å¯ä»¥æŒ‡å®šæœŸæœ›çš„è¿”å›ç±»å‹ï¼Œmapperä¼šå°è¯•è¿›è¡Œæ˜ å°„\n1 2 3 String json = \u0026#34;{\\\u0026#34;date_as_long\\\u0026#34; : 1411455611975}\u0026#34;; Date date = JsonPath.parse(json).read(\u0026#34;$[\u0026#39;date_as_long\u0026#39;]\u0026#34;, Date.class); If you configure JsonPath to use JacksonMappingProvider or GsonMappingProvider you can even map your JsonPath output directly into POJO\u0026rsquo;s.\n1 Book book = JsonPath.parse(json).read(\u0026#34;$.store.book[0]\u0026#34;, Book.class); To obtain full generics type information, use TypeRef.\nè¦è·å–å®Œæ•´çš„æ³›å‹ç±»å‹ä¿¡æ¯ï¼Œè¯·ä½¿ç”¨ TypeRefã€‚\n1 2 3 TypeRef\u0026lt;List\u0026lt;String\u0026gt;\u0026gt; typeRef = new TypeRef\u0026lt;List\u0026lt;String\u0026gt;\u0026gt;() {}; List\u0026lt;String\u0026gt; titles = JsonPath.parse(JSON_DOCUMENT).read(\u0026#34;$.store.book[*].title\u0026#34;, typeRef); Predicates # åˆ¤æ–­ There are three different ways to create filter predicates in JsonPath.\nInline Predicates Inline predicates are the ones defined in the path.\n1 2 List\u0026lt;Map\u0026lt;String, Object\u0026gt;\u0026gt; books = JsonPath.parse(json) .read(\u0026#34;$.store.book[?(@.price \u0026lt; 10)]\u0026#34;); You can use \u0026amp;\u0026amp; and || to combine multiple predicates [?(@.price \u0026lt; 10 \u0026amp;\u0026amp; @.category == 'fiction')] , [?(@.category == 'reference' || @.price \u0026gt; 10)].\nYou can use ! to negate a predicate [?(!(@.price \u0026lt; 10 \u0026amp;\u0026amp; @.category == 'fiction'))].\nFilter Predicates Predicates can be built using the Filter API as shown below:\n1 2 3 4 5 6 7 8 9 10 11 12 import static com.jayway.jsonpath.JsonPath.parse; import static com.jayway.jsonpath.Criteria.where; import static com.jayway.jsonpath.Filter.filter; ... ... Filter cheapFictionFilter = filter( where(\u0026#34;category\u0026#34;).is(\u0026#34;fiction\u0026#34;).and(\u0026#34;price\u0026#34;).lte(10D) ); List\u0026lt;Map\u0026lt;String, Object\u0026gt;\u0026gt; books = parse(json).read(\u0026#34;$.store.book[?]\u0026#34;, cheapFictionFilter); Notice the placeholder ? for the filter in the path. When multiple filters are provided they are applied in order where the number of placeholders must match the number of provided filters. You can specify multiple predicate placeholders in one filter operation [?, ?], both predicates must match.\n\u0026lsquo;?\u0026lsquo;çš„æ•°ç›® å¿…é¡»ä¸è¿‡æ»¤å™¨çš„æ•°ç›®ç›¸åŒ¹é…\nFilters can also be combined with \u0026lsquo;OR\u0026rsquo; and \u0026lsquo;AND\u0026rsquo;\n1 2 3 4 5 6 7 Filter fooOrBar = filter( where(\u0026#34;foo\u0026#34;).exists(true)).or(where(\u0026#34;bar\u0026#34;).exists(true) ); Filter fooAndBar = filter( where(\u0026#34;foo\u0026#34;).exists(true)).and(where(\u0026#34;bar\u0026#34;).exists(true) ); Roll Your Own Third option is to implement your own predicates\n1 2 3 4 5 6 7 8 9 Predicate booksWithISBN = new Predicate() { @Override public boolean apply(PredicateContext ctx) { return ctx.item(Map.class).containsKey(\u0026#34;isbn\u0026#34;); } }; List\u0026lt;Map\u0026lt;String, Object\u0026gt;\u0026gt; books = reader.read(\u0026#34;$.store.book[?].isbn\u0026#34;, List.class, booksWithISBN); Path vs Value In the Goessner implementation a JsonPath can return either Path or Value. Value is the default and what all the examples above are returning. If you rather have the path of the elements our query is hitting this can be achieved with an option.\nå¯ä»¥æŒ‡å®šoptionæ¥è¿”å›pathï¼ˆé»˜è®¤è¿”å›valueï¼‰\n1 2 3 4 5 6 7 8 9 10 Configuration conf = Configuration.builder() .options(Option.AS_PATH_LIST).build(); List\u0026lt;String\u0026gt; pathList = using(conf).parse(json).read(\u0026#34;$..author\u0026#34;); assertThat(pathList).containsExactly( \u0026#34;$[\u0026#39;store\u0026#39;][\u0026#39;book\u0026#39;][0][\u0026#39;author\u0026#39;]\u0026#34;, \u0026#34;$[\u0026#39;store\u0026#39;][\u0026#39;book\u0026#39;][1][\u0026#39;author\u0026#39;]\u0026#34;, \u0026#34;$[\u0026#39;store\u0026#39;][\u0026#39;book\u0026#39;][2][\u0026#39;author\u0026#39;]\u0026#34;, \u0026#34;$[\u0026#39;store\u0026#39;][\u0026#39;book\u0026#39;][3][\u0026#39;author\u0026#39;]\u0026#34;); Set a value The library offers the possibility to set a value.\n1 String newJson = JsonPath.parse(json).set(\u0026#34;$[\u0026#39;store\u0026#39;][\u0026#39;book\u0026#39;][0][\u0026#39;author\u0026#39;]\u0026#34;, \u0026#34;Paul\u0026#34;).jsonString(); Tweaking Configuration Options When creating your Configuration there are a few option flags that can alter the default behaviour.\nDEFAULT_PATH_LEAF_TO_NULL This option makes JsonPath return null for missing leafs. Consider the following json\nä¸å­˜åœ¨çš„keyè¿”å›NULL\n1 2 3 4 5 6 7 8 9 [ { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;gender\u0026#34; : \u0026#34;male\u0026#34; }, { \u0026#34;name\u0026#34; : \u0026#34;ben\u0026#34; } ] 1 2 3 4 5 6 7 8 9 10 11 12 13 Configuration conf = Configuration.defaultConfiguration(); //Works fine String gender0 = JsonPath.using(conf).parse(json).read(\u0026#34;$[0][\u0026#39;gender\u0026#39;]\u0026#34;); //PathNotFoundException thrown String gender1 = JsonPath.using(conf).parse(json).read(\u0026#34;$[1][\u0026#39;gender\u0026#39;]\u0026#34;); Configuration conf2 = conf.addOptions(Option.DEFAULT_PATH_LEAF_TO_NULL); //Works fine String gender0 = JsonPath.using(conf2).parse(json).read(\u0026#34;$[0][\u0026#39;gender\u0026#39;]\u0026#34;); //Works fine (null is returned) String gender1 = JsonPath.using(conf2).parse(json).read(\u0026#34;$[1][\u0026#39;gender\u0026#39;]\u0026#34;); ALWAYS_RETURN_LIST This option configures JsonPath to return a list even when the path is definite.\næ°¸è¿œè¿”å›List\n1 2 3 4 5 6 7 8 9 Configuration conf = Configuration.defaultConfiguration(); //ClassCastException thrown List\u0026lt;String\u0026gt; genders0 = JsonPath.using(conf).parse(json).read(\u0026#34;$[0][\u0026#39;gender\u0026#39;]\u0026#34;); Configuration conf2 = conf.addOptions(Option.ALWAYS_RETURN_LIST); //Works fine List\u0026lt;String\u0026gt; genders0 = JsonPath.using(conf2).parse(json).read(\u0026#34;$[0][\u0026#39;gender\u0026#39;]\u0026#34;); SUPPRESS_EXCEPTIONS This option makes sure no exceptions are propagated from path evaluation. It follows these simple rules:\nè·¯å¾„è®¡ç®—ä¸è¿”å›å¼‚å¸¸\nIf option ALWAYS_RETURN_LIST is present an empty list will be returned If option ALWAYS_RETURN_LIST is NOT present null returned REQUIRE_PROPERTIES This option configures JsonPath to require properties defined in path when an indefinite path is evaluated.\nå¿…é¡»ç»å¯¹è·¯å¾„\n1 2 3 4 5 6 7 8 9 Configuration conf = Configuration.defaultConfiguration(); //Works fine List\u0026lt;String\u0026gt; genders = JsonPath.using(conf).parse(json).read(\u0026#34;$[*][\u0026#39;gender\u0026#39;]\u0026#34;); Configuration conf2 = conf.addOptions(Option.REQUIRE_PROPERTIES); //PathNotFoundException thrown List\u0026lt;String\u0026gt; genders = JsonPath.using(conf2).parse(json).read(\u0026#34;$[*][\u0026#39;gender\u0026#39;]\u0026#34;); JsonProvider SPI JsonPath is shipped with five different JsonProviders:\nJsonSmartJsonProvider (default) JacksonJsonProvider JacksonJsonNodeJsonProvider GsonJsonProvider JsonOrgJsonProvider Changing the configuration defaults as demonstrated should only be done when your application is being initialized. Changes during runtime is strongly discouraged, especially in multi threaded applications.\nä»…åœ¨åˆå§‹åŒ–åº”ç”¨ç¨‹åºæ—¶æ‰åº”æŒ‰ç…§æ¼”ç¤ºæ›´æ”¹é…ç½®é»˜è®¤å€¼ã€‚å¼ºçƒˆå»ºè®®ä¸è¦åœ¨è¿è¡Œæ—¶è¿›è¡Œæ›´æ”¹ï¼Œå°¤å…¶æ˜¯åœ¨å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºä¸­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Configuration.setDefaults(new Configuration.Defaults() { private final JsonProvider jsonProvider = new JacksonJsonProvider(); private final MappingProvider mappingProvider = new JacksonMappingProvider(); @Override public JsonProvider jsonProvider() { return jsonProvider; } @Override public MappingProvider mappingProvider() { return mappingProvider; } @Override public Set\u0026lt;Option\u0026gt; options() { return EnumSet.noneOf(Option.class); } }); Note that the JacksonJsonProvider requires com.fasterxml.jackson.core:jackson-databind:2.4.5 and the GsonJsonProvider requires com.google.code.gson:gson:2.3.1 on your classpath.\nCache SPI In JsonPath 2.1.0 a new Cache SPI was introduced. This allows API consumers to configure path caching in a way that suits their needs. The cache must be configured before it is accesses for the first time or a JsonPathException is thrown. JsonPath ships with two cache implementations\ncom.jayway.jsonpath.spi.cache.LRUCache (default, thread safe) com.jayway.jsonpath.spi.cache.NOOPCache (no cache) If you want to implement your own cache the API is simple.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 CacheProvider.setCache(new Cache() { //Not thread safe simple cache private Map\u0026lt;String, JsonPath\u0026gt; map = new HashMap\u0026lt;String, JsonPath\u0026gt;(); @Override public JsonPath get(String key) { return map.get(key); } @Override public void put(String key, JsonPath jsonPath) { map.put(key, jsonPath); } }); ","date":"2021-06-04T17:02:13Z","permalink":"https://MyLoveES.github.io/p/jsonpath-guide-read/","title":"JSONPATH guide read"},{"content":"Shell åŸºç¡€ variables variable meaning $$ Shellæœ¬èº«çš„PIDï¼ˆProcessIDï¼‰ $! Shellæœ€åè¿è¡Œçš„åå°Processçš„PID $? æœ€åè¿è¡Œçš„å‘½ä»¤çš„ç»“æŸä»£ç ï¼ˆè¿”å›å€¼ï¼‰,ä¸Šä¸€ä¸ªå‘½ä»¤æ‰§è¡Œåçš„è¿”å›ç»“æœã€‚æ˜¯æ˜¾ç¤ºæœ€åå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ï¼Œ0è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼Œå…¶ä»–è¡¨ç¤ºæœ‰é”™è¯¯ $- ä½¿ç”¨Setå‘½ä»¤è®¾å®šçš„Flagä¸€è§ˆ $* æ‰€æœ‰å‚æ•°åˆ—è¡¨ã€‚æ˜¯ä»¥ä¸€ä¸ªå•å­—ç¬¦ä¸²æ˜¾ç¤ºæ‰€æœ‰å‘è„šæœ¬ä¼ é€’çš„å‚æ•°ï¼Œä¸ä½ç½®å˜é‡ä¸åŒï¼Œå‚æ•°å¯è¶…è¿‡9ä¸ª.å¦‚\u0026quot;$*\u0026ldquo;ç”¨ã€Œ\u0026quot;ã€æ‹¬èµ·æ¥çš„æƒ…å†µã€ä»¥\u0026rdquo;$1 $2 â€¦ $n\u0026quot;çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚ $@ æ‰€æœ‰å‚æ•°åˆ—è¡¨ã€‚å¦‚\u0026quot;$@\u0026ldquo;ç”¨ã€Œ\u0026quot;ã€æ‹¬èµ·æ¥çš„æƒ…å†µã€ä»¥\u0026rdquo;$1\u0026quot; \u0026ldquo;$2\u0026rdquo; â€¦ \u0026ldquo;$n\u0026rdquo; çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚ $# æ·»åŠ åˆ°Shellçš„å‚æ•°ä¸ªæ•° $0 Shellæœ¬èº«çš„æ–‡ä»¶å $1ï½$n æ·»åŠ åˆ°Shellçš„å„å‚æ•°å€¼ã€‚$1æ˜¯ç¬¬1å‚æ•°ã€$2æ˜¯ç¬¬2å‚æ•°â€¦ã€‚ symnbols meaning -eq ç­‰äº equal -ne ä¸ç­‰äº not equal -gt å¤§äº greater -lt å°äº less -ge å¤§äºç­‰äº greater or equal -le å°äºç­‰äº less or equal ","date":"2021-02-20T12:00:00Z","permalink":"https://MyLoveES.github.io/p/hi-linux-shell/","title":"Hi, Linux shell"},{"content":"layout: post title: \u0026ldquo;Hi, Linux commands\u0026rdquo; subtitle: \u0026quot; \u0026quot;Hi, Linux commands\u0026quot;\u0026quot; date: 2021-02-21 17:00:00 author: \u0026ldquo;ruili\u0026rdquo; header-img: \u0026ldquo;img/post-bg-2015.jpg\u0026rdquo; catalog: true categories:\n\u0026ldquo;æŠ€æœ¯\u0026rdquo; tags: \u0026ldquo;è®¾è®¡æ¨¡å¼\u0026rdquo; \u0026ldquo;å‘½ä»¤æ¨¡å¼\u0026rdquo; å¸¸ç”¨ Shell å‘½ä»¤ 1. æ–‡æœ¬æ£€ç´¢ wc wc -c the byte counts -m the character counts -l the newline counts -L the maximum display width -w the word counts 2. é‡å®šå‘ åœ¨shellè„šæœ¬ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ€»æ˜¯æœ‰ä¸‰ä¸ªæ–‡ä»¶å¤„äºæ‰“å¼€çŠ¶æ€ï¼š\næ ‡å‡†è¾“å…¥(é”®ç›˜è¾“å…¥)ã€æ ‡å‡†è¾“å‡ºï¼ˆè¾“å‡ºåˆ°å±å¹•ï¼‰ã€æ ‡å‡†é”™è¯¯ï¼ˆä¹Ÿæ˜¯è¾“å‡ºåˆ°å±å¹•ï¼‰ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦æ˜¯0ï¼Œ1ï¼Œ2\n\u0026gt; é»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºé‡å®šå‘ï¼Œä¸ 1\u0026gt; ç›¸åŒ\n2\u0026gt;\u0026amp;1 æ„æ€æ˜¯æŠŠ æ ‡å‡†é”™è¯¯è¾“å‡º é‡å®šå‘åˆ° æ ‡å‡†è¾“å‡º.\n\u0026amp;\u0026gt;file æ„æ€æ˜¯æŠŠæ ‡å‡†è¾“å‡º å’Œ æ ‡å‡†é”™è¯¯è¾“å‡º éƒ½é‡å®šå‘åˆ°æ–‡ä»¶fileä¸­\n/dev/nullæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ¯”è¾ƒç‰¹æ®Šï¼Œæ‰€æœ‰ä¼ ç»™å®ƒçš„ä¸œè¥¿å®ƒéƒ½ä¸¢å¼ƒæ‰\n3. è¿ç®—ç¬¦ =~ å…¶ä¸­ ~ å…¶å®æ˜¯å¯¹åé¢çš„æ­£åˆ™è¡¨è¾¾å¼è¡¨ç¤ºåŒ¹é…çš„æ„æ€ï¼Œå¦‚æœåŒ¹é…å°±è¾“å‡º1ï¼Œä¸åŒ¹é…å°±è¾“å‡º0. == æ˜¯å¦ç›¸ç­‰ ä¾‹å­ï¼š [[ $test =~ ^[0-9]+ ]] \u0026amp;\u0026amp; echo 1 || echo 0\n4. awk -F fs or \u0026ndash;field-separator fs\næŒ‡å®šè¾“å…¥æ–‡ä»¶æŠ˜åˆ†éš”ç¬¦ï¼Œfsæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚-F:ã€‚ -v var=value or \u0026ndash;asign var=value èµ‹å€¼ä¸€ä¸ªç”¨æˆ·å®šä¹‰å˜é‡ã€‚ -f scripfile or \u0026ndash;file scriptfile\nä»è„šæœ¬æ–‡ä»¶ä¸­è¯»å–awkå‘½ä»¤ã€‚ -mf nnn and -mr nnn\nå¯¹nnnå€¼è®¾ç½®å†…åœ¨é™åˆ¶ï¼Œ-mfé€‰é¡¹é™åˆ¶åˆ†é…ç»™nnnçš„æœ€å¤§å—æ•°ç›®ï¼›-mré€‰é¡¹é™åˆ¶è®°å½•çš„æœ€å¤§æ•°ç›®ã€‚è¿™ä¸¤ä¸ªåŠŸèƒ½æ˜¯Bellå®éªŒå®¤ç‰ˆawkçš„æ‰©å±•åŠŸèƒ½ï¼Œåœ¨æ ‡å‡†awkä¸­ä¸é€‚ç”¨ã€‚ -W compact or \u0026ndash;compat, -W traditional or \u0026ndash;traditional åœ¨å…¼å®¹æ¨¡å¼ä¸‹è¿è¡Œawkã€‚æ‰€ä»¥gawkçš„è¡Œä¸ºå’Œæ ‡å‡†çš„awkå®Œå…¨ä¸€æ ·ï¼Œæ‰€æœ‰çš„awkæ‰©å±•éƒ½è¢«å¿½ç•¥ã€‚ -W copyleft or \u0026ndash;copyleft, -W copyright or \u0026ndash;copyright æ‰“å°ç®€çŸ­çš„ç‰ˆæƒä¿¡æ¯ã€‚ -W help or \u0026ndash;help, -W usage or \u0026ndash;usage æ‰“å°å…¨éƒ¨awké€‰é¡¹å’Œæ¯ä¸ªé€‰é¡¹çš„ç®€çŸ­è¯´æ˜ã€‚ -W lint or \u0026ndash;lint æ‰“å°ä¸èƒ½å‘ä¼ ç»Ÿunixå¹³å°ç§»æ¤çš„ç»“æ„çš„è­¦å‘Šã€‚ -W lint-old or \u0026ndash;lint-old æ‰“å°å…³äºä¸èƒ½å‘ä¼ ç»Ÿunixå¹³å°ç§»æ¤çš„ç»“æ„çš„è­¦å‘Šã€‚ -W posix æ‰“å¼€å…¼å®¹æ¨¡å¼ã€‚ä½†æœ‰ä»¥ä¸‹é™åˆ¶ï¼Œä¸è¯†åˆ«ï¼š/xã€å‡½æ•°å…³é”®å­—ã€funcã€æ¢ç åºåˆ—ä»¥åŠå½“fsæ˜¯ä¸€ä¸ªç©ºæ ¼æ—¶ï¼Œå°†æ–°è¡Œä½œä¸ºä¸€ä¸ªåŸŸåˆ†éš”ç¬¦ï¼›æ“ä½œç¬¦å’Œ=ä¸èƒ½ä»£æ›¿^å’Œ^=ï¼›fflushæ— æ•ˆã€‚ -W re-interval or \u0026ndash;re-inerval å…è®¸é—´éš”æ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨ï¼Œå‚è€ƒ(grepä¸­çš„Posixå­—ç¬¦ç±»)ï¼Œå¦‚æ‹¬å·è¡¨è¾¾å¼[[:alpha:]]ã€‚ -W source program-text or \u0026ndash;source program-text ä½¿ç”¨program-textä½œä¸ºæºä»£ç ï¼Œå¯ä¸-få‘½ä»¤æ··ç”¨ã€‚ -W version or \u0026ndash;version æ‰“å°bugæŠ¥å‘Šä¿¡æ¯çš„ç‰ˆæœ¬ã€‚ ç”¨æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 2 this is a test 3 Are you like awk This\u0026#39;s a test 10 There are orange,apple,mongo 1. awk \u0026#39;{[pattern] action}\u0026#39; {filenames} # è¡ŒåŒ¹é…è¯­å¥ awk \u0026#39;\u0026#39; åªèƒ½ç”¨å•å¼•å· $ awk \u0026#39;{print $1,$4}\u0026#39; log.txt --------------------------------------------- 2 a 3 like This\u0026#39;s 10 orange,apple,mongo # æ ¼å¼åŒ–è¾“å‡º $ awk \u0026#39;{printf \u0026#34;%-8s %-10s\\n\u0026#34;,$1,$4}\u0026#39; log.txt --------------------------------------------- 2 a 3 like This\u0026#39;s 10 orange,apple,mongo 2. awk -F #-Fç›¸å½“äºå†…ç½®å˜é‡FS, æŒ‡å®šåˆ†å‰²å­—ç¬¦ # ä½¿ç”¨\u0026#34;,\u0026#34;åˆ†å‰² $ awk -F, \u0026#39;{print $1,$2}\u0026#39; log.txt --------------------------------------------- 2 this is a test 3 Are you like awk This\u0026#39;s a test 10 There are orange apple # æˆ–è€…ä½¿ç”¨å†…å»ºå˜é‡ $ awk \u0026#39;BEGIN{FS=\u0026#34;,\u0026#34;} {print $1,$2}\u0026#39; log.txt --------------------------------------------- 2 this is a test 3 Are you like awk This\u0026#39;s a test 10 There are orange apple # ä½¿ç”¨å¤šä¸ªåˆ†éš”ç¬¦.å…ˆä½¿ç”¨ç©ºæ ¼åˆ†å‰²ï¼Œç„¶åå¯¹åˆ†å‰²ç»“æœå†ä½¿ç”¨\u0026#34;,\u0026#34;åˆ†å‰² $ awk -F \u0026#39;[ ,]\u0026#39; \u0026#39;{print $1,$2,$5}\u0026#39; log.txt --------------------------------------------- 2 this test 3 Are awk This\u0026#39;s a 10 There apple 3. awk -v # è®¾ç½®å˜é‡ $ awk -va=1 \u0026#39;{print $1,$1+a}\u0026#39; log.txt --------------------------------------------- 2 3 3 4 This\u0026#39;s 1 10 11 $ awk -va=1 -vb=s \u0026#39;{print $1,$1+a,$1b}\u0026#39; log.txt --------------------------------------------- 2 3 2s 3 4 3s This\u0026#39;s 1 This\u0026#39;ss 10 11 10s 4. awk -f {awkè„šæœ¬} {æ–‡ä»¶å} awk -f cal.awk log.txt 5. è¿‡æ»¤ç¬¬ä¸€åˆ—å¤§äº2å¹¶ä¸”ç¬¬äºŒåˆ—ç­‰äº\u0026#39;Are\u0026#39;çš„è¡Œ $ awk \u0026#39;$1\u0026gt;2 \u0026amp;\u0026amp; $2==\u0026#34;Are\u0026#34; {print $1,$2,$3}\u0026#39; log.txt #å‘½ä»¤ #è¾“å‡º 3 Are you 6. è®¡ç®—å¤§å° awk \u0026#39;{sum+=$5} END {print sum}\u0026#39; 7. ä»æ–‡ä»¶ä¸­æ‰¾å‡ºé•¿åº¦å¤§äº 80 çš„è¡Œï¼š awk \u0026#39;length\u0026gt;80\u0026#39; log.txt nc 1 2 3 4 5 6 7 8 9 10 é€šè¿‡ nc ä¼ è¾“æ–‡ä»¶å’Œç›®å½• ç›®å½•ï¼š æ¥æ”¶ç«¯ï¼šnc -l 7777 | tar xf - å‘é€ç«¯ï¼štar cf - ${dir_name} | nc 192.168.1.1 7777 æ–‡ä»¶ï¼š å¾€10.105.135.50 ä¸Šä¼ è¾“æ–‡ä»¶ï¼š æ¥æ”¶ç«¯ï¼šnc -l 9999 \u0026gt; 123 å‘é€ç«¯ï¼šnc 10.105.135.50 9999 \u0026lt; 123 ","date":"0001-01-01T00:00:00Z","permalink":"https://MyLoveES.github.io/p/","title":""}]